<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="client-nojs">
<head>
<title>XEP-0079 - Jabber/XMPP中文翻译计划</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Jabber/XMPP中文翻译计划 (zh-cn)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.jabbercn.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Jabber/XMPP中文翻译计划的Atom" href="/index.php?title=%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9&amp;feed=atom" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=zh-cn&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: mediawiki:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */</style>
<script src="/load.php?debug=false&amp;lang=zh-cn&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "XEP-0079", "wgTitle": "XEP-0079", "wgCurRevisionId": 661, "wgArticleId": 12, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": ["XMPP扩展", "已翻译"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgSearchNamespaces": [0]});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
.source-xml {border: 1px dashed #2f6fab; color: black; background-color: #f9f9f9;}
.source-xml li, .source-xml pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for xml
 * CSS class: source-xml, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-xml .de1, .source-xml .de2 {font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;}
.source-xml  {font-family: monospace;}
.source-xml .imp {font-weight: bold; color: red;}
.source-xml li, .source-xml li.li1 {font-weight: normal;}
.source-xml li.li2 {font-weight: bold;}
.source-xml .co1 {color: #808080; font-style: italic;}
.source-xml .co2 {color: #404040; font-style: italic;}
.source-xml .co3 {color: #000000;}
.source-xml .co4 {color: #400000; font-weight: bold;}
.source-xml .es0 {color: #000099; font-weight: bold;}
.source-xml .br0 {color: #66cc66;}
.source-xml .sy0 {color: #66cc66;}
.source-xml .st0 {color: #ff0000;}
.source-xml .nu0 {color: #cc66cc;}
.source-xml .re0 {color: #000066;}
.source-xml .re1 {color: #000000; font-weight: bold;}
.source-xml .re2 {color: #000000; font-weight: bold;}
.source-xml .ln-xtra, .source-xml li.ln-xtra, .source-xml div.ln-xtra {background-color: #ffc;}
.source-xml span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-XEP-0079 action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">XEP-0079</h1>
	<div id="bodyContent">
		<div id="siteSub">来自Jabber/XMPP中文翻译计划</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">跳转到： <a href="#column-one">导航</a>, <a href="#searchInput">搜索</a></div>
		<!-- start content -->
<div lang="zh-cn" dir="ltr" class="mw-content-ltr"><p><br />
<b>本文的英文原文来自<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0079.html">XEP-0079</a></b>
</p><p><b>XEP-0079: 高级消息处理</b>
</p><p>摘要: 本文定义了一个XMPP协议扩展来实现实体请求,服务器执行的,高级XMPP message 节处理, 包括可靠数据传输, 时间敏感递送, 和临时消息的过期.
</p><p>作者: Matthew Miller, Peter Saint-Andre
</p><p>版权: © 1999 - 2010 XMPP标准化基金会(XSF). 参见<a href="/XEP-0079#.E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A" title="XEP-0079">法律通告</a>.
</p><p>状态: 草案
</p><p>类型: 标准跟踪
</p><p>版本: 1.2
</p><p>最后更新日期: 2005-11-30
</p><p>注意: 这里定义的协议是XMPP标准化基金会的一个<b>草案标准</b>.对本协议的执行是被鼓励的,也适于布署到生产系统,但是在它成为最终标准之前可能还会有一些变动.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目录</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E7.BB.AA.E8.AE.BA"><span class="tocnumber">1</span> <span class="toctext">绪论</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#.E5.8A.A8.E6.9C.BA"><span class="tocnumber">1.1</span> <span class="toctext">动机</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#.E6.A6.82.E5.BF.B5"><span class="tocnumber">1.2</span> <span class="toctext">概念</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#.E5.89.8D.E6.8F.90"><span class="tocnumber">1.3</span> <span class="toctext">前提</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#.E5.A4.84.E7.90.86.E6.B5.81.E7.A8.8B"><span class="tocnumber">2</span> <span class="toctext">处理流程</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#.E5.8F.91.E9.80.81.E8.80.85-.E5.88.B0-.E6.9C.8D.E5.8A.A1.E5.99.A8"><span class="tocnumber">2.1</span> <span class="toctext">发送者-到-服务器</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#.E5.8F.91.E7.8E.B0"><span class="tocnumber">2.1.1</span> <span class="toctext">发现</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#.E6.8C.87.E5.AE.9A.E8.AF.AD.E4.B9.89"><span class="tocnumber">2.1.2</span> <span class="toctext">指定语义</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#.E6.9C.8D.E5.8A.A1.E5.99.A8.E5.A4.84.E7.90.86"><span class="tocnumber">2.2</span> <span class="toctext">服务器处理</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#.E7.A1.AE.E8.AE.A4.E8.AF.AD.E4.B9.89"><span class="tocnumber">2.2.1</span> <span class="toctext">确认语义</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#.E5.86.B3.E5.AE.9A.E7.BC.BA.E7.9C.81.E5.8A.A8.E4.BD.9C"><span class="tocnumber">2.2.2</span> <span class="toctext">决定缺省动作</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#.E5.A4.84.E7.90.86.E8.A7.84.E5.88.99"><span class="tocnumber">2.2.3</span> <span class="toctext">处理规则</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#.E6.89.A7.E8.A1.8C.E5.86.B3.E5.AE.9A.E7.9A.84.E5.8A.A8.E4.BD.9C"><span class="tocnumber">2.2.4</span> <span class="toctext">执行决定的动作</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#.E8.BF.94.E5.9B.9E.E4.BA.8B.E4.BB.B6"><span class="tocnumber">2.2.5</span> <span class="toctext">返回事件</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#.E6.9D.A1.E4.BB.B6.E5.92.8C.E5.8A.A8.E4.BD.9C"><span class="tocnumber">3</span> <span class="toctext">条件和动作</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#.E8.A7.84.E5.88.99.E6.9D.A1.E4.BB.B6.E6.8C.87.E5.8D.97"><span class="tocnumber">3.1</span> <span class="toctext">规则条件指南</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#.E8.A7.84.E5.88.99.E5.8A.A8.E4.BD.9C.E6.8C.87.E5.8D.97"><span class="tocnumber">3.2</span> <span class="toctext">规则动作指南</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#.E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6"><span class="tocnumber">3.3</span> <span class="toctext">定义的条件</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#.E9.80.92.E9.80.81"><span class="tocnumber">3.3.1</span> <span class="toctext">递送</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#.E6.9C.9F.E6.BB.A1"><span class="tocnumber">3.3.2</span> <span class="toctext">期满</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#.E5.8C.B9.E9.85.8D.E8.B5.84.E6.BA.90"><span class="tocnumber">3.3.3</span> <span class="toctext">匹配资源</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-22"><a href="#.E5.AE.9A.E4.B9.89.E7.9A.84.E5.8A.A8.E4.BD.9C"><span class="tocnumber">3.4</span> <span class="toctext">定义的动作</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#.E8.AD.A6.E5.91.8A"><span class="tocnumber">3.4.1</span> <span class="toctext">警告</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#.E4.B8.A2.E5.BC.83"><span class="tocnumber">3.4.2</span> <span class="toctext">丢弃</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#.E9.94.99.E8.AF.AF"><span class="tocnumber">3.4.3</span> <span class="toctext">错误</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#.E9.80.9A.E7.9F.A5"><span class="tocnumber">3.4.4</span> <span class="toctext">通知</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#.E6.9D.A1.E4.BB.B6.2F.E5.8A.A8.E4.BD.9C.E8.81.94.E5.90.88.E6.8F.8F.E8.BF.B0"><span class="tocnumber">3.5</span> <span class="toctext">条件/动作联合描述</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#.E9.80.92.E9.80.81.E8.A7.84.E5.88.99"><span class="tocnumber">3.5.1</span> <span class="toctext">递送规则</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#.E6.9C.9F.E6.BB.A1.E8.A7.84.E5.88.99"><span class="tocnumber">3.5.2</span> <span class="toctext">期满规则</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#.E8.B5.84.E6.BA.90.E5.8C.B9.E9.85.8D.E8.A7.84.E5.88.99"><span class="tocnumber">3.5.3</span> <span class="toctext">资源匹配规则</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-31"><a href="#.E6.AD.A3.E5.BC.8F.E6.8F.8F.E8.BF.B0"><span class="tocnumber">4</span> <span class="toctext">正式描述</span></a>
<ul>
<li class="toclevel-2 tocsection-32"><a href="#.3Camp.2F.3E.E6.A0.B9.E5.85.83.E7.B4.A0"><span class="tocnumber">4.1</span> <span class="toctext">&lt;amp/&gt;根元素</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#.3Crule.2F.3E.E5.85.83.E7.B4.A0"><span class="tocnumber">4.2</span> <span class="toctext">&lt;rule/&gt;元素</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-34"><a href="#.E7.A4.BA.E4.BE.8B.E5.9C.BA.E6.99.AF"><span class="tocnumber">5</span> <span class="toctext">示例场景</span></a>
<ul>
<li class="toclevel-2 tocsection-35"><a href="#.E5.8F.AF.E9.9D.A0.E6.95.B0.E6.8D.AE.E4.BC.A0.E8.BE.93"><span class="tocnumber">5.1</span> <span class="toctext">可靠数据传输</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#.E6.97.B6.E9.97.B4.E6.95.8F.E6.84.9F.E6.B6.88.E6.81.AF"><span class="tocnumber">5.2</span> <span class="toctext">时间敏感消息</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#.E7.9E.AC.E6.97.B6.E6.B6.88.E6.81.AF"><span class="tocnumber">5.3</span> <span class="toctext">瞬时消息</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#.E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86"><span class="tocnumber">6</span> <span class="toctext">错误处理</span></a>
<ul>
<li class="toclevel-2 tocsection-39"><a href="#.E6.9D.A1.E4.BB.B6"><span class="tocnumber">6.1</span> <span class="toctext">条件</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#.E4.BE.8B.E5.AD.90"><span class="tocnumber">6.2</span> <span class="toctext">例子</span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E7.9A.84.E5.8A.A8.E4.BD.9C"><span class="tocnumber">6.2.1</span> <span class="toctext">不支持的动作</span></a></li>
<li class="toclevel-3 tocsection-42"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E7.9A.84.E6.9D.A1.E4.BB.B6"><span class="tocnumber">6.2.2</span> <span class="toctext">不支持的条件</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#.E4.B8.8D.E8.A2.AB.E6.8E.A5.E5.8F.97"><span class="tocnumber">6.2.3</span> <span class="toctext">不被接受</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#.E6.9C.8D.E5.8A.A1.E4.B8.8D.E5.8F.AF.E7.94.A8"><span class="tocnumber">6.2.4</span> <span class="toctext">服务不可用</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#.E6.9C.AA.E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6"><span class="tocnumber">6.2.5</span> <span class="toctext">未定义的条件</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-46"><a href="#.E5.AE.9E.E7.8E.B0.E5.A4.87.E6.B3.A8"><span class="tocnumber">7</span> <span class="toctext">实现备注</span></a></li>
<li class="toclevel-1 tocsection-47"><a href="#.E6.B5.81.E7.89.B9.E6.80.A7"><span class="tocnumber">8</span> <span class="toctext">流特性</span></a></li>
<li class="toclevel-1 tocsection-48"><a href="#.E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9"><span class="tocnumber">9</span> <span class="toctext">安全事项</span></a></li>
<li class="toclevel-1 tocsection-49"><a href="#IANA.E4.BA.8B.E9.A1.B9"><span class="tocnumber">10</span> <span class="toctext">IANA事项</span></a></li>
<li class="toclevel-1 tocsection-50"><a href="#XMPP.E6.B3.A8.E5.86.8C.E4.BA.8B.E9.A1.B9"><span class="tocnumber">11</span> <span class="toctext">XMPP注册事项</span></a>
<ul>
<li class="toclevel-2 tocsection-51"><a href="#.E5.8D.8F.E8.AE.AE.E5.90.8D.E5.AD.97.E7.A9.BA.E9.97.B4"><span class="tocnumber">11.1</span> <span class="toctext">协议名字空间</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#.E6.B5.81.E7.89.B9.E6.80.A7_2"><span class="tocnumber">11.2</span> <span class="toctext">流特性</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#.E7.9F.A5.E5.90.8D.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E8.8A.82.E7.82.B9"><span class="tocnumber">11.3</span> <span class="toctext">知名服务发现节点</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#.E6.B3.A8.E5.86.8C.E9.A1.B9"><span class="tocnumber">11.4</span> <span class="toctext">注册项</span></a>
<ul>
<li class="toclevel-3 tocsection-55"><a href="#.E8.A7.84.E5.88.99.E6.9D.A1.E4.BB.B6.E6.B3.A8.E5.86.8C.E9.A1.B9"><span class="tocnumber">11.4.1</span> <span class="toctext">规则条件注册项</span></a>
<ul>
<li class="toclevel-4 tocsection-56"><a href="#.E8.BF.87.E7.A8.8B"><span class="tocnumber">11.4.1.1</span> <span class="toctext">过程</span></a></li>
<li class="toclevel-4 tocsection-57"><a href="#.E6.9C.80.E4.BD.8E.E8.A6.81.E6.B1.82"><span class="tocnumber">11.4.1.2</span> <span class="toctext">最低要求</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-58"><a href="#.E8.A7.84.E5.88.99.E5.8A.A8.E4.BD.9C.E6.B3.A8.E5.86.8C.E9.A1.B9"><span class="tocnumber">11.4.2</span> <span class="toctext">规则动作注册项</span></a>
<ul>
<li class="toclevel-4 tocsection-59"><a href="#.E8.BF.87.E7.A8.8B_2"><span class="tocnumber">11.4.2.1</span> <span class="toctext">过程</span></a></li>
<li class="toclevel-4 tocsection-60"><a href="#.E5.88.9D.E5.A7.8B.E6.8F.90.E4.BA.A4"><span class="tocnumber">11.4.2.2</span> <span class="toctext">初始提交</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-61"><a href="#XML.E6.9E.B6.E6.9E.84"><span class="tocnumber">12</span> <span class="toctext">XML架构</span></a>
<ul>
<li class="toclevel-2 tocsection-62"><a href="#AMP"><span class="tocnumber">12.1</span> <span class="toctext">AMP</span></a></li>
<li class="toclevel-2 tocsection-63"><a href="#.E9.94.99.E8.AF.AF_2"><span class="tocnumber">12.2</span> <span class="toctext">错误</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#.E6.B5.81.E7.89.B9.E6.80.A7_3"><span class="tocnumber">12.3</span> <span class="toctext">流特性</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-65"><a href="#.E8.87.B4.E8.B0.A2"><span class="tocnumber">13</span> <span class="toctext">致谢</span></a></li>
<li class="toclevel-1 tocsection-66"><a href="#.E9.99.84.E5.BD.95"><span class="tocnumber">14</span> <span class="toctext">附录</span></a>
<ul>
<li class="toclevel-2 tocsection-67"><a href="#.E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF"><span class="tocnumber">14.1</span> <span class="toctext">附录A:文档信息</span></a></li>
<li class="toclevel-2 tocsection-68"><a href="#.E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF"><span class="tocnumber">14.2</span> <span class="toctext">附录B:作者信息</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A"><span class="tocnumber">14.3</span> <span class="toctext">附录C:法律通告</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB"><span class="tocnumber">14.4</span> <span class="toctext">附录D:和XMPP的关系</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9"><span class="tocnumber">14.5</span> <span class="toctext">附录E:讨论地点</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7"><span class="tocnumber">14.6</span> <span class="toctext">附录F:需求一致性</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8"><span class="tocnumber">14.7</span> <span class="toctext">附录G:备注</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#.E9.99.84.E5.BD.95H:.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2"><span class="tocnumber">14.8</span> <span class="toctext">附录H:修订历史</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id=".E7.BB.AA.E8.AE.BA">绪论</span></h2>
<p>本文定义了一个协议让终端实体能够为一个XMPP &lt;message/&gt;节指定附加的递送语义. 本协议通常用于客户端通知接收服务器如何递送一个特殊的节, 例如提供一个失效期或资源匹配策略
</p>
<h3> <span class="mw-headline" id=".E5.8A.A8.E6.9C.BA">动机</span></h3>
<p>&lt;message/&gt;节的内置递送语义(定义于<a href="/RFC3920" title="RFC3920">XMPP Core</a> <a href="/index.php?title=XEP-0079-&amp;action=edit&amp;redlink=1" class="new" title="XEP-0079-（尚未撰写）">1</a>, 对即时消息应用来说,也定义于<a href="/RFC3921" title="RFC3921">XMPP IM</a> <a href="/index.php?title=XEP-0079-&amp;action=edit&amp;redlink=1" class="new" title="XEP-0079-（尚未撰写）">2</a>),对目前大多数的应用,是足够的. 无论如何, 更严格的递送语义在很多情况下还是需要的. 本文讨论的是最常见的一些情况:
</p>
<ul><li> 可靠的数据传输 -- 发送者要求消息递送的通知(肯定的和/或否定的).
</li></ul>
<ul><li> 时间敏感的消息 -- 消息仅在特定的日期和时间之前是合法的.
</li></ul>
<ul><li> 临时消息 -- 消息不应该离线存储用于以后的递送.
</li></ul>
<h3> <span class="mw-headline" id=".E6.A6.82.E5.BF.B5">概念</span></h3>
<p>本协议主要由服务器或处理&lt;message/&gt;的服务来处理. 协议包括一系列的规则, 每个规则有相应的条件和动作. 在收到一个适当标记的消息之后, 服务器解析它们所收到的规则, 寻找吻合的条件. 当一个条件吻合时, 那个规则的相应动作被执行, 同时消息处理停止.
</p><p>每个规则受限于它所应用的范围, 要么是全部路由, 或者是路由的每一跳. 另外, 虽然本文定义了一套缺省的条件和动作, 本协议有足够的可扩展性允许将来更多的定义.
</p><p>本协议的名字空间是"<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp">http://jabber.org/protocol/amp</a>".
</p>
<h3> <span class="mw-headline" id=".E5.89.8D.E6.8F.90">前提</span></h3>
<p>为了本协议能够正常执行, 包含的&lt;message/&gt;节必须(MUST)拥有一个'id'属性并且'id'属性的值不能(MUST NOT)是一个空的字符串. 服务器必须(MUST)在任何给发送者的应答中包含这个'id'属性值; 这使服务器和客户端能把初始的请求正确关联到接下来的任何警报,错误,或通知中.
</p>
<h2> <span class="mw-headline" id=".E5.A4.84.E7.90.86.E6.B5.81.E7.A8.8B">处理流程</span></h2>
<h3> <span class="mw-headline" id=".E5.8F.91.E9.80.81.E8.80.85-.E5.88.B0-.E6.9C.8D.E5.8A.A1.E5.99.A8">发送者-到-服务器</span></h3>
<p>以下用例描述了发送者和服务器之间的交互. 如下所示, 这个交互实际上很简单:
</p>
<ol><li> 发送者确定支持(E1)
</li><li> 发送者指定适当的规则并发送消息给服务器(E1,E2)
</li><li> 发送者等待任何协议定义的应答(UCE)
</li></ol>
<ul><li> E1: 服务器不支持本协议(UCE unsuccessfully)
</li></ul>
<ul><li> E2: 服务器不支持一个或多个定义的规则条件/动作(UCE unsuccessfully)
</li></ul>
<h4> <span class="mw-headline" id=".E5.8F.91.E7.8E.B0">发现</span></h4>
<p>希望使用AMP的发送实体应该(SHOULD)向预定的路径查询对本协议的支持(使用<a href="/XEP-0030" title="XEP-0030">服务发现</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">3</a>). 一般来说, 这包括发送 disco#info 查询 给发送者本身所在的服务器以及接收者的服务器. 这些查询的结果可以(MAY)被缓存24小时, 除非有其他原因过期.
</p><p>如果一个服务器支持高级消息处理, 它必须(MUST)在返回给请求实体的服务查询信息结果中包含一个服务特性"<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp">http://jabber.org/protocol/amp</a>"来报告.
</p><p><b>例子 1. 初始化服务发现信息请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit/westminster'</span>
    <span class="re0">to</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 2. 服务发现信息应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit/westminster'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">name</span>=<span class="st0">'Shakespeare IM'</span> <span class="re0">category</span>=<span class="st0">'im'</span> <span class="re0">type</span>=<span class="st0">'server'</span><span class="re2">/&gt;</span><span class="co3">
    ...
    </span><span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">/&gt;</span><span class="co3">
    ...
  </span><span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>一个服务器也应该(SHOULD)维护一个名为"<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp">http://jabber.org/protocol/amp</a>"的服务查询节点, 在那里声明它支持的单个的动作和条件. 如果一个实体需要决定是否服务器支持单个的动作和条件, 它应该(SHOULD)发送一个服务发现信息请求给那个节点; 然后服务器必须(MUST)要么返回支持的动作和条件列表要么返回一个错误例如&lt;feature-not-implemented/&gt;. (注意: 如果这个服务器节点不为此查询节点提供信息, 请求实体必须(MUST)认为每一个动作集或条件集的所有动作和条件都被支持.)
</p><p>每个支持的动作将被报告成一个特性,使用以下格式:
</p>
<pre>
http://jabber.org/protocol/amp?action={action}
</pre>
<p>每个支持的条件将被报告成一个特性, 使用以下格式:
</p>
<pre>
http://jabber.org/protocol/amp?condition={condition}
</pre>
<p>以下展示的 请求-应答 流的例子是关于独立的动作和条件的信息(注意'node'属性中包含了什么).
</p><p><b>例子 3. 对于独立动作和条件的信息的请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit/westminster'</span>
    <span class="re0">to</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 4. 对于独立动作和条件的应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit/westminster'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">name</span>=<span class="st0">'Shakespeare IM AMP Support'</span> <span class="re0">category</span>=<span class="st0">'im'</span> <span class="re0">type</span>=<span class="st0">'server'</span><span class="re2">/&gt;</span><span class="co3">
    ...
    </span><span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?action=drop'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?action=error'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?action=notify'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?condition=deliver'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?condition=expire-at'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/amp?condition=match-resource'</span><span class="re2">/&gt;</span><span class="co3">
    ...
  </span><span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.8C.87.E5.AE.9A.E8.AF.AD.E4.B9.89">指定语义</span></h4>
<p>一旦支持被确定了, 发送者就可以附加期望的递送语义给消息:
</p><p><b>例子 5. 一个伴随 AMP 语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span>
          <span class="re0">action</span>=<span class="st0">'drop'</span>
          <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>那些语义作为一组 &lt;rule/&gt; 元素定义在 &lt;amp/&gt; 根元素中. 每个 &lt;rule/&gt; 声明一个触发条件和触发后执行的动作.
</p><p>缺省的, 规则集仅用于 "边缘服务器": 那些发送和接收实体所连接的服务器. (注意: 为了实现高级消息处理, 这里 "服务器" 被定义为在 <b>XMPP Core</b> 范畴之内并且不包括任何内部组件(可能在服务器实现或安装中提供功能), 如连接管理器 .)
</p><p>通过增加"per-hop"属性给 &lt;amp/&gt; 元素, 规则集可以(MAY)应用于从发送实体到接收实体的路由中的 服务器-服务器 的每一"跳". 这个属性的值要么是 "true" (应用规则于每一跳) 要么是 "false" (保持缺省行为, 也就是, 规则仅应用于边缘服务器).
</p><p><b>例子 6. 另一个伴随 AMP 语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
       <span class="re0">per-hop</span>=<span class="st0">'true'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span>
          <span class="re0">action</span>=<span class="st0">'drop'</span>
          <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>关于失败确认的例子, 参考本文的<a href="/XEP-0079#.E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86" title="XEP-0079">错误处理</a>章.
</p><p>注意: 即使 "per-hop" 处理被请求, 路由中的每一个服务器必须(MUST)忽略它无法应用的规则; <a href="/XEP-0079#.E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6" title="XEP-0079">定义的条件</a>说明了是否它们能被应用于每一跳.
</p>
<h3> <span class="mw-headline" id=".E6.9C.8D.E5.8A.A1.E5.99.A8.E5.A4.84.E7.90.86">服务器处理</span></h3>
<p>服务器操作大多在此处执行. 接收到一个包含 AMP 扩展的消息之后, 服务器执行以下流程:
</p><p>1. 确认语义 (E1, E2).
</p><p>2. 决定缺省行为.
</p><p>3. 处理规则直到条件吻合.
</p>
<dl><dd><ul><li> 如果条件吻合, 执行那个规则的动作
</li><li> 如果没有条件吻合, 执行那个消息的 "缺省" 行为
</li></ul>
</dd></dl>
<p>4. 运行决定的动作 (UCE) (E3).
</p>
<dl><dd><ul><li> E1: 已提供的语义 (条件和/或动作) 不被支持或不合法 (UCE 不成功的)
</li><li> E2: 请求的语义不可接受(UCE 不成功的)
</li><li> E3: 下一个服务器不支持此协议(UCE 不成功的)
</li></ul>
</dd></dl>
<h4> <span class="mw-headline" id=".E7.A1.AE.E8.AE.A4.E8.AF.AD.E4.B9.89">确认语义</span></h4>
<p>确认可以采取多种方式, 但是最少服务器必须(MUST)确认它理解每一个规则条件和动作, 并且条件内容是适当的. 服务器也可以(MAY)拒绝接受特定的条件和动作组合, 例如如果他们会导致违反安全策略的风险. 如果语义不合法, 不被支持, 或不被接受, 服务器必须(MUST)应答一个错误指出那些卷入的规则. 服务器应当(SHOULD)在返回错误之前确认所有语义. 关于和确认失败相关的错误处理语法和例子, 参考本文的<a href="/XEP-0079#.E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86" title="XEP-0079">错误处理</a>章.
</p>
<h4> <span class="mw-headline" id=".E5.86.B3.E5.AE.9A.E7.BC.BA.E7.9C.81.E5.8A.A8.E4.BD.9C">决定缺省动作</span></h4>
<p>这一步是原本服务器通常应该做的, 除了那些不确定执行的动作. 它决定如果没有语义附加到一个消息的时候将会发生什么(例如分发给另一个服务器或离线存储). 在这一点, 服务器也应该(SHOULD)计算任何定时或日历需求(如果可以应用的话).
</p>
<h4> <span class="mw-headline" id=".E5.A4.84.E7.90.86.E8.A7.84.E5.88.99">处理规则</span></h4>
<p>在这一步, 服务器处理附加的语义. 服务器必须(MUST)顺序处理规则, 并且是按照它们在 &lt;amp/&gt; 元素中出现的顺序. 一旦一个规则的条件吻合, 处理结束于那一个动作并超越前面定义的缺省动作(除非这个动作允许继续处理).
</p>
<h4> <span class="mw-headline" id=".E6.89.A7.E8.A1.8C.E5.86.B3.E5.AE.9A.E7.9A.84.E5.8A.A8.E4.BD.9C">执行决定的动作</span></h4>
<p>一旦所有规则被处理或其他合理的理由, 服务器在这一点执行决定的动作.
</p><p>服务器不应该(SHOULD NOT)分发一个包含 AMP 语义的 &lt;message/&gt; 节给另一个服务器, 除非它知道下一个服务器支持 AMP (这应该(SHOULD)通过<b>服务发现</b>协议来查询并可以(MAY)缓存以防止递送延迟). 如果下一个服务器不支持 AMP, 当前服务器应答给原始发送者一个 &lt;service-unavailable/&gt; 错误条件. 否则流程再次从那个消息已分发到其中的服务器开始.
</p>
<h4> <span class="mw-headline" id=".E8.BF.94.E5.9B.9E.E4.BA.8B.E4.BB.B6">返回事件</span></h4>
<p>如果决定的动作包括返回一个事件(警告, 错误, 或通知) 给发送者, 服务器必须(MUST)发送一个&lt;message/&gt; 节给发送者, 包含那个吻合的规则. 这个 &lt;message/&gt; 节必须(MUST)包含初始的'id'属性值并且不应该(SHOULD NOT)包含开始发送者发送的非-AMP 的内容(例如, &lt;body/&gt; 子元素).
</p>
<h2> <span class="mw-headline" id=".E6.9D.A1.E4.BB.B6.E5.92.8C.E5.8A.A8.E4.BD.9C">条件和动作</span></h2>
<p>本文的前面章节中定义了关于 AMP 的一般行为. 本章概述怎样设置 &lt;rule/&gt; 动作和条件集. 它也提供定义的动作和条件集; 这些动作和条件集应该(SHOULD)被任何 AMP 的实现所支持, 但是对任何动作或条件集的支持不是必需的. (注意: 这里定义的动作和条件集可以在将来补充, 只要在 XMPP Registrar中注册新增的动作和条件集.)
</p>
<h3> <span class="mw-headline" id=".E8.A7.84.E5.88.99.E6.9D.A1.E4.BB.B6.E6.8C.87.E5.8D.97">规则条件指南</span></h3>
<p>一个 &lt;rule/&gt; 条件必须(MUST)提供以下信息:
</p>
<ul><li> 定义一个管理条件集的名字空间
</li></ul>
<ul><li> 定义条件:
</li></ul>
<ul><li><ul><li> 定义 'condition' 属性值
</li></ul>
</li></ul>
<ul><li><ul><li> 指定 "per-hop" 标记(如果应用了的话)
</li></ul>
</li></ul>
<ul><li><ul><li> 定义 'value' 属性值的语法/格式
</li></ul>
</li></ul>
<ul><li><ul><li> 定义 "value" 如何与条件匹配
</li></ul>
</li></ul>
<h3> <span class="mw-headline" id=".E8.A7.84.E5.88.99.E5.8A.A8.E4.BD.9C.E6.8C.87.E5.8D.97">规则动作指南</span></h3>
<p>一个 &lt;rule/&gt; 动作的定义必须(MUST)提供以下信息:
</p>
<ul><li> 定义一个管理动作集的名字空间
</li></ul>
<ul><li> 定义动作:
</li></ul>
<ul><li><ul><li> 定义每个 'action' 属性值
</li></ul>
</li></ul>
<ul><li><ul><li> 定义 &lt;rule/&gt; 被触发之后期望的行为
</li></ul>
</li></ul>
<h3> <span class="mw-headline" id=".E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6">定义的条件</span></h3>
<p>条件定义了一个典型的规则如何或何时被触发. 条件属性的值决定 &lt;rule/&gt; 内容的含义.
</p><p>以下本文定义的条件应该(SHOULD)被所有实现支持.
</p><p>在以下章节中, 术语 "content" 和 "contents" 参考包含在 &lt;rule/&gt; 元素中的XML字符数据.
</p>
<h4> <span class="mw-headline" id=".E9.80.92.E9.80.81">递送</span></h4>
<p>"deliver" 条件用于在以下五种情况下确保递送 (或不递送):
</p>
<ol><li> 通过 XMPP 直接给指定的地址或帐号
</li><li> 延迟递送离线储存 (用于以后通过 XMPP 递送)
</li><li> 通过 XMPP 转发给替代的地址或帐号
</li><li> 通过一个网关非直接地发给一个替代的非XMPP系统地址或帐号
</li></ol>
<p>在条件吻合的时候在接收的这一刻处理器将对这些消息做些什么, 如下:
</p><p><b>表 1: "deliver" 值</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>值 </th>
<th> 描述
</th></tr>
<tr>
<td>direct </td>
<td> 消息将被立刻递送给指定的接收者或路由到下一跳.
</td></tr>
<tr>
<td>forward </td>
<td> 消息将被转发给另一个 XMPP 地址或帐号.
</td></tr>
<tr>
<td>gateway </td>
<td> 消息将通过网关发送给一个 非XMPP 系统的地址或帐号.
</td></tr>
<tr>
<td>none </td>
<td> 消息将根本不被递送 (例如, 因为指定的接收者离线并且消息存储不被允许).
</td></tr>
<tr>
<td>stored </td>
<td> 消息将被离线存储用于以后递送给指定的接收者.
</td></tr></table>
<p>这个条件可以(MAY)应用于服务器路由中的每一 "跳".
</p>
<h4> <span class="mw-headline" id=".E6.9C.9F.E6.BB.A1">期满</span></h4>
<p>"expire-at"条件用于确保在一个绝对的时间点之前递送. 很自然的, 这不保证<a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">4</a> 从发送者的角度来看那个消息在那个时间之后不被发送, 因为本文没有假定所有机器(例如, 对于递送路由中的所有服务器)的时钟是同步的. 无论如何, 为了帮助确保这一条件正确地匹配, 那些实现了本文的服务器(或那些承载了这类服务的机器) 应该(SHOULD)使用网络时间协议(<a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc1305">RFC 1305</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">5</a>)和已确定的授时保持同步. 也要注意 期满 时间离当前时间越近则 期满 功能越不可靠(例如, 一个消息指定的 期满 时间为两秒比起设置为两小时或两天, 发送者将会更容易得到不可靠的递送).
</p><p>'value'属性的内容定义了消息发送的准确时间之后的一些点; 它的内容必须(MUST)是一个 DateTime (定义在 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">6</a>), 并且时区必须(MUST)是 UTC.
</p><p>如果消息将在指定的日期时间之后发送, 则条件成立. 要决定时间的比较, 处理器首先要决定是否以及何时一个消息能被分发(例如不是离线存储). 然后处理器记录这个时间, 并把它和指定的时间比较. 如果当前的时间正好在指定时间或在指定时间之后, 则条件吻合.
</p><p>这个条件可以(MAY)被应用于服务器路由中的每一"跳".
</p>
<h4> <span class="mw-headline" id=".E5.8C.B9.E9.85.8D.E8.B5.84.E6.BA.90">匹配资源</span></h4>
<p>"match-resource"条件用于基于接收者的 JID 中的 资源ID 来限制递送.
</p><p>这个条件的定义值如下:
</p><p><b>表 2: "match-resource"值</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>值 </th>
<th> 描述 </th>
<th> 例子
</th></tr>
<tr>
<td>any </td>
<td> 目标资源匹配任何值, 高效地忽略任何指定的资源. </td>
<td> "home/laptop"匹配"home", "home/desktop"或"work/desktop"
</td></tr>
<tr>
<td>exact </td>
<td> 目标资源精确匹配指定的资源. </td>
<td> "home/laptop"只匹配"home/laptop"而不是"home/desktop"或"work/desktop"
</td></tr>
<tr>
<td>other </td>
<td> 目标资源匹配任何除指定资源之外的值. </td>
<td> "home/laptop"匹配"work/desktop", "home"或"home/desktop", 但不包括"home/laptop"
</td></tr></table>
<p>按照上述规则, 如果实际的目标JID的资源匹配指定的JID, 则条件成立. 例如, 如果一个消息指定给"romeo@montague.net/work", 伴随"exact"的"match-resource"条件 , 如果这个消息只能立刻被发送给"romeo@montague.net/work", 则条件吻合.
</p><p>为了达到这个条件的目的, 一个没有资源的特定 JID 有以下行为:
</p>
<ul><li> 如果值为"exact", 仅当服务器将发送给一个没有资源ID的目标JID时,条件成立(例如, 一个 <a href="/XEP-0045" title="XEP-0045">多用户聊天</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">7</a> 房间 或离线存储).
</li></ul>
<ul><li> 如果值为"other", 仅当服务器将不递送给没有资源ID的目标JID时, 条件成立.
</li></ul>
<p>这个条件不能(MUST NOT)被应用于服务器路由的每一"跳", 只能用于边缘服务器. 如果一个 &lt;amp/&gt; 元素包含了这个条件并且指明它将被每一跳处理, 这个 &lt;rule/&gt; 将被忽略.
</p><p>注意: 从设计上说, 这个协议不包含局部资源匹配的支持(它将导致, 例如, 资源ID"home/laptop"和"homeboy"都匹配"home").
</p>
<h3> <span class="mw-headline" id=".E5.AE.9A.E4.B9.89.E7.9A.84.E5.8A.A8.E4.BD.9C">定义的动作</span></h3>
<p>动作定义了当一个特定的规则被触发时将发生什么. 动作属性的值决定如果一个规则的条件被触发之后的行为.
</p><p>以下动作由本文定义.
</p>
<h4> <span class="mw-headline" id=".E8.AD.A6.E5.91.8A">警告</span></h4>
<p>"alert"动作触发一个应答 &lt;message/&gt; 节给发送实体. 这个 &lt;message/&gt; 节必须(MUST)包含元素&lt;amp status='alert'/&gt;, 它本身包含触发这个动作的 &lt;rule/&gt; . 在所有其他的关系中In all other respects, 这个动作表现为"drop".
</p><p><b>例子 7. 警告 应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre>  <span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
           <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
           <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
         <span class="re0">status</span>=<span class="st0">'alert'</span>
         <span class="re0">from</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'alert'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.B8.A2.E5.BC.83">丢弃</span></h4>
<p>"drop"动作安静地从任何更多递送尝试中丢弃消息并确保它不会被离线存储. drop 不能(MUST NOT)导致任何其他应答.
</p>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF">错误</span></h4>
<p>"error"动作触发一个类型为"error"的应答 &lt;message/&gt; 节给发送实体. 这个 &lt;message/&gt; 节的 &lt;error/&gt; 子元素必须(MUST)包含一个 &lt;failed-rules xmlns='<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp#errors'/">http://jabber.org/protocol/amp#errors'/</a>&gt; 错误条件, 它本身包含触发这个动作的规则.
</p><p><b>例子 8. 错误应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre>  <span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
           <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
           <span class="re0">type</span>=<span class="st0">'error'</span>
           <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
         <span class="re0">status</span>=<span class="st0">'error'</span>
         <span class="re0">from</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
    <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'500'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;undefined-condition</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;failed-rules</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp#errors'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/failed-rules<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>注意这个错误应该(SHOULD)类型为"modify", 并且一般错误条件应该(SHOULD) 是&lt;undefined-condition xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;.
</p>
<h4> <span class="mw-headline" id=".E9.80.9A.E7.9F.A5">通知</span></h4>
<p>"notify"动作触发一个应答 &lt;message/&gt; 节给发送实体. 这个 &lt;message/&gt; 节应该(MUST)包含元素 &lt;amp status='notify'/&gt;, 它本身包含触发这个动作的 &lt;rule/&gt; . 不像其他动作, 这个动作不超越服务器的缺省行为. 取而代之的是, 服务器在发送这个通知之后执行它的缺省行为.
</p><p><b>例子 9. 通知应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre>  <span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
           <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
           <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
         <span class="re0">status</span>=<span class="st0">'notify'</span>
         <span class="re0">from</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'notify'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.9D.A1.E4.BB.B6.2F.E5.8A.A8.E4.BD.9C.E8.81.94.E5.90.88.E6.8F.8F.E8.BF.B0">条件/动作联合描述</span></h3>
<p>一般来说, 一个规则被视为"如果 {condition} 对于 {value} 是真就去做 {action}"; 无论如何, 为了便于理解, 本章以简单文字来描述多种多样的条件/动作联合.
</p>
<h4> <span class="mw-headline" id=".E9.80.92.E9.80.81.E8.A7.84.E5.88.99">递送规则</span></h4>
<p>当条件是"deliver", 规则可能被描述如下:
</p><p><b>表 3: 递送规则</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>动作 </th>
<th> 值 </th>
<th> 描述
</th></tr>
<tr>
<td>alert </td>
<td> direct </td>
<td> 返回一个警告如果消息将被直接递送.
</td></tr>
<tr>
<td>alert </td>
<td> forward </td>
<td> 返回一个警告如果消息将被转发给另一个 XMPP 地址.
</td></tr>
<tr>
<td>alert </td>
<td> gateway </td>
<td> 返回一个警告如果消息将通过一个网关递送到一个非XMPP地址.
</td></tr>
<tr>
<td>alert </td>
<td> none </td>
<td> 返回一个警告如果消息无法递送.
</td></tr>
<tr>
<td>alert </td>
<td> stored </td>
<td> 返回一个警告如果消息将被离线存储用于以后通过 XMPP 递送.
</td></tr>
<tr>
<td>drop </td>
<td> direct </td>
<td> 丢弃这个消息如果它将被直接递送.
</td></tr>
<tr>
<td>drop </td>
<td> forward </td>
<td> 丢弃这个消息如果它将被转发到另一个 XMPP 地址.
</td></tr>
<tr>
<td>drop </td>
<td> gateway </td>
<td> 丢弃这个消息如果它将通过一个网关递送到一个非XMPP地址.
</td></tr>
<tr>
<td>drop </td>
<td> none </td>
<td> 丢弃这个消息如果它无法递送.
</td></tr>
<tr>
<td>drop </td>
<td> stored </td>
<td> 丢弃这个消息如果它将被离线存储用于以后通过 XMPP 递送.
</td></tr>
<tr>
<td>error </td>
<td> direct </td>
<td> 返回一个错误如果消息将被直接递送.
</td></tr>
<tr>
<td>error </td>
<td> forward </td>
<td> 返回一个错误如果消息将被转发给另一个 XMPP 地址.
</td></tr>
<tr>
<td>error </td>
<td> gateway </td>
<td> 返回一个错误如果消息将通过一个网关递送到一个非XMPP地址.
</td></tr>
<tr>
<td>error </td>
<td> none </td>
<td> 返回一个错误如果消息无法递送.
</td></tr>
<tr>
<td>error </td>
<td> stored </td>
<td> 返回一个错误如果消息将被离线存储用于以后通过 XMPP 递送.
</td></tr>
<tr>
<td>notify </td>
<td> direct </td>
<td> 返回一个通知如果消息将被直接递送.
</td></tr>
<tr>
<td>notify </td>
<td> forward </td>
<td> 返回一个通知如果消息将被转发给另一个 XMPP 地址.
</td></tr>
<tr>
<td>notify </td>
<td> gateway </td>
<td> 返回一个通知如果消息将通过一个网关递送到一个非XMPP地址.
</td></tr>
<tr>
<td>notify </td>
<td> none </td>
<td> 返回一个通知如果消息无法递送.
</td></tr>
<tr>
<td>notify </td>
<td> stored </td>
<td> 返回一个通知如果消息将被离线存储用于以后通过 XMPP 递送.
</td></tr></table>
<h4> <span class="mw-headline" id=".E6.9C.9F.E6.BB.A1.E8.A7.84.E5.88.99">期满规则</span></h4>
<p>当一个条件是"expire-at", 规则描述如下:
</p><p><b>表 4: 期满规则</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>动作 </th>
<th> 描述
</th></tr>
<tr>
<td>alert </td>
<td> 返回一个警告如果消息将在指定的时间戳之后递送.
</td></tr>
<tr>
<td>drop </td>
<td> 丢弃这个消息如果它将在指定的时间戳之后递送.
</td></tr>
<tr>
<td>error </td>
<td> 返回一个错误如果消息将在指定的时间戳之后递送.
</td></tr>
<tr>
<td>notify </td>
<td> 返回一个通知如果消息将在指定的时间戳之后递送.
</td></tr></table>
<h4> <span class="mw-headline" id=".E8.B5.84.E6.BA.90.E5.8C.B9.E9.85.8D.E8.A7.84.E5.88.99">资源匹配规则</span></h4>
<p>当一个条件是"match-resource", 规则描述如下:
</p><p><b>表 5: 资源匹配规则</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>动作 </th>
<th> 值 </th>
<th> 描述
</th></tr>
<tr>
<td>alert </td>
<td> any </td>
<td> 返回一个警告如果消息将被递送给任何资源.
</td></tr>
<tr>
<td>alert </td>
<td> exact </td>
<td> 返回一个警告如果消息将被递送给准确的资源.
</td></tr>
<tr>
<td>alert </td>
<td> other </td>
<td> 返回一个警告如果消息将被递送给指定资源之外的资源.
</td></tr>
<tr>
<td>drop </td>
<td> any </td>
<td> 丢弃这个消息如果它将被递送给任何资源.
</td></tr>
<tr>
<td>drop </td>
<td> exact </td>
<td> 丢弃这个消息如果它将被递送给准确的资源.
</td></tr>
<tr>
<td>drop </td>
<td> other </td>
<td> 丢弃这个消息如果它将被递送给指定资源之外的资源.
</td></tr>
<tr>
<td>error </td>
<td> any </td>
<td> 返回一个错误如果消息将被递送给任何资源.
</td></tr>
<tr>
<td>error </td>
<td> exact </td>
<td> 返回一个错误如果消息将被递送给准确的资源.
</td></tr>
<tr>
<td>error </td>
<td> other </td>
<td> 返回一个错误如果消息将被递送给指定资源之外的资源.
</td></tr>
<tr>
<td>notify </td>
<td> any </td>
<td> 返回一个通知如果消息将被递送给任何资源.
</td></tr>
<tr>
<td>notify </td>
<td> exact </td>
<td> 返回一个通知如果消息将被递送给准确的资源.
</td></tr>
<tr>
<td>notify </td>
<td> other </td>
<td> 返回一个通知如果消息将被递送给指定资源之外的资源.
</td></tr></table>
<h2> <span class="mw-headline" id=".E6.AD.A3.E5.BC.8F.E6.8F.8F.E8.BF.B0">正式描述</span></h2>
<h3> <span class="mw-headline" id=".3Camp.2F.3E.E6.A0.B9.E5.85.83.E7.B4.A0">&lt;amp/&gt;根元素</span></h3>
<p>所有递送语义都被封装在 &lt;amp/&gt; 元素里. 这个元素包含一个或多个 &lt;rule/&gt; 元素指定特定的规则来处理. 它能选择性地拥有关于当前状态的属性, 原始发送者和接收者, 以及路由的适用性.
</p><p>'status'属性为 &lt;amp/&gt; 元素指定原因. 当指定的语义被应用时(客户端到服务器), 这个属性不能(MUST NOT)出现. 当根据一个匹配的条件向一个发送实体应答时, 这个属性必须(MUST)出现并且应该(SHOULD)是已触发规则的'action'属性的值. (注意: 单独的动作定义可以(MAY)提供它们自己的要求.)
</p><p>'from'属性指明包含 &lt;message/&gt; 节的原始发送者. 这个属性必须(MUST)由任何从支持的服务器发送的 &lt;message/&gt; 节指定, 不管接收者是什么情况. 它不应该(SHOULD NOT)以别的方式指定. 'from'属性值必须(MUST)是原始 &lt;message/&gt; 节的发送者的全JID (node@domain/resource).
</p><p>'to'属性指明包含 &lt;message/&gt; 节的原始(期望的)接收者. 这个属性必须(MUST)由任何从支持的服务器发送的 &lt;message/&gt; 节指定, 不管接收者是什么情况. 它不应该(SHOULD NOT)以别的方式指定. 'to'属性值必须(MUST)是原始 &lt;message/&gt; 节的预定接收者的全JID (node@domain/resource). 
</p><p>'per-hop'属性标记是否在原始发送者和原始的预定接收者之间的路由的每一跳处理包含的规则集. 这个属性可以(MAY)出现, 并且必须(MUST)要么是"true"要么是"false". 如果不显示, 缺省是"false".
</p>
<h3> <span class="mw-headline" id=".3Crule.2F.3E.E5.85.83.E7.B4.A0">&lt;rule/&gt;元素</span></h3>
<p>每个语义规则由一个 &lt;rule/&gt; 元素指定. 这个元素拥有一些属性用于条件, 值, 和动作.
</p><p>'action'属性为这个规则定义结果. 这个属性必须(MUST)出现, 并且必须(MUST)要么是一个在 <a href="/XEP-0079#.E5.AE.9A.E4.B9.89.E7.9A.84.E5.8A.A8.E4.BD.9C" title="XEP-0079">定义的动作</a> 章节定义的值, 要么在 XMPP Registrar 中注册了.
</p><p>'condition'属性定义这个规则应用的全部条件. 这个属性必须(MUST)出现, 并且必须(MUST)要么是一个在 <a href="/XEP-0079#.E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6" title="XEP-0079">定义的条件</a> 章节定义的值, 要么在 XMPP Registrar 中注册了. 
</p><p>'value'属性定义条件如何匹配. 这个属性必须(MUST)出现, 并且不能(MUST NOT)是空的字符串(""). 这个属性的值的解释由'condition'属性决定.
</p>
<h2> <span class="mw-headline" id=".E7.A4.BA.E4.BE.8B.E5.9C.BA.E6.99.AF">示例场景</span></h2>
<h3> <span class="mw-headline" id=".E5.8F.AF.E9.9D.A0.E6.95.B0.E6.8D.AE.E4.BC.A0.E8.BE.93">可靠数据传输</span></h3>
<p>&lt;message/&gt; 节对于数据传输来说几乎是完美的, 但是为了确保可靠性经常会要求某一消息不递送给任何指定资源之外的资源. 为了满足这个要求, 发送实体包含一个 &lt;rule action='drop' condition='match-resource' value='other'/&gt; (如果不需要失败通知的话) 或 &lt;rule action='error' condition='match-resource' value='other'/&gt; (如果需要失败通知的话). 以下例子使用 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0047.html">带内字节流</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">8</a> 展示了这一场景:
</p><p><b>例子 10. 发送一个可靠数据传输的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'francisco@hamlet.lit/pda'</span>
         <span class="re0">from</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
         <span class="re0">id</span>=<span class="st0">'ibb1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;data</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/ibb'</span> <span class="re0">sid</span>=<span class="st0">'mySID'</span> <span class="re0">seq</span>=<span class="st0">'0'</span><span class="re2">&gt;</span><span class="co3">
    qANQR1DBwU4DX7jmYZnncmUQB/9KuKBddzQH+tZ1ZywKK0yHKnq57kWq+RFtQdCJ
    WpdWpR0uQsuJe7+vh3NWn59/gTc5MDlX8dS9p0ovStmNcyLhxVgmqS8ZKhsblVeu
    IpQ0JgavABqibJolc3BKrVtVV1igKiX/N7Pi8RtY1K18toaMDhdEfhBRzO/XB0+P
    AQhYlRjNacGcslkhXqNjK5Va4tuOAPy2n1Q8UUrHbUd0g+xJ9Bm0G0LZXyvCWyKH
    kuNEHFQiLuCY6Iv0myq6iX6tjuHehZlFSh80b5BVV9tNLwNR5Eqz1klxMhoghJOA
  </span><span class="re1">&lt;/data<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span> <span class="re0">per-hop</span>=<span class="st0">'true'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-09-10T08:33:14Z'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'match-resource'</span> <span class="re0">value</span>=<span class="st0">'other'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>在以上案例中, 如果消息不能在指定的时间递送到指定的"francisco@hamlet.lit/pda"地址, 发送者将收到一个错误应答. 举例来说, 如果预定的资源在消息能够递送之前下线了, 处理服务器将返回以下错误:
</p><p><b>例子 11. 失败的可靠数据传输消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
         <span class="re0">id</span>=<span class="st0">'ibb1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
      <span class="re0">from</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
      <span class="re0">to</span>=<span class="st0">'francisco@hamlet.lit/pda'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'match-resource'</span> <span class="re0">value</span>=<span class="st0">'other'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'500'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;undefined-condition</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;failed-rules</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp#errors'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'match-resource'</span> <span class="re0">value</span>=<span class="st0">'other'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/failed-rules<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.97.B6.E9.97.B4.E6.95.8F.E6.84.9F.E6.B6.88.E6.81.AF">时间敏感消息</span></h3>
<p>时间敏感消息在某些环境是一个频繁发生的事情(例如, 全体决策人员例行通知其他人某些客户"事件", 意外的小憩, 以及特别的聚会). 要发送一个时间敏感消息, 发送实体可以在一个 &lt;rule action='drop' condition='expire-at'/&gt; 中包含事件发生的时间:
</p><p><b>例子 12. 发送一个时间敏感消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'linuxwolf@outer-planes.net'</span>
         <span class="re0">from</span>=<span class="st0">'receptionist@outer-planes.net'</span>
         <span class="re0">id</span>=<span class="st0">'alert849'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="co3">Guest Alert!</span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">
    There will be clients in the conference room today around 1 PM!
    As always, be courteous and quiet nearby...
  </span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2003-06-23T23:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>在上述例子中, 一旦时间超过 23:00 UTC (3:00 PM Pacific Daylight Time)， "linuxwolf@outer-planes.net"的服务器将不递送这个消息.
</p>
<h3> <span class="mw-headline" id=".E7.9E.AC.E6.97.B6.E6.B6.88.E6.81.AF">瞬时消息</span></h3>
<p>瞬时消息是指那些永远不应该离线存储的消息. 要发送一个瞬时消息, 发送实体可以包含一个 &lt;rule action='drop' condition='deliver' value='stored'/&gt;:
</p><p><b>例子 13. 发送一个瞬时消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">from</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
         <span class="re0">type</span>=<span class="st0">'chat'</span>
         <span class="re0">id</span>=<span class="st0">'chatty1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Who</span><span class="co4">&amp;apos;</span><span class="co3">s there?</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>作为选择, 发送实体可以包含一个 &lt;rule action='alert' condition='deliver' value='stored'/&gt; 来提出警告而不是安静地丢弃这个消息:
</p><p><b>例子 14. 发送一个瞬时消息(请求警告)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">from</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
         <span class="re0">type</span>=<span class="st0">'chat'</span>
         <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Who</span><span class="co4">&amp;apos;</span><span class="co3">s there?</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'alert'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 15. 关于瞬时消息的发送者警告</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
         <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
       <span class="re0">action</span>=<span class="st0">'alert'</span>
       <span class="re0">from</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
       <span class="re0">to</span>=<span class="st0">'francisco@hamlet.lit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'alert'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86">错误处理</span></h2>
<h3> <span class="mw-headline" id=".E6.9D.A1.E4.BB.B6">条件</span></h3>
<p>为了简化错误条件的讨论, 本文在名字空间 URIs 和名字空间前缀之间使用以下映射(注意: 这个映射仅用于简化讨论的目的而不是想在协议本身中使用它).
</p><p><b>表 6: 名字空间映射</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>前缀 </th>
<th> URI
</th></tr>
<tr>
<td>xmpp </td>
<td> urn:ietf:params:xml:ns:xmpp-stanzas
</td></tr>
<tr>
<td>msg </td>
<td> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp">http://jabber.org/protocol/amp</a>
</td></tr>
<tr>
<td>err </td>
<td> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp#errors">http://jabber.org/protocol/amp#errors</a>
</td></tr></table>
<p>接下来的表显示和一般的 AMP 规则,和条件以及 <a href="/XEP-0079#.E5.AE.9A.E4.B9.89.E7.9A.84.E5.8A.A8.E4.BD.9C" title="XEP-0079">定义的动作</a> 相关的可能的错误条件.
</p><p><b>表 7: 错误条件</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>一般条件 </th>
<th> 错误类型 </th>
<th> 详细条件 </th>
<th> 描述
</th></tr>
<tr>
<td>&lt;xmpp:bad-request/&gt; </td>
<td> modify </td>
<td> &lt;msg:unsupported-actions/&gt; </td>
<td> 不支持一个或多个规则的指定动作. 元素 &lt;msg:unsupported-actions/&gt; 包含那个指定了不支持的动作的 &lt;rule/&gt; 元素.
</td></tr>
<tr>
<td>&lt;xmpp:bad-request/&gt; </td>
<td> modify </td>
<td> &lt;msg:unsupported-conditions/&gt; </td>
<td> 不支持一个或多个规则的指定条件. 元素 &lt;msg:unsupported-conditions/&gt; 包含那个指定了不支持的条件的 &lt;rule/&gt; 元素.
</td></tr>
<tr>
<td>&lt;xmpp:not-acceptable/&gt; </td>
<td> modify </td>
<td> &lt;msg:invalid-rules/&gt; </td>
<td> 服务器不接受一个或多个规则, 通常是因为条件/动作组合被限制. 元素 &lt;msg:invalid-rules/&gt; 包含那个不被接受的&lt;rule/&gt; 元素.
</td></tr>
<tr>
<td>&lt;xmpp:service-unavailable/&gt; </td>
<td> cancel </td>
<td> NONE </td>
<td> 不支持本协议. 如果到达接收者的路由中的服务器没有实现本协议, 这个错误被返回给发送实体.
</td></tr>
<tr>
<td>&lt;xmpp:undefined-condition/&gt; </td>
<td> modify </td>
<td> &lt;err:failed-rules/&gt; </td>
<td> 一个或多个 &lt;rule/&gt; 元素触发了 "error" 动作. 这个条件包含那个被触发的 &lt;rule/&gt; 元素.
</td></tr></table>
<h3> <span class="mw-headline" id=".E4.BE.8B.E5.AD.90">例子</span></h3>
<p>本章显示上一章的错误条件的例子(关于 XMPP 错误条件和　Jabber　错误码的映射信息, 参考 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0086.html">错误条件映射</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">9</a>).
</p>
<h4> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E7.9A.84.E5.8A.A8.E4.BD.9C">不支持的动作</span></h4>
<p><b>例子 16. 一个包含AMP语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 17. 服务器不支持动作</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'400'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported-actions</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span>
            <span class="re0">action</span>=<span class="st0">'drop'</span>
            <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/unsupported-actions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E7.9A.84.E6.9D.A1.E4.BB.B6">不支持的条件</span></h4>
<p><b>例子 18. 一个包含AMP语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 19. 服务器不支持条件</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'400'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported-conditions</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/unsupported-conditions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.B8.8D.E8.A2.AB.E6.8E.A5.E5.8F.97">不被接受</span></h4>
<p><b>例子 20. 一个包含AMP语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 21. 规则不被服务器接受</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'405'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-rules</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/invalid-rules<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.9C.8D.E5.8A.A1.E4.B8.8D.E5.8F.AF.E7.94.A8">服务不可用</span></h4>
<p><b>例子 22. 一个包含AMP语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'kingrichard@royalty.england.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">My lord, dispatch; read o'er these articles.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 23. AMP服务不可用</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'royalty.england.lit'</span>
    <span class="re0">id</span>=<span class="st0">'richard2-4.1.247'</span>
    <span class="re0">to</span>=<span class="st0">'northumberland@shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'drop'</span> <span class="re0">condition</span>=<span class="st0">'expire-at'</span> <span class="re0">value</span>=<span class="st0">'2004-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span> <span class="re0">code</span>=<span class="st0">'503'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;service-unavailable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.9C.AA.E5.AE.9A.E4.B9.89.E7.9A.84.E6.9D.A1.E4.BB.B6">未定义的条件</span></h4>
<p><b>例子 24. 一个包含AMP语义的消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre>  <span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
           <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
           <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Who</span><span class="co4">&amp;apos;</span><span class="co3">s there?</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
    <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
         <span class="re0">status</span>=<span class="st0">'error'</span>
         <span class="re0">from</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 25. 失败的规则</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre>  <span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet.lit'</span>
           <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span>
           <span class="re0">type</span>=<span class="st0">'error'</span>
           <span class="re0">id</span>=<span class="st0">'chatty2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
         <span class="re0">status</span>=<span class="st0">'error'</span>
         <span class="re0">from</span>=<span class="st0">'francisco@hamlet.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bernardo@hamlet.lit/elsinore'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/amp<span class="re2">&gt;</span></span>
    <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span> <span class="re0">code</span>=<span class="st0">'500'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;undefined-condition</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;failed-rules</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp#errors'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;rule</span> <span class="re0">action</span>=<span class="st0">'error'</span> <span class="re0">condition</span>=<span class="st0">'deliver'</span> <span class="re0">value</span>=<span class="st0">'stored'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/failed-rules<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E5.AE.9E.E7.8E.B0.E5.A4.87.E6.B3.A8">实现备注</span></h2>
<p>如果接收者的服务器实现了"离线存储", 它将需要跟踪那些离线消息以遵守期满规则并且不能递送那些过期的消息. 如何正确地做到这一点是实施的一个问题. 一个可能的实施是让服务器维护一个独立的可过期消息的数据库并定时扫描它; 发现一个过期的消息之后, 它可以把这个消息标记为符合丢弃条件并通知发送者, 但是直到接收者下次可用的时候才真正丢弃这个消息.
</p>
<h2> <span class="mw-headline" id=".E6.B5.81.E7.89.B9.E6.80.A7">流特性</span></h2>
<p><a href="/RFC3920" title="RFC3920">XMPP Core</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">10</a> 定义了在流协商期间声明特性支持的方法. 为了提高效率, 服务器把AMP作为流特性支持来声明是值得的. 在 &lt;stream:features/&gt; 中用于报告这一支持的名字空间是 "<a rel="nofollow" class="external free" href="http://jabber.org/features/amp">http://jabber.org/features/amp</a>". 从初始化实体接收到流头信息之后, 接收实体(通常是服务器)返回一个流头信息给初始化实体并且可以(MAY)通过注册相关的流特性宣告支持AMP:
</p><p><b>例子 26. 宣告AMP为流特性之一</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'utf-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;stream:stream</span> <span class="re0">xmlns:stream</span>=<span class="st0">'http://etherx.jabber.org/streams/'</span>
    <span class="re0">xmlns</span>=<span class="st0">'jabber:client'</span>
    <span class="re0">from</span>=<span class="st0">'somedomain'</span>
    <span class="re0">version</span>=<span class="st0">'1.0'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;stream:features<span class="re2">&gt;</span></span><span class="co3">
&#160;
    ...
&#160;
    </span><span class="re1">&lt;amp</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/features/amp'</span><span class="re2">/&gt;</span><span class="co3">
&#160;
    ...
&#160;
  </span><span class="re1">&lt;/stream:features<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9">安全事项</span></h2>
<p>大部分的 AMP 条件可能被用于未授权的个体获得IM服务器及其他基于出席信息的消息系统的用户的出席信息. 例如, 考虑以下场景: 用户 &lt;romeo@montague.net&gt; 不是用户 &lt;nurse@capulet.com&gt; 出席信息的一个授权订阅者, 但是发送了一个 &lt;message/&gt; 节给那个地址, 这个节包含了一个条件为 "deliver"值为"stored"的规则以及一个"alert"动作; 如果 Nurse 不在线, 在发现 Nurse 离线的过程中, Romeo 将接收到一个 AMP 警告那个消息已离线存储. 类似的场景可能出现在"match-resource"规则(发送给用户的常用资源)和"expire-at"规则(每分钟发送消息以获得出席信息). 如果一个服务器实现了如 <a href="/index.php?title=RFC3291&amp;action=edit&amp;redlink=1" class="new" title="RFC3291（尚未撰写）">RFC 3921</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">11</a>定义的出席信息订阅, 如果一个通知将暴露接收者的在线或离线状态<a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">12</a>, 这个服务器不应该(SHOULD NOT)返回警告, 错误, 或其他 AMP 通知给未被授权查看接收者出席信息(通过一个订阅 "both" 或 "from")的发送者.
</p><p>关于这个问题有以下几种不同的实施指引:
</p>
<ul><li> 不实现相关的条件, 作为结果, 如果那个条件被指定, 服务器必须(MUST)应答一个 &lt;feature-not-implemented/&gt; 错误条件; 无论如何, 这过度限制了支持的条件显著地削弱了 AMP 的功能, 所以它是不推荐的(NOT RECOMMENDED).
</li></ul>
<ul><li> 只在动作为"drop"时接受相关的条件, 作为结果, 如果这个动作为"alert", "error", 或"notify", 服务器必须(MUST)应答一个 &lt;not-acceptable/&gt; 错误条件; 这轻微地限制但仍是不必要地限制了系统的功能, 所以这是不推荐的(NOT RECOMMENDED).
</li></ul>
<ul><li> 只有发送者被授权可以获得接收者的出席信息的时候才接受相关的条件, 作为结果, 如果发送者未获得那样的授权, 服务器必须(MUST)应答一个 &lt;not-acceptable/&gt; 错误条件; 这是推荐的(RECOMMENDED)行为.
</li></ul>
<h2> <span class="mw-headline" id="IANA.E4.BA.8B.E9.A1.B9">IANA事项</span></h2>
<p>本文档与<a rel="nofollow" class="external text" href="http://www.iana.org/">互联网编号分配授权机构</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">13</a>无关。
</p>
<h2> <span class="mw-headline" id="XMPP.E6.B3.A8.E5.86.8C.E4.BA.8B.E9.A1.B9">XMPP注册事项</span></h2>
<h3> <span class="mw-headline" id=".E5.8D.8F.E8.AE.AE.E5.90.8D.E5.AD.97.E7.A9.BA.E9.97.B4">协议名字空间</span></h3>
<p><a rel="nofollow" class="external text" href="http://www.xmpp.org/registrar/">XMPP Registrar</a> <a href="/XEP-0079#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0079">14</a>在它的协议名字空间注册项中包含了 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp'">http://jabber.org/protocol/amp'</a> 和 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp#errors'">http://jabber.org/protocol/amp#errors'</a> 名字空间.
</p>
<h3> <span class="mw-headline" id=".E6.B5.81.E7.89.B9.E6.80.A7_2">流特性</span></h3>
<p>XMPP注册在它的流特性名字注册项中包括'<a rel="nofollow" class="external free" href="http://jabber.org/features/amp'名字空间">http://jabber.org/features/amp'名字空间</a>.
</p>
<h3> <span class="mw-headline" id=".E7.9F.A5.E5.90.8D.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E8.8A.82.E7.82.B9">知名服务发现节点</span></h3>
<p>XMPP注册在它的知名服务发现节点的注册项中包括了'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp'">http://jabber.org/protocol/amp'</a>.
</p>
<h3> <span class="mw-headline" id=".E6.B3.A8.E5.86.8C.E9.A1.B9">注册项</span></h3>
<h4> <span class="mw-headline" id=".E8.A7.84.E5.88.99.E6.9D.A1.E4.BB.B6.E6.B3.A8.E5.86.8C.E9.A1.B9">规则条件注册项</span></h4>
<p>XMPP登记处在 &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/registrar/amp-conditions.html">http://www.xmpp.org/registrar/amp-conditions.html</a>&gt; 维护了一个AMP &lt;rule/&gt;条件的注册项 .
</p>
<h5> <span class="mw-headline" id=".E8.BF.87.E7.A8.8B">过程</span></h5>
<p>为了给这个注册项提交新值, 注册者必须按以下格式定义一个 XML 片断并且要么把它包含在相关的 XMPP 扩展协议中要么把它用发送给email地址&lt;registrar@xmpp.org&gt;:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;condition<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">the value of the 'condition' attribute</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">the namespace to be used as a service discovery feature</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;per-hop<span class="re2">&gt;</span></span><span class="co3">does the &quot;per-hop&quot; flag apply? [true|false]</span><span class="re1">&lt;/per-hop<span class="re2">&gt;</span></span>
  <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
     The syntax (e.g., datatype or allowable values) of the
     'value' attribute.
  </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
  <span class="re1">&lt;processing<span class="re2">&gt;</span></span><span class="co3">values that result in message processing</span><span class="re1">&lt;/processing<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">the document (e.g., XEP) in which this condition is specified</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/condition<span class="re2">&gt;</span></span></pre></div></div>
<p>注册者可以同一时间注册多个条件, 每个包含在一个独立的 &lt;condition/&gt; 节之中.
</p><p>注意: 这个条件集的名字空间将被包含在 服务器发现特性注册项中Service Discovery features registry.
</p>
<h5> <span class="mw-headline" id=".E6.9C.80.E4.BD.8E.E8.A6.81.E6.B1.82">最低要求</span></h5>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;condition<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">deliver</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?condition=deliver</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;per-hop<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/per-hop<span class="re2">&gt;</span></span>
  <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">[direct|forward|gateway|none|stored]</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
  <span class="re1">&lt;processing<span class="re2">&gt;</span></span><span class="co3">
    The condition is met if (1) the value is &quot;direct&quot; and the message
    can be immediately delivered or further dispatched, (2) the value
    is &quot;forward&quot; and the message can be forwarded to another XMPP
    address, (3) the value is &quot;gateway&quot; and the message can be sent
    to a non-XMPP address via a gateway, (4) the value is &quot;none&quot; and
    the message cannot be delivered at all, or (5) the value is 
    &quot;stored&quot; and the message can be stored for later delivery.
  </span><span class="re1">&lt;/processing<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/condition<span class="re2">&gt;</span></span>
<span class="re1">&lt;condition<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">expire-at</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?condition=expire-at</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;per-hop<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/per-hop<span class="re2">&gt;</span></span>
  <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">DateTime per XEP-0082</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
  <span class="re1">&lt;processing<span class="re2">&gt;</span></span><span class="co3">
    The condition is met if the message would be delivered after
    the specified DateTime.
  </span><span class="re1">&lt;/processing<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/condition<span class="re2">&gt;</span></span>
<span class="re1">&lt;condition<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">match-resource</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?condition=match-resource</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;per-hop<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/per-hop<span class="re2">&gt;</span></span>
  <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">[any|exact|other]</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
  <span class="re1">&lt;processing<span class="re2">&gt;</span></span><span class="co3">
    The condition is met if (1) the value is &quot;any&quot; and the intended
    recipient has at least one available resource (as defined in the
    XMPP IM specification); (2) the value &quot;exact&quot; and the intended
    recipient has an available resource that exactly matches the JID
    specified in the 'to' address; (3) the value is &quot;other&quot; and the
    intended recipient has an available resource whose full JID is
    other than that specified in the 'to' address.
  </span><span class="re1">&lt;/processing<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/condition<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A7.84.E5.88.99.E5.8A.A8.E4.BD.9C.E6.B3.A8.E5.86.8C.E9.A1.B9">规则动作注册项</span></h4>
<p>XMPP登记处在 &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/registrar/amp-actions.html">http://www.xmpp.org/registrar/amp-actions.html</a>&gt; 中维护了一个 AMP &lt;rule/&gt; 动作注册项.
</p>
<h5> <span class="mw-headline" id=".E8.BF.87.E7.A8.8B_2">过程</span></h5>
<p>为了给这个注册项提交新值, 注册者必须按以下格式定义一个 XML 片断并且要么把它包含在相关的 XMPP 扩展协议中要么把它用发送给email地址&lt;registrar@xmpp.org&gt;:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;action<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">the value of the 'action' attribute</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">the namespace to be used as a service discovery feature</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;behavior<span class="re2">&gt;</span></span><span class="co3">the expected behavior if the rule is triggered</span><span class="re1">&lt;/behavior<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">the document (e.g., XEP) in which this action is specified</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/action<span class="re2">&gt;</span></span></pre></div></div>  
<p>注册者可以同一时间注册多个动作, 每个包含在一个独立的 &lt;action/&gt; 节之中.
</p><p>注意: 这个动作集的名字空间将被包含在 服务器发现特性注册项中Service Discovery features registry.
</p>
<h5> <span class="mw-headline" id=".E5.88.9D.E5.A7.8B.E6.8F.90.E4.BA.A4">初始提交</span></h5>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;action<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">alert</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?action=drop</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;behavior<span class="re2">&gt;</span></span><span class="co3">
    The message is silently discarded but an alert is returned to the
    sender.
  </span><span class="re1">&lt;/behavior<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/action<span class="re2">&gt;</span></span>
<span class="re1">&lt;action<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">drop</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?action=drop</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;behavior<span class="re2">&gt;</span></span><span class="co3">
    The message is silently discarded.
  </span><span class="re1">&lt;/behavior<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/action<span class="re2">&gt;</span></span>
<span class="re1">&lt;action<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">error</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?action=error</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;behavior<span class="re2">&gt;</span></span><span class="co3">
    The message is not processed and an error is returned to the sender,
    specifying which rule resulted in failed processing.
  </span><span class="re1">&lt;/behavior<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/action<span class="re2">&gt;</span></span>
<span class="re1">&lt;action<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">notify</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;ns<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/amp?action=notify</span><span class="re1">&lt;/ns<span class="re2">&gt;</span></span>
  <span class="re1">&lt;behavior<span class="re2">&gt;</span></span><span class="co3">
    The message is processed and a notification message is returned to
    the sender, specifying which rule was processed.
  </span><span class="re1">&lt;/behavior<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0079</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/action<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id="XML.E6.9E.B6.E6.9E.84">XML架构</span></h2>
<h3> <span class="mw-headline" id="AMP">AMP</span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
&#160;
      The protocol documented by this schema is defined in
      XEP-0079: http://www.xmpp.org/extensions/xep-0079.html
&#160;
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'amp'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
&#160;
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'rule'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'from'</span> <span class="re0">usage</span>=<span class="st0">'optional'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'per-hop'</span> <span class="re0">use</span>=<span class="st0">'optional'</span> <span class="re0">type</span>=<span class="st0">'xs:bool'</span> <span class="re0">default</span>=<span class="st0">'false'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'status'</span> <span class="re0">usage</span>=<span class="st0">'optional'</span> <span class="re0">type</span>=<span class="st0">'xs:NCName'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'to'</span> <span class="re0">usage</span>=<span class="st0">'optional'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invalid-rules'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
&#160;
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'rule'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unsupported-actions'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
&#160;
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'rule'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unsupported-conditions'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
&#160;
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'rule'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'rule'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'action'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:NCName'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'condition'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:NCName'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'value'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E9.94.99.E8.AF.AF_2">错误</span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/amp#errors'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/amp#errors'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
&#160;
      The protocol documented by this schema is defined in
      XEP-0079: http://www.xmpp.org/extensions/xep-0079.html
&#160;
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'failed-rules'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
&#160;
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'rule'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'rule'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'action'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:NCName'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'condition'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:NCName'</span><span class="re2">/&gt;</span>
&#160;
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'value'</span> <span class="re0">use</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.B5.81.E7.89.B9.E6.80.A7_3">流特性</span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/features/amp'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/features/amp'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
&#160;
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
&#160;
      The protocol documented by this schema is defined in
      XEP-0079: http://www.xmpp.org/extensions/xep-0079.html
&#160;
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'amp'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
&#160;
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
&#160;
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
&#160;
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E8.87.B4.E8.B0.A2">致谢</span></h2>
<p>感谢 Marshall Rose 和 Craig Kaes 的评论.
</p>
<h2> <span class="mw-headline" id=".E9.99.84.E5.BD.95">附录</span></h2>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF">附录A:文档信息</span></h3>
<p>系列：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/">XEP</a>
</p><p>序号：0079
</p><p>发布者：<a rel="nofollow" class="external text" href="http://xmpp.org/xsf/">XMPP标准基金会</a>
</p><p>状态：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0001.html#states-Draft">草案</a>
</p><p>类型：<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards%20Track">标准跟踪</a>
</p><p>版本：1.2
</p><p>最后更新：2005-11-30
</p><p>批准机构：<a rel="nofollow" class="external text" href="http://xmpp.org/council/">XMPP理事会</a>
</p><p>依赖标准：XMPP Core, XEP-0030, XEP-0082
</p><p>替代标准：XEP-0023
</p><p>被替代标准：无
</p><p>缩略名：amp
</p><p>amp名字空间的XML架构(Schema): &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/amp.xsd">http://www.xmpp.org/schemas/amp.xsd</a>&gt;
</p><p>amp#errors名字空间的XML方案(Schema): &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/amp-errors.xsd">http://www.xmpp.org/schemas/amp-errors.xsd</a>&gt;
</p><p>feature名字空间的XML方案(Schema): &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/amp-feature.xsd">http://www.xmpp.org/schemas/amp-feature.xsd</a>&gt;
</p><p>注册项： &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/registrar/amp.html">http://xmpp.org/registrar/amp.html</a>&gt;
</p><p>原文控制： <a rel="nofollow" class="external text" href="http://svn.xmpp.org:18080/browse/XMPP/trunk/extensions/xep-0079.xml">HTML</a> <a rel="nofollow" class="external text" href="http://svn.xmpp.org:18080//changelog/~rss/XMPP/trunk/extensions/xep-0079.xml/rss.xml">RSS</a>
</p><p>本文的其它格式： <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0079.xml">XML</a> <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0079.pdf">PDF</a>
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF">附录B:作者信息</span></h3>
<p><b>Matthew Miller</b>
</p><p>Email: <a rel="nofollow" class="external text" href="mailto:linuxwolf@outer-planes.net">linuxwolf@outer-planes.net</a>
</p><p>JabberID: linuxwolf@outer-planes.net
</p><p><b>Peter Saint-Andre</b>
</p><p>Email: <a rel="nofollow" class="external text" href="mailto:stpeter@jabber.org">stpeter@jabber.org</a>
</p><p>JabberID: stpeter@jabber.org
</p><p>URI: <a rel="nofollow" class="external free" href="https://stpeter.im/">https://stpeter.im/</a>
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A">附录C:法律通告</span></h3>
<p><b>版权</b>
</p><p>XMPP扩展协议的版权(1999-2008)归XMPP标准化基金会(XSF)所有.
</p><p><b>权限</b>
</p><p>特此授权,费用全免,对任何获得本协议副本的人,对使用本协议没有限制,包括不限制在软件程序中实现本协议,不限制在网络服务中布署本协议,不限制拷贝,修改,合并,发行,翻译,分发,转授,或销售本协议的副本,被允许使用本协议做了以上工作的人士,应接受前述的版权声明和本许可通知并且必须包含在所有的副本或实质性部分的规格中.除非单独的许可，被重新分发的修改工作，不得含有关于作者，标题，编号，或出版者的规格的误导性资料，并不得宣称修改工作是由本文的作者，作者所属的任何组织或项目，或XMPP标准基金会签注。
</p><p><b>免责声明'</b>
</p><p><b>## 特别注意：本协议是提供的“原样”的基础，没有担保或任何形式的条件，明示或暗示，包括，但不限于任何担保或关于名称，非侵权性，适销性或适合作某一特定目的的条件. ##</b>
</p><p><b>责任限制</b>
</p><p>在任何情况下以及没有任何法律规定时，不论是侵权行为（包括疏忽），合同或其它方面，除非根据适用法律的要求（如蓄意和有严重疏忽行为）或以书面形式同意，XMPP标准基金会或任何作者不对本协议所造成的损失承担责任，包括任何直接，间接，特殊，偶发，或任何从本协议出，入，连接的字符产生的或实现，布署或其他对本协议的使用导致的相应的损害赔偿（包括但不限于善意的损失，停止作业，电脑失灵或故障，或任何和所有其他商业损害或损失） ，即使XMPP标准基金会或作者已被告知此类损害的可能性。
</p><p><b>知识产权的一致性</b>
</p><p>XMPP扩展协议完全遵守XSF的知识产权策略(可在&lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt;找到副本或写信给XMPP标准基金会, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB">附录D:和XMPP的关系</span></h3>
<p>可扩展的消息和出席信息协议 (XMPP) 定义于 XMPP Core (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>) 和 XMPP IM (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>) 规范里，由 XMPP标准基金会贡献到由依据<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2026">RFC 2026</a>成立的互联网工程人物组管理的互联网标准流程 Internet Standards Process. 本文定义的任何协议已在互联网标准流程之外开发，并且被理解为 XMPP 的扩展而不是一个XMPP本身的演化, 开发, 或修改.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9">附录E:讨论地点</span></h3>
<p>主要的XMPP扩展协议讨论地点是 &lt;standards@xmpp.org&gt; 讨论列表.
</p><p>在 xmpp.org 的其它讨论列表中的讨论可能也有合适的; 所有的列表见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; .
</p><p>勘误表可以发送邮件到 &lt;editor@xmpp.org&gt;.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7">附录F:需求一致性</span></h3>
<p>以下用于本文的需求关键字的解释见于 <a rel="nofollow" class="external text" href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p><p><br />
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8">附录G:备注</span></h3>
<ol><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>: 可扩展的消息和出席信息协议 (XMPP): 核心 &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3920">http://tools.ietf.org/html/rfc3920</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>: 可扩展的消息和出席信息协议 (XMPP): 即时消息和出席信息 &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.
</li><li> XEP-0030: Service Discovery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.
</li><li> 担保(Guarantee)是一个很重的词. 本文定义的方法是为了使得消息递送在特定范围内更加可靠, 而不是为了伪称这个方法使用了任何保证递送的措施.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc1305">RFC 1305</a>: Network Time Protocol (Version 3) &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc1305">http://tools.ietf.org/html/rfc1305</a>&gt;.
</li><li> XEP-0082: XMPP Date and Time Profiles &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0082.html">http://xmpp.org/extensions/xep-0082.html</a>&gt;.
</li><li> XEP-0045: Multi-User Chat &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0045.html">http://xmpp.org/extensions/xep-0045.html</a>&gt;.
</li><li> XEP-0047: In-Band Bytestreams &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0047.html">http://xmpp.org/extensions/xep-0047.html</a>&gt;.
</li><li> XEP-0086: Error Condition Mappings &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0086.html">http://xmpp.org/extensions/xep-0086.html</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>: 可扩展的消息和出席信息协议 (XMPP): 核心 &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3920">http://tools.ietf.org/html/rfc3920</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>: 可扩展的消息和出席信息协议 (XMPP): 即时消息和出席信息 &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.
</li><li> 一个例外可以是完全信任或封闭的网络.
</li><li> 互联网编号分配机构(IANA) 是用于互联网协议的唯一性参数值分配的核心协调者, 例如号码和URI计划. 更多信息, 见 &lt;<a rel="nofollow" class="external free" href="http://www.iana.org/">http://www.iana.org/</a>&gt;.
</li><li> XMPP登记员XMPP Registrar 维护着一个保留的协议名字空间以及用于由XMPP标准基金会批准的XMPP扩展协议的上下文参数的注册项的列表. 更多信息, 见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/registrar/">http://xmpp.org/registrar/</a>&gt;.
</li></ol>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95H:.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2">附录H:修订历史</span></h3>
<p>注意: 本协议的旧版本可能在 <a rel="nofollow" class="external free" href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a> 还可用
</p><p><b>版本 1.2 (2005-11-30)</b>
</p><p>加强和概括了安全事项. (psa)
</p><p><b>版本 1.1 (2005-10-19)</b>
</p><p>逆转了"期满"之外的条件的含义 (通过邮件列表的讨论); 纠正了特定的流特性. (psa)
</p><p><b>版本 1.0 (2004-10-11)</b>
</p><p>根据Jabber理事会的一次投票, 提升到草案状态. (psa)
</p><p>Version 0.12 (2004-09-09)
</p><p>Relaxed server-to-server requirements; clarified discovery rules; removed expire-in condition. (lw)
</p><p>Version 0.11 (2004-08-25)
</p><p>Specified that the timestamp for an expire-at condition must be a UTC DateTime per XEP-0082; provided further explanation regarding expire-at and expire-in conditions. (lw/psa)
</p><p>Version 0.10 (2004-07-14)
</p><p>Changes to address Council feedback: clarified error handling and provided error examples; specified that server should validate all rule semantics before returning an error; specified that service discovery information can be cached (not necessary to send disco query before dispatching each message); added "forward" and "gateway" to values of "deliver" condition to handle redirection of messages to alternate XMPP addresses and non-XMPP systems respectively; more clearly specified processing rules for "expire-in" condition; changed milliseconds to seconds for "expire-in"; made explicit that partial JID-matching is not included for "match-resource" condition; added clarifying note to security consideration regarding "deliver" condition; corrected values of per-hop from [yes|no] to [true|false]; changed "standard" conditions to "defined" conditions and mandated that they should be supported; changed "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp#std-actions">http://jabber.org/protocol/amp#std-actions</a>" namespace to "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/amp#errors">http://jabber.org/protocol/amp#errors</a>". (lw/psa)
</p><p>Version 0.9 (2004-04-25)
</p><p>Editorial review: clarified some matters in the text; fully defined the XMPP Registrar Considerations. (psa)
</p><p>Version 0.8 (2004-01-20)
</p><p>Reorganized for Editorial preferences; revised error conditions to properly align with XMPP-Core (lw)
</p><p>Version 0.7 (2003-12-10)
</p><p>Incorported changes requested from Standards list discussions: Changed entity-to-server discovery behavior; s2s discovery behavior; Expanded application-specific error conditions; Reorganized for better presentation; Changed "per-hop" to apply to the entire ruleset; Fixed minor typos and missteps (lw)
</p><p>Version 0.6 (2003-10-15)
</p><p>Changed disco behavior; Changed schema to reflect customizations (lw)
</p><p>Version 0.5.1 (2003-09-20)
</p><p>Fixed many typos (lw)
</p><p>Version 0.5 (2003-08-28)
</p><p>Renamed to "amp" (thanks stpeter!); Added information about the original addressing; Added requirement for id attribute in &lt;message/&gt;; Restricted behavior within the "Security Considerations"; (lw)
</p><p>Version 0.4 (2003-06-23)
</p><p>Completely rewritten to better account for various suggested usage details and requirements; Completely reorganized to better codify the protocol(s) and their possible uses; Added more conditions; Added more actions; Added common usage scenarios (lw)
</p><p>Version 0.3 (2003-04-21)
</p><p>Clarified client-side processing; Removed semantics scope; Clarified "fail" action; Moved existing "use-cases" into "Usage" section in "Overview"; Added more relevant use cases; Added XMPP-style error conditions (lw)
</p><p>Version 0.2 (2003-04-15)
</p><p>Added XML Schema (with author's assistance). (psa)
</p><p>Version 0.1 (2003-04-15)
</p><p>Initial version. (lw)
</p>
<hr />
<p>结束
</p>
<!-- 
NewPP limit report
Preprocessor node count: 602/1000000
Post-expand include size: 3174/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki:pcache:idhash:12-0!*!0!!zh-cn!*!* and timestamp 20160221163413 -->
</div><div class="printfooter">
来自“<a href="http://wiki.jabbercn.org/index.php?title=XEP-0079&amp;oldid=661">http://wiki.jabbercn.org/index.php?title=XEP-0079&amp;oldid=661</a>”</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/%E7%89%B9%E6%AE%8A:%E9%A1%B5%E9%9D%A2%E5%88%86%E7%B1%BB" title="特殊:页面分类">2个分类</a>: <ul><li><a href="/%E5%88%86%E7%B1%BB:XMPP%E6%89%A9%E5%B1%95" title="分类:XMPP扩展">XMPP扩展</a></li><li><a href="/%E5%88%86%E7%B1%BB:%E5%B7%B2%E7%BF%BB%E8%AF%91" title="分类:已翻译">已翻译</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="/XEP-0079" title="查看内容页面 [c]" accesskey="c">页面</a></li>
				<li id="ca-talk" class="new"><a href="/index.php?title=%E8%AE%A8%E8%AE%BA:XEP-0079&amp;action=edit&amp;redlink=1" title="关于内容页面的讨论 [t]" accesskey="t">讨论</a></li>
				<li id="ca-viewsource"><a href="/index.php?title=XEP-0079&amp;action=edit" title="本页面已被保护。你可以查看其源代码。 [e]" accesskey="e">查看源代码</a></li>
				<li id="ca-history"><a href="/index.php?title=XEP-0079&amp;action=history" title="本页面的早前修订版本 [h]" accesskey="h">历史</a></li>
			</ul>
		</div>
	</div>

	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95&amp;returnto=XEP-0079" title="我们希望您可以登入，但不强求 [o]" accesskey="o">登录/创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="访问首页" style="background-image: url(/skins/common/images/xmppcn.png);" href="/%E9%A6%96%E9%A1%B5"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/%E9%A6%96%E9%A1%B5" title="访问首页 [z]" accesskey="z">首页</a></li>
				<li id="n-portal"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E7%A4%BE%E5%8C%BA%E4%B8%93%E9%A1%B5" title="关于本项目，你可以做什么，在哪里找到你需要的事物">社区专页</a></li>
				<li id="n-currentevents"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E6%96%B0%E9%97%BB%E5%8A%A8%E6%80%81" title="查看当前事件的背景信息">新闻动态</a></li>
				<li id="n-recentchanges"><a href="/%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9" title="本wiki的最近更改列表 [r]" accesskey="r">最近更改</a></li>
				<li id="n-randompage"><a href="/%E7%89%B9%E6%AE%8A:%E9%9A%8F%E6%9C%BA%E9%A1%B5%E9%9D%A2" title="随机进入一个页面 [x]" accesskey="x">随机页面</a></li>
				<li id="n-help"><a href="/%E5%B8%AE%E5%8A%A9:%E7%9B%AE%E5%BD%95" title="寻求帮助的地方">帮助</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-XMPP.E8.B5.84.E6.BA.90">
		<h5>XMPP资源</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XMPP.E5.85.AC.E5.85.B1.E6.9C.8D.E5.8A.A1"><a href="/XMPP%E5%85%AC%E5%85%B1%E6%9C%8D%E5%8A%A1">XMPP公共服务</a></li>
				<li id="n-XMPP.E5.AE.A2.E6.88.B7.E7.AB.AF.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6">XMPP客户端软件</a></li>
				<li id="n-XMPP.E6.9C.8D.E5.8A.A1.E5.99.A8.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6">XMPP服务器软件</a></li>
				<li id="n-.E5.8F.8B.E6.83.85.E9.93.BE.E6.8E.A5"><a href="/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5">友情链接</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform">
				<input type='hidden' name="title" value="特殊:搜索"/>
				<input type="search" name="search" title="在Jabber/XMPP中文翻译计划中搜索 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="提交" title="如果相同的标题存在的话便直接前往该页面" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="搜索" title="搜索含这些文字的页面" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>




<script src="http://yacy.jabbercn.org:8090/yacy/ui/js/jquery-1.3.2.min.js" type="text/javascript"></script>
<script>
   $(document).ready(function() {
      yconf = {
         url : 'http://yacy.jabbercn.org:8090/',
         theme : 'smoothness',
         title : 'XMPP搜索大全',
         logo     : 'http://yacy.jabbercn.org:8090/env/grafics/50-xmpp_logo.jpg',
         link     : 'http://wiki.jabbercn.org',
         urlmaskfilter : '.*',
         width : 500,
         height : 500
      };
      $.getScript(yconf.url+'/yacy/ui/js/yacyui-portalsearch.js', function(){});
   });
</script>
        <div id="p-search" class="portlet">
<h5>站外搜索</h5>
<div id="yacylivesearch" class="pBody">
   <form id="ysearch" method="get" accept-charset="UTF-8" action="http://yacy.jabbercn.org:8090/yacysearch.html">
      <input name="search" id="yquery" type="text" size="8" maxlength="80" value=""/>
      <input type="hidden" name="verify" value="false" />
      <input type="hidden" name="maximumRecords" value="10" />
      <input type="hidden" name="resource" value="local" />
      <input type="hidden" name="urlmaskfilter" value=".*" />
      <input type="hidden" name="prefermaskfilter" value="" />
      <input type="hidden" name="former" value="" />
      <input type="hidden" name="display" value="2" />
      <input type="hidden" name="nav" value="all" />
      <input type="submit" name="Enter" value="搜索" class="searchButton" />
   </form>
</div>
</div>



	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%85%A5%E9%A1%B5%E9%9D%A2/XEP-0079" title="所有链入本页的wiki页面列表 [j]" accesskey="j">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%87%BA%E6%9B%B4%E6%94%B9/XEP-0079" title="本页链入的页面的最近更改 [k]" accesskey="k">链出更改</a></li>
				<li id="t-specialpages"><a href="/%E7%89%B9%E6%AE%8A:%E7%89%B9%E6%AE%8A%E9%A1%B5%E9%9D%A2" title="所有特殊页面列表 [q]" accesskey="q">特殊页面</a></li>
				<li><a href="/index.php?title=XEP-0079&amp;printable=yes" rel="alternate">可打印版</a></li>
				<li id="t-permalink"><a href="/index.php?title=XEP-0079&amp;oldid=661" title="本页面该修订版本的永久链接">永久链接</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0 Unported" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> 本页面最后修订于2010年5月29日 (星期六) 02:58。</li>
		<li id="viewcount">此页面已被浏览过35,367次。</li>
		<li id="copyright">本站全部文字内容使用<a class="external" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Attribution-Noncommercial-Share Alike 3.0 Unported</a>授权。</li>
		<li id="privacy"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E9%9A%90%E7%A7%81%E6%9D%83%E6%94%BF%E7%AD%96" title="Jabber/XMPP中文翻译计划:隐私权政策">隐私权政策</a></li>
		<li id="about"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%B3%E4%BA%8E" title="Jabber/XMPP中文翻译计划:关于">关于Jabber/XMPP中文翻译计划</a></li>
		<li id="disclaimer"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="Jabber/XMPP中文翻译计划:免责声明">免责声明</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax", "mediawiki.legacy.mwsuggest"]);
}
</script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"zh-cn","language":"zh-cn","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: mediawiki:resourceloader:filter:minify-js:4:42c4e9caefe8ca663d220ee0c286ac74 */
}
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://rtp.rooyee.im/piwik/" : "http://rtp.rooyee.im/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 5);
piwikTracker.setDocumentTitle("XEP-0079");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://rtp.rooyee.im/piwik/piwik.php?idsite=5" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.038 secs. --></body></html>