<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="client-nojs">
<head>
<title>XEP-0060 - Jabber/XMPP中文翻译计划</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Jabber/XMPP中文翻译计划 (zh-cn)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.jabbercn.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Jabber/XMPP中文翻译计划的Atom" href="/index.php?title=%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9&amp;feed=atom" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=zh-cn&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: mediawiki:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */</style>
<script src="/load.php?debug=false&amp;lang=zh-cn&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "XEP-0060", "wgTitle": "XEP-0060", "wgCurRevisionId": 3400, "wgArticleId": 8, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": ["XMPP扩展", "已翻译"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgSearchNamespaces": [0]});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
.source-xml {border: 1px dashed #2f6fab; color: black; background-color: #f9f9f9;}
.source-xml li, .source-xml pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for xml
 * CSS class: source-xml, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-xml .de1, .source-xml .de2 {font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;}
.source-xml  {font-family: monospace;}
.source-xml .imp {font-weight: bold; color: red;}
.source-xml li, .source-xml li.li1 {font-weight: normal;}
.source-xml li.li2 {font-weight: bold;}
.source-xml .co1 {color: #808080; font-style: italic;}
.source-xml .co2 {color: #404040; font-style: italic;}
.source-xml .co3 {color: #000000;}
.source-xml .co4 {color: #400000; font-weight: bold;}
.source-xml .es0 {color: #000099; font-weight: bold;}
.source-xml .br0 {color: #66cc66;}
.source-xml .sy0 {color: #66cc66;}
.source-xml .st0 {color: #ff0000;}
.source-xml .nu0 {color: #cc66cc;}
.source-xml .re0 {color: #000066;}
.source-xml .re1 {color: #000000; font-weight: bold;}
.source-xml .re2 {color: #000000; font-weight: bold;}
.source-xml .ln-xtra, .source-xml li.ln-xtra, .source-xml div.ln-xtra {background-color: #ffc;}
.source-xml span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-text {border: 1px dashed #2f6fab; color: black; background-color: #f9f9f9;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-text .de1, .source-text .de2 {font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;}
.source-text  {font-family: monospace;}
.source-text .imp {font-weight: bold; color: red;}
.source-text li, .source-text li.li1 {font-weight: normal;}
.source-text li.li2 {font-weight: bold;}
.source-text .ln-xtra, .source-text li.ln-xtra, .source-text div.ln-xtra {background-color: #ffc;}
.source-text span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-html4strict {border: 1px dashed #2f6fab; color: black; background-color: #f9f9f9;}
.source-html4strict li, .source-html4strict pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for html4strict
 * CSS class: source-html4strict, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-html4strict .de1, .source-html4strict .de2 {font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;}
.source-html4strict  {font-family: monospace;}
.source-html4strict .imp {font-weight: bold; color: red;}
.source-html4strict li, .source-html4strict li.li1 {font-weight: normal;}
.source-html4strict li.li2 {font-weight: bold;}
.source-html4strict .kw1 {color: #b1b100;}
.source-html4strict .kw2 {color: #000000; font-weight: bold;}
.source-html4strict .kw3 {color: #000066;}
.source-html4strict .coMULTI {color: #808080; font-style: italic;}
.source-html4strict .es0 {color: #000099; font-weight: bold;}
.source-html4strict .br0 {color: #66cc66;}
.source-html4strict .sy0 {color: #66cc66;}
.source-html4strict .st0 {color: #ff0000;}
.source-html4strict .nu0 {color: #cc66cc;}
.source-html4strict .sc0 {color: #00bbdd;}
.source-html4strict .sc1 {color: #ddbb00;}
.source-html4strict .sc2 {color: #009900;}
.source-html4strict .ln-xtra, .source-html4strict li.ln-xtra, .source-html4strict div.ln-xtra {background-color: #ffc;}
.source-html4strict span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-XEP-0060 action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">XEP-0060</h1>
	<div id="bodyContent">
		<div id="siteSub">来自Jabber/XMPP中文翻译计划</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">跳转到： <a href="#column-one">导航</a>, <a href="#searchInput">搜索</a></div>
		<!-- start content -->
<div lang="zh-cn" dir="ltr" class="mw-content-ltr"><p><b>本文的英文原文来自<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0060.html">XEP-0060</a></b>
</p><p><b>XEP-0060: 发布-订阅</b>
</p><p><b>摘要:</b> 本文定义了一个XMPP协议扩展来实现实现通用的 发布-订阅 功能。这个协议使 XMPP实体能在一个pubsub服务创建节点(主题)并发布信息到那些节点上；然后一个事件通知(携带或未带载荷)被广播到所有订阅了该节点的实体. PubSub因此坚持了经典的观察者设计模式，并可以作为广泛应用的服务基础，包括新闻提要，内容整合，富出席信息，地理位置，工作流系统，网络管理系统，以及任何其他需要事件通知的应用。
</p><p><b>作者:</b> Peter Millard, Peter Saint-Andre, Ralph Meijer
</p><p><b>版权:</b> © 1999 - 2013 XMPP标准化基金会(XSF). 参见<a href="/XEP-0060#.E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A" title="XEP-0060">法律通告</a>.
</p><p>状态: 草案
</p><p>类型: 标准跟踪
</p><p>版本: 1.13
</p><p>最后更新日期: 2010-07-12
</p>
<hr />
<p>注意: 这里定义的协议是XMPP标准化基金会的一个<b>草案标准</b>.对本协议的执行是被鼓励的,也适于布署到生产系统,但是在它成为最终标准之前可能还会有一些变动.
</p>
<hr />
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目录</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E7.BB.AA.E8.AE.BA"><span class="tocnumber">1</span> <span class="toctext">绪论</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#.E6.A6.82.E8.A7.88"><span class="tocnumber">1.1</span> <span class="toctext">概览</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#.E5.AE.83.E5.A6.82.E4.BD.95.E5.B7.A5.E4.BD.9C"><span class="tocnumber">1.2</span> <span class="toctext">它如何工作</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#.E6.9C.AF.E8.AF.AD.E8.A1.A8"><span class="tocnumber">2</span> <span class="toctext">术语表</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.E9.9C.80.E6.B1.82"><span class="tocnumber">3</span> <span class="toctext">需求</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#.E5.87.86.E5.A4.87.E5.B7.A5.E4.BD.9C"><span class="tocnumber">4</span> <span class="toctext">准备工作</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB"><span class="tocnumber">4.1</span> <span class="toctext">从属关系</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81"><span class="tocnumber">4.2</span> <span class="toctext">订阅状态</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.E4.BA.8B.E4.BB.B6.E7.B1.BB.E5.9E.8B"><span class="tocnumber">4.3</span> <span class="toctext">事件类型</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.E8.8A.82.E7.82.B9.E7.B1.BB.E5.9E.8B"><span class="tocnumber">4.4</span> <span class="toctext">节点类型</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F"><span class="tocnumber">4.5</span> <span class="toctext">节点访问模式</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#.E5.AF.BB.E5.9D.80"><span class="tocnumber">4.6</span> <span class="toctext">寻址</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#JID"><span class="tocnumber">4.6.1</span> <span class="toctext">JID</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#JID.2BNodeID"><span class="tocnumber">4.6.2</span> <span class="toctext">JID+NodeID</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#.E5.AE.9E.E4.BD.93.E7.94.A8.E4.BE.8B"><span class="tocnumber">5</span> <span class="toctext">实体用例</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#.E6.9F.A5.E8.AF.A2.E7.89.B9.E6.80.A7"><span class="tocnumber">5.1</span> <span class="toctext">查询特性</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9"><span class="tocnumber">5.2</span> <span class="toctext">查询节点</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E8.8A.82.E7.82.B9.E4.BF.A1.E6.81.AF"><span class="tocnumber">5.3</span> <span class="toctext">查询节点节点信息</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E5.85.83.E6.95.B0.E6.8D.AE"><span class="tocnumber">5.4</span> <span class="toctext">查询节点元数据</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE"><span class="tocnumber">5.5</span> <span class="toctext">查询节点条目</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#.E6.89.BE.E5.9B.9E.E8.AE.A2.E9.98.85"><span class="tocnumber">5.6</span> <span class="toctext">找回订阅</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#.E6.89.BE.E5.9B.9E.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB"><span class="tocnumber">5.7</span> <span class="toctext">找回从属关系</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23"><a href="#.E8.AE.A2.E9.98.85.E8.80.85.E7.94.A8.E4.BE.8B"><span class="tocnumber">6</span> <span class="toctext">订阅者用例</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#.E8.AE.A2.E9.98.85.E8.8A.82.E7.82.B9"><span class="tocnumber">6.1</span> <span class="toctext">订阅节点</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="#.E8.AF.B7.E6.B1.82"><span class="tocnumber">6.1.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF"><span class="tocnumber">6.1.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF"><span class="tocnumber">6.1.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-28"><a href="#JIDs.E4.B8.8D.E5.8C.B9.E9.85.8D"><span class="tocnumber">6.1.3.1</span> <span class="toctext">JIDs不匹配</span></a></li>
<li class="toclevel-4 tocsection-29"><a href="#.E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF"><span class="tocnumber">6.1.3.2</span> <span class="toctext">要求订阅出席信息</span></a></li>
<li class="toclevel-4 tocsection-30"><a href="#.E4.B8.8D.E5.9C.A8.E5.90.8D.E5.86.8C.E7.BB.84.E4.B8.AD"><span class="tocnumber">6.1.3.3</span> <span class="toctext">不在名册组中</span></a></li>
<li class="toclevel-4 tocsection-31"><a href="#.E4.B8.8D.E5.9C.A8.E7.99.BD.E5.90.8D.E5.8D.95.E4.B8.AD"><span class="tocnumber">6.1.3.4</span> <span class="toctext">不在白名单中</span></a></li>
<li class="toclevel-4 tocsection-32"><a href="#.E8.A6.81.E6.B1.82.E4.BB.98.E6.AC.BE"><span class="tocnumber">6.1.3.5</span> <span class="toctext">要求付款</span></a></li>
<li class="toclevel-4 tocsection-33"><a href="#.E4.B8.8D.E5.85.81.E8.AE.B8.E5.8C.BF.E5.90.8D.E8.AE.A2.E9.98.85"><span class="tocnumber">6.1.3.6</span> <span class="toctext">不允许匿名订阅</span></a></li>
<li class="toclevel-4 tocsection-34"><a href="#.E8.AE.A2.E9.98.85.E6.9C.AA.E5.86.B3"><span class="tocnumber">6.1.3.7</span> <span class="toctext">订阅未决</span></a></li>
<li class="toclevel-4 tocsection-35"><a href="#.E8.A2.AB.E5.B1.8F.E8.94.BD"><span class="tocnumber">6.1.3.8</span> <span class="toctext">被屏蔽</span></a></li>
<li class="toclevel-4 tocsection-36"><a href="#.E5.A4.AA.E5.A4.9A.E8.AE.A2.E9.98.85"><span class="tocnumber">6.1.3.9</span> <span class="toctext">太多订阅</span></a></li>
<li class="toclevel-4 tocsection-37"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.AE.A2.E9.98.85"><span class="tocnumber">6.1.3.10</span> <span class="toctext">不支持订阅</span></a></li>
<li class="toclevel-4 tocsection-38"><a href="#.E8.8A.82.E7.82.B9.E8.A2.AB.E7.A7.BB.E8.B5.B0.E4.BA.86"><span class="tocnumber">6.1.3.11</span> <span class="toctext">节点被移走了</span></a></li>
<li class="toclevel-4 tocsection-39"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8"><span class="tocnumber">6.1.3.12</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-40"><a href="#.E8.A6.81.E6.B1.82.E6.89.B9.E5.87.86"><span class="tocnumber">6.1.4</span> <span class="toctext">要求批准</span></a></li>
<li class="toclevel-3 tocsection-41"><a href="#.E8.A6.81.E6.B1.82.E9.85.8D.E7.BD.AE"><span class="tocnumber">6.1.5</span> <span class="toctext">要求配置</span></a></li>
<li class="toclevel-3 tocsection-42"><a href="#.E5.A4.9A.E9.87.8D.E8.AE.A2.E9.98.85"><span class="tocnumber">6.1.6</span> <span class="toctext">多重订阅</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#.E8.8E.B7.E5.8F.96.E6.9C.80.E8.BF.91.E5.8F.91.E5.B8.83.E7.9A.84.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.1.7</span> <span class="toctext">获取最近发布的条目</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-44"><a href="#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.8F.96.E6.B6.88.E8.AE.A2.E9.98.85"><span class="tocnumber">6.2</span> <span class="toctext">从节点取消订阅</span></a>
<ul>
<li class="toclevel-3 tocsection-45"><a href="#.E8.AF.B7.E6.B1.82_2"><span class="tocnumber">6.2.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_2"><span class="tocnumber">6.2.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_2"><span class="tocnumber">6.2.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-48"><a href="#.E6.97.A0.E8.AE.A2.E9.98.85ID"><span class="tocnumber">6.2.3.1</span> <span class="toctext">无订阅ID</span></a></li>
<li class="toclevel-4 tocsection-49"><a href="#.E6.97.A0.E8.AF.A5.E8.AE.A2.E9.98.85.E8.80.85"><span class="tocnumber">6.2.3.2</span> <span class="toctext">无该订阅者</span></a></li>
<li class="toclevel-4 tocsection-50"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3"><span class="tocnumber">6.2.3.3</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-51"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_2"><span class="tocnumber">6.2.3.4</span> <span class="toctext">节点不存在</span></a></li>
<li class="toclevel-4 tocsection-52"><a href="#.E5.9D.8F.E7.9A.84.E8.AE.A2.E9.98.85ID"><span class="tocnumber">6.2.3.5</span> <span class="toctext">坏的订阅ID</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-53"><a href="#.E9.85.8D.E7.BD.AE.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9"><span class="tocnumber">6.3</span> <span class="toctext">配置订阅选项</span></a>
<ul>
<li class="toclevel-3 tocsection-54"><a href="#.E5.A3.B0.E6.98.8E.E6.94.AF.E6.8C.81"><span class="tocnumber">6.3.1</span> <span class="toctext">声明支持</span></a></li>
<li class="toclevel-3 tocsection-55"><a href="#.E8.AF.B7.E6.B1.82_3"><span class="tocnumber">6.3.2</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-56"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_3"><span class="tocnumber">6.3.3</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-57"><a href="#.E5.A4.B1.E8.B4.A5.E5.9C.BA.E6.99.AF"><span class="tocnumber">6.3.4</span> <span class="toctext">失败场景</span></a>
<ul>
<li class="toclevel-4 tocsection-58"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_2"><span class="tocnumber">6.3.4.1</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-59"><a href="#.E6.97.A0.E8.AF.A5.E8.AE.A2.E9.98.85.E8.80.85_2"><span class="tocnumber">6.3.4.2</span> <span class="toctext">无该订阅者</span></a></li>
<li class="toclevel-4 tocsection-60"><a href="#.E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E8.80.85JID"><span class="tocnumber">6.3.4.3</span> <span class="toctext">要求订阅者JID</span></a></li>
<li class="toclevel-4 tocsection-61"><a href="#.E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85ID"><span class="tocnumber">6.3.4.4</span> <span class="toctext">要求订阅ID</span></a></li>
<li class="toclevel-4 tocsection-62"><a href="#.E9.94.99.E8.AF.AF.E7.9A.84.E8.AE.A2.E9.98.85ID"><span class="tocnumber">6.3.4.5</span> <span class="toctext">错误的订阅ID</span></a></li>
<li class="toclevel-4 tocsection-63"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9"><span class="tocnumber">6.3.4.6</span> <span class="toctext">不支持订阅选项</span></a></li>
<li class="toclevel-4 tocsection-64"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_3"><span class="tocnumber">6.3.4.7</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-65"><a href="#.E8.A1.A8.E5.8D.95.E6.8F.90.E4.BA.A4"><span class="tocnumber">6.3.5</span> <span class="toctext">表单提交</span></a></li>
<li class="toclevel-3 tocsection-66"><a href="#.E8.A1.A8.E5.8D.95.E5.A4.84.E7.90.86"><span class="tocnumber">6.3.6</span> <span class="toctext">表单处理</span></a>
<ul>
<li class="toclevel-4 tocsection-67"><a href="#.E6.88.90.E5.8A.9F"><span class="tocnumber">6.3.6.1</span> <span class="toctext">成功</span></a></li>
<li class="toclevel-4 tocsection-68"><a href="#.E5.A4.B1.E8.B4.A5"><span class="tocnumber">6.3.6.2</span> <span class="toctext">失败</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-69"><a href="#.E8.AE.A2.E9.98.85.E5.B9.B6.E9.85.8D.E7.BD.AE"><span class="tocnumber">6.3.7</span> <span class="toctext">订阅并配置</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-70"><a href="#.E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.AE.A2.E9.98.85.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9"><span class="tocnumber">6.4</span> <span class="toctext">请求缺省订阅配置选项</span></a>
<ul>
<li class="toclevel-3 tocsection-71"><a href="#.E8.AF.B7.E6.B1.82_4"><span class="tocnumber">6.4.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-72"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_4"><span class="tocnumber">6.4.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-73"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_3"><span class="tocnumber">6.4.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-74"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE"><span class="tocnumber">6.4.3.1</span> <span class="toctext">不支持节点配置</span></a></li>
<li class="toclevel-4 tocsection-75"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8E.B7.E5.8F.96.E7.BC.BA.E7.9C.81.E8.AE.A2.E9.98.85.E9.85.8D.E7.BD.AE"><span class="tocnumber">6.4.3.2</span> <span class="toctext">不支持获取缺省订阅配置</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-76"><a href="#.E4.BB.8E.E8.8A.82.E7.82.B9.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5</span> <span class="toctext">从节点获取条目</span></a>
<ul>
<li class="toclevel-3 tocsection-77"><a href="#.E8.AE.B8.E5.8F.AF"><span class="tocnumber">6.5.1</span> <span class="toctext">许可</span></a></li>
<li class="toclevel-3 tocsection-78"><a href="#.E8.AF.B7.E6.B1.82.E6.89.80.E6.9C.89.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.2</span> <span class="toctext">请求所有条目</span></a></li>
<li class="toclevel-3 tocsection-79"><a href="#.E8.BF.94.E5.9B.9E.E6.89.80.E6.9C.89.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.3</span> <span class="toctext">返回所有条目</span></a></li>
<li class="toclevel-3 tocsection-80"><a href="#.E8.BF.94.E5.9B.9E.E4.B8.80.E4.BA.9B.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.4</span> <span class="toctext">返回一些条目</span></a></li>
<li class="toclevel-3 tocsection-81"><a href="#.E8.BF.94.E5.9B.9E.E6.9C.80.E8.BF.91.E5.8F.91.E5.B8.83.E7.9A.84.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.5</span> <span class="toctext">返回最近发布的条目</span></a></li>
<li class="toclevel-3 tocsection-82"><a href="#.E5.8F.AA.E8.BF.94.E5.9B.9E.E9.80.9A.E7.9F.A5"><span class="tocnumber">6.5.6</span> <span class="toctext">只返回通知</span></a></li>
<li class="toclevel-3 tocsection-83"><a href="#.E8.AF.B7.E6.B1.82.E6.9C.80.E8.BF.91.E7.9A.84.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.7</span> <span class="toctext">请求最近的条目</span></a></li>
<li class="toclevel-3 tocsection-84"><a href="#.E8.AF.B7.E6.B1.82.E4.B8.80.E4.B8.AA.E7.89.B9.E5.AE.9A.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.8</span> <span class="toctext">请求一个特定条目</span></a></li>
<li class="toclevel-3 tocsection-85"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_4"><span class="tocnumber">6.5.9</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-86"><a href="#.E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85ID_2"><span class="tocnumber">6.5.9.1</span> <span class="toctext">要求订阅ID</span></a></li>
<li class="toclevel-4 tocsection-87"><a href="#.E9.9D.9E.E6.B3.95.E7.9A.84.E8.AE.A2.E9.98.85ID"><span class="tocnumber">6.5.9.2</span> <span class="toctext">非法的订阅ID</span></a></li>
<li class="toclevel-4 tocsection-88"><a href="#.E5.AE.9E.E4.BD.93.E6.9C.AA.E8.AE.A2.E9.98.85"><span class="tocnumber">6.5.9.3</span> <span class="toctext">实体未订阅</span></a></li>
<li class="toclevel-4 tocsection-89"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.9.4</span> <span class="toctext">不支持持久化条目</span></a></li>
<li class="toclevel-4 tocsection-90"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.9.5</span> <span class="toctext">不支持获取条目</span></a></li>
<li class="toclevel-4 tocsection-91"><a href="#.E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF_2"><span class="tocnumber">6.5.9.6</span> <span class="toctext">要求订阅出席信息</span></a></li>
<li class="toclevel-4 tocsection-92"><a href="#.E4.B8.8D.E5.9C.A8.E5.90.8D.E5.86.8C.E7.BB.84"><span class="tocnumber">6.5.9.7</span> <span class="toctext">不在名册组</span></a></li>
<li class="toclevel-4 tocsection-93"><a href="#.E4.B8.8D.E5.9C.A8.E7.99.BD.E5.90.8D.E5.8D.95"><span class="tocnumber">6.5.9.8</span> <span class="toctext">不在白名单</span></a></li>
<li class="toclevel-4 tocsection-94"><a href="#.E8.A6.81.E6.B1.82.E4.BB.98.E8.B4.B9"><span class="tocnumber">6.5.9.9</span> <span class="toctext">要求付费</span></a></li>
<li class="toclevel-4 tocsection-95"><a href="#.E8.A2.AB.E7.A6.81.E6.AD.A2"><span class="tocnumber">6.5.9.10</span> <span class="toctext">被禁止</span></a></li>
<li class="toclevel-4 tocsection-96"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_4"><span class="tocnumber">6.5.9.11</span> <span class="toctext">节点不存在</span></a></li>
<li class="toclevel-4 tocsection-97"><a href="#.E6.97.A0.E6.AD.A4.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.5.9.12</span> <span class="toctext">无此条目</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-98"><a href="#.E5.8F.91.E5.B8.83.E8.80.85.E7.94.A8.E4.BE.8B"><span class="tocnumber">7</span> <span class="toctext">发布者用例</span></a>
<ul>
<li class="toclevel-2 tocsection-99"><a href="#.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9"><span class="tocnumber">7.1</span> <span class="toctext">发布条目到节点</span></a>
<ul>
<li class="toclevel-3 tocsection-100"><a href="#.E8.AF.B7.E6.B1.82_5"><span class="tocnumber">7.1.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-101"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_5"><span class="tocnumber">7.1.2</span> <span class="toctext">成功场景</span></a>
<ul>
<li class="toclevel-4 tocsection-102"><a href="#.E5.B8.A6.E8.BD.BD.E8.8D.B7.E7.9A.84.E9.80.9A.E7.9F.A5"><span class="tocnumber">7.1.2.1</span> <span class="toctext">带载荷的通知</span></a></li>
<li class="toclevel-4 tocsection-103"><a href="#.E4.B8.8D.E5.B8.A6.E8.BD.BD.E8.8D.B7.E7.9A.84.E9.80.9A.E7.9F.A5"><span class="tocnumber">7.1.2.2</span> <span class="toctext">不带载荷的通知</span></a></li>
<li class="toclevel-4 tocsection-104"><a href="#.E6.9D.A1.E7.9B.AE.E5.8F.91.E5.B8.83.E8.80.85"><span class="tocnumber">7.1.2.3</span> <span class="toctext">条目发布者</span></a></li>
<li class="toclevel-4 tocsection-105"><a href="#.E5.8C.85.E5.90.AB.E8.AE.A2.E9.98.85ID"><span class="tocnumber">7.1.2.4</span> <span class="toctext">包含订阅ID</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-106"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_5"><span class="tocnumber">7.1.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-107"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_3"><span class="tocnumber">7.1.3.1</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-108"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE"><span class="tocnumber">7.1.3.2</span> <span class="toctext">不支持发布条目</span></a></li>
<li class="toclevel-4 tocsection-109"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_5"><span class="tocnumber">7.1.3.3</span> <span class="toctext">节点不存在</span></a></li>
<li class="toclevel-4 tocsection-110"><a href="#.E8.BD.BD.E8.8D.B7.E8.BF.87.E5.A4.A7"><span class="tocnumber">7.1.3.4</span> <span class="toctext">载荷过大</span></a></li>
<li class="toclevel-4 tocsection-111"><a href="#.E5.9D.8F.E7.9A.84.E8.BD.BD.E8.8D.B7"><span class="tocnumber">7.1.3.5</span> <span class="toctext">坏的载荷</span></a></li>
<li class="toclevel-4 tocsection-112"><a href="#.E8.AF.B7.E6.B1.82.E5.92.8C.E9.85.8D.E7.BD.AE.E4.B8.8D.E5.8C.B9.E9.85.8D"><span class="tocnumber">7.1.3.6</span> <span class="toctext">请求和配置不匹配</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-113"><a href="#.E8.87.AA.E5.8A.A8.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9"><span class="tocnumber">7.1.4</span> <span class="toctext">自动创建节点</span></a></li>
<li class="toclevel-3 tocsection-114"><a href="#.E5.8F.91.E5.B8.83.E9.80.89.E9.A1.B9"><span class="tocnumber">7.1.5</span> <span class="toctext">发布选项</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-115"><a href="#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE"><span class="tocnumber">7.2</span> <span class="toctext">从节点删除条目</span></a>
<ul>
<li class="toclevel-3 tocsection-116"><a href="#.E8.AF.B7.E6.B1.82_6"><span class="tocnumber">7.2.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-117"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_6"><span class="tocnumber">7.2.2</span> <span class="toctext">成功场景</span></a>
<ul>
<li class="toclevel-4 tocsection-118"><a href="#.E5.88.A0.E9.99.A4.E5.B9.B6.E9.80.9A.E7.9F.A5"><span class="tocnumber">7.2.2.1</span> <span class="toctext">删除并通知</span></a></li>
<li class="toclevel-4 tocsection-119"><a href="#.E5.8C.85.E5.90.AB.E8.AE.A2.E9.98.85ID_2"><span class="tocnumber">7.2.2.2</span> <span class="toctext">包含订阅ID</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-120"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_6"><span class="tocnumber">7.2.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-121"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_4"><span class="tocnumber">7.2.3.1</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-122"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_6"><span class="tocnumber">7.2.3.2</span> <span class="toctext">节点不存在</span></a></li>
<li class="toclevel-4 tocsection-123"><a href="#.E8.A6.81.E6.B1.82NodeID"><span class="tocnumber">7.2.3.3</span> <span class="toctext">要求NodeID</span></a></li>
<li class="toclevel-4 tocsection-124"><a href="#.E8.A6.81.E6.B1.82Item.E6.88.96ItemID"><span class="tocnumber">7.2.3.4</span> <span class="toctext">要求Item或ItemID</span></a></li>
<li class="toclevel-4 tocsection-125"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE_2"><span class="tocnumber">7.2.3.5</span> <span class="toctext">不支持持久化条目</span></a></li>
<li class="toclevel-4 tocsection-126"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E6.9D.A1.E7.9B.AE.E5.88.A0.E9.99.A4"><span class="tocnumber">7.2.3.6</span> <span class="toctext">不支持条目删除</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-127"><a href="#.E6.89.80.E6.9C.89.E8.80.85.E7.94.A8.E4.BE.8B"><span class="tocnumber">8</span> <span class="toctext">所有者用例</span></a>
<ul>
<li class="toclevel-2 tocsection-128"><a href="#.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9"><span class="tocnumber">8.1</span> <span class="toctext">创建节点</span></a>
<ul>
<li class="toclevel-3 tocsection-129"><a href="#.E5.B8.B8.E8.A7.84.E4.BA.8B.E9.A1.B9"><span class="tocnumber">8.1.1</span> <span class="toctext">常规事项</span></a></li>
<li class="toclevel-3 tocsection-130"><a href="#.E4.BB.A5.E7.BC.BA.E7.9C.81.E9.85.8D.E7.BD.AE.E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E8.8A.82.E7.82.B9"><span class="tocnumber">8.1.2</span> <span class="toctext">以缺省配置创建一个节点</span></a></li>
<li class="toclevel-3 tocsection-131"><a href="#.E5.88.9B.E5.BB.BA.E5.B9.B6.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9"><span class="tocnumber">8.1.3</span> <span class="toctext">创建并配置节点</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-132"><a href="#.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9"><span class="tocnumber">8.2</span> <span class="toctext">配置节点</span></a>
<ul>
<li class="toclevel-3 tocsection-133"><a href="#.E8.AF.B7.E6.B1.82_7"><span class="tocnumber">8.2.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-134"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_7"><span class="tocnumber">8.2.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-135"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_7"><span class="tocnumber">8.2.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-136"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE_2"><span class="tocnumber">8.2.3.1</span> <span class="toctext">不支持节点配置</span></a></li>
<li class="toclevel-4 tocsection-137"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_5"><span class="tocnumber">8.2.3.2</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-138"><a href="#.E8.A6.81.E6.B1.82NodeID_2"><span class="tocnumber">8.2.3.3</span> <span class="toctext">要求NodeID</span></a></li>
<li class="toclevel-4 tocsection-139"><a href="#.E6.97.A0.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9"><span class="tocnumber">8.2.3.4</span> <span class="toctext">无配置选项</span></a></li>
<li class="toclevel-4 tocsection-140"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_7"><span class="tocnumber">8.2.3.5</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-141"><a href="#.E8.A1.A8.E5.8D.95.E6.8F.90.E4.BA.A4_2"><span class="tocnumber">8.2.4</span> <span class="toctext">表单提交</span></a></li>
<li class="toclevel-3 tocsection-142"><a href="#.E8.A1.A8.E5.8D.95.E5.A4.84.E7.90.86_2"><span class="tocnumber">8.2.5</span> <span class="toctext">表单处理</span></a>
<ul>
<li class="toclevel-4 tocsection-143"><a href="#.E6.88.90.E5.8A.9F_2"><span class="tocnumber">8.2.5.1</span> <span class="toctext">成功</span></a></li>
<li class="toclevel-4 tocsection-144"><a href="#.E5.A4.B1.E8.B4.A5_2"><span class="tocnumber">8.2.5.2</span> <span class="toctext">失败</span></a></li>
<li class="toclevel-4 tocsection-145"><a href="#.E6.88.90.E5.8A.9F.E5.B9.B6.E9.80.9A.E7.9F.A5"><span class="tocnumber">8.2.5.3</span> <span class="toctext">成功并通知</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-146"><a href="#.E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9"><span class="tocnumber">8.3</span> <span class="toctext">请求缺省节点配置选项</span></a>
<ul>
<li class="toclevel-3 tocsection-147"><a href="#.E8.AF.B7.E6.B1.82_8"><span class="tocnumber">8.3.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-148"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_8"><span class="tocnumber">8.3.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-149"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_8"><span class="tocnumber">8.3.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-150"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE_3"><span class="tocnumber">8.3.3.1</span> <span class="toctext">不支持节点配置</span></a></li>
<li class="toclevel-4 tocsection-151"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E7.BC.BA.E7.9C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE.E8.8E.B7.E5.8F.96"><span class="tocnumber">8.3.3.2</span> <span class="toctext">不支持缺省节点配置获取</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-152"><a href="#.E5.88.A0.E9.99.A4.E8.8A.82.E7.82.B9"><span class="tocnumber">8.4</span> <span class="toctext">删除节点</span></a>
<ul>
<li class="toclevel-3 tocsection-153"><a href="#.E8.AF.B7.E6.B1.82_9"><span class="tocnumber">8.4.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-154"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_9"><span class="tocnumber">8.4.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-155"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_9"><span class="tocnumber">8.4.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-156"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_6"><span class="tocnumber">8.4.3.1</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-157"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_8"><span class="tocnumber">8.4.3.2</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-158"><a href="#.E6.B8.85.E9.99.A4.E6.89.80.E6.9C.89.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE"><span class="tocnumber">8.5</span> <span class="toctext">清除所有节点条目</span></a>
<ul>
<li class="toclevel-3 tocsection-159"><a href="#.E8.AF.B7.E6.B1.82_10"><span class="tocnumber">8.5.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-160"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_10"><span class="tocnumber">8.5.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-161"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_10"><span class="tocnumber">8.5.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-162"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E6.B8.85.E7.90.86"><span class="tocnumber">8.5.3.1</span> <span class="toctext">不支持节点清理</span></a></li>
<li class="toclevel-4 tocsection-163"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_7"><span class="tocnumber">8.5.3.2</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-164"><a href="#.E8.8A.82.E7.82.B9.E6.9C.AA.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE"><span class="tocnumber">8.5.3.3</span> <span class="toctext">节点未持久化条目</span></a></li>
<li class="toclevel-4 tocsection-165"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_9"><span class="tocnumber">8.5.3.4</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-166"><a href="#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82"><span class="tocnumber">8.6</span> <span class="toctext">管理订阅请求</span></a></li>
<li class="toclevel-2 tocsection-167"><a href="#.E5.A4.84.E7.90.86.E6.9C.AA.E5.86.B3.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82"><span class="tocnumber">8.7</span> <span class="toctext">处理未决订阅请求</span></a>
<ul>
<li class="toclevel-3 tocsection-168"><a href="#.E8.AF.B7.E6.B1.82_11"><span class="tocnumber">8.7.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-3 tocsection-169"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_11"><span class="tocnumber">8.7.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-3 tocsection-170"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_11"><span class="tocnumber">8.7.3</span> <span class="toctext">错误场景</span></a>
<ul>
<li class="toclevel-4 tocsection-171"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81Ad-Hoc_Commands"><span class="tocnumber">8.7.3.1</span> <span class="toctext">不支持Ad-Hoc Commands</span></a></li>
<li class="toclevel-4 tocsection-172"><a href="#.E4.B8.8D.E6.94.AF.E6.8C.81Get-Pending"><span class="tocnumber">8.7.3.2</span> <span class="toctext">不支持Get-Pending</span></a></li>
<li class="toclevel-4 tocsection-173"><a href="#.E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_8"><span class="tocnumber">8.7.3.3</span> <span class="toctext">权限不足</span></a></li>
<li class="toclevel-4 tocsection-174"><a href="#.E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_10"><span class="tocnumber">8.7.3.4</span> <span class="toctext">节点不存在</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-175"><a href="#.E6.8C.89.E8.8A.82.E7.82.B9.E8.AF.B7.E6.B1.82"><span class="tocnumber">8.7.4</span> <span class="toctext">按节点请求</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-176"><a href="#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85"><span class="tocnumber">8.8</span> <span class="toctext">管理订阅</span></a>
<ul>
<li class="toclevel-3 tocsection-177"><a href="#.E8.8E.B7.E5.8F.96.E8.AE.A2.E9.98.85.E5.88.97.E8.A1.A8"><span class="tocnumber">8.8.1</span> <span class="toctext">获取订阅列表</span></a>
<ul>
<li class="toclevel-4 tocsection-178"><a href="#.E8.AF.B7.E6.B1.82_12"><span class="tocnumber">8.8.1.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-4 tocsection-179"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_12"><span class="tocnumber">8.8.1.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-4 tocsection-180"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_12"><span class="tocnumber">8.8.1.3</span> <span class="toctext">错误场景</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-181"><a href="#.E4.BF.AE.E6.94.B9.E8.AE.A2.E9.98.85"><span class="tocnumber">8.8.2</span> <span class="toctext">修改订阅</span></a>
<ul>
<li class="toclevel-4 tocsection-182"><a href="#.E8.AF.B7.E6.B1.82_13"><span class="tocnumber">8.8.2.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-4 tocsection-183"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_13"><span class="tocnumber">8.8.2.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-4 tocsection-184"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_13"><span class="tocnumber">8.8.2.3</span> <span class="toctext">错误场景</span></a></li>
<li class="toclevel-4 tocsection-185"><a href="#.E5.A4.9A.E9.87.8D.E4.BF.AE.E6.94.B9"><span class="tocnumber">8.8.2.4</span> <span class="toctext">多重修改</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-186"><a href="#.E5.88.A0.E9.99.A4.E8.AE.A2.E9.98.85.E8.80.85"><span class="tocnumber">8.8.3</span> <span class="toctext">删除订阅者</span></a></li>
<li class="toclevel-3 tocsection-187"><a href="#.E9.80.9A.E7.9F.A5.E8.AE.A2.E9.98.85.E8.80.85"><span class="tocnumber">8.8.4</span> <span class="toctext">通知订阅者</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-188"><a href="#.E7.AE.A1.E7.90.86.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB"><span class="tocnumber">8.9</span> <span class="toctext">管理从属关系</span></a>
<ul>
<li class="toclevel-3 tocsection-189"><a href="#.E8.8E.B7.E5.8F.96.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB.E5.88.97.E8.A1.A8"><span class="tocnumber">8.9.1</span> <span class="toctext">获取从属关系列表</span></a>
<ul>
<li class="toclevel-4 tocsection-190"><a href="#.E8.AF.B7.E6.B1.82_14"><span class="tocnumber">8.9.1.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-4 tocsection-191"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_14"><span class="tocnumber">8.9.1.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-4 tocsection-192"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_14"><span class="tocnumber">8.9.1.3</span> <span class="toctext">错误场景</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-193"><a href="#.E4.BF.AE.E6.94.B9.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB"><span class="tocnumber">8.9.2</span> <span class="toctext">修改从属关系</span></a>
<ul>
<li class="toclevel-4 tocsection-194"><a href="#.E8.AF.B7.E6.B1.82_15"><span class="tocnumber">8.9.2.1</span> <span class="toctext">请求</span></a></li>
<li class="toclevel-4 tocsection-195"><a href="#.E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_15"><span class="tocnumber">8.9.2.2</span> <span class="toctext">成功场景</span></a></li>
<li class="toclevel-4 tocsection-196"><a href="#.E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_15"><span class="tocnumber">8.9.2.3</span> <span class="toctext">错误场景</span></a></li>
<li class="toclevel-4 tocsection-197"><a href="#.E5.A4.9A.E9.87.8D.E4.BF.AE.E6.94.B9_2"><span class="tocnumber">8.9.2.4</span> <span class="toctext">多重修改</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-198"><a href="#.E5.88.A0.E9.99.A4.E5.AE.9E.E4.BD.93"><span class="tocnumber">8.9.3</span> <span class="toctext">删除实体</span></a></li>
<li class="toclevel-3 tocsection-199"><a href="#.E9.80.9A.E7.9F.A5.E5.AE.9E.E4.BD.93"><span class="tocnumber">8.9.4</span> <span class="toctext">通知实体</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-200"><a href="#IM.E5.B8.90.E5.8F.B7.E9.9B.86.E6.88.90"><span class="tocnumber">9</span> <span class="toctext">IM帐号集成</span></a>
<ul>
<li class="toclevel-2 tocsection-201"><a href="#.E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85"><span class="tocnumber">9.1</span> <span class="toctext">自动订阅</span></a>
<ul>
<li class="toclevel-3 tocsection-202"><a href="#.E5.B8.90.E5.8F.B7.E6.89.80.E6.9C.89.E8.80.85"><span class="tocnumber">9.1.1</span> <span class="toctext">帐号所有者</span></a></li>
<li class="toclevel-3 tocsection-203"><a href="#.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E8.AE.A2.E9.98.85.E8.80.85"><span class="tocnumber">9.1.2</span> <span class="toctext">出席信息订阅者</span></a></li>
<li class="toclevel-3 tocsection-204"><a href="#.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E5.88.86.E4.BA.AB.E8.80.85"><span class="tocnumber">9.1.3</span> <span class="toctext">出席信息分享者</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-205"><a href="#.E8.BF.87.E6.BB.A4.E9.80.9A.E7.9F.A5"><span class="tocnumber">9.2</span> <span class="toctext">过滤通知</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-206"><a href="#.E7.89.B9.E6.80.A7.E6.B1.87.E6.80.BB"><span class="tocnumber">10</span> <span class="toctext">特性汇总</span></a></li>
<li class="toclevel-1 tocsection-207"><a href="#.E9.94.99.E8.AF.AF.E6.9D.A1.E4.BB.B6"><span class="tocnumber">11</span> <span class="toctext">错误条件</span></a></li>
<li class="toclevel-1 tocsection-208"><a href="#.E5.AE.9E.E7.8E.B0.E5.A4.87.E6.B3.A8"><span class="tocnumber">12</span> <span class="toctext">实现备注</span></a>
<ul>
<li class="toclevel-2 tocsection-209"><a href="#.E9.80.9A.E7.9F.A5.E8.A7.A6.E5.8F.91"><span class="tocnumber">12.1</span> <span class="toctext">通知触发</span></a></li>
<li class="toclevel-2 tocsection-210"><a href="#.E6.9C.9F.E6.9C.9B.E7.9A.84.E9.80.9A.E7.9F.A5.E6.8E.A5.E6.94.B6.E8.80.85"><span class="tocnumber">12.2</span> <span class="toctext">期望的通知接收者</span></a></li>
<li class="toclevel-2 tocsection-211"><a href="#.E9.80.9A.E7.9F.A5.E7.9B.B8.E5.85.B3.E7.9A.84.E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86"><span class="tocnumber">12.3</span> <span class="toctext">通知相关的错误处理</span></a></li>
<li class="toclevel-2 tocsection-212"><a href="#.E4.B8.B4.E6.97.B6.E8.AE.A2.E9.98.85"><span class="tocnumber">12.4</span> <span class="toctext">临时订阅</span></a></li>
<li class="toclevel-2 tocsection-213"><a href="#.E4.BA.8B.E4.BB.B6.E5.9F.BA.E4.BA.8E.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E9.80.92.E9.80.81"><span class="tocnumber">12.5</span> <span class="toctext">事件基于出席信息递送</span></a></li>
<li class="toclevel-2 tocsection-214"><a href="#.E4.B8.8D.E8.B7.AF.E7.94.B1.E4.BA.8B.E4.BB.B6.E5.88.B0.E7.A6.BB.E7.BA.BF.E5.AD.98.E5.82.A8"><span class="tocnumber">12.6</span> <span class="toctext">不路由事件到离线存储</span></a></li>
<li class="toclevel-2 tocsection-215"><a href="#.E5.8C.85.E5.90.AB.E6.B6.88.E6.81.AF.E4.B8.BB.E4.BD.93"><span class="tocnumber">12.7</span> <span class="toctext">包含消息主体</span></a></li>
<li class="toclevel-2 tocsection-216"><a href="#.E8.8A.82.E7.82.B9ID.E5.92.8C.E6.9D.A1.E7.9B.AEID.E5.94.AF.E4.B8.80.E6.80.A7"><span class="tocnumber">12.8</span> <span class="toctext">节点ID和条目ID唯一性</span></a></li>
<li class="toclevel-2 tocsection-217"><a href="#.E6.9D.A1.E7.9B.AE.E7.BC.93.E5.AD.98"><span class="tocnumber">12.9</span> <span class="toctext">条目缓存</span></a></li>
<li class="toclevel-2 tocsection-218"><a href="#.E6.89.B9.E5.A4.84.E7.90.86"><span class="tocnumber">12.10</span> <span class="toctext">批处理</span></a></li>
<li class="toclevel-2 tocsection-219"><a href="#.E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85.E7.9A.84.E6.89.80.E6.9C.89.E8.80.85.E5.92.8C.E5.8F.91.E5.B8.83.E8.80.85"><span class="tocnumber">12.11</span> <span class="toctext">自动订阅的所有者和发布者</span></a></li>
<li class="toclevel-2 tocsection-220"><a href="#.E6.8E.88.E6.9D.83.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82.28.E6.9C.AA.E5.86.B3.E8.AE.A2.E9.98.85.E8.80.85.29"><span class="tocnumber">12.12</span> <span class="toctext">授权订阅请求(未决订阅者)</span></a></li>
<li class="toclevel-2 tocsection-221"><a href="#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5"><span class="tocnumber">12.13</span> <span class="toctext">订阅状态变更通知</span></a></li>
<li class="toclevel-2 tocsection-222"><a href="#NodeID.E8.AF.AD.E4.B9.89"><span class="tocnumber">12.14</span> <span class="toctext">NodeID语义</span></a></li>
<li class="toclevel-2 tocsection-223"><a href="#.E5.8C.85.E5.90.ABSHIM.E5.A4.B4"><span class="tocnumber">12.15</span> <span class="toctext">包含SHIM头</span></a></li>
<li class="toclevel-2 tocsection-224"><a href="#.E5.92.8C.E7.94.9F.E6.88.90.E5.AE.9E.E4.BD.93.E5.85.B3.E8.81.94.E7.9A.84.E4.BA.8B.E4.BB.B6.E5.92.8C.E8.BD.BD.E8.8D.B7"><span class="tocnumber">12.16</span> <span class="toctext">和生成实体关联的事件和载荷</span></a></li>
<li class="toclevel-2 tocsection-225"><a href="#.E9.93.BE.E6.8E.A5"><span class="tocnumber">12.17</span> <span class="toctext">链接</span></a></li>
<li class="toclevel-2 tocsection-226"><a href="#.E5.9F.BA.E4.BA.8E.E6.97.B6.E9.97.B4.E7.9A.84.E8.AE.A2.E9.98.85.28.E7.A7.9F.E7.94.A8.29"><span class="tocnumber">12.18</span> <span class="toctext">基于时间的订阅(租用)</span></a></li>
<li class="toclevel-2 tocsection-227"><a href="#.E5.9F.BA.E4.BA.8E.E5.86.85.E5.AE.B9.E7.9A.84Pubsub.E7.B3.BB.E7.BB.9F"><span class="tocnumber">12.19</span> <span class="toctext">基于内容的Pubsub系统</span></a></li>
<li class="toclevel-2 tocsection-228"><a href="#.E5.8D.95.E4.BB.B6.E8.8A.82.E7.82.B9"><span class="tocnumber">12.20</span> <span class="toctext">单件节点</span></a></li>
<li class="toclevel-2 tocsection-229"><a href="#PubSub_URIs"><span class="tocnumber">12.21</span> <span class="toctext">PubSub URIs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-230"><a href="#XML_Schemas"><span class="tocnumber">13</span> <span class="toctext">XML Schemas</span></a>
<ul>
<li class="toclevel-2 tocsection-231"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub"><span class="tocnumber">13.1</span> <span class="toctext">http://jabber.org/protocol/pubsub</span></a></li>
<li class="toclevel-2 tocsection-232"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23errors"><span class="tocnumber">13.2</span> <span class="toctext">http://jabber.org/protocol/pubsub#errors</span></a></li>
<li class="toclevel-2 tocsection-233"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23event"><span class="tocnumber">13.3</span> <span class="toctext">http://jabber.org/protocol/pubsub#event</span></a></li>
<li class="toclevel-2 tocsection-234"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23owner"><span class="tocnumber">13.4</span> <span class="toctext">http://jabber.org/protocol/pubsub#owner</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-235"><a href="#.E8.87.B4.E8.B0.A2"><span class="tocnumber">14</span> <span class="toctext">致谢</span></a></li>
<li class="toclevel-1 tocsection-236"><a href="#.E4.BD.9C.E8.80.85.E5.A4.87.E6.B3.A8"><span class="tocnumber">15</span> <span class="toctext">作者备注</span></a></li>
<li class="toclevel-1 tocsection-237"><a href="#.E9.99.84.E5.BD.95"><span class="tocnumber">16</span> <span class="toctext">附录</span></a>
<ul>
<li class="toclevel-2 tocsection-238"><a href="#.E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF"><span class="tocnumber">16.1</span> <span class="toctext">附录A:文档信息</span></a></li>
<li class="toclevel-2 tocsection-239"><a href="#.E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF"><span class="tocnumber">16.2</span> <span class="toctext">附录B:作者信息</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A"><span class="tocnumber">16.3</span> <span class="toctext">附录C:法律通告</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB"><span class="tocnumber">16.4</span> <span class="toctext">附录D:和XMPP的关系</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9"><span class="tocnumber">16.5</span> <span class="toctext">附录E:讨论地点</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7"><span class="tocnumber">16.6</span> <span class="toctext">附录F:需求一致性</span></a></li>
<li class="toclevel-2 tocsection-240"><a href="#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8"><span class="tocnumber">16.7</span> <span class="toctext">附录G:备注</span></a></li>
<li class="toclevel-2 tocsection-241"><a href="#.E9.99.84.E5.BD.95H:.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2"><span class="tocnumber">16.8</span> <span class="toctext">附录H:修订历史</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id=".E7.BB.AA.E8.AE.BA">绪论</span></h2>
<h3> <span class="mw-headline" id=".E6.A6.82.E8.A7.88">概览</span></h3>
<p>本文定义的XMPP 发布-订阅 扩展提供了一个框架用于广泛的应用, 包括新闻摘要, 内容整合, 扩展的出席信息, 地理位置, 头像管理, 共享的标签, 拍卖和贸易系统, 工作流系统, 网络管理系统, NNTP网关, 资料管理, 以及任何其他需要事件通知的应用.
</p><p>这个技术使用了经典的 "发布-订阅" 或曰 "观察者" 设计模式: 一个人或应用发布信息, 同时一个事件通知 (包含或不包含有效载荷) 被广播到所有授权的订阅者. 通常, 发布者和订阅者之间的联系是由一个服务来调节的,这个服务接收发布请求，广播事件通知到订阅者, 并允许特许实体能管理被授权发布或订阅的人员或应用的列表. 对于发布和订阅的焦点是一个节点 "node" ，它是发布者发送数据的目的地，也是订阅者接收通知的目的地. 节点也维护一个事件历史并提供其他服务以补充纯的 pubsub 模式.
</p><p>本文定义一个通用的协议，所有 pubsub 应用都能使用. 兼容的实现不需要实现这里定义的所有特性 (参见 <a href="/XEP-0060#.E7.89.B9.E6.80.A7.E6.B1.87.E6.80.BB" title="XEP-0060">特性汇总</a>.)  其他协议可以定义 发布-订阅 的子集 "subsets" 或范本 "profiles" 用于特定的场合, 但是这些范本超出了本文的范围.
</p>
<h3> <span class="mw-headline" id=".E5.AE.83.E5.A6.82.E4.BD.95.E5.B7.A5.E4.BD.9C">它如何工作</span></h3>
<p>尽管本协议很大，因为它定义了多方面的用例和可能的错误流程, 但其基本的思路是简单的:
</p>
<ol><li> 一个实体发布信息到一个 发布-订阅 服务上的一个节点.
</li><li> pubsub服务推送一个事件通知到所有被授权可以得知该发布信息的实体.
</li></ol>
<p>可能最流行的类似 发布-订阅 功能的应用是内容整合, 它常见于和博客，新闻网站，以及其他互联网可用的经常更新的信息相关的 RSS 和 Atom (<a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc4287">RFC 4287</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">1</a>) 种子. 设想一个&lt;hamlet@denmark.lit&gt;的博客发布例子. 当 Hamlet 写下一篇新博文, 他的博客软件发布该文到一个位于&lt;pubsub.shakespeare.lit&gt;的pubsub节点:
</p><p><b>例子 1. 发布者发布一篇新博文</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/blogbot'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'pub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;publish</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item<span class="re2">&gt;</span></span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/publish<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>所以那就是 发布-订阅 pubsub 的发布 "pub" 部分.
</p><p>现在 pubsub 服务通知所有订阅者新博文:
</p><p><b>例子 2. 服务通知订阅者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span><span class="co3">
        [ ... ENTRY ... ]
      </span><span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span><span class="co3">
        [ ... ENTRY ... ]
      </span><span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'baz'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span><span class="co3">
        [ ... ENTRY ... ]
      </span><span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'fez'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span><span class="co3">
        [ ... ENTRY ... ]
      </span><span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>这里是一个甚至更简单的例子: 一个临时的节点只发送通知而不带有效载荷:
</p><p><b>例子 3. 一个临时通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'elsinore/doorbell'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>自然, 涉及的实体为了得到完整的 pubsub 功能可能需要完成其他用例 -- 例如, 发布者可能需要建立一个节点 (见 <a href="/XEP-0060#.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">创建节点</a>) 并且订阅者可能需要为通知报名(见  <a href="/XEP-0060#.E8.AE.A2.E9.98.85.E8.8A.82.E7.82.B9" title="XEP-0060">订阅节点</a>). 这些用例在本文的其余部分有完整的描述. (关于哪些特性是必需的，哪些是推荐的或可选的信息, 参考 <a href="/XEP-0060#.E7.89.B9.E6.80.A7.E6.B1.87.E6.80.BB" title="XEP-0060">特性汇总</a>.)
</p>
<h2> <span class="mw-headline" id=".E6.9C.AF.E8.AF.AD.E8.A1.A8">术语表</span></h2>
<p>以下术语用于本文中涉及的pubsub服务上下文中的元素，对象，或动作.(注意: 本文的一些术语在正文中有更详细的解释.)
</p>
<dl><dd><b>Authorize Access Model  授权访问模式</b>
</dd></dl>
<dl><dd><dl><dd>一种节点访问模式,一个实体只能在节点所有者批准了订阅申请之后才能订阅(订阅申请被接受但是只是临时的),并且只有订阅者可以获取项目.
</dd></dl>
</dd></dl>
<dl><dd><b>Address  地址</b>
</dd></dl>
<dl><dd><dl><dd>(1) 一个<a href="/RFC6120" title="RFC6120">XMPP Core</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">2</a>中定义的 JID , 或 (2) 一个JID和一个服务查询<a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">3</a>的联合节点.
</dd></dl>
</dd></dl>
<dl><dd><b>Collection Node  集合节点</b>
</dd></dl>
<dl><dd><dl><dd>一个节点类型，它包含很多节点 和/或 其他集合，但是不发布条目。集合使得展示节点间更复杂的关系成为可能。集合节点定义于<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0248.html">PubSub集合节点</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">4</a>
</dd></dl>
</dd></dl>
<dl><dd><b>|Entity  实体</b>
<dl><dd>一个以JID为地址的Jabber实体 (客户端，服务，应用等).
</dd></dl>
</dd></dl>
<dl><dd><b>Event  事件</b>
<dl><dd>一个节点状态的一次变更
</dd></dl>
</dd></dl>
<dl><dd><b>Instant Node  即时节点</b>
<dl><dd>一个节点，它的NodeID由pubsub服务自动生成
</dd></dl>
</dd></dl>
<dl><dd><b>Item  条目</b>
<dl><dd>一个XML片段，它由一个节点发布, 从而生成一个事件
</dd></dl>
</dd></dl>
<dl><dd><b>ItemID  条目ID</b>
<dl><dd>在一个特定的节点上下文中一个条目的唯一标识符
</dd></dl>
</dd></dl>
<dl><dd><b>Leaf Node  叶子节点</b>
<dl><dd>一个节点类型，它仅包含已发布的条目. 它不是其他节点的一个容器
</dd></dl>
</dd></dl>
<dl><dd><b>Node  节点</b>
<dl><dd>一个虚拟的位置，信息可以被发布到那，并且从它那能接收到事件通知 和/或 有效载荷(在其他pubsub系统中，它可能被称为“topic”（主题））
</dd></dl>
</dd></dl>
<dl><dd><b>NodeID  节点ID</b>
<dl><dd>在一个特定的pubsub服务上下文中一个节点的唯一标识符，节点ID要么由节点创建者提供，要么由pubsub服务生成（如果节点创建者请求一个即时节点）。节点ID可以有语义（例如，在一些系统或在类似PEP的pubsub范本中，节点ID可以是一个 用于相关的载荷的XML命名空间）但是这类含义是可选的.如果一个文档定义了在某个给定的节点ID在XMPP pubsub系统的领域中是独特的, 它必须指定相关载荷的XML命名空间.
</dd></dl>
</dd></dl>
<dl><dd><b>Notification  通知</b>
<dl><dd>一个发送给订阅者的消息通知他们一个事件
</dd></dl>
</dd></dl>
<dl><dd><b>Outcast  被排斥者</b>
<dl><dd>一个不被允许订阅或发布到某个节点的实体
</dd></dl>
</dd></dl>
<dl><dd><b>Owner  所有者</b>
<dl><dd>一个节点的管理者，可能不止一个; 经常（但不是必要的）是节点创建者
</dd></dl>
</dd></dl>
<dl><dd><b>Open Access Model  开放访问模式</b>
<dl><dd>一种节点访问模式，任何实体可以订阅和获取条目而不需要批准.
</dd></dl>
</dd></dl>
<dl><dd><b>Payload  载荷</b>
<dl><dd>包含在一个发布请求或一个事件通知的&lt;item/&gt;元素中的XML数据。一个给定的载荷由一个XML命名空间和相关的schema来定义。一个定义某个载荷的格式的文档应该指定该载荷是否只用于具有相同的XML命名空间的节点ID，或是否能被用于任何条目ID。这样一个文档也应该对于被发布载荷的那个节点是否单个节点的最佳配置提出建议.
</dd></dl>
</dd></dl>
<dl><dd><b>Personal Eventing  个人事件</b>
<dl><dd>发布-订阅的一个简化的子集，用于即时消息和出席信息应用程序场景，每个IM用户的JID是一个虚拟的pubsub服务； 细节请看<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0163.html">基于Pubsub的个人事件</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">5</a>.
</dd></dl>
</dd></dl>
<dl><dd><b>Presence Access Model  出席信息访问模式	</b>
<dl><dd>一种节点访问模式，任何订阅了所有者出席信息（订阅类型为"from" 或 "both"）的实体（参见<a href="/RFC3921" title="RFC3921">RFC3921</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">6</a>），可以订阅一个节点并从节点获取条目；这个访问模式主要应用于即时消息系统。
</dd></dl>
</dd></dl>
<dl><dd><b>Publisher  发布者</b>
<dl><dd>一个实体，被允许发布条目到一个节点并且自动订阅到该节点
</dd></dl>
</dd></dl>
<dl><dd><b>Publish-Only  仅发布</b>
<dl><dd>一个实体，被允许发布条目到一个节点但不被允许接收通知. (当自动化实体需要代表所有者生成通知的时候，这个岗位在没有开放访问模式的上下文中是有用的.)
</dd></dl>
</dd></dl>
<dl><dd><b>Pubsub Service  发布订阅服务</b>
<dl><dd>一个遵循这里定义的协议的 XMPP 服务器或组件
</dd></dl>
</dd></dl>
<dl><dd><b>Roster Access Model  名册访问模式</b>
<dl><dd>一种节点访问模式，任何订阅了所有者的出席信息并且在指定的名册组中的实体订阅该节点并从该节点获取条目；这个访问模式主要适用于即时消息系统
</dd></dl>
</dd></dl>
<dl><dd><b>Subscriber  订阅者</b>
<dl><dd>订阅了某个节点的一个实体
</dd></dl>
</dd></dl>
<dl><dd><b>Whitelist Access Model  白名单访问模式</b>
<dl><dd>一种节点访问模式，一个实体只有在显式地被所有者允许的情况下才可以订阅和接收条目(从未授权的实体发出的订阅请求会被拒绝).
</dd></dl>
</dd></dl>
<h2> <span class="mw-headline" id=".E9.9C.80.E6.B1.82">需求</span></h2>
<p>pubsub服务的需求可能是由终端用户的需要驱动的，也包括其他可能使用这项服务的组件或服务器。首先，一个用Jabber实现的pubsub服务必须提供基本的特性来实现一个纯的 发布-订阅 模式:
</p>
<dl><dd><ul><li> 一个实体必须（MUST）能够发布事件到一个服务，这样所有某个节点的订阅者能接收到事件通知.参见<a href="/XEP-0060#.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9" title="XEP-0060">发布条目到节点</a>.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个实体必需能订阅一个节点(或被告知不允许订阅). 见<a href="/XEP-0060#.E8.AE.A2.E9.98.85.E8.8A.82.E7.82.B9" title="XEP-0060">订阅节点</a>.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个实体必须被允许从属于一个节点。被允许的从属关系包括member(成员)、无(none)、outcast(被排斥者)、所有者(owner)、仅发布者(publish-only)、以及发布者(publisher)。实现必须支持无和所有者的从属关系，可以支持成员、被排斥者、发布者、和仅发布者的从属关系. 见<a href="/XEP-0060#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">从属关系</a>.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个实体必须被允许查询一个pubsub服务（或一个指定的节点）以确定该服务(或节点)实现提供了本文定义的哪些可选的特性。这个查询必须使用服务查询(disco#info)协议. 见<a href="/XEP-0060#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E4.BF.A1.E6.81.AF" title="XEP-0060">查询节点信息</a>.
</li></ul>
</dd></dl>
<p>一些基于Jabber的pubsub服务可能需要使用其他特性，但是这些特性是可选的（OPTIONAL）所以不是强制要求和本协议兼容的。无论如何，如果以下这些特性被实现了，它们必须（MUST）按照此处本协议的规定来保证兼容性。这些特性包括:
</p>
<dl><dd><ul><li> 一个服务可以对一个节点缓存最近一次发布的条目（即使"persistent-items"选项未被设置成true）；如果它确实把缺省的 "cache-last-item" 设置成 true，它应该（SHOULD）按照"send_last_published_item"参数的配置发送最近发布的条目（或关于它的通知）给订阅的实体。
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个节点所有者应该能指定谁可以订阅该节点.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个节点所有者应该能指定谁可以发布项目到该节点.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个节点可以被配置成在事件通知内递送已发布的有效载荷.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个节点可以被配置成持久化已发布条目到一些持久存储机构.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个节点可以被配置成只持久化有限次数的已发布条目.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个服务可以支持集合.如<b>XEP-0248</b>所述.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 一个服务或节点可以支持扩展的服务查询信息(meta-data).
</li></ul>
</dd></dl>
<h2> <span class="mw-headline" id=".E5.87.86.E5.A4.87.E5.B7.A5.E4.BD.9C">准备工作</span></h2>
<h3> <span class="mw-headline" id=".E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB">从属关系</span></h3>
<p>为了管理许可，此处定义的协议使用了一个层次从属关系，类似<a href="/XEP-0045" title="XEP-0045">多用户聊天</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">7</a>中所采用的.
</p><p>所有的从属关系必需基于一个纯JID (&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;) 而不是全JID (&lt;localpart@domain.tld/resource&gt; 或 &lt;domain.tld/resource&gt;).
</p><p>对于 "owner" 和 "none" 的从属关系的支持是必需的。对于所有其他的从属关系的支持是推荐的（RECOMMENDED）。对于由一个实现支持的每个非必需的从属关系, 它应该返回一个服务查询特性 "name-affiliation" , 这里 "name" 是从属关系的名称, 类似 "member", "outcast", 或 "publisher" (见<a href="/XEP-0060#.E7.89.B9.E6.80.A7.E6.80.BB.E7.BB.93" title="XEP-0060">特性总结</a>). 特殊种类的pubsub服务可以强制额外的需求(例如, 要求支持给定的非必需从属关系或所有从属关系).
</p><p><b>表 1: 从属关系和他们的权限</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>从属关系	</th>
<th> 订阅	</th>
<th>获取条目  </th>
<th>发布条目  </th>
<th>删除单个条目  </th>
<th>清理节点  </th>
<th>配置节点  </th>
<th>删除节点
</th></tr>
<tr>
<td>所有者	</td>
<td> Yes	</td>
<td> Yes     </td>
<td> Yes    </td>
<td> Yes	   </td>
<td> Yes    </td>
<td> Yes    </td>
<td> Yes
</td></tr>
<tr>
<td>发布者  </td>
<td> Yes  </td>
<td> Yes     </td>
<td> Yes    </td>
<td> Yes *       </td>
<td> Yes *   </td>
<td> No     </td>
<td> No
</td></tr>
<tr>
<td>仅发布 </td>
<td> No   </td>
<td> No     </td>
<td> Yes    </td>
<td> Yes *       </td>
<td> No *   </td>
<td> No     </td>
<td> No
</td></tr>
<tr>
<td>成员    </td>
<td> Yes   </td>
<td> Yes    </td>
<td> No     </td>
<td> No         </td>
<td> No     </td>
<td> No     </td>
<td> No
</td></tr>
<tr>
<td>无	</td>
<td>Yes	</td>
<td> No	   </td>
<td> No     </td>
<td> No	    </td>
<td> No    </td>
<td> No     </td>
<td> No
</td></tr>
<tr>
<td>被排斥者 </td>
<td> No	</td>
<td> No	   </td>
<td> No     </td>
<td> No          </td>
<td> No    </td>
<td> No      </td>
<td> No
</td></tr></table>
<ul><li> 注意: 一旦一个发布者已经发布条目到了那个节点, 服务可以允许任何发布者删除/清理任何条目而不只是允许原始的发布者移除它。对于 仅发布 从属关系，这种行为是不推荐的，该 仅发布 实体将仅被允许删除它曾经发布的条目。
</li></ul>
<p>实体变更它和节点的从属关系的方法是很明确的。典型来讲，一个从属关系状态的改变需要所有者的动作。从属关系变更和它们的触发动作定义在下表中。
</p><p><b>表 2: 从属关系状态图</b>
</p>
<table border="1" cellspacing="0">


<tr>
<td>被排斥者	</td>
<td>--	</td>
<td>所有者移除禁令	</td>
<td>所有者添加实体到成员列表	</td>
<td>所有者添加实体到发布者列表 </td>
<td>所有者添加实体到所有者列表
</td></tr>
<tr>
<td>无	</td>
<td>所有者禁止实体	</td>
<td>--	</td>
<td>所有者添加实体到成员列表   </td>
<td>所有者添加实体到发布者列表	</td>
<td>所有者添加实体到所有者列表
</td></tr>
<tr>
<td>成员	</td>
<td>所有者禁止实体	</td>
<td>所有者从成员列表中移除实体	</td>
<td>--	</td>
<td>所有者添加实体到发布者列表 </td>
<td>所有者添加实体到所有者列表
</td></tr>
<tr>
<td>发布者	</td>
<td>所有者禁止实体	</td>
<td>所有者从发布者列表中移除实体  </td>
<td>n/a  </td>
<td>--	</td>
<td>所有者添加实体到所有者列表
</td></tr>
<tr>
<td>所有者	</td>
<td>n/a	</td>
<td>所有者辞职	</td>
<td>n/a	</td>
<td>n/a   </td>
<td>--
</td></tr></table>
<h3> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81">订阅状态</span></h3>
<p>订阅某个节点可以有很多状态
</p><p><b>表 3: 订阅状态</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>订阅状态	</th>
<th> 描述
</th></tr>
<tr>
<td>无	</td>
<td> 节点不能（MUST NOT）发送事件通知或有效载荷给实体.
</td></tr>
<tr>
<td>未决的	</td>
<td> 一个实体已经申请订阅一个节点，但是这个申请还没被节点所有者批准。处于这个状态时节点不能（MUST NOT）发送事件通知或有效载荷给实体。
</td></tr>
<tr>
<td>未配置的	</td>
<td> 一个实体已经订阅但是它的订阅选项还没有配置。在这个状态时节点可以发送事件通知或有效载荷给实体。 服务可以（MAY）让未配置的订阅超时(作废)。
</td></tr>
<tr>
<td>已订阅的	</td>
<td> 一个实体已经订阅了一个节点。在这个状态下节点必须发送所有事件通知（和有效载荷，如果配置了的话）给实体(按照订阅者配置和内容过滤)。
</td></tr></table>
<h3> <span class="mw-headline" id=".E4.BA.8B.E4.BB.B6.E7.B1.BB.E5.9E.8B">事件类型</span></h3>
<p>发布-订阅协议需要两个主要的尺度来使我们能够衡量事件：持久性和临时性，纯的通知和包含有效载荷的通知。实现应该让所有者能够从两个尺度都可以配置一个节点。
</p><p>无论一个节点是否配置用于持久性或者临时性的事件，一个服务可以缓存最后发布到节点的条目，在这种情况下，它应该根据"send_last_published_item"选项(参见本文的 <a href="/XEP-0060#.E6.9D.A1.E7.9B.AE.E7.BC.93.E5.AD.98" title="XEP-0060">条目缓存</a>)的配置发送那个条目给订阅者; 如果该服务支持 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#last-published">http://jabber.org/protocol/pubsub#last-published</a>" 特性，那么这个选项的值的缺省值必须是 "on_sub_and_presence" (尽管该服务应该允许该节点所有者覆盖该缺省值).
</p>
<div dir="ltr" style="text-align: left;"><div class="source-text" style="font-family: monospace;"><pre>注意: &quot;on_sub_and_presence&quot; 设置和订阅者的出席信息相关, 而不是和发布者的出席信息相关.</pre></div></div>
<p>一个pubsub服务必须确认发布请求在这两个方面都满足节点的配置。(参见本文的 <a href="/XEP-0060#.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9" title="XEP-0060">发布条目到节点</a> 章节了解相关的出错条件)。
</p><p>节点配置和期望的事件类型决定了是否一个条目必须由发布者提供，该条目是否在发布请求或事件通知中包含一个载荷，以及一个条目的I是由发布者提供还是由pubsub服务生成。我们在下表中总结相关的规则:
</p><p><b>表 4: 条目，载荷，以及条目 ID</b>
</p>
<table border="1" cellspacing="0">


<tr>
<td>持久性节点 **	</td>
<td> 发布者必须包含一个 &lt;item/&gt; 元素，它可以是空的或者包含一个载荷；即使发布请求包含一个载荷,pubsub服务也不能(MUST NOT)在事件通知中包含载荷;如果发布请求不包含条目ID，pubsub服务必须生成条目ID	</td>
<td> 发布请求必须包含一个 &lt;item/&gt; 元素，其中应该包含一个载荷；如果发布请求包含一个载荷，事件通知必需包含该载荷；如果发布请求不包含条目ID，pubsub服务必须生成条目ID
</td></tr>
<tr>
<td>临时性节点 **	</td>
<td> 发布请求不能（MUST NOT）包含一个 &lt;item/&gt; 元素；载荷不被包含在发布请求或事件通知中，尽管事件通知必须包含一个空的&lt;items/&gt;元素；条目ID既不会由发布请求提供也不会由pubsub服务生成	</td>
<td> 发布请求必须包含一个 &lt;item/&gt; 元素，其中包含一个载荷；如果发布请求包含一个载荷，事件通知必需包含该载荷；pubsub服务可以生成一个条目ID
</td></tr></table>
<ul><li> 注意: 节点通知是仅通知的还是包含载荷, 由 "pubsub#deliver_payloads" 配置项来决定.
</li></ul>
<ul><li><ul><li> 注意: 该节点是持久的还是临时的,由 "pubsub#persist_items" 配置项来决定.
</li></ul>
</li></ul>
<h3> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E7.B1.BB.E5.9E.8B">节点类型</span></h3>
<p>有两种节点类型:
</p><p><b>表 5: 节点类型</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>节点类型	</th>
<th> 描述
</th></tr>
<tr>
<td>叶节点	</td>
<td> 一个仅包含发布的条目的节点。它不包含任何其他节点。这是最常见的节点类型。
</td></tr>
<tr>
<td>集合节点	</td>
<td> 一个包含节点和/或其他集合但是不包含发布项目的节点。集合使得节点之间更复杂的关系成为可能。详见 <b>XEP-0248.</b>
</td></tr></table>
<h3> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F">节点访问模式</span></h3>
<p>为了使节点创建对客户端更加简单，我们定义了以下节点访问模式(为了公开性):
</p><p><b>表 6: 节点访问模式</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>访问模式	</th>
<th> 描述
</th></tr>
<tr>
<td>开放的	</td>
<td> 任何实体可以订阅这个节点(即, 订阅不需要批准) ，并且任何实体可以从这个节点获取条目(即，不需要被订阅)；这应该是一般pubsub服务的缺省访问模式。
</td></tr>
<tr>
<td>出席信息	</td>
<td> 任何拥有"from"或"both"类型的订阅的实体可以向节点订阅并获取条目；这个访问模式主要应用于即时消息系统 (参见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a></b> ).
</td></tr>
<tr>
<td>名册	</td>
<td> 任何处于指定名册组中的实体可以向节点订阅和获取条目；这种访问模式主要用于即时消息系统 (参见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a></b> ).
</td></tr>
<tr>
<td>授权的	</td>
<td> 节点所有者必须批准所有订阅请求，并且只有订阅者可以从节点获取条目.
</td></tr>
<tr>
<td>白名单	</td>
<td> 一个实体仅仅在被节点所有者加入白名单的时候才可以订阅和获取条目。节点所有者必须自动进入白名单。为了添加实体到白名单，节点所有者应该y使用本文的 <a href="/XEP-0060#.E7.AE.A1.E7.90.86.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">管理从属关系</a> 中定义的协议，特别是把从属关系设为"member".
</td></tr></table>
<p><br />
一个通用的发布-订阅实现应该支持所有已定义的访问模式, 尽管专门的 发布-订阅 实现可以只支持访问模式的一个子集. 在一个特定的部署中提供哪个访问模式是一个服务供应的问题(比如，一些受限的部署可能希望锁定许可从而只提供“授权的”和"白名单"的访问模式,或甚至只提供"白名单"的访问模式).
</p><p>一个节点创建者或所有者可以覆盖缺省的访问模式,通过给'pubsub#access_model'配置项指定一个适当的值(参见本文的 <a href="/XEP-0060#.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">以缺省值创建节点</a> 和 <a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9" title="XEP-0060">配置节点</a>).
</p>
<h3> <span class="mw-headline" id=".E5.AF.BB.E5.9D.80">寻址</span></h3>
<p>如果一个 pubsub 节点是可设定地址的，它必须（MUST）被设定为一个JID或一个JID和一个节点的组合。<a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">7</a>
</p>
<h4> <span class="mw-headline" id="JID">JID</span></h4>
<p>如果一个 pubsub 节点的地址被设定成一个JID，节点ID必须（MUST）是资源标识符，并且节点ID不能（MUST NOT）是JID中的"user"(节点标识符)部分（如"domain.tld/NodeID" 和 "user@domain.tld/NodeID" 是被允许的; "NodeID@domain.tld" 是不允许的<a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">9</a>）。JID 寻址应该在使用一个不支持节点属性的协议和一个 pubsub 节点交互的时候使用. 例如,当一个服务允许实体通过出席信息订阅节点, 它会把节点地址设成JID。如果一个 pubsub 节点可以被设置成 JID ，pubsub 服务必须确保节点ID符合 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 所述的Stringprep中的Resourceprep范本。
</p><p>考虑以下例子，pubsub服务定位于主机 pubsub.shakespeare.lit.
</p><p><b>例子 4. 节点地址设定为 domain.tld/NodeID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit/news announcements'</span><span class="re2">&gt;</span><span class="co3">
    ...
</span><span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>现在再考虑以下例子, pubsub 服务定位于 pubsub@shakespeare.lit.
</p><p><b>例子 5. 节点地址设定为 user@domain.tld/NodeID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">to</span>=<span class="st0">'pubsub@shakespeare.lit/news announcements'</span><span class="re2">&gt;</span><span class="co3">
    ...
</span><span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id="JID.2BNodeID">JID+NodeID</span></h4>
<p>如果一个pubsub节点地址可以被设成一个JID加节点，这个节点ID必须既是<a href="/XEP-0030" title="XEP-0030">服务查询</a>的'node'属性又是pubsub服务的'node'属性；即，用于查询时，一个pubsub节点等同于一个服务查询节点。如果一个pubsub节点可以被设置成 JID 加 node，这个pubsub服务应该节点ID符合 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 所述的Stringprep中的Resourceprep范本。
</p><p>考虑以下例子，（虚拟的）pubsub服务位于 hamlet@denmark.lit.
</p><p><b>例子 6. 节点地址设为 JID+NodeID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;query</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E5.AE.9E.E4.BD.93.E7.94.A8.E4.BE.8B">实体用例</span></h2>
<p>本章定义了使用案例，用于任何希望和一个发布-订阅服务交互的实体使用的任何协议，主要集中于服务查询的用例。
</p>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E7.89.B9.E6.80.A7">查询特性</span></h3>
<p>一个服务必须回应由'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/disco#info'命名空间限定的服务查询信息请求。由一个pubsub服务返回的">http://jabber.org/protocol/disco#info'命名空间限定的服务查询信息请求。由一个pubsub服务返回的</a>"disco#info"结果必须表明服务的标识符以及支持哪些pubsub特性。
</p><p><b>案例子 7. 实体查询 Pubsub 服务支持的特性</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'feature1'</span><span class="re2">&gt;</span>
   <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 8. Pubsub 服务返回支持的特性组</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'feature1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'pubsub'</span> <span class="re0">type</span>=<span class="st0">'service'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>可能的 pubsub 特性在本文中到处都是，并且它们都已经被注册了，如本文的 <a href="/XEP-0060#XMPP.E6.B3.A8.E5.86.8C.E5.A4.84.E4.BA.8B.E9.A1.B9" title="XEP-0060">XMPP注册处事项</a> 所述。想了解哪个特性是必需的，建议的，可选的，参见本文的 <a href="/XEP-0060#.E7.89.B9.E6.80.A7.E6.80.BB.E7.BB.93" title="XEP-0060">特性总结</a> 。
</p>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9">查询节点</span></h3>
<p>如果一个服务实现了一个多层次节点（也就是 <a href="/XEP-0060#.E9.9B.86.E5.90.88" title="XEP-0060">集合节点</a>），它必须（MUST）也要让实体能够通过 <a href="/XEP-0030" title="XEP-0030">服务查询</a> 协议在这些层级中查询节点，在结果集很大的时候遵照 <b>XEP-0030</b> 的建议(这时候应该使用<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0055.html">Jabber search</a>] <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">10</a> 或一些其他协议).以下例子展示在一个多层次 pubsub 服务中如何使用 服务查询 来查询可用的节点.
</p><p>注意: 节点层次和集合节点是可选的. 详细情况参照本文的 <a href="/XEP-0060#.E8.8A.82.E7.82.B9ID.E8.AF.AD.E4.B9.89" title="XEP-0060">节点ID语义</a> 和 <a href="/XEP-0060#.E9.9B.86.E5.90.88.E8.8A.82.E7.82.B9" title="XEP-0060">集合节点</a>.
</p><p>在第一个例子中,一个实体向一个根节点(即服务本身)发送一个服务查询条目("disco#items")请求,它是一个集合节点:
</p><p><b>例子 9. 实体请求所有一级节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'nodes1'</span><span class="re2">&gt;</span>
<span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 10. 服务返回所有一级节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'nodes1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'blogs'</span>
          <span class="re0">name</span>=<span class="st0">'Weblog updates'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'news'</span>
          <span class="re0">name</span>=<span class="st0">'News and announcements'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>第二个例子中,一个实体发送一个 disco#items 请求给其中一个一级节点,它也是一个集合节点:
</p><p>'<i>例子 11. 实体请求二级节点</i>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'nodes2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'blogs'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 12. 服务返回二级节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'nodes2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'blogs'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'kingly_ravings'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'starcrossed_stories'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
          <span class="re0">node</span>=<span class="st0">'moorish_meanderings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果一个节点是叶子节点而不是一个集合节点并且有条目被发布到该节点,这个服务可以为每一个已发布的条目返回一个 &lt;item/&gt; 元素,如本文的<a href="/XEP-0060#.E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE" title="XEP-0060">查询节点条目</a>所述，无论如何这类条目不能(MUST NOT)包含一个'node'属性(因为它们是已发布的条目,不是节点).
</p>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E8.8A.82.E7.82.B9.E4.BF.A1.E6.81.AF">查询节点节点信息</span></h3>
<p>一个 pubsub 服务必须允许实体去查询每个单独的节点来获得该节点的相关信息。必须（MUST）使用服务查询协议来查询这些信息。"disco#info" 结果必须包含一个标识符，其类别是“pubsub”，类型是“leaf”或“collection”。
</p><p>注意: 如果一个节点的标识符的类型为“leaf”，它不能（MUST NOT）包含其它的节点或集合（只有条目）；如果一个节点的ID类型是“collection”，它不能（MUST NOT）包含条目（只有其它节点或集合）。
</p><p>'<i>例子 13. 实体查询集合节点的信息</i>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'info2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'blogs'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 14. 服务应答pubsub/collection标识符</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'meta1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'blogs'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'pubsub'</span> <span class="re0">type</span>=<span class="st0">'collection'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 15. 实体查询叶子节点信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'info1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 16. 服务应答 pubsub/leaf 标识符</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'info1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span><span class="co3">
    ...
    </span><span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'pubsub'</span> <span class="re0">type</span>=<span class="st0">'leaf'</span><span class="re2">/&gt;</span><span class="co3">
    ...
  </span><span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E5.85.83.E6.95.B0.E6.8D.AE">查询节点元数据</span></h3>
<p>"disco#info" 结果可以包含关于节点的详细元数据，封装在<a href="/XEP-0128" title="XEP-0128">服务发现扩展|服务发现扩展</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">12</a> 定义的<a href="/XEP-0004" title="XEP-0004">数据表格</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">11</a> 格式中，这里的数据表格上下文通过包含一个 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#meta-data">http://jabber.org/protocol/pubsub#meta-data</a>" 中定义的 FORM_TYPE 来指定的，并遵循 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0068.html">数据表格的字段标准化</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">13</a>。如果元数据被提供了，它应该包含所有已配置的选项值，像"automatic" 信息一样，比如节点创建日期，发布者列表以及类似的信息。
</p><p><b>例子 17. 实体查询节点的信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'meta1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 18. 服务应答信息和元数据</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'meta1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'pubsub'</span> <span class="re0">type</span>=<span class="st0">'leaf'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#meta-data</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#type'</span> <span class="re0">label</span>=<span class="st0">'Payload type'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.w3.org/2005/Atom</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#creator'</span> <span class="re0">label</span>=<span class="st0">'Node creator'</span> <span class="re0">type</span>=<span class="st0">'jid-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hamlet@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#creation_date'</span> <span class="re0">label</span>=<span class="st0">'Creation date'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">2003-07-29T22:56Z</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span> <span class="re0">label</span>=<span class="st0">'A short name for the node'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Princely Musings (Atom)</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#description'</span> <span class="re0">label</span>=<span class="st0">'A description of the node'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Updates for Hamlet</span><span class="co4">&amp;apos;</span><span class="co3">s Princely Musings weblog.</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#language'</span> <span class="re0">label</span>=<span class="st0">'Default language'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">en</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#contact'</span> <span class="re0">label</span>=<span class="st0">'People to contact with questions'</span> <span class="re0">type</span>=<span class="st0">'jid-multi'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">bard@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#owner'</span> <span class="re0">label</span>=<span class="st0">'Node owners'</span> <span class="re0">type</span>=<span class="st0">'jid-multi'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hamlet@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publisher'</span> <span class="re0">label</span>=<span class="st0">'Publishers to this node'</span> <span class="re0">type</span>=<span class="st0">'jid-multi'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hamlet@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#num_subscribers'</span> <span class="re0">label</span>=<span class="st0">'Number of subscribers to this node'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1066</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 节点元数据可以用多种方法设置。一些是基于节点配置（如所有者的JID），也有的是动态的（如订阅者的编号）。任何在节点元数据中提供的静态信息应该（SHOULD）在节点配置表单中以字段形式提供。
</p><p>注意: pubsub#language 字段应该是单列的，这样pubsub服务能展示一个适当的语言和语言代码列表.
</p>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE">查询节点条目</span></h3>
<p>为了查询服务中特定节点的已发布条目，一个实体可以发送"disco#items"请求给节点本身，服务可以通过服务查询的&lt;item/&gt;元素返回每个条目。每个服务查询条目的'name'属性必须包含它的ItemID，并且该条目不能（MUST NOT）有'node'属性。这个ItemID可以用于获取条目，使用本文中<a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点获取条目</a>定义的协议.
</p><p>'<i>例子 19. 实体请求一个节点的所有条目</i>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">name</span>=<span class="st0">'368866411b877c30064a5f62b917cffe'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">name</span>=<span class="st0">'3300659945416e274474e469a1f0154c'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">name</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">name</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.89.BE.E5.9B.9E.E8.AE.A2.E9.98.85">找回订阅</span></h3>
<p>一个实体可能想查询服务以找回它对服务中所有节点的订阅。推荐支持这个特性("retrieve-subscriptions").
</p><p>为了做出这些查询，请求的实体必须发送一个 IQ-get 节，这个节的　&lt;pubsub/&gt; 子元素包含一个没有属性的空&lt;subscriptions/&gt;元素。
</p><p><b>例子 20. 实体请求所有当前的订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该服务返回一个订阅列表，它必须（MUST）返回所有和请求中'from'属性中的纯JID(&lt;localpart@domain.tld&gt; or &lt;domain.tld&gt;)部分匹配的JIDs的订阅．
</p><p>对于每个订阅, 返回一个 &lt;subscription/&gt; 元素以指明 NodeID, 以及这个节点ID所从属的JID(可以包含一个资源，取决于实体如何订阅的)，以及当前的订阅状态。如果服务支持订阅标识符，'subid' 属性也必须出现.
</p><p><b>例子 21. 服务返回所有当前订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions<span class="re2">&gt;</span></span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node1'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node2'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node5'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'123-abc'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'004-yyy'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体没有订阅，pubsub 服务必须返回一个空的 &lt;subscriptions/&gt; 元素.
</p><p><b>例子 22. 没有订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果服务不支持订阅找回,该服务必须应答一个&lt;feature-not-implemented/&gt; 错误, 指定一个pubsub特有的错误条件 &lt;unsupported/&gt; 以及特性 "retrieve-subscriptions".
</p><p><b>例子 23. 不支持订阅找回</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'retrieve-subscriptions'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>一个实体也可以在一个特定节点请求它的所有订阅(例如, 如果它的订阅有多个SubIDs(子ID))，通过在&lt;subscriptions/&gt;元素包含一个'node'属性.
</p><p><b>例子 24. 实体从一个特定节点请求当前所有订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<p>服务以后将只返回该实体的订阅到那个特定的节点; 这就像在该实体的订阅上做了个过滤器.
</p><p><b>例子 25. 服务返回所有当前订阅到一个特定节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subscriptions2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'node6'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'123-abc'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'004-yyy'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h3> <span class="mw-headline" id=".E6.89.BE.E5.9B.9E.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB">找回从属关系</span></h3>
<p>一个实体可能希望查询服务以找回它在该服务上的所有节点的从属关系，或查询一个特定的节点以找回在那个节点的从属关系。推荐支持这个特性("retrieve-affiliations").
</p><p>为了向服务做出这些请求，请求实体包含一个没有属性的空 &lt;affiliations/&gt; 元素。
</p><p><b>例子 26. 实体请求所有当前从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'affil1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果服务返回一个从属关系列表，它必须返回所有和该请求的'from'属性的纯JID(&lt;localpart@domain.tld&gt; or &lt;domain.tld&gt;)部分相匹配的JID的从属关系。
</p><p>对于每个从属关系, 返回一个 &lt;affiliation/&gt; 元素，包含　NodeID 和从属关系状态(所有者, 发布者, 仅发布，成员，或 被排斥者).
</p><p><b>例子 27. 服务应答所有当前从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'affil1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations<span class="re2">&gt;</span></span>
      <span class="re1">&lt;affiliation</span> <span class="re0">node</span>=<span class="st0">'node1'</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">node</span>=<span class="st0">'node2'</span> <span class="re0">affiliation</span>=<span class="st0">'publisher'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">node</span>=<span class="st0">'node5'</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体没有从属关系, pubsub服务必须返回一个空的 &lt;affiliations/&gt; 元素.
</p><p><b>例子 28. 没有从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'affil1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该服务不支持从属关系找回, 服务必须应答一个 &lt;feature-not-implemented/&gt; 错误, 指明一个pubsub特有的错误条件 &lt;unsupported/&gt;　和 一个 "retrieve-affiliations"　的特性.
</p><p><b>例子 29. 不支持从属关系找回</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'affil1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'retrieve-affiliations'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<p>为了执行一个对特定节点的从属关系请求, 请求实体包含一个带'node'属性的空&lt;affiliations/&gt;元素.
</p><p><b>例子 30. 实体请求特定节点的从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'affil2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'node6'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>        
<p><b>例子 31. 服务返回当前从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'affil2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations<span class="re2">&gt;</span></span>
      <span class="re1">&lt;affiliation</span> <span class="re0">node</span>=<span class="st0">'node6'</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E8.80.85.E7.94.A8.E4.BE.8B">订阅者用例</span></h2>
<p>本节定义了潜在和实际的订阅者使用协议的用例。（注意：本文的<a href="/XEP-0060#.E5.AE.9E.E7.8E.B0.E5.A4.87.E6.B3.A8" title="XEP-0060">实现备注</a>描述了一个pubsub服务必须遵守的许多重要的因素和商业规则．另外，所有例子都假定独立的pubsub组件存在并包含任何服务器或网络标记的相关'from'地址）．
</p>
<h3> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E8.8A.82.E7.82.B9">订阅节点</span></h3>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82">请求</span></h4>
<p>当一个Jabber实体希望订阅一个节点，它向pubsub服务发送订阅请求。订阅请求是一个 IQ-set　消息，其&lt;pubsub/&gt; 元素包含并且仅包含一个&lt;subscribe/&gt;元素．这个&lt;subscribe/&gt;元素应该拥有一个'node' 属性指明实体希望订阅的节点．这个&lt;subscribe/&gt;元素也必须拥有一个'jid' 属性指明用于订阅的JID确切的XMPP地址－－通常是一个纯JID(&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;) 或全JID(&lt;localpart@domain.tld/resource&gt; or &lt;domain.tld/resource&gt;)．
</p><p>这里是一个订阅请求的例子.
</p><p><b>例子 32. 实体订阅节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscribe</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF">成功场景</span></h4>
<p>如果订阅请求被成功地处理, 该服务器必须通知该请求实体它已经被订阅了(它可以包含一个服务器生成的SubID).
</p><p><b>例子 33. 服务返回成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subid</span>=<span class="st0">'ba49252aaa4f5d320c24d3766f0bdcade78c78d3'</span>
        <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF">错误场景</span></h4>
<p>有很多原因可能导致订阅请求失败:
</p>
<ol><li> JIDs的纯JID部分不匹配.
</li><li> 节点有一个"presence"访问模式并且请求实体没有订阅所有者的出席信息。
</li><li> 节点有一个"roster"的访问模式并且请求实体不在授权名册组中。
</li><li> 节点有一个"whitelist"的访问模式并且请求实体不在白名单中。
</li><li> 订阅节点的时候服务需要付费。
</li><li> 请求实体是匿名的并且服务不允许匿名实体订阅。
</li><li> 请求实体有一个未决的订阅。
</li><li> 请求实体被禁止订阅(例如，因为从属关系是被排斥者)。
</li><li> 请求实体尝试建立太多订阅.
</li><li> 节点不支持订阅。
</li><li> 节点已经被移走了。
</li><li> 节点不存在。
</li></ol>
<p>更完整的错误案例在以下章节.
</p>
<h5> <span class="mw-headline" id="JIDs.E4.B8.8D.E5.8C.B9.E9.85.8D">JIDs不匹配</span></h5>
<p>如果指定的JID是一个纯JID或全JID, 该服务必需最低程度检查纯JID部分和接收到的IQ请求的'from'属性的纯JID部分以确保请求实体和正在请求加入订阅者列表的JID是同一个实体.
</p><p>如果JIDs的纯JID部分不符合以上描述并且请求实体没有被实现定义某种管理或代理特权, 该服务必须返回一个&lt;bad-request/&gt;错误, 它应该也包含一个pubsub特有的错误条件&lt;invalid-jid/&gt;.
</p><p><b>例子 34. JIDs不匹配</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-jid</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>        
<p>注意: 实现可以允许该服务的管理员配置一个实体列表免于这种检查; 那些实体可以被认为是"可信的代理"，被允许代表其他实体订阅. 同样的办法, 实现可以允许实体黑名单，不被允许执行特定的操作(类似订阅或创建节点).
</p>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF">要求订阅出席信息</span></h5>
<p>对于拥有"presence"访问模式的节点，如果请求实体没有订阅所有者的出席信息，那么pubsub服务必须返回一个 &lt;not-authorized/&gt; 错误，它也应该包含一个pubsub特有的&lt;presence-subscription-required/&gt;错误条件。
</p><p><b>例子 35. 实体没有被授权创建一个订阅(需要出席信息订阅)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;presence-subscription-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.9C.A8.E5.90.8D.E5.86.8C.E7.BB.84.E4.B8.AD">不在名册组中</span></h5>
<p>对于拥有"roster"访问模式的节点，如果请求实体不在授权的名册组中，pubsub服务必须返回一个 &lt;not-authorized/&gt; 错误，它也应该也包含一个 pubsub特有的&lt;not-in-roster-group/&gt;错误条件。
</p><p><b>例子 36. 实体没有被授权创建一个订阅(不在名册组中)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;not-in-roster-group</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.9C.A8.E7.99.BD.E5.90.8D.E5.8D.95.E4.B8.AD">不在白名单中</span></h5>
<p>对于拥有"白名单"节点访问模式的节点，如果请求实体不在白名单中，pubsub服务必须返回一个 &lt;not-allowed/&gt; 错误，指定一个pubsub特有的&lt;closed-node/&gt;错误条件。
</p><p><b>例子 37. 节点有白名单访问模式</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;closed-node</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E4.BB.98.E6.AC.BE">要求付款</span></h5>
<p>商业部署可能希望把订阅者连接到一个付费客户数据库。如果订阅者需要付费才能订阅该节点（例如，如果订阅者不在客户数据库中或客户还未付帐），该服务应该返回一个 &lt;payment-required/&gt; 错误给订阅者。
</p><p><b>例子 38. 订阅需要付费</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;payment-required</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.85.81.E8.AE.B8.E5.8C.BF.E5.90.8D.E8.AE.A2.E9.98.85">不允许匿名订阅</span></h5>
<p>一些 XMPP 服务器可能允许使用SASL　ANONYMOUS验证；无论如何，因为这会导致实体不稳定（分配的JID可能不是同一个负责人持续拥有的），一个服务可以阻止匿名实体订阅一个节点并且应该使用服务查询来决定是否有一个实体的标识符是 "account/anonymous"．如果一个请求实体是匿名的但是服务器不允许匿名实体订阅，该服务应该返回一个&lt; forbidden/&gt;错误给订阅者．
</p><p><b>例子 39. 请求实体是匿名用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'anonymous@denmark.lit/foo'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E6.9C.AA.E5.86.B3">订阅未决</span></h5>
<p>如果请求实体有一个未决的订阅, 服务必须返回一个&lt;not-authorized/&gt;错误给订阅者,表明一个发生了pubsub特有的&lt;pending-subscription/&gt;错误条件.
</p><p><b>例子 40. 请求实体有一个未决的订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;pending-subscription</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A2.AB.E5.B1.8F.E8.94.BD">被屏蔽</span></h5>
<p>如果请求实体被屏蔽订阅(例如, 因为它有一个被排斥者的从属关系), 服务器必须返回一个&lt;forbidden/&gt;错误给订阅者.
</p><p><b>例子 41. 请求实体被屏蔽</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.A4.AA.E5.A4.9A.E8.AE.A2.E9.98.85">太多订阅</span></h5>
<p>如果请求实体尝试建立太多订阅("太多"的定义是本地服务策略的问题), 该服务必须返回一个&lt;policy-violation/&gt;错误给订阅者, 指定一个pubsub特有的错误条件&lt;too-many-subscriptions/&gt;.
</p><p><b>例子 42. 请求实体超出了订阅数量限制</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'wait'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;policy-violation</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;too-many-subscriptions</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>        
<p>该服务可能匹配订阅实体的纯JID或全JID来确定是否一个实体请求了太多订阅.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.AE.A2.E9.98.85">不支持订阅</span></h5>
<p>如果节点不允许实体订阅, 服务应该返回一个&lt;feature-not-implemented/&gt;错误给订阅者,指定一个pubsub特有的&lt;unsupported/&gt;错误条件和一个"subscribe"特性.
</p><p><b>例子 43. 订阅不支持</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'subscribe'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E8.A2.AB.E7.A7.BB.E8.B5.B0.E4.BA.86">节点被移走了</span></h5>
<p>如果该节点被移走了, 该服务应该返回一个&lt;gone/&gt;错误(如果该节点被永久性的移走了)或一个&lt;redirect/&gt;错误(如果该节点被临时移走了).
</p><p><b>例子 44. 节点被移走了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;gone</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">&gt;</span><span class="co3">
      xmpp:pubsub.shakespeare.lit?;node=some-other-node
    </span><span class="re1">&lt;/gone<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8">节点不存在</span></h5>
<p>如果节点不存在, 服务应该返回一个&lt;item-not-found/&gt;错误给订阅者.
</p><p><b>例子 45. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E6.89.B9.E5.87.86">要求批准</span></h4>
<p>对于拥有"authorize"访问模式的节点, 订阅请求必须由节点所有者批准, 除非服务策略允许非"none"实体自动订阅(例如，成员和发布者可能被允许自动订阅); 所以pubsub服务发送一个消息给节点所有者请求授权(参见本文的 <a href="/XEP-0060#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82" title="XEP-0060">管理订阅请求</a>). 因为订阅请求可能被批准也可能不被批准, 服务必须返回一个未决通知给订阅者.
</p><p><b>例子 46. 服务应答未决</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subscription</span>=<span class="st0">'pending'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E9.85.8D.E7.BD.AE">要求配置</span></h4>
<p>如果实体在接收事件通知之前必须配置它的订阅选项(见本文 <a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9" title="XEP-0060">配置订阅选项</a>),服务必须通知实体这件事. 它应该返回一个IQ-result给请求实体一个记号表示需要订阅配置。
</p><p><b>例子 47. 服务应答成功并指示要求订阅配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscribe-options<span class="re2">&gt;</span></span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/subscribe-options<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/subscription<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>注意: 只有在订阅者必须在收到任何事件通知之前配置订阅，节点才将包含这个&lt;required/&gt;子元素. 如果配置是必需的而配置请求没有在合理的时间内提交，一个服务可以判定订阅请求超时(取决于服务或节点的配置).
</p><p>替代的方案是, 如果没有同步做配置就不能创建这个订阅, 服务可以返回一个&lt;not-acceptable/&gt; 错误, 指定一个pubsub特有的&lt;configuration-required/&gt;错误条件.
</p><p><b>例子 48. 服务返回错误指出要求订阅配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscribe</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;configuration-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>如果没有包含&lt;required/&gt;元素也没有错误返回, 订阅立刻生效并且实体可以在任何时间配置这个订阅(服务可以通过在IQ-result中包含一个空的&lt;subscribe- options/&gt;元素指出支持订阅选项, 如下案例所示).
</p><p><b>例子 49. 服务应答成功并指示订阅选项被支持但不是必需的</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscribe-options</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscription<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E5.A4.9A.E9.87.8D.E8.AE.A2.E9.98.85">多重订阅</span></h4>
<p>一个实体可能希望使用不同的订阅选项来订阅, 这样它能多次订阅同一个节点. 对这个特性("multi-subscribe")的支持是可选的.
</p><p>如果允许相同的JID的多重订阅, 该服务必需使用'subid'属性来区分相同实体的多个订阅(所以对于每个node+JID组合来说SubID必须是唯一的并且SubID被发送给订阅者的任何时候都是存在的). 不推荐客户端生成SubIDs, 因为可能导致冲突; 所以一个服务应该代表该订阅者生成SubID并且如果订阅者已经提供了SubID服务可以覆盖它. 如果该服务不允许相同实体多重订阅并且它接收到了额外的订阅请求, 该服务必须返回当前的订阅状态(好像订阅刚被批准).
</p><p>当pubsub服务生成事件通知, 它应该只发送一个事件通知给一个有多重订阅的实体, 而不是为每个订阅发送一个事件通知. 这里"实体"意味着指定订阅的JID, 要么是纯JID要么是全JID; 无论如何, 如果相同的纯JID有多个订阅但是那些订阅的全JIDs不同(例如, 一个订阅是用于 user@domain.tld./foo 而另一个订阅是用于 user@domain.tld/bar), 该服务必须把它们视为不同的 JIDs 用来生成事件通知.
</p>
<h4> <span class="mw-headline" id=".E8.8E.B7.E5.8F.96.E6.9C.80.E8.BF.91.E5.8F.91.E5.B8.83.E7.9A.84.E6.9D.A1.E7.9B.AE">获取最近发布的条目</span></h4>
<p>当一个订阅请求被成功处理, 服务可以发送最近发布的条目给新订阅者. 包含这个条目的消息应该被标为由'urn:xmpp:delay'命名空间限定的扩展信息(见<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0203.html">延迟递送</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">14</a>) 以表明它是被延迟递送的. (注意在本例子中该事件通知被发送到纯JID，因为它就是订阅JID.)
</p><p><b>例子 50. 服务发送最近发布的条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span> <span class="re0">stamp</span>=<span class="st0">'2003-12-13T23:58:37Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>      
<p>如果该服务缺省的配置是对所有节点都发送最近发布的条目(根据节点配置覆盖的), 它必须在它对 disco#info 请求的应答中返回一个特性 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#last-published">http://jabber.org/protocol/pubsub#last-published</a>" .
</p>
<h3> <span class="mw-headline" id=".E4.BB.8E.E8.8A.82.E7.82.B9.E5.8F.96.E6.B6.88.E8.AE.A2.E9.98.85">从节点取消订阅</span></h3>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_2">请求</span></h4>
<p>为了从一个节点取消订阅, 订阅者发送一个 IQ-set， 它的 &lt;pubsub/&gt; 子元素包含一个&lt;unsubscribe/&gt;元素，指明节点和已订阅的 JID.
</p><p><b>例子 51. 实体从一个节点取消订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
     <span class="re1">&lt;unsubscribe</span>
         <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
         <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_2">成功场景</span></h4>
<p>如果请求可以被成功处理,服务必须返回一个　IQ result.
</p><p><b>例子 52. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">/&gt;</span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_2">错误场景</span></h4>
<p>有很多原因可能导致取消订阅失败:
</p>
<ol><li> 请求实体对该节点有多个订阅但是没有指定一个订阅ID.
</li><li> 请求未指定一个已存在的订阅者
</li><li> 请求实体没有足够的权限取消指定JID的订阅.
</li><li> 节点不存在.
</li><li> 请求指定的订阅ID不合法或不是当前的.
</li></ol>
<p>错误场景的更完整的描述如下.
</p>
<h5> <span class="mw-headline" id=".E6.97.A0.E8.AE.A2.E9.98.85ID">无订阅ID</span></h5>
<p>如果请求实体有多个订阅指向该节点但是没有指定一个订阅ID, 服务必须返回一个&lt;bad-request/&gt;错误, 它也应该也包含一个 &lt;subid-required/&gt;的pubsub特有的错误条件.
</p><p><b>例子 53. 实体未指定SubID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;subid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.97.A0.E8.AF.A5.E8.AE.A2.E9.98.85.E8.80.85">无该订阅者</span></h5>
<p>如果'jid'属性的值未指定一个已存在的订阅者, pubsub服务必须返回一个错误节, 这个节应该是&lt;unexpected-request/&gt;并且也应该包含一个 &lt;not-subscribed/&gt;的pubsub特有的错误条件.
</p><p><b>例子 54. 请求实体不是一个订阅者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;unexpected-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;not-subscribed</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3">权限不足</span></h5>
<p>如果请求实体被禁止取消指定JID的订阅, 服务必须返回一个&lt;forbidden/&gt;错误. 服务必须检查这个做出请求的实体是否被授权可以取消订阅. 如果订阅者的JID格式是&lt;localpart@domain.tld/resource&gt; 或 &lt;domain.tld/resource&gt;, 服务必须通过比较两个JID的&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt; 部分来执行这个检查以确保它们是匹配的. 如果这些JID的纯JID部分不匹配并且请求实体没有被授权取消这个JID的订阅(例如, 因为它不是一个服务管理员或被授权的代理), 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 55. 请求实体被禁止取消订阅实体</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_2">节点不存在</span></h5>
<p>如果节点不存在, pubsub服务必须返回一个 &lt;item-not-found/&gt; 错误.
</p><p><b>例子 56. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.9D.8F.E7.9A.84.E8.AE.A2.E9.98.85ID">坏的订阅ID</span></h5>
<p>如果一个订阅标识符关联于某个订阅项, 取消订阅请求必须包含一个适当的'subid'属性. 如果这个取消订阅请求包含一个 SubID 但是该节点不支持 SubIDs (或该订阅者第一次并没有使用 SubID 来订阅), 服务应该忽略这个 SubID 并简单地取消订阅这个实体. 如果订阅者以前使用一个 SubID 来订阅但是取消订阅申请包含一个不合法或非当前订阅者的 SubID , 服务必须返回一个&lt;not-acceptable/&gt;错误, 它应该也包含一个&lt;invalid-subid/&gt;的pubsub特有的错误条件.
</p><p><b>例子 57. 非法的订阅标识符</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-subid</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E9.85.8D.E7.BD.AE.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9">配置订阅选项</span></h3>
<p>实现可以允许订阅者们配置订阅选项. 实现应该使用 <b>数据表单</b> (Data Forms)协议来实现这个配置(无论如何, 一个带外机制如web界面也可能被提供).
</p>
<h4> <span class="mw-headline" id=".E5.A3.B0.E6.98.8E.E6.94.AF.E6.8C.81">声明支持</span></h4>
<p>如果一个服务支持订阅选项, 它必须在它对"disco#info"查询的应答中声明(在应答中包含一个feature,其'var'属性为"pubsub#subscription-options").
</p><p><b>例子 58. Pubsub服务指示支持订阅选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'feature1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span><span class="co3">
    ...
    </span><span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/pubsub#subscription-options'</span><span class="re2">/&gt;</span><span class="co3">
    ...
  </span><span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_3">请求</span></h4>
<p>一个订阅者通过在IQ-get节中包含一个&lt;options/&gt;元素来请求订阅选项.
</p><p><b>例子 59. 订阅者请求订阅选项表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_3">成功场景</span></h4>
<p>如果请求被成功的处理, 服务必须应答选项.
</p><p><b>例子 60. 服务应答选项表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Enable delivery?'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Receive digest notifications (approx. one per day)?'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Receive message body in addition to payload?'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span>
            <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span>
            <span class="re0">type</span>=<span class="st0">'list-multi'</span>
            <span class="re0">label</span>=<span class="st0">'Select the presence types which are
                   allowed to receive event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Want to Chat'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Available'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Away'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Extended Away'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">xa</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Do Not Disturb'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">dnd</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>注意: 前述的例子展示了一些(但不是所有)的可以(MAY)被提供的可能的配置选项. 如果一个实现使用 <b>数据表单</b> (Data Forms)协议提供了这些选项, 它必须使用那些在和 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub'">http://jabber.org/protocol/pubsub'</a> 命名空间相关的XMPP注册处中注册了的字段(以上初步展示了那些字段, 并且在本文的 <a href="/XEP-0060#pubsub.23subscribe_options_FORM_TYPE" title="XEP-0060">pubsub#subscribe_options FORM_TYPE</a> 描述了它们, 但是不能(MUST NOT)被当作规范, 因为 XMPP注册处以后还可以在不改变本文的情况下标准化更多的字段).
</p><p>注意: 很多相关的数据表单字段有一个 "boolean" 类型并且必须被有效处理. <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">15</a>
</p>
<h4> <span class="mw-headline" id=".E5.A4.B1.E8.B4.A5.E5.9C.BA.E6.99.AF">失败场景</span></h4>
<p>很多原因可以导致选项请求失败:
</p>
<dl><dd><ol><li> 请求实体没有足够的权限来修改指定的JID的订阅选项.
</li><li> 请求实体(或指定的订阅者)未曾订阅.
</li><li> 请求没有同时指定 NodeID 和订阅者的 JID.
</li><li> 请求没有指定一个订阅ID但是它是必需的.
</li><li> 请求指定了一个订阅项ID但不是合法的或当前的.
</li><li> 订阅选项不支持.
</li><li> 节点不存在.
</li></ol>
</dd></dl>
<p>更完整的错误场景描述如下.
</p>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_2">权限不足</span></h5>
<p>请求订阅选项的时候, 订阅者必须指定向节点订阅的 JID 并且应该指定一个节点(如果没有指定节点, 即 通过 node="", 服务必须认为请求实体希望为它的订阅项向根集合节点请求订阅选项; 详见 <b>XEP-0248</b> ).
</p><p>服务必须验证提出请求的实体已经被授权为订阅的实体设置订阅选项. 如果订阅者的JID的格式是(&lt;localpart@domain.tld/resource&gt; 或 &lt;domain.tld/resource&gt;), 服务必须比较两个JID的(&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;)部分以确保他们是匹配的. 如果两个JID的纯JID部分不匹配并且请求实体没有被授权修改这个JID的订阅选项(例如, 因为它不是一个服务范围内的管理员或授权代理), 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 61. 请求实体没有足够的权限修改订阅选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.97.A0.E8.AF.A5.E8.AE.A2.E9.98.85.E8.80.85_2">无该订阅者</span></h5>
<p>如果请求实体(或指定的订阅者, 如果不同的话) 未曾订阅, 服务必须返回一个 &lt;unexpected-request/&gt; 错误, 它也应该包括一个 &lt;not-subscribed/&gt; 的 pubsub特有的错误条件.
</p><p><b>例子 62. 没有这个订阅者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;unexpected-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;not-subscribed</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E8.80.85JID">要求订阅者JID</span></h5>
<p>如果订阅者没有指定一个订阅者JID, 服务必须返回一个&lt;bad-request/&gt;错误, 它也应该包含一个&lt;jid-required/&gt;的pubsub特有的错误条件.
</p><p><b>例子 63. 订阅者JID未指定</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;jid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85ID">要求订阅ID</span></h5>
<p>如果一个订阅标识符关联于某个订阅, 为了服务能够区分来自同一实体的订阅,在订阅请求中必须带上'subid'属性. 如果'subid'是必需的但未被提供, 服务必须返回一个&lt;bad-request/&gt;错误, 它也应该包含一个&lt;subid-required/&gt;的pubsub特有的错误条件.
</p><p><b>例子 64. 要求SubID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;subid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E7.9A.84.E8.AE.A2.E9.98.85ID">错误的订阅ID</span></h5>
<p>如果一个订阅标识符关联于某订阅, 但请求包含的 SubID 不合法或不是当前订阅者的, 服务必须返回一个&lt;not-acceptable/&gt;错误, 它也应该包含一个&lt;invalid-subid/&gt;的pubsub特有的错误条件.
</p><p><b>例子 65. 非法的订阅标识符</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'unsub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-subid</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9">不支持订阅选项</span></h5>
<p>如果节点或服务不支持订阅选项, 服务必须应答一个&lt;feature-not-implemented/&gt;错误, 指定一个&lt;unsupported/&gt;的pubsub特有的错误条件和一个"subscription-options"特性.
</p><p><b>例子 66. 不支持订阅选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'subscription-options'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_3">节点不存在</span></h5>
<p>如果节点不存在, pubsub服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 67. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A1.A8.E5.8D.95.E6.8F.90.E4.BA.A4">表单提交</span></h4>
<p>接收了配置表单之后, 请求实体应该提交这个表单来更新这个实体对于那个节点的订阅选项.
</p><p><b>例子 68. 订阅者提交完成的选项表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'options2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
     <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A1.A8.E5.8D.95.E5.A4.84.E7.90.86">表单处理</span></h4>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F">成功</span></h5>
<p>如果服务能成功处理提交的表单, 它必须应答成功.
</p><p><b>例子 69. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options2'</span><span class="re2">/&gt;</span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.A4.B1.E8.B4.A5">失败</span></h5>
<p>如果订阅者尝试设置一组非法的选项, 服务必须应答一个&lt;bad-request/&gt;错误.
</p><p><b>例子 70. 服务对于请求非法选项应答错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'options2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-options</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>其他适用于获取订阅选项时发生的错误也同样适用于设置订阅选项的情形.
</p>
<h4> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E5.B9.B6.E9.85.8D.E7.BD.AE">订阅并配置</span></h4>
<p>大家直到, 如果一个服务支持订阅选项, 一个实体可以在同一个节中订阅和提供订阅选项.
</p><p>注意: &lt;options/&gt;元素必须跟随在&lt;subscribe/&gt;元素之后并且不能(MUST NOT)拥有一个'node'属性或'jid'属性, 因为&lt;subscribe/&gt;元素的'node'属性值指明了期望的NodeID而&lt;subscribe/&gt;元素的'jid'属性值指明了订阅者的JID; 如果这些值中的任何一个违规了, 服务必须(MUST)返回一个&lt;bad-request/&gt;错误.
</p><p><b>例子 71. 实体订阅节点并设置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscribe</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;options<span class="re2">&gt;</span></span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>当服务通知客户端成功时, 它应该包含一个类型为"result"的数据表单来通知客户端配置选项的结果.
</p><p><b>例子 72. 服务应答成功(包含配置选项)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'sub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subid</span>=<span class="st0">'ba49252aaa4f5d320c24d3766f0bdcade78c78d3'</span>
        <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;options<span class="re2">&gt;</span></span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.AE.A2.E9.98.85.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9">请求缺省订阅配置选项</span></h3>
<p>一个实体可能想请求关于缺省订阅配置的信息. 对此特性的支持是可选的.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_4">请求</span></h4>
<p>要获得一个节点的缺省订阅选项, 实体必须发送一个空的&lt;default/&gt;元素到该节点; 在应答里面, 该节点应该返回缺省的订阅选项.
</p><p><b>例子 73. 实体请求缺省订阅配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;default</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 这里的命名空间是 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub'">http://jabber.org/protocol/pubsub'</a> (不是用于获取缺省节点配置选项的 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#owner'">http://jabber.org/protocol/pubsub#owner'</a> ).
</p><p>服务本身也可以有缺省订阅配置选项. 要获得一个服务的缺省订阅配置选项的所有(叶子)节点, 实体必须发送一个空的&lt;default/&gt;元素但是不指定节点; 在应答中, 该服务应该返回缺省订阅选项.
</p><p><b>例子 74. 实体请求缺省订阅配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'def2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;default</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>获取集合节点的缺省订阅配置选项的过程参见 <b>XEP-0248</b> .
</p>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_4">成功场景</span></h4>
<p>如果没有发生错误, 该节点必须返回缺省的订阅配置选项.
</p><p><b>例子 75. 服务应答缺省订阅配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;default</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#digest'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#include_body'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#show-values'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">chat</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">online</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">away</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/default<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_3">错误场景</span></h4>
<p>有很多原因使得请求缺省订阅配置选项失败:
</p>
<dl><dd><ol><li> 服务不支持订阅配置.
</li><li> 服务不支持获取缺省订阅选项.
</li></ol>
</dd></dl>
<p>对这些错误的完整描述见接下来的章节.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE">不支持节点配置</span></h5>
<p>如果节点不支持订阅配置, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个 "subscription-options" 特性.
</p><p><b>例子 76. 服务不支持订阅配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'subscription-options'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8E.B7.E5.8F.96.E7.BC.BA.E7.9C.81.E8.AE.A2.E9.98.85.E9.85.8D.E7.BD.AE">不支持获取缺省订阅配置</span></h5>
<p>如果节点不支持或缺缺省明月配置选项, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "retrieve-default-sub" .
</p><p><b>例子 77. 服务不支持获取缺省订阅配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'retrieve-default-sub'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BB.8E.E8.8A.82.E7.82.B9.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE">从节点获取条目</span></h3>
<p>选择持久化条目的pubsub实现可以允许实体从一个节点请求已有的条目(例如, 一个实体可能希望在成功订阅之后这样做以接收这个节点历史上发布的所有条目). 
</p>
<h4> <span class="mw-headline" id=".E8.AE.B8.E5.8F.AF">许可</span></h4>
<p>服务必须遵循节点访问模式来决定是否向请求它们的实体返回这些条目. 具体来说:
</p>
<dl><dd><ul><li> 如果访问模式是"open", 服务应该允许任何实体(无论是否订阅)获取条目.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 如果访问模式是"presence", 服务应该允许任何已订阅这个所有者的出席信息的实体获取条目.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 如果访问模式是"roster", 服务应该允许任何已订阅这个所有者的出席信息并处于适当的名册组中的实体获取条目.
</li></ul>
</dd></dl>
<dl><dd><ul><li> 如果访问模式是"authorize"或"whitelist", 服务必须只允许已订阅的实体来获取条目.
</li></ul>
</dd></dl>
<p>(In addition, a service MUST always allow the node owner to retrieve items from a node and SHOULD always allow a publisher to do so.)
</p><p>对于将来的访问模式的需求, 唯一的例外应该是强制本地隐私和安全策略, 更全面的描述见本文的<a href="/XEP-0060#.E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9" title="XEP-0060">安全事项</a>. (另外, 一个服务必须总是允许节点所有者从一个节点获取条目并且应该总是允许一个发布者这样做.)
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E6.89.80.E6.9C.89.E6.9D.A1.E7.9B.AE">请求所有条目</span></h4>
<p>订阅者可以通过仅仅不加限制地指明节点ID来请求所有的条目.
</p><p><b>例子 78. 订阅者请求所有条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h4> <span class="mw-headline" id=".E8.BF.94.E5.9B.9E.E6.89.80.E6.9C.89.E6.9D.A1.E7.9B.AE">返回所有条目</span></h4>
<p>服务然后应该返回所有发布到这个节点的条目, 尽管它可以截取结果(如果已发行的条目数量太多的话,参见下一节)，很自然的它不能返回那些已删除的，过期的，等等条目.
</p><p><b>例子 79. 服务返回所有条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'368866411b877c30064a5f62b917cffe'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">The Uses of This World</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
O, that this too too solid flesh would melt
Thaw and resolve itself into a dew!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'3300659945416e274474e469a1f0154c'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Ghostly Encounters</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
O all you host of heaven! O earth! what else?
And shall I couple hell? O, fie! Hold, hold, my heart;
And you, my sinews, grow not instant old,
But bear me stiffly up. Remember thee!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-12T23:21:34Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-12T23:21:34Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Alone</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
Now I am alone.
O, what a rogue and peasant slave am I!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h4> <span class="mw-headline" id=".E8.BF.94.E5.9B.9E.E4.B8.80.E4.BA.9B.E6.9D.A1.E7.9B.AE">返回一些条目</span></h4>
<p>一个节点可能有非常多的条目，在这种情况下在应答一个条目请求时返回所有条目是一个问题. 这种情况下,服务应该返回一些条目并提示条目列表已经被截断了，包含一个<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0059.html">结果集管理</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">16</a> 记号.
</p><p><b>例子 80. 服务通过结果集管理返回一些条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'368866411b877c30064a5f62b917cffe'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">The Uses of This World</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
O, that this too too solid flesh would melt
Thaw and resolve itself into a dew!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'3300659945416e274474e469a1f0154c'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Ghostly Encounters</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
O all you host of heaven! O earth! what else?
And shall I couple hell? O, fie! Hold, hold, my heart;
And you, my sinews, grow not instant old,
But bear me stiffly up. Remember thee!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-12T23:21:34Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-12T23:21:34Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Alone</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
Now I am alone.
O, what a rogue and peasant slave am I!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
    <span class="re1">&lt;set</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/rsm'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;first</span> <span class="re0">index</span>=<span class="st0">'0'</span><span class="re2">&gt;</span><span class="co3">368866411b877c30064a5f62b917cffe</span><span class="re1">&lt;/first<span class="re2">&gt;</span></span>
      <span class="re1">&lt;last<span class="re2">&gt;</span></span><span class="co3">4e30f35051b7b8b42abe083742187228</span><span class="re1">&lt;/last<span class="re2">&gt;</span></span>
      <span class="re1">&lt;count<span class="re2">&gt;</span></span><span class="co3">19</span><span class="re1">&lt;/count<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/set<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.BF.94.E5.9B.9E.E6.9C.80.E8.BF.91.E5.8F.91.E5.B8.83.E7.9A.84.E6.9D.A1.E7.9B.AE">返回最近发布的条目</span></h4>
<p>即使服务或节点不支持持久化条目, 它可以返回最近发布的条目.
</p><p><b>例子 81. 服务返回最近发布的条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E5.8F.AA.E8.BF.94.E5.9B.9E.E9.80.9A.E7.9F.A5">只返回通知</span></h4>
<p>一个服务可以返回事件通知而不包含载荷(例如, 为了节省带宽). 如果这样, 该客户端可以请求一个特定的条目(使用 ItemID)以获取载荷. 当一个实体通过ItemID请求条目, 实现必须允许在该请求中指定多个条目.
</p><p><b>例子 82. 订阅者通过ItemID请求特定条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'368866411b877c30064a5f62b917cffe'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 83. 服务发送被请求的条目(们)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'368866411b877c30064a5f62b917cffe'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">The Uses of This World</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
O, that this too too solid flesh would melt
Thaw and resolve itself into a dew!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-12T17:47:23Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Alone</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
Now I am alone.
O, what a rogue and peasant slave am I!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E6.9C.80.E8.BF.91.E7.9A.84.E6.9D.A1.E7.9B.AE">请求最近的条目</span></h4>
<p>一个服务可以允许实体使用 'max_items' 属性请求最近的N个条目 . 当使用了 max_items , 实现应该返回N个最近的(和N个最旧的相反)条目. (注意: 本协议的未来版本可能推荐使用 <b>XEP-0059</b> 取代 'max_items' 属性.)
</p><p><b>例子 84. 订阅者请求两个最近的条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">max_items</span>=<span class="st0">'2'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 85. 服务返回两个最近的条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Alone</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
Now I am alone.
O, what a rogue and peasant slave am I!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E4.B8.80.E4.B8.AA.E7.89.B9.E5.AE.9A.E6.9D.A1.E7.9B.AE">请求一个特定条目</span></h4>
<p>订阅者可以通过指定节点ID和适当的ItemID请求一个特定条目.
</p><p><b>例子 86. 订阅者请求一个特定条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>该服务接着将返回那个特定的条目，如果可用的话.
</p>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_4">错误场景</span></h4>
<p>有很多种原因可能导致条目接收请求失败:
</p>
<dl><dd><ol><li> 请求实体对同一个节点有多个订阅但是没有指定一个订阅ID.
</li><li> 请求实体订阅了但是指定了一个非法的订阅项ID.
</li><li> 节点不返回条目给未订阅的实体而请求实体确实未曾订阅.
</li><li> 服务或节点不支持持久化条目并且不返回最后发布的条目.
</li><li> 服务或节点不支持条目获取.
</li><li> 节点有一个"presence"访问模式而请求实体没有订阅所有者的出席信息.
</li><li> 节点有一个"roster"访问模式而请求实体不在授权的名册组之一.
</li><li> 节点有一个"whitelist"访问模式而请求实体不在白名单中.
</li><li> 服务或节点需要付费才允许获取条目.
</li><li> 请求实体被禁止从节点获取条目(例如, 因为有一个排斥者的从属关系).
</li><li> 节点不存在.
</li></ol>
</dd></dl>
<p>这些错误的完整描述如下.
</p>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85ID_2">要求订阅ID</span></h5>
<p>如果请求实体对同一个节点有多个订阅但是没有指定一个订阅ID, 服务必须返回一个&lt;bad-request/&gt;错误给订阅者, 它也应该包含一个&lt;subid-required/&gt;的pubsub特有的错误条件.
</p><p><b>例子 87. 实体未指定SubID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;subid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.9D.9E.E6.B3.95.E7.9A.84.E8.AE.A2.E9.98.85ID">非法的订阅ID</span></h5>
<p>如果请求实体订阅了但是指定了一个非法的订阅ID, 服务必须返回一个&lt;not-acceptable/&gt;错误给订阅者, 它也应该包含一个&lt;invalid-subid/&gt;的pubsub特有的错误条件.
</p><p><b>例子 88. 实体指定了非法的SubID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-subid</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.AE.9E.E4.BD.93.E6.9C.AA.E8.AE.A2.E9.98.85">实体未订阅</span></h5>
<p>如果节点未返回条目给未订阅的实体并且请求实体未曾订阅(包括已有一个未决的订阅的情形), 服务必须返回一个&lt;not-authorized/&gt;错误给订阅者, 它也应该包含一个&lt;not-subscribed/&gt;的pubsub特有的错误条件.
</p><p><b>例子 89. 实体未订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;not-subscribed</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE">不支持持久化条目</span></h5>
<p>如果服务或节点不支持持久化条目且没有返回最后发行的条目, 服务必须返回一个&lt;feature-not-implemented/&gt;错误给订阅者, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;以及一个特性"persistent-items".
</p><p><b>例子 90. 不支持持久化条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'persistent-items'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE">不支持获取条目</span></h5>
<p>如果服务或节点不支持获取条目(例如, 因为节点是一个如 <b>XEP-0248</b> 所述的集合节点), 服务必须返回一个&lt;feature-not-implemented/&gt;错误给订阅者, 指明一个pubsub特有的错误条件&lt;unsupported/&gt;以及一个特性"retrieve-items".
</p><p><b>例子 91. 不支持获取条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'retrieve-items'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E8.AE.A2.E9.98.85.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF_2">要求订阅出席信息</span></h5>
<p>对于访问模式为"presence"的节点, 如果请求实体没有订阅所有者的出席信息那么pubsub服务必须应答一个&lt;not-authorized/&gt;错误, 它还应该包含一个pubsub特有的错误条件&lt;presence-subscription-required/&gt;.
</p><p><b>例子 92. 实体没有被授权获取条目(要求订阅出席信息)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;presence-subscription-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.9C.A8.E5.90.8D.E5.86.8C.E7.BB.84">不在名册组</span></h5>
<p>对于访问模式为"roster"的节点, 如果请求实体不在授权名册组中那么pubsub服务必须应答一个&lt;not-authorized/&gt;错误, 它也应该包含一个pubsub特有的错误条件&lt;not-in-roster-group/&gt;.
</p><p><b>例子 93. 实体没有被授权获取条目(不在名册组中)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;not-in-roster-group</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.9C.A8.E7.99.BD.E5.90.8D.E5.8D.95">不在白名单</span></h5>
<p>对于访问模式为"whitelist"的节点, 如果请求实体不在白名单中那么服务必须返回一个&lt;not-allowed/&gt;错误, 指明一个pubsub特有的错误条件&lt;closed-node/&gt;.
</p><p><b>例子 94. 节点为白名单模式</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;closed-node</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82.E4.BB.98.E8.B4.B9">要求付费</span></h5>
<p>商业部署可能希望把订阅者链接到一个付费客户数据库. 如果订阅者需要付费才能从那个节点获取条目(例如, 如果订阅者不在客户数据库或客户的帐目没有付清), 服务应该返回一个&lt;payment-required/&gt;错误给订阅者.
</p><p><b>例子 95. 需要付费才能获取条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;payment-required</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E8.A2.AB.E7.A6.81.E6.AD.A2">被禁止</span></h5>
<p>如果请求实体被禁止获取条目(例如, 因为有一个被排斥者的从属关系), 服务必须返回一个&lt;forbidden/&gt;错误给订阅者.
</p><p><b>例子 96. 请求实体被禁止</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>    
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_4">节点不存在</span></h5>
<p>如果节点不存在, 服务应该返回一个&lt;item-not-found/&gt;错误给订阅者.
</p><p><b>例子 97. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.97.A0.E6.AD.A4.E6.9D.A1.E7.9B.AE">无此条目</span></h5>
<p>如果该节点没有条目或请求的那个条目不存在, 服务应该返回一个类型为"result"并带有一个空的&lt;items/&gt;元素的IQ节.
</p><p><b>例子 98. 无此条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'items1'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E5.8F.91.E5.B8.83.E8.80.85.E7.94.A8.E4.BE.8B">发布者用例</span></h2>
<h3> <span class="mw-headline" id=".E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9">发布条目到节点</span></h3>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_5">请求</span></h4>
<p>一个被允许向一个节点发布条目的实体 (即.,一个发布者或一个所有者) 可以在任何时候通过发送一个包含一个pubsub子元素&lt;publish/&gt;的 IQ-set 节给服务来做到这一点.
</p><p>语法如下:
</p>
<dl><dd><ul><li> &lt;publish/&gt; 元素必须拥有一个 'node' 属性, 指定该节点的NodeID.
</li><li> 根据该节点的配置, 该&lt;publish/&gt;元素可以不包含 &lt;item/&gt;元素或包含一个 &lt;item/&gt; 元素. <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">17</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">18</a>
</li><li> 有发布者提供的&lt;item/&gt;元素可以拥有一个 'id' 属性, 为该条目指定一个唯一的ItemID. 如果在发布请求中未提供一个ItemID, 该pubsub服务必须生成一个并且必须确保它对于该节点是唯一的.
</li></ul>
</dd></dl>
<p>例子如下.
</p><p><b>例子 99. 发布者带ItemID发布一个条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/blogbot'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;publish</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'bnd81g37d61f49fgn581'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/publish<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_5">成功场景</span></h4>
<p>如果pubsub服务能成功处理请求, 它必须通知发布者成功了. 如果发布请求不包含一个ItemID, IQ-result 应该包含一个空的&lt;item/&gt;元素来指定已发布的条目的ItemID.
</p><p><b>例子 100. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/blogbot'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;publish</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/publish<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>注意: 如果发布者之前用同一个ItemID发布了一个条目, 该请求的成功处理意味着服务必须以新条目覆盖那个旧条目并做如下处理.
</p><p>pubsub服务接着必须发送一个事件通知给每个按标准可以接收事件通知的实体(典型的是对于每个已批准的订阅者, 尽管在其他上下文中实体也可以接收事件通知，如<a href="/XEP-0060#.E9.80.9A.E7.9F.A5.E8.A7.A6.E5.8F.91.E5.99.A8" title="XEP-0060">通知触发器</a>总结的那样). 每个由pubsub服务生成的&lt;message/&gt;节应该拥有一个值为唯一的'id'属性这样该服务能正确地追踪任何和通知相关的可能发生的错误(见本文的<a href="/XEP-0060#.E5.A4.84.E7.90.86.E9.80.9A.E7.9F.A5.E7.9B.B8.E5.85.B3.E7.9A.84.E9.94.99.E8.AF.AF" title="XEP-0060">处理通知相关的错误</a>). 根据节点配置, 事件通知要么包含要么不包含在和, 如下所示.
</p><p>注意: 为了做到如本文<a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点删除条目</a>所述的条目删除的授权, 支持持久化条目的实现应该存储该条目(如果该节点是如此配置的)并维护一个发布者的记录.
</p><p>注意: 如果该服务或节点已被配置，那么该节点上缓存的条目数有一个最大值，如果当一个条目被发布时缓存数量已经达到了最大值，该服务必须删除现有的条目之一. 推荐服务遵循 "先进先出" 规则并删除最旧的条目. 根据节点配置, 删除一个现有的条目可能(MAY)导致发送一个删除通知给订阅者.
</p>
<h5> <span class="mw-headline" id=".E5.B8.A6.E8.BD.BD.E8.8D.B7.E7.9A.84.E9.80.9A.E7.9F.A5">带载荷的通知</span></h5>
<p>如果节点被配置成包含载荷, 订阅者将随事件通知接收到载荷.
</p><p><b>例子 101. 订阅者接收带载荷的事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'baz'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'fez'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E5.B8.A6.E8.BD.BD.E8.8D.B7.E7.9A.84.E9.80.9A.E7.9F.A5">不带载荷的通知</span></h5>
<p>如果节点被配置成不包含载荷, 订阅者将只接收事件通知. (如果不包含载荷, 订阅者可以通过本文<a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E6.8E.A5.E6.94.B6.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点接收条目</a>定义的协议请求已发布的条目.)
</p><p><b>例子 102. 订阅者只接收事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'baz'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'fez'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.9D.A1.E7.9B.AE.E5.8F.91.E5.B8.83.E8.80.85">条目发布者</span></h5>
<p>如果配置成这样, 服务在生成事件通知的时候可以包含该条目的发布者.
</p><p><b>例子 103. 服务通知订阅者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span>
            <span class="re0">publisher</span>=<span class="st0">'hamlet@denmark.lit'</span><span class="re2">&gt;</span><span class="co3">
        [ ... ENTRY ... ]
      </span><span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>'publisher'属性的值必须由服务生成, 服务不接受在发布条目中带它, 因为允许发布者断言它的JID可能导致欺诈.
</p><p>由服务标记的JID要么是 (1) 从用来发布该条目的 IQ-set 的 'from'属性获得的发布者的全JID &lt;localpart@domain.tld/resource&gt; ，要么是 (2) 在发布者白名单的显式列表中的一个正式的从属关系中衍生出的发布者的纯JID &lt;localpart@domain.tld&gt;.
</p>
<h5> <span class="mw-headline" id=".E5.8C.85.E5.90.AB.E8.AE.A2.E9.98.85ID">包含订阅ID</span></h5>
<p>如果一个单一的实体多次向一个节点订阅, 服务应该以符号标记事件通知这样该实体能确定哪个订阅标识符生成了该事件. 如果包含了这些符号, 它们必须使用<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0131.html">Stanza Headers and Internet Metadata</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">19</a> 格式并且应该在事件通知信息之后被包含(即, 作为&lt;message/&gt;节的最后的子元素).
</p><p><b>例子 104. 订阅者接收带标记的事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
  <span class="re1">&lt;headers</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/shim'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;header</span> <span class="re0">name</span>=<span class="st0">'SubID'</span><span class="re2">&gt;</span><span class="co3">123-abc</span><span class="re1">&lt;/header<span class="re2">&gt;</span></span>
    <span class="re1">&lt;header</span> <span class="re0">name</span>=<span class="st0">'SubID'</span><span class="re2">&gt;</span><span class="co3">004-yyy</span><span class="re1">&lt;/header<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/headers<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_5">错误场景</span></h4>
<p>有很多原因可能导致发布请求失败:
</p>
<dl><dd><ol><li> 请求实体没有足够的权限发布.
</li><li> 节点不支持条目发布.
</li><li> 节点不存在.
</li><li> 载荷大小超出服务器定义的限制.
</li><li> 条目包含多个载荷元素或根载荷元素的命名空间和为该节点配置的命名空间不匹配.
</li><li> 请求和该节点配置不匹配.
</li></ol>
</dd></dl>
<p>这写错误场景的完整描述见下面章节.
</p><p>注意: 如果一个发布者以一个Item ID发布一个条目并且该ItemID和现有的条目匹配, pubsub服务不能(MUST NOT)让这次发布失败而是必须覆盖现有条目并生成一个新的事件通知(即, 重发布等同于修改).
</p>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_3">权限不足</span></h5>
<p>如果请求实体没有足够的权限发布, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 105. 实体没有足够权限发布到节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE">不支持发布条目</span></h5>
<p>如果该节点不支持条目发布(例如, 因为它是一个如 <b>XEP-0248</b> 所述的集合节点), 服务必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "publish" .
</p><p><b>例子 106. 节点不支持条目发布</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'publish'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_5">节点不存在</span></h5>
<p>如果请求实体尝试发布条目到一个不存在的节点并且服务不支持"自动创建"特性 (见<a href="/XEP-0060#.E8.87.AA.E5.8A.A8.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">自动创建节点</a>), 该服务必须返回一个&lt;item-not-found/&gt; 错误.
</p><p><b>例子 107. 实体尝试发布到不存在的节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.BD.BD.E8.8D.B7.E8.BF.87.E5.A4.A7">载荷过大</span></h5>
<p>如果载荷的大小超出了服务定义的限制, 服务必须返回一个&lt;not-acceptable/&gt;错误, 它也将包含一个pubsub特有的错误条件&lt;payload-too-big/&gt;.
</p><p><b>例子 108. 实体尝试发布非常大的载荷</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;payload-too-big</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.9D.8F.E7.9A.84.E8.BD.BD.E8.8D.B7">坏的载荷</span></h5>
<p>如果&lt;item/&gt;元素包含多个载荷元素或根载荷元素的命名空间和为该节点配置的命名空间不匹配, 服务必须弹回该请求一个&lt;bad-request/&gt;错误, 它也应该包含一个pubsub特有的错误条件&lt;invalid-payload/&gt;.
</p><p><b>例子 109. 实体尝试发布条目时带多个载荷元素或命名空间不匹配</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invalid-payload</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E5.92.8C.E9.85.8D.E7.BD.AE.E4.B8.8D.E5.8C.B9.E9.85.8D">请求和配置不匹配</span></h5>
<p>如果请求未遵循该节点配置的事件类型, 服务可以弹回该请求一个&lt;bad-request/&gt;错误, 它也应该包含一个pubsub特有的错误条件. 采用以下规则:
</p>
<dl><dd><ul><li> 如果事件类型是持久化(事件通知或载荷)并且发布者未指定一个ItemID, 服务必须生成该ItemID且不能(MUST NOT)弹回发布请求.
</li><li> 如果事件类型是持久化(事件通知或载荷)并且发布者未包含一个条目, 服务必须弹回发布请求一个&lt;bad-request/&gt;错误以及一个pubsub特有的错误条件&lt;item-required/&gt;.
</li><li> 如果事件类型是载荷(持久化或临时的)并且发布者未包含一个载荷, 服务应该弹回发布请求一个&lt;bad-request/&gt;错误和一个pubsub特有的错误条件&lt;payload-required/&gt;.
</li><li> 如果事件类型是 通知 + 临时的 并且发布者提供了一个条目, 服务必须弹回发布请求一个&lt;bad-request/&gt;错误和一个pubsub特有的错误条件&lt;item-forbidden/&gt;.
</li></ul>
</dd></dl>
<p>这些错误的例子如下所示.
</p><p><b>例子 110. 发布者尝试不带条目发布到持久化节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 111. 发布者尝试不带载荷发布到载荷节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;payload-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 112. 发布者尝试带条目发布到临时通知节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'publish1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item-forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.87.AA.E5.8A.A8.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9">自动创建节点</span></h4>
<p>一个pubsub服务可以在它接收到一个发送到不存在的节点的发布请求的时候自动创建一个节点而不是返回一个&lt;item-not-found/&gt;错误). 当这样做的时候, 该服务应该应用缺省节点配置. 如果一个服务支持这个功能, 它必须声明那个事实，在它的 disco#info 应答中包含一个特性 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#auto-create">http://jabber.org/protocol/pubsub#auto-create</a>" .
</p>
<h4> <span class="mw-headline" id=".E5.8F.91.E5.B8.83.E9.80.89.E9.A1.B9">发布选项</span></h4>
<p>一个pubsub服务可以支持为一个发布请求指定选项的能力(如果这样, 它必须声明支持 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#publish-options">http://jabber.org/protocol/pubsub#publish-options</a>" 特性). 这是例子:
</p><p><b>例子 113. 带选项发布</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/blogbot'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'pub1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;publish</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Soliloquy</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
To be, or not to be: that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles,
And by opposing end them?
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32397</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T18:30:02Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/publish<span class="re2">&gt;</span></span>
    <span class="re1">&lt;publish-options<span class="re2">&gt;</span></span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#publish-options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/publish-options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;publish-options/&gt;元素应该包含一个数据表单(见 <a href="/XEP-0004" title="XEP-0004">XEP-0004</a> ), 它的 FORM_TYPE 应该是 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#publish-options">http://jabber.org/protocol/pubsub#publish-options</a>" (见 <b>XEP-0068</b> ).
</p><p>字段如何被处理取决于该pubsub服务, 它在 XEP-0004 的功能语境中是作为一个 表单处理 实体.
</p><p>例如, 服务可以把字段视为一个前提条件, 在那种情况下服务将做如下处理:
</p>
<dl><dd><ol><li> 如果该节点存在但前提条件不吻合, 那么发布将以一个&lt;conflict/&gt;错误条件和一个pubsub特有的条件&lt;precondition-not-met/&gt;失败.
</li><li> 如果该节点存在且前提条件吻合, 那么发布成功.
</li><li> 如果该节点不存在且该服务支持"auto-create"特性, 那么该服务将以除了哪些在前提条件中指定的配置之外的缺省配置自动创建该节点, 并且发布成功.
</li><li> 如果该节点不存在且该服务不支持"auto-create"特性, 那么发布将失败.
</li></ol>
</dd></dl>
<h3> <span class="mw-headline" id=".E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE">从节点删除条目</span></h3>
<p>一个发布者可能想在它已经发布一个条目到一个支持持久化条目的节点之后删除那个条目. 对此特性("delete-items")的支持是推荐的.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_6">请求</span></h4>
<p>要删除一个条目, 发布者发送一个如下例所示的retract请求. &lt;retract/&gt;元素必须拥有一个'node'属性, 可以拥有一个'notify'属性, 并且必须包含一个&lt;item/&gt;元素; 该&lt;item/&gt;元素必须是空的并且必须拥有一个'id'属性.
</p><p><b>例子 114. 实体从节点删除一个条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;retract</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/retract<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_6">成功场景</span></h4>
<p>如果没发生错误, 服务必须删除该条目.
</p><p><b>例子 115. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">/&gt;</span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.88.A0.E9.99.A4.E5.B9.B6.E9.80.9A.E7.9F.A5">删除并通知</span></h5>
<p>如果没发生错误且&lt;retract/&gt;元素包含一个值为 "true" 或 "1" 的 'notify' 属性 <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">20</a>, 那么服务必须删除该条目并且必须如下所示通知所有的订阅者. 语法除了替换了一个&lt;item/&gt;元素和事件通知完全一样, 这里的&lt;items/&gt;元素包含了一个&lt;retract/&gt;元素.
</p><p><b>例子 116. 订阅者被通知删除</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;retract</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;retract</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.8C.85.E5.90.AB.E8.AE.A2.E9.98.85ID_2">包含订阅ID</span></h5>
<p>如果一个单独的实体多次订阅了某节点, 服务应该标记该节点删除，这样实体能确定哪个订阅标识符生成了这个通知. 如上, 如果这些标记被包含, 它们必需使用 <b>Stanza Headers and Internet Metadata (SHIM)</b> 协议并且应该在通知数据之后被包含(即, 作为&lt;message/&gt;节的最后的子元素).
</p><p><b>例子 117. 订阅者接收带标记的事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;retract</span> <span class="re0">id</span>=<span class="st0">'ae890ac52d0df67ed7cfdf51b644e901'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
  <span class="re1">&lt;headers</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/shim'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;header</span> <span class="re0">name</span>=<span class="st0">'SubID'</span><span class="re2">&gt;</span><span class="co3">123-abc</span><span class="re1">&lt;/header<span class="re2">&gt;</span></span>
    <span class="re1">&lt;header</span> <span class="re0">name</span>=<span class="st0">'SubID'</span><span class="re2">&gt;</span><span class="co3">004-yyy</span><span class="re1">&lt;/header<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/headers<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_6">错误场景</span></h4>
<p>有很多原因可能导致条目撤销请求失败:
</p>
<dl><dd><ol><li> 发布者没有足够权限删除请求的条目.
</li><li> 节点或条目不存在.
</li><li> 请求没有指定节点.
</li><li> 请求没有包含一个&lt;item/&gt;元素或&lt;item/&gt;元素未指定一个ItemID.
</li><li> 节点不支持持久化条目.
</li><li> 服务不支持条目删除.
</li></ol>
</dd></dl>
<p>这些错误的完整描述见下面章节.
</p>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_4">权限不足</span></h5>
<p>如果请求的实体没有足够的权限删除该条目, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 118. 请求实体没有足够权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_6">节点不存在</span></h5>
<p>如果该节点或条目不存在, 服务必须返回一个&lt;item-not-found/&gt;条目.
</p><p><b>例子 119. 不存在的节点或条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82NodeID">要求NodeID</span></h5>
<p>如果请求未指定一个节点, 服务必须返回一个&lt;bad-request/&gt;错误, 它也应该包含一个pubsub特有的错误条件&lt;nodeid-required/&gt;.
</p><p><b>例子 120. 请求未指定一个节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;nodeid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82Item.E6.88.96ItemID">要求Item或ItemID</span></h5>
<p>如果请求未包含一个&lt;item/&gt;元素或&lt;item/&gt;元素未指定一个ItemID, 服务必须返回一个&lt;bad-request/&gt;错误, 它也应该包含一个pubsub特有的错误条件&lt;item-required/&gt;.
</p><p><b>例子 121. 请求未指定一个条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE_2">不支持持久化条目</span></h5>
<p>如果该节点不支持持久化条目(例如, 因为它是一个集合节点或一个临时节点所以不递送载荷), 服务必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "persistent-items" .
</p><p><b>例子 122. 节点不支持持久化条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'persistent-items'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E6.9D.A1.E7.9B.AE.E5.88.A0.E9.99.A4">不支持条目删除</span></h5>
<p>如果该服务不支持条目删除, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "delete-items" .
</p><p><b>例子 123. 服务不支持条目删除</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'retract1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'delete-items'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E6.89.80.E6.9C.89.E8.80.85.E7.94.A8.E4.BE.8B">所有者用例</span></h2>
<h3> <span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9">创建节点</span></h3>
<h4> <span class="mw-headline" id=".E5.B8.B8.E8.A7.84.E4.BA.8B.E9.A1.B9">常规事项</span></h4>
<p>一个实体可能想创建一个新节点. 推荐支持这个特性("create-nodes"). 无论如何, 一个服务可以基于请求实体的身份不允许创建一个节点, 或可以完全不允许创建节点(例如, 为服务器范围的管理员保留这个权限).
</p><p>有两种办法创建一个节点:
</p>
<dl><dd><ol><li> 以缺省配置和指定的节点类型创建一个节点.
</li><li> 同时创建并配置一个节点.
</li></ol>
</dd></dl>
<p><b>例子 124. 请求创建一个节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;create</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>这些方法, 以及相应的方法特有的错误条件的完整解释在下面章节中.
</p><p>在方法特有的错误条件之外, 有很多常规的原因导致节点创建请求失败:
</p>
<dl><dd><ul><li> 服务不支持节点创建.
</li><li> 只有在该服务上注册了的实体被允许创建节点，未注册的请求实体不允许.
</li><li> 请求实体没有足够权限创建节点.
</li><li> 请求的NodeID已存在.
</li><li> 请求未包含一个NodeID且不支持"instant nodes".
</li></ul>
</dd></dl>
<p>常规错误场景的完整描述如下.
</p><p>如果服务不支持节点创建, 它必须应答一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "create-nodes" .
</p><p><b>例子 125. 服务不支持节点创建</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'create-nodes'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果只有在服务上注册了的实体可以创建节点但是请求实体还没有注册, 服务必须应答一个&lt;registration-required/&gt;错误.
</p><p><b>例子 126. 服务要求注册</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;registration-required</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体没有足够权限创建节点, 服务必须应答一个&lt;forbidden/&gt;错误.
</p><p><b>例子 127. 请求实体被禁止创建节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求的NodeID已存在, 服务必须应答一个&lt;conflict/&gt;错误.
</p><p><b>例子 128. NodeID已存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;conflict</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果节点创建者未指定一个NodeID但是服务不支持即时节点, 服务必须返回一个&lt;not-acceptable/&gt;错误, 指定一个pubsub特有的错误条件&lt;nodeid-required/&gt;.
</p><p><b>例子 129. 服务不支持即时节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;nodeid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p>如果节点创建者未指定一个NodeID但是服务支持即时节点, 服务应该代表节点创建者生成一个在该服务上下文中唯一的NodeID.
</p><p><b>例子 130. 实体请求一个即时节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;create</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>  
<p>如果没有发生错误, pubsub服务应该创建该节点, 生成一个那个服务上下文中唯一的NodeID, 并通知该用户成功了(应答中包含该NodeID).
</p><p><b>例子 131. 服务应答成功和生成的NodeID</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;create</span> <span class="re0">node</span>=<span class="st0">'25e3d37dabbab9541f7523321421edc5bfeb2dae'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 当一个服务代表请求实体成功创建一个节点, 它必须返回一个 IQ result (根据 XMPP Core). 如果该节点创建请求未指定一个NodeID且服务支持创建即时节点, 该服务必须在该 IQ result 中指定已创建的NodeID. 类似的, 如果该节点创建请求指定了一个NodeID但是服务在创建该节点之前修改了该NodeID, 该服务必须也在 IQ result 中指定已修改的节点. 在所有其他情况下, 该服务可以在该 IQ result 中指定NodeID但是节点创建者不能(MUST NOT)依赖从服务接收到它(因为节点创建者能通过跟踪 IQ-set 指定的'id'属性来确定哪个节点被创建了).
</p>
<h4> <span class="mw-headline" id=".E4.BB.A5.E7.BC.BA.E7.9C.81.E9.85.8D.E7.BD.AE.E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E8.8A.82.E7.82.B9">以缺省配置创建一个节点</span></h4>
<p>如上文解释的, 每个节点有它自己的缺省配置. 通过以缺省配置向服务请求创建一个节点, 该节点创建者接受缺省配置. 如果服务允许节点配置, 所有者可以在创建节点之后重新配置该节点(如本文的<a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9" title="XEP-0060">配置节点</a>所述). 另外, 一个服务可以允许实体在创建节点之前为一个给定的节点类型决定缺省配置(如本文的<a href="/XEP-0060#.E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E9.85.8D.E7.BD.AE" title="XEP-0060">请求缺省配置</a>所述).
</p><p>为了以缺省配置创建一个节点, 节点创建者可以简单的包含一个空的&lt;create/&gt;子元素.
</p><p>在以下例子中, 节点创建者以一个公开访问模式(假定是该服务的缺省类型)请求一个叶子节点(缺省类型).
</p><p><b>例子 132. 实体以(缺省的)公开访问模式请求叶子节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;create</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 'pubsub#node_type' 配置字段的的缺省设置是"leaf".
</p><p>为了向服务请求一个不同于缺省的访问模式, 该节点创建者必须在节点创建请求中包含一个数据表单来为 'pubsub#access_model' 字段指定一个非缺省的值.
</p><p><b>例子 133. 实体以非缺省访问模式请求叶子节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;create</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;configure<span class="re2">&gt;</span></span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">whitelist</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该访问模式是被支持的并且没有发生常规或方法特有的错误, 服务应该创建该节点并通知请求实体成功.
</p><p><b>例子 134. 服务通知请求实体成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果服务不支持指定的访问模式, 它必须返回一个&lt;not-acceptable/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported-access-model/&gt;.
</p><p><b>例子 135. 服务不支持指定的访问模式</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported-access-model</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>(对于如果服务不支持指定的节点类型的错误处理, 参考 <b>XEP-0248</b> .)
</p>
<h4> <span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E5.B9.B6.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9">创建并配置节点</span></h4>
<p>如果一个实现允许节点配置(见本文的<a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9" title="XEP-0060">配置节点</a>), 它应该允许创建请求在节点创建请求中包含期望的节点配置.
</p><p>注意: &lt;configure/&gt;元素必须跟随&lt;create/&gt;元素且不能(MUST NOT)拥有 'node' 属性, 因为&lt;create/&gt;元素的 'node' 属性的值指定了期望的NodeID; 如果这些规则中的任何一个规则被违反了, 该服务必须返回一个&lt;bad-request/&gt;错误.
</p><p><b>例子 136. 实体以非缺省配置请求一个新节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;create</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;configure<span class="re2">&gt;</span></span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Princely Musings (Atom)</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_notifications'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_payloads'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#persist_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#item_expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">604800</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publish_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#purge_offline'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#send_last_published_item'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#presence_based_delivery'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notification_type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_config'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_delete'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_retract'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_sub'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_payload_size'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1028</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.w3.org/2005/Atom</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#body_xslt'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabxslt.jabberstudio.org/atom_body.xslt</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>      
<p><b>例子 137. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果一个服务支持这个 "create-and-configure" 特性, 它必须在对服务查询信息请求的应答中通过返回一个特性 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#create-and-configure">http://jabber.org/protocol/pubsub#create-and-configure</a>" 来声明那一事实. 如果 create-and-configure 选项不被支持但是请求实体还是发送了这样一个请求, 服务应该忽略该请求的配置部分而当成没有包含这些配置一样处理.
</p>
<h3> <span class="mw-headline" id=".E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9">配置节点</span></h3>
<p>在创建了一个新节点之后, 该节点所有者可能想修改该节点的配置. 推荐支持这个特性.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_7">请求</span></h4>
<p><b>例子 138. 所有者请求配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configure</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_7">成功场景</span></h4>
<p>如果没有发生错误, 服务器必须返回一个配置表单给该节点所有者, 它应该包含当前的节点配置作为缺省值.
</p><p>注意: 接下来的例子展示了一些可以提供的可能的配置选项. 如果一个实现使用 <a href="/XEP-0004" title="XEP-0004">数据表单</a> 协议实现了这些特性, 那个实现必须使用已经注册到XMPP注册处的和 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub'">http://jabber.org/protocol/pubsub'</a> 命名空间相关的字段(那些字段变量的初步表述见下文以及本文的<a href="/XEP-0060#pubsub.23node_config_FORM_TYPE" title="XEP-0060">pubsub#node_config FORM_TYPE</a>, 但是不能(MUST NOT)被解释为标准, 因为XMPP注册处可以晚些时候标准化额外的字段而不用改变本文). 一个实现可以选择指定不同的标签, 值, 以及甚至字段类型, 但必须遵循已定义的变量名scheme.
</p><p><b>例子 139. 服务应答配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configure</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'A friendly name for the node'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_notifications'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Whether to deliver event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_payloads'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Whether to deliver payloads with event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_config'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when the node configuration changes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_delete'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when the node is deleted'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_retract'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when items are removed from the node'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_sub'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify owners about new subscribers and unsubscribes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#persist_items'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Persist items to storage'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_items'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Max # of items to persist'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#item_expire'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Time after which to automatically purge items'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">604800</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subscribe'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Whether to allow subscriptions'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the subscriber model'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">authorize</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">roster</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">whitelist</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#roster_groups_allowed'</span> <span class="re0">type</span>=<span class="st0">'list-multi'</span>
               <span class="re0">label</span>=<span class="st0">'Roster groups allowed to subscribe'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">friends</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">courtiers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">servants</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">enemies</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publish_model'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the publisher model'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">subscribers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#purge_offline'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Purge all items when the relevant publisher goes offline?'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_payload_size'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Max Payload size in bytes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1028</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#send_last_published_item'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'When to send the last published item'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Never'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'When a new subscription is processed'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">on_sub</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'When a new subscription is processed and whenever a subscriber comes online'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">on_sub_and_presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#presence_based_delivery'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Deliver event notifications only to available users'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notification_type'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the delivery style for event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">normal</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#type'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the type of payload data to be provided at this node'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.w3.org/2005/Atom</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#dataform_xslt'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Payload XSLT'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_7">错误场景</span></h4>
<p>有很多原因可能导致节点配置请求失败:
</p>
<dl><dd><ol><li> 服务不支持节点配置.
</li><li> 请求实体没有足够权限配置该节点.
</li><li> 请求未指定一个节点.
</li><li> 节点没有配置选项.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述在下面章节.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE_2">不支持节点配置</span></h5>
<p>如果服务不支持节点配置, 该服务必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "config-node" .
</p><p><b>例子 140. 服务不支持节点配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'config-node'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_5">权限不足</span></h5>
<p>如果请求实体没有足够权限去配置该节点, 服务必须应答一个&lt;forbidden/&gt;错误.
</p><p><b>例子 141. 请求实体被禁止配置该节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.A6.81.E6.B1.82NodeID_2">要求NodeID</span></h5>
<p>如果请求未指定一个节点, 服务应该返回一个&lt;bad-request/&gt;错误. 有可能不包含一个NodeID是因为请求实体向根节点请求配置; 无论如何, 如果请求实体不是一个服务器范围的管理员, 最好返回&lt;bad-request/&gt;而不是&lt;forbidden/&gt;.
</p><p><b>例子 142. 请求未指定一个节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;nodeid-required</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.97.A0.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9">无配置选项</span></h5>
<p>如果没有配置选项可用(例如, 因为节点配置"被封止了"), 该服务必须返回一个&lt;not-allowed/&gt;错误给所有者.
</p><p><b>例子 143. 节点无配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_7">节点不存在</span></h5>
<p>如果节点不存在, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 144. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A1.A8.E5.8D.95.E6.8F.90.E4.BA.A4_2">表单提交</span></h4>
<p>在接收到配置表单之后, 所有者应该提交一个完成的配置表单.
</p><p><b>例子 145. 所有者提交节点配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configure</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Princely Musings (Atom)</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_notifications'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_payloads'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#persist_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#item_expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">604800</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">roster</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#roster_groups_allowed'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">friends</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">servants</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">courtiers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publish_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#purge_offline'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#send_last_published_item'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#presence_based_delivery'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notification_type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_config'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_delete'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_retract'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_sub'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_payload_size'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1028</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.w3.org/2005/Atom</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#body_xslt'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabxslt.jabberstudio.org/atom_body.xslt</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>替代的, 所有者可以取消配置过程, 在这种情况下必须应用现有的配置.
</p><p><b>例子 146. 所有者取消配置过程</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configure</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A1.A8.E5.8D.95.E5.A4.84.E7.90.86_2">表单处理</span></h4>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F_2">成功</span></h5>
<p>如果表单能被成功处理, 服务必须返回一个 IQ-result.
</p><p><b>例子 147. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'config2'</span><span class="re2">/&gt;</span></pre></div></div>
<p>注意: 如果该节点类型从叶子改成集合且有条目和该节点相关, 服务必须清除节点的所有条目(通知或不通知订阅者).
</p>
<h5> <span class="mw-headline" id=".E5.A4.B1.E8.B4.A5_2">失败</span></h5>
<p>如果请求的节点配置变更不能被处理(例如, 因为节点所有者尝试修改配置使得它没有节点所有者), 服务必须返回一个&lt;not-acceptable/&gt;错误给所有者.
</p><p><b>例子 148. 配置变更不能被处理</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'config2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.B9.B6.E9.80.9A.E7.9F.A5">成功并通知</span></h5>
<p>如果 "pubsub#notify_config" 选项被设为true, 服务必须通知订阅者配置变更. (服务应该为叶子节点支持这个选项，必须为集合节点支持这个选项，如 <b>XEP-0248</b> 所述.) 如果节点配置被设为仅通知, 该通知必须包含一个空的&lt;configuration/&gt;元素，它的'node'属性被设为该节点的NodeID; 如果该节点配置被设为全载荷, &lt;configuration/&gt;元素必须额外包含该节点配置并通过 <b>数据表单</b> 协议展示它.
</p><p><b>例子 149. 服务发送配置变更通知(仅事件通知)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configuration</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 150. 服务发送配置变更通知(带载荷)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configuration</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Princely Musings (Atom)</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_notifications'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_payloads'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_config'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_delete'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_retract'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_sub'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#persist_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_items'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#item_expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">604800</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subscribe'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publish_model'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#purge_offline'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_payload_size'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">9216</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#send_last_published_item'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#presence_based_delivery'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notification_type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#type'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.w3.org/2005/Atom</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#body_xslt'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabxslt.jabberstudio.org/atom_body.xslt</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/configuration<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9">请求缺省节点配置选项</span></h3>
<p>一个实体可能希望请求关于缺省节点配置的信息, 例如 为了确定是否执行前文所述的 创建并配置 . 对这个特性的支持是可选的.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_8">请求</span></h4>
<p>要获得节点选项, 该实体必须不带NodeID发送一个空的&lt;default/&gt;元素给服务; 在应答中, 该服务应该返回缺省节点选项.
</p><p><b>例子 151. 实体请求缺省节点配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;default</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_8">成功场景</span></h4>
<p>如果没有发生错误, 服务必须返回缺省节点配置选项.
</p><p><b>例子 152. 服务应答缺省节点配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;default<span class="re2">&gt;</span></span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
           <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#title'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'A friendly name for the node'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_notifications'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Deliver event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#deliver_payloads'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
             <span class="re0">label</span>=<span class="st0">'Deliver payloads with event notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#description'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
             <span class="re0">label</span>=<span class="st0">'A description of the node'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_config'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when the node configuration changes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_delete'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when the node is deleted'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_retract'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify subscribers when items are removed from the node'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notify_sub'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Notify owners about new subscribers and unsubscribes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#persist_items'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Persist items to storage'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_items'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Max # of items to persist'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#item_expire'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Time after which to automatically purge items'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">604800</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subscribe'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Whether to allow subscriptions'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#access_model'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the subscriber model'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">authorize</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">roster</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">whitelist</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#roster_groups_allowed'</span> <span class="re0">type</span>=<span class="st0">'list-multi'</span>
               <span class="re0">label</span>=<span class="st0">'Roster groups allowed to subscribe'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">friends</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">courtiers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">servants</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">enemies</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#publish_model'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the publisher model'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">subscribers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">open</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">publishers</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#purge_offline'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Purge all items when the relevant publisher goes offline?'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#max_payload_size'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Max payload size in bytes'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">9216</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#send_last_published_item'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'When to send the last published item'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Never'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'When a new subscription is processed'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">on_sub</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'When a new subscription is processed and whenever a subscriber comes online'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">on_sub_and_presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">never</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#presence_based_delivery'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
               <span class="re0">label</span>=<span class="st0">'Deliver notifications only to available users'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#notification_type'</span> <span class="re0">type</span>=<span class="st0">'list-single'</span>
               <span class="re0">label</span>=<span class="st0">'Specify the delivery style for notifications'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">normal</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">headline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/default<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_8">错误场景</span></h4>
<p>有很多原因可能导致缺省节点配置选项请求失败:
</p>
<dl><dd><ol><li> 服务不支持节点配置.
</li><li> 服务不支持获取缺省节点配置.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE_3">不支持节点配置</span></h5>
<p>如果服务不支持节点配置, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "config-node" .
</p><p><b>例子 153. 服务不支持节点配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'config-node'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E7.BC.BA.E7.9C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE.E8.8E.B7.E5.8F.96">不支持缺省节点配置获取</span></h5>
<p>如果服务不支持获取缺省节点配置选项, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "retrieve-default" .
</p><p><b>例子 154. 服务不支持获取缺省节点配置选项</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'def1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'retrieve-default'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E5.88.A0.E9.99.A4.E8.8A.82.E7.82.B9">删除节点</span></h3>
<p>如果一个服务支持节点创建, 它必须支持节点删除. 如果一个实现持久化了条目, 它必须在节点被删除之前从持久化存储删除所有条目.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_9">请求</span></h4>
<p>为了删除一个节点, 一个节点所有者必须发送一个节点删除请求, 包含一个&lt;delete/&gt;元素， 其 'node' 属性指定要被删除的节点的NodeID.
</p><p><b>例子 155. 所有者删除一个节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'delete1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;delete</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>该删除请求可以包含包含一个替换节点的URI，请求可以被重定向到那. 典型的这是一个 XMPP URI 或 IRI ，如 <a href="/XEP-0060#PubSub_URIs" title="XEP-0060">PubSub URIs</a>所述, 但是它也可以是一个 HTTP URI 或任何其他形式.
</p><p><b>例子 156. 所有者删除一个节点并重定向</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'delete1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;delete</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;redirect</span> <span class="re0">uri</span>=<span class="st0">'xmpp:hamlet@denmark.lit?;node=blog'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/delete<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>对重定向的支持在pubsub服务的部分中是可选的.
</p>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_9">成功场景</span></h4>
<p>如果没发生错误, 服务必须通知所有者成功.
</p><p><b>例子 157. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'delete1'</span><span class="re2">/&gt;</span></pre></div></div>
<p>另外, 该服务也必须发送节点删除的通知给所有订阅者(它应该包含未决和未配置的订阅).
</p><p><b>例子 158. 订阅者被通知节点删除了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;delete</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;redirect</span> <span class="re0">uri</span>=<span class="st0">'xmpp:hamlet@denmark.lit?;node=blog'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/delete<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;delete</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;redirect</span> <span class="re0">uri</span>=<span class="st0">'xmpp:hamlet@denmark.lit?;node=blog'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/delete<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_9">错误场景</span></h4>
<p>有很多原因可能导致节点删除失败:
</p>
<dl><dd><ol><li> 请求实体没有足够权限删除该节点.
</li><li> 该节点是根集合节点, 它不能被删除(见 <b>XEP-0248</b> ).
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_6">权限不足</span></h5>
<p>如果请求实体没有足够权限删除该节点(例如, 不是一个所有者), 该服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 159. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'delete1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_8">节点不存在</span></h5>
<p>如果请求实体尝试删除一个不存在的节点, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 160. 所有者尝试删除一个不存在的节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'delete1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.B8.85.E9.99.A4.E6.89.80.E6.9C.89.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE">清除所有节点条目</span></h3>
<p>如果一个服务持久化了发布的条目, 一个节点所有者可能想清除该节点的所有已发布条目(也就是从持久化存储中移除所有条目, 除了最后发布的条目以外, 它可以被缓存). 实现这个特性对于一个服务是可选的.
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_10">请求</span></h4>
<p>为了清除一个节点的所有条目, 一个节点所有者发送一个节点清除请求，包含一个&lt;purge/&gt;元素，它的 'node' 属性指定要被清理的节点的NodeID.
</p><p><b>例子 161. 所有者从一个节点清除所有条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;purge</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_10">成功场景</span></h4>
<p>如果没发生错误, 服务必须清理该节点并通知所有者成功了.
</p><p><b>例子 162. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该节点或服务已经被配置成通知订阅者条目删除了, 一个清除请求不能(MUST NOT)导致发送和删除条目时一样的通知(因为清理一个节点的很多持久化条目可能导致大量的通知); 取而代之的是, 该节点必须发送一个单独的通知给每个订阅者, 包含一个空的&lt;purge/&gt;子元素.
</p><p><b>例子 163. 订阅者被通知节点清理了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'foo'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;purge</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">id</span>=<span class="st0">'bar'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;purge</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_10">错误场景</span></h4>
<p>有很躲原因可能导致节点清理请求失败:
</p>
<dl><dd><ol><li> 该节点或服务不支持节点清理.
</li><li> 请求实体没有足够权限清理该节点.
</li><li> 该节点未被配置成持久化条目.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误的完整描述在下面章节.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81.E8.8A.82.E7.82.B9.E6.B8.85.E7.90.86">不支持节点清理</span></h5>
<p>如果该节点或服务不支持节点清理, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "purge-nodes" .
</p><p><b>例子 164. 服务不支持节点清理</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'purge-nodes'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_7">权限不足</span></h5>
<p>如果请求实体没有足够权限清理该节点(例如, 因为它不是节点所有者), 该服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 165. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E6.9C.AA.E6.8C.81.E4.B9.85.E5.8C.96.E6.9D.A1.E7.9B.AE">节点未持久化条目</span></h5>
<p>如果该服务或节点未持久化条目(例如, 因为该节点是一个集合节点， 如 <b>XEP-0248</b> 所述), 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "persistent-items" .
</p><p><b>例子 166. 节点未被配置成持久化条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'persistent-items'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_9">节点不存在</span></h5>
<p>如果该节点不存在, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 167. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82">管理订阅请求</span></h3>
<p>任何时候一个服务可以发送订阅批准请求给该节点的所有者. 一个订阅批准求情包含一个message节，这个节包含了一个由 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#subscribe_authorization">http://jabber.org/protocol/pubsub#subscribe_authorization</a>" FORM_TYPE 限定的数据表单. 这个格式必须包含一个布尔值字段，其 'var' 属性的值为 "pubsub#allow", 这个字段指出是否允许订阅请求. 这个表单应该包含字段来指定节点标识符和未决订阅者的JID. 该message可以包含一个&lt;body/&gt;元素以包含自然语言文本来解释该消息所包含的一个未决订阅表单
</p><p><b>例子 168. 服务发送授权请求给节点所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit'</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'approve1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">PubSub subscriber request</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
    <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
      To approve this entity</span><span class="co4">&amp;apos;</span><span class="co3">s subscription request,
      click the OK button. To deny the request, click the
      cancel button.
    </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_authorization</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subid'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">123-abc</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#node'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span> <span class="re0">label</span>=<span class="st0">'Node ID'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">princely_musings</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pusub#subscriber_jid'</span> <span class="re0">type</span>=<span class="st0">'jid-single'</span> <span class="re0">label</span>=<span class="st0">'Subscriber Address'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">horatio@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#allow'</span> <span class="re0">type</span>=<span class="st0">'boolean'</span>
           <span class="re0">label</span>=<span class="st0">'Allow this JID to subscribe to this pubsub node?'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>为了批准请求, 所有者将提交该表单并把 "pubsub#allow" 字段的值设为 "1" 或 "true"; 为了追踪的目的该message必须反映最初提供的 'id' 属性.
</p><p><b>例子 169. 所有者批准订阅请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span> <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'approve1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_authorization</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subid'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">123-abc</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#node'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">princely_musings</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subscriber_jid'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">horatio@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#allow'</span><span class="re2">&gt;</span>
       <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>然后服务应该通知被批准的订阅者(见本文的 <a href="/XEP-0060#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5" title="XEP-0060">订阅状态变更通知</a>).
</p><p><b>例子 170. 订阅批准通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'approvalnotify1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>为了禁止请求, 所有者将提交该表单并把 "pubsub#allow" 字段的值设为 "0" 或 "false"; 如上, 该message必须反映最初提供的 'id' .
</p><p><b>例子 171. 所有者禁止订阅请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span> <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'approve1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
       <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_authorization</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subid'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">123-abc</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#node'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">princely_musings</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#subscriber_jid'</span><span class="re2">&gt;</span>
       <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">horatio@denmark.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#allow'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>然后服务应该通知被禁止的订阅者(见本文的 <a href="/XEP-0060#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5" title="XEP-0060">订阅状态变更通知</a>).
</p><p><b>例子 172. 订阅 取消/禁止 通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'unsubnotify1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>为了取消该表单的提交, 所有者将把表单的 'type' 属性设为 "cancel" 来应答.
</p><p><b>例子 173. 所有者取消表单提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span> <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'approve1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_authorization</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须检查 "pubsub#allow" 字段来看是否订阅应该被允许或禁止. 如果所有者取消数据表单, 那么该订阅请求必须保持在未决状态.
</p>
<h3> <span class="mw-headline" id=".E5.A4.84.E7.90.86.E6.9C.AA.E5.86.B3.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82">处理未决订阅请求</span></h3>
<p>一个节点所有者可能想在一个服务上获取它们的节点上的所有未决订阅请求. 对于一个服务来说实现该特性是可选的.
</p><p>这个特性必须使用<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0050.html">Ad-Hoc Commands</a> <a href="/XEP-0060#.E4.BF.98.E8.99.8FG:.E5.A4.87.E6.B3.A8" title="XEP-0060">21</a>协议来实现, 这里的命令名称(command元素的 'node' 属性)的值必须为 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#get-pending">http://jabber.org/protocol/pubsub#get-pending</a>".
</p>
<h4> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_11">请求</span></h4>
<p><b>例子 174. 所有者请求未决的请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;command</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/commands'</span>
           <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/pubsub#get-pending'</span>
           <span class="re0">action</span>=<span class="st0">'execute'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_11">成功场景</span></h4>
<p>如果没发生错误, 服务应该为管理的订阅请求返回一个数据表单, 它必须包含一个单独的字段，其 'var' 属性值为 "pubsub#node" ，其&lt;option/&gt;元素指定请求实体有批准权限的节点们(为了优化, 服务可以只指定那些有未决订阅请求的节点们).
</p><p><b>例子 175. 服务以所在的数据表单应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;command</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/commands'</span>
           <span class="re0">sessionid</span>=<span class="st0">'pubsub-get-pending:20031021T150901Z-600'</span>
           <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/pubsub#get-pending'</span>
           <span class="re0">status</span>=<span class="st0">'executing'</span>
           <span class="re0">action</span>=<span class="st0">'execute'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_authorization</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'list-single'</span> <span class="re0">var</span>=<span class="st0">'pubsub#node'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">princely_musings</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option<span class="re2">&gt;</span></span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">news_from_elsinore</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/command<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_11">错误场景</span></h4>
<p>有很多原因可能导致获取未决的订阅批准请求失败:
</p>
<dl><dd><ol><li> 服务不支持 ad-hoc commands 协议.
</li><li> 服务支持 ad-hoc commands 但是不支持 "get-pending" 特性.
</li><li> 请求实体没有足够权限批准订阅请求.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81Ad-Hoc_Commands">不支持Ad-Hoc Commands</span></h5>
<p>如果服务不支持ad-hoc commands协议, 它必须应答一个&lt;service-unavailable/&gt;错误.
</p><p><b>例子 176. 服务以未找到节点应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;service-unavailable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E4.B8.8D.E6.94.AF.E6.8C.81Get-Pending">不支持Get-Pending</span></h5>
<p>如果服务不支持 "get-pending" 特性, 它必须应该一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "get-pending".
</p><p><b>例子 177. 服务以未找到节点应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'get-pending'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.9D.83.E9.99.90.E4.B8.8D.E8.B6.B3_8">权限不足</span></h5>
<p>如果请求实体没有足够权限批准订阅请求, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 178. 实体没有足够权限批准订阅请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E8.8A.82.E7.82.B9.E4.B8.8D.E5.AD.98.E5.9C.A8_10">节点不存在</span></h5>
<p>如果请求的节点不存在, 服务必须应答一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 179. 服务以未找到节点应答</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'pending1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.8C.89.E8.8A.82.E7.82.B9.E8.AF.B7.E6.B1.82">按节点请求</span></h4>
<p>在接收到管理的订阅请求的数据表单之后, 接着所有者可以获取给定节点的未决订阅批准请求.
</p><p><b>例子 180. 所有者获取某个节点的所有未决订阅请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span> <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">id</span>=<span class="st0">'pending2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;command</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/commands'</span>
           <span class="re0">sessionid</span>=<span class="st0">'pubsub-get-pending:20031021T150901Z-600'</span>
           <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/pubsub#get-pending'</span>
           <span class="re0">action</span>=<span class="st0">'execute'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#node'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">princely_musings</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/command<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果没发生错误, 服务将应答成功.
</p><p><b>例子 181. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'pending2'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;command</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/commands'</span>
           <span class="re0">sessionid</span>=<span class="st0">'pubsub-get-pending:20031021T150901Z-600'</span>
           <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/pubsub#get-pending'</span>
           <span class="re0">action</span>=<span class="st0">'completed'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务接着将为每个未决的订阅请求发送一个订阅批准消息, 如上文所述的每个单独的未决订阅请求.
</p><p>注意: 一个服务应该遵循它的从属关系策略来维护一个未决订阅的列表. 特别是, 如果某个带有一个未决订阅的实体的从属关系被修改成所有者或发布者, 服务应该自动批准该订阅请求并把该实体从未决列表中移除之前的请求. 类似的, 如果某个带有一个未决订阅的实体的从属关系被修改成被排斥者, 服务应该自动拒绝该订阅请求并从未决列表中移除该实体之前的请求. (如果一个实体的订阅请求被禁止, 服务应该发送一个&lt;message/&gt;给该实体, 这个message遵循本文的<a href="/XEP-0060#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5" title="XEP-0060">订阅状态变更通知</a>所述的格式.)
</p>
<h3> <span class="mw-headline" id=".E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85">管理订阅</span></h3>
<p>一个节点所有者可能想编辑和一个给定节点相关的订阅的列表. 对这个特性("pubsub#manage-subscriptions")的支持是可选的.
</p>
<h4> <span class="mw-headline" id=".E8.8E.B7.E5.8F.96.E8.AE.A2.E9.98.85.E5.88.97.E8.A1.A8">获取订阅列表</span></h4>
<p>首先所有者获取订阅列表.
</p>
<h5> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_12">请求</span></h5>
<p>为了请求一个所有订阅的列表, 节点所有者必须发送一个订阅请求, 包含一个&lt;subscriptions/&gt;元素，它的 'node' 属性指定相关节点的NodeID.
</p><p><b>例子 182. 所有者请求所有订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_12">成功场景</span></h5>
<p>如果没发生错误, 服务必须返回那些订阅状态为 "subscribed" 或 "unconfigured" 的实体的订阅列表(它不能(MUST NOT)返回订阅状态为 "none" 的实体，不应该(SHOULD NOT)返回订阅状态为 "pending" 的实体). 结果可以为同一个实体(JID)指定多个&lt;subscription/&gt;元素, 但是每个元素必须拥有一个值为唯一的 'subid' 属性(如下所述).
</p><p><b>例子 183. 服务返回订阅列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'subman1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'hamlet@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'123-abc'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'bernardo@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span> <span class="re0">subid</span>=<span class="st0">'004-yyy'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_12">错误场景</span></h5>
<p>有很多原因可能导致管理订阅请求失败:
</p>
<dl><dd><ol><li> 服务不支持订阅管理.
</li><li> 请求实体没有足够权限管理订阅.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p><p>如果一个实现不支持订阅管理, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "manage-subscriptions".
</p><p><b>例子 184. 节点或服务不支持订阅管理</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'manage-subscriptions'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体不是一个节点所有者, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 185. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该节点不存在, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 186. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'purge1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E8.AE.A2.E9.98.85">修改订阅</span></h4>
<h5> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_13">请求</span></h5>
<p>在接收到订阅列表之后, 节点所有者可以修改订阅状态. 该所有者必须只发送修改过的订阅状态(即, 一个 "delta"), 而不是完整的列表. (注意: 如果在一个修改请求中未指定 'subscription' 属性, 那么该值不能(MUST NOT)被变更.)
</p><p><b>例子 187. 所有者修改订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_13">成功场景</span></h5>
<p><b>例子 188. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman2'</span><span class="re2">/&gt;</span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_13">错误场景</span></h5>
<p>有很多原因可能导致修改订阅请求失败:
</p>
<dl><dd><ol><li> 服务不支持订阅管理.
</li><li> 请求实体没有足够权限管理订阅.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p><p>如果一个实现不支持订阅管理, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "manage-subscriptions".
</p><p>’‘’例子 189. 节点或服务不支持订阅管理
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'manage-subscriptions'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体不是个节点所有者, 该服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 190. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该节点不存在, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 191. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.A4.9A.E9.87.8D.E4.BF.AE.E6.94.B9">多重修改</span></h5>
<p>所有者可以在一个请求中变更多个订阅. 如果该实体元素中的一个是非法的, 该服务必须返回一个带着错误条目的 IQ 错误(它应该是&lt;not-acceptable/&gt;), 这里返回的是原始的, 未改变过的订阅.
</p><p><b>例子 192. 所有者为多个实体设置订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'subman3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 193. 服务应答一个错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'subman3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscriptions</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscription</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/subscriptions<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果在一个对多个实体修改的请求中发生错误, pubsub服务必须返回任何导致该错误的&lt;subscription/&gt;元素(们). 返回的修改失败的实体必须包含现有的 'subscription' 属性. 任何未在一个 IQ 错误场景中返回的实体元素必须被视为已经成功修改. 所有者可以为相同实体指定多个&lt;subscription/&gt;元素, 但是每个元素必须拥有一个值为唯一的 'subid' 属性.
</p>
<h4> <span class="mw-headline" id=".E5.88.A0.E9.99.A4.E8.AE.A2.E9.98.85.E8.80.85">删除订阅者</span></h4>
<p>为了从订阅列表移除一个实体, 所有者必须把 'subscription' 属性的值设为 "none" 且服务必须从订阅列表中移除那个实体并在未来的列表请求中不再返回它.
</p>
<h4> <span class="mw-headline" id=".E9.80.9A.E7.9F.A5.E8.AE.A2.E9.98.85.E8.80.85">通知订阅者</span></h4>
<p>一个实现应该通知一个实体它的订阅已经改变(见本文的<a href="/index.php?title=XEP_0060&amp;action=edit&amp;redlink=1" class="new" title="XEP 0060（尚未撰写）">订阅状态变更通知</a>).
</p><p><b>例子 194. 服务发送订阅变更通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'polonius@denmark.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E7.AE.A1.E7.90.86.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB">管理从属关系</span></h3>
<p>一个节点可能想管理和一个给定节点相关的实体的从属关系并为新实体设置从属关系. 对此特性("pubsub#modify-affiliations")的支持是可选的.
</p>
<h4> <span class="mw-headline" id=".E8.8E.B7.E5.8F.96.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB.E5.88.97.E8.A1.A8">获取从属关系列表</span></h4>
<p>首先所有者获取从属关系列表.
</p>
<h5> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_14">请求</span></h5>
<p>为了请求一个所有从属的实体的列表, 一个节点所有者必须发送一个从属关系请求, 包含一个&lt;affiliations/&gt;元素，它的 'node' 属性指定相关节点的NodeID.
</p><p><b>例子 195. 所有者请求所有从属的实体</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_14">成功场景</span></h5>
<p>如果未发生错误, 该服务必须返回从属关系为 "owner", "member", "publisher", "publish-only", 或 "outcast" 的实体的列表(它不能(MUST NOT)返回从属关系为 "none" 的实体).
</p><p><b>例子 196. 服务返回从属的实体的列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'hamlet@denmark.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_14">错误场景</span></h5>
<p>有很多原因可能导致从属实体请求失败:
</p>
<dl><dd><ol><li> 服务不支持从属关系修改.
</li><li> 请求实体没有足够权限修改从属关系.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述见下面章节.
</p><p>如果一个实现不支持从属关系修改, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "modify-affiliations".
</p><p><b>例子 197. 节点或服务不支持从属关系管理</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'modify-affiliations'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体不是一个节点所有者, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 198. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该节点不存在, 该服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 199. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB">修改从属关系</span></h4>
<p>一个节点所有者可能想编辑和一个给定节点相关的一个实体的从属关系或为一个新实体设置从属关系.
</p>
<h5> <span class="mw-headline" id=".E8.AF.B7.E6.B1.82_15">请求</span></h5>
<p>为了修改一个从属关系, 一个节点所有者必须发送一个 IQ set , 包含要修改的从属关系或从属关系们. 该所有者必须只发送要修改的从属关系(即, 一个 "delta"), 而不是完整的列表 (注意: 如果在一个修改请求中未指定 'affiliation' 属性, 那么其值不能(MUST NOT)被修改.)
</p><p><b>例子 200. 所有者修改从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'publisher'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E6.88.90.E5.8A.9F.E5.9C.BA.E6.99.AF_15">成功场景</span></h5>
<p><b>例子 201. 服务应答成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent2'</span><span class="re2">/&gt;</span></pre></div></div>
<h5> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.9C.BA.E6.99.AF_15">错误场景</span></h5>
<p>有很多原因可能导致修改从属关系请求失败:
</p>
<dl><dd><ol><li> 节点或服务不支持请求的从属关系.
</li><li> 服务不支持从属关系修改.
</li><li> 请求实体没有足够权限来修改从属关系.
</li><li> 指定的节点不存在.
</li></ol>
</dd></dl>
<p>这些错误场景的完整描述在下面章节.
</p><p>如果一个实现不支持从属关系修改, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和一个特性 "modify-affiliations".
</p><p><b>例子 202. 节点或服务不支持从属关系管理</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'modify-affiliations'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果节点或服务不支持请求的从属关系, 它必须返回一个&lt;feature-not-implemented/&gt;错误, 指定一个pubsub特有的错误条件&lt;unsupported/&gt;和特性 "member-affiliation", "outcast-affiliation", "publisher-affiliation", 或 "publish-only-affiliation" 之一的适当特性.
</p><p><b>例子 203. 节点或服务不支持请求的从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature-not-implemented</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;unsupported</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
                 <span class="re0">feature</span>=<span class="st0">'member-affiliation'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果请求实体不是节点所有者, 服务必须返回一个&lt;forbidden/&gt;错误.
</p><p><b>例子 204. 实体不是一个所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该节点不存在, 服务必须返回一个&lt;item-not-found/&gt;错误.
</p><p><b>例子 205. 节点不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h5> <span class="mw-headline" id=".E5.A4.9A.E9.87.8D.E4.BF.AE.E6.94.B9_2">多重修改</span></h5>
<p>所有者可以在一个单独的请求中变更多个从属关系. 如果指定的实体元素之一是非法的, 服务必须返回一个 IQ error (它应该是&lt;not-acceptable/&gt;) 并携带该非法的条目, 这里返回的从属关系是原始的, 未改变的从属关系.
</p><p>下面的例子展示一个实体尝试让一些从属关系为 "owner" 的实体变成其他从属关系, 如果只有一个所有者那么这个动作是不能(MUST NOT)被允许的.
</p><p><b>例子 206. 所有者为多个实体设置从属关系</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ent3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'hamlet@denmark.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;affiliation</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'publisher'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 207. 服务应答一个错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'error'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">id</span>=<span class="st0">'ent3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>在本文开始的状态图是一组 必须实现 的规则，用于检查可能的状态变迁. 实现可以强制其他(更严格的)规则. 如果在一个为多个实体做修改的请求期间发生错误, pubsub错误必须返回任何导致错误的&lt;affiliation/&gt;元素(们). 返回修改失败的实体必须包含现有的 'affiliation' 属性. 在一个 IQ error 中未返回的任何实体元素必须被视为成功地修改了. 所有者不能(MUST NOT)为相同实体指定多个&lt;affiliation/&gt;元素; 否则服务必须返回一个&lt;bad-request/&gt;错误.
</p>
<h4> <span class="mw-headline" id=".E5.88.A0.E9.99.A4.E5.AE.9E.E4.BD.93">删除实体</span></h4>
<p>为了从从属关系列表中删除一个实体, 所有者必须把 'affiliation' 属性的值设为 "none" 并且服务必须从从属关系列表中移除那个实体且在将来的列表请求中不应答它.
</p>
<h4> <span class="mw-headline" id=".E9.80.9A.E7.9F.A5.E5.AE.9E.E4.BD.93">通知实体</span></h4>
<p>一个实现可以发送一个事件通知给一个从属关系改变了的实体, 它可以包含一个&lt;body/&gt;元素来指定关于从属关系变更的自然语言文本且它应该包含修改过的从属关系数据.
</p><p><b>例子 208. 服务发送从属关系变更通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'polonius@denmark.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;affiliations</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;affilation</span> <span class="re0">jid</span>=<span class="st0">'polonius@denmark.lit'</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/affiliations<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id="IM.E5.B8.90.E5.8F.B7.E9.9B.86.E6.88.90">IM帐号集成</span></h2>
<p>发布-订阅 功能能被集成到现有的即时消息和出席信息服务中(见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a></b>), 这样每个注册的帐号相当于一个虚拟的pubsub服务(有时候称为 "pubsub-on-a-JID"). 在这类部署中, 每个pubsub服务的根pubsub节点有和该帐号的纯JID(&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;)相同的地址, 它典型地和一个IM用户(例如, &lt;hamlet@denmark.lit&gt;)关联. 因为一个IM用户典型地有一个名册 "好友" 并分享出席信息给那些好友, 该虚拟pubsub服务能使用名册和出席信息来为订阅者提供一些有用的快捷方式, 特别是本章所描述的自动订阅和过滤通知特性.
</p>
<div dir="ltr" style="text-align: left;"><div class="source-text" style="font-family: monospace;"><pre>注意: PEP把接收者的PEP通知捆绑到订阅者的出席信息, 但没把PEP通知的生成捆绑到发布者的出席信息. 如果发布者希望在结束它的出席信息会话之前停止生成PEP事件(或生成一个 &quot;空&quot; 事件，
好像某些PEP载荷能做的那样), 该发布者必须直接引导它的客户端去这样做而不能(MUST NOT)依赖于当PEP服务从发布者接收到unavailable出席信息时PEP服务自动 &quot;清零&quot; 它的PEP信息.</pre></div></div>
<p>如果一个即时消息和出席信息帐号也是一个虚拟pubsub服务, 来自该帐号的纯JID对服务查询信息("disco#info")的应答必须包含一个特性 "http:/jabber.org/protocol/pubsub#pubsub-on-a-jid":
</p><p><b>例子 209. IM服务器代表IM帐号返回支持的特性</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'bvg194j7'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'account'</span> <span class="re0">type</span>=<span class="st0">'registered'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/pubsub#pubsub-on-a-jid'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 因为对于一个客户端生成的任何节来说，帐号所有者的纯JID是缺省目的地址, 客户端经常在这类节中省略 "to" 属性; 在这一点上, 参见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc6120">RFC 6120</a></b> 和 (关于名册) <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc6121">RFC 6121</a></b>.
</p>
<h3> <span class="mw-headline" id=".E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85">自动订阅</span></h3>
<p>当一个联系人通过分享XMPP出席信息从属于帐号所有者, "auto-subscribe" 特性极大地简化了订阅过程. 特别是, 对 "auto-subscribe" 的支持有以下的内涵:
</p>
<h4> <span class="mw-headline" id=".E5.B8.90.E5.8F.B7.E6.89.80.E6.9C.89.E8.80.85">帐号所有者</span></h4>
<p>因为帐号所有者本身隐性地订阅了它自己的XMPP出席信息(例如, 每个XMPP资源从该帐号所有者的所有资源接收出席信息), 一个服务必须认为该帐号所有者有一个对该帐号所有者的根集合节点的pubsub订阅，该订阅的订阅类型为 "items" 且订阅层次为 "all". 这一点对所有访问模式都是对的.
</p>
<h4> <span class="mw-headline" id=".E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E8.AE.A2.E9.98.85.E8.80.85">出席信息订阅者</span></h4>
<p>在节点处于以下几种访问模式下，如果一个实体(即, 一个IM帐号)对某个帐号所有者的纯JID(&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;)有一个XMPP出席信息订阅, 服务必须认为该联系人有一个对该帐号所有者的根集合节点的订阅类型为 "items" 且订阅层次为 "all" 的pubsub订阅:
</p>
<dl><dd><ol><li> 该节点的访问模式为 "open".
</li><li> 该节点的访问模式为 "presence".
</li><li> 该节点的访问模式为 "roster" 且联系人在指定的名册组.
</li></ol>
</dd></dl>
<p>如果该联系人没有权限从任何帐号所有者的根集合节点之下的特定节点接收信息(例如, 因为一个特定节点的访问模式是 "roster" 但是该联系人不在指定的名册组中), 该服务不能(MUST NOT)发送关于那个节点的通知给该联系人并且也不能(MUST NOT)返回任何关于那个节点存在一个潜在的订阅的错误给该联系人(例如, 当联系人发送出席信息给该帐号所有者的时候，服务不能(MUST NOT)返回一个pubsub订阅错误给该联系人).
</p><p>注意: 当一个IM联系人对帐号所有者有一个订阅, 自动的pubsub订阅必须基于包含在该出席信息订阅请求的 'from' 地址的纯JID, 它对于一个IM联系人将是一个纯JID (&lt;localpart@domain.tld&gt; 或 &lt;domain.tld&gt;).
</p>
<h4> <span class="mw-headline" id=".E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E5.88.86.E4.BA.AB.E8.80.85">出席信息分享者</span></h4>
<p>如果该节点有一个开放访问模式, 如果某实体在没有出席信息订阅的情况下曾经发送了出席信息给该帐号所有者，pubsub服务应该也认为该实体临时或隐性地订阅了该节点. 在这种情况下, 该订阅应该基于该出席信息节的 'from' 地址, 它将是一个全JID (&lt;localpart@domain.tld/resource&gt; 或 &lt;domain.tld/resource&gt;). 当该服务从该全JID接收到unavailable出席信息, 它必须取消该临时订阅.
</p>
<h3> <span class="mw-headline" id=".E8.BF.87.E6.BB.A4.E9.80.9A.E7.9F.A5">过滤通知</span></h3>
<p>一个联系人可能不想接收某个用户的虚拟pubsub服务上所有节点的通知. 一个联系人应该标记它的参数给该帐号所有者的服务器，通过包含 <b>XEP-0115</b> 信息，指定该联系人希望接收到通知的节点(如果有的话)的NodeIDs. 这个信息被一个pubsub服务用于支持 "filtered-notifications" 特性,只从那些和订阅者的参数匹配的NodeIDs发送通知.
</p><p>为了让这变为可能, 所有可能的NodeIDs能被加上字符串 "+notify" 以指示该联系人希望从该指定的NodeID接收到通知. 因而如果Romeo想接收到的定位数据的通知(<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0080.html">User Geolocation</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">22</a>) 和 歌曲数据 (<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0118.html">User Tune</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">23</a>)而不是活动数据(<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0108.html">User Activity</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">24</a>), 它的客户端在它发送的对 disco#info 的应答结果中将声明支持如下字符串: <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">25</a>
</p>
<dl><dd><ul><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/geoloc+notify">http://jabber.org/protocol/geoloc+notify</a>
</li><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/tune+notify">http://jabber.org/protocol/tune+notify</a>
</li></ul>
</dd></dl>
<p>这组字符串接着将被声明，通过把它们包含到 标识符+特性 哈希封装到 'ver' 属性里，如 <b>XEP-0115</b> 所述.
</p><p><b>例子 210. 联系人携带caps发送出席信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">from</span>=<span class="st0">'romeo@montague.lit/orchard'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;c</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/caps'</span>
     <span class="re0">node</span>=<span class="st0">'http://www.chatopus.com/#2.2'</span>
     <span class="re0">ver</span>=<span class="st0">'AFBT0mPr29zQE5aGtCJp97CIS6E='</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>缓存 <b>XEP-0115</b> 信息是该帐号所有者的服务器的责任. 当该服务器从一个联系人接收出席信息, 它必须检查那个出席信息的实体能力数据并为该联系人的客户端把那个数据和期望的NodeIDs关联起来. 该服务器不能(MUST NOT)发送和该联系人未曾通过 "NodeID+notify" 的disco#info特性请求的任何NodeIDs相关的通知. 这使得一个客户端能关闭所有通知(例如, 因为带宽限制)并容易地接收所有期望的数据格式，只要简单地在它的 disco#info 结果中增加适当的 "NodeID+notify" 支持和客户端能力的支持. 无论如何, 它也暗示一个客户端只能在一个全局基础上请求通知而不能请求, 比如说, 只从在该用户的名册中的特定联系人请求心情信息. 社区一致统一这是一个可接受的折衷. 而且, 注意这只在如果帐号所有者对联系人有一个出席信息订阅且该联系人也有对该帐号所有者有一个出席信息订阅的时候发生.
</p><p>一些例子可能有助于演示通知过滤的概念. 这里我们显示由以上列出的联系人中的两个生成的出席信息(benvolio@montague.lit 和  juliet@capulet.lit 之间没有任何订阅和被订阅出席信息，所以没有被纳入这些协议流程).
</p><p><b>例子 211. 带caps的出席信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">from</span>=<span class="st0">'nurse@capulet.lit/chamber'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;c</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/caps'</span>
     <span class="re0">node</span>=<span class="st0">'http://exodus.jabberstudio.org/#0.9.1'</span>
     <span class="re0">ver</span>=<span class="st0">'wXj6c5xhT9frdqhvTSjkdejUUP8='</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span> <span class="re0">from</span>=<span class="st0">'romeo@montague.lit/orchard'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;c</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/caps'</span>
     <span class="re0">node</span>=<span class="st0">'http://www.chatopus.com/#2.2'</span>
     <span class="re0">ver</span>=<span class="st0">'1FDrLLbYMpzvcI95jgSHABSWDRY='</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>我们假定Juliet的服务器不知道任何这些能力, 所以它代表Juliet本身发送服务查询信息请求给每个客户端(实际上, capulet.lit服务器将很快建立一个客户端能力的缓存, 有了这个结果，它将不需要发送这些服务查询请求):
</p><p><b>例子 212. 帐号服务器查询联系人</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'juliet@capulet.lit'</span>
    <span class="re0">to</span>=<span class="st0">'nurse@capulet.lit/chamber'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">id</span>=<span class="st0">'disco123'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'nurse@capulet.lit/chamber'</span>
    <span class="re0">to</span>=<span class="st0">'juliet@capulet.lit'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">id</span>=<span class="st0">'disco123'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'client'</span> <span class="re0">type</span>=<span class="st0">'pc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/activity'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/activity+notify'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/geoloc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/geoloc+notify'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/tune'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/tune+notify'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>该服务器也将查询为&lt;romeo@montague.lit&gt; identity+features&#160;:
</p><p><b>例子 213. 帐号服务器查询联系人</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'juliet@capulet.lit'</span>
    <span class="re0">to</span>=<span class="st0">'romeo@montague.lit/orchard'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">id</span>=<span class="st0">'disco234'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'romeo@montague.lit/orchard'</span>
    <span class="re0">to</span>=<span class="st0">'juliet@capulet.lit'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">id</span>=<span class="st0">'disco234'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span> <span class="re0">category</span>=<span class="st0">'client'</span> <span class="re0">type</span>=<span class="st0">'pda'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/geoloc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/geoloc+notify'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/tune'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/tune+notify'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>(如 <b>XEP-0115</b> 提到的, 该服务器必须使用生成的方法来检查 'ver' 属性提供的哈希值以确保未中毒.)
</p><p>现在我们回到帐号所有者的发布和通知的服务器生成, 因为服务器有caps信息，过滤被激活了:
</p>
<dl><dd><ol><li> 如果Juliet发布一个tune条目给 presence-access "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/tune">http://jabber.org/protocol/tune</a>" 节点, 她的服务器将发送通知给&lt;nurse@capulet.lit/chamber&gt;和&lt;romeo@montague.lit/orchard&gt;(全JIDs).
</li><li> 如果Juliet发布一个activity条目给 presence-access "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/activity">http://jabber.org/protocol/activity</a>" 节点, 她的服务器将只发送通知给&lt;nurse@capulet.lit/chamber&gt;.
</li><li> 如果Juliet发布一个geolocation条目给 roster-access "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/geoloc">http://jabber.org/protocol/geoloc</a>" 节点，并带着 "pubsub#roster_groups_allowed" 变量，其值为 "Friends", 她的服务器将只发送通知给&lt;romeo@montague.lit/orchard&gt;，因为nurse不在那个名册组中.
</li></ol>
</dd></dl>
<h2> <span class="mw-headline" id=".E7.89.B9.E6.80.A7.E6.B1.87.E6.80.BB">特性汇总</span></h2>
<p>本章汇总这里描述的特性, 为每个特性指定了适当的要求(REQUIRED, RECOMMENDED, 或 OPTIONAL), 并给描述的每个特性和本文的章节提供了横向参考.
</p><p>注意: 特性名称的格式都是 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#name">http://jabber.org/protocol/pubsub#name</a>", 这里 "name" 是在第一行下面指定的文本.
</p><p><b>表 7: 服务查询特性</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>名称 </th>
<th>描述 </th>
<th>支持 </th>
<th>章节
</th></tr>
<tr>
<td>access-authorize </td>
<td>缺省访问模式为 "authorize" (授权). </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F" title="XEP-0060">节点访问模式</a>
</td></tr>
<tr>
<td>access-open </td>
<td>缺省访问模式为 "open" (公开). </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F" title="XEP-0060">节点访问模式</a>
</td></tr>
<tr>
<td>access-presence </td>
<td>缺省访问模式为 "presence" (出席信息). </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F" title="XEP-0060">节点访问模式</a>
</td></tr>
<tr>
<td>access-roster </td>
<td>缺省访问模式为 "roster" (名册). </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F" title="XEP-0060">节点访问模式</a>
</td></tr>
<tr>
<td>access-whitelist </td>
<td>缺省访问模式为 "whitelist" . </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.8A.82.E7.82.B9.E8.AE.BF.E9.97.AE.E6.A8.A1.E5.BC.8F" title="XEP-0060">节点访问模式</a>
</td></tr>
<tr>
<td>auto-create </td>
<td>服务支持在对不存在的节点发布的时候自动创建节点 </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.87.AA.E5.8A.A8.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">自动创建节点</a>
</td></tr>
<tr>
<td>auto-subscribe </td>
<td>服务支持基于出席信息订阅自动订阅到一个节点. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85" title="XEP-0060">自动订阅</a>
</td></tr>
<tr>
<td>collections </td>
<td>支持集合节点. </td>
<td>可选 </td>
<td>参考 <b>XEP-0248</b>
</td></tr>
<tr>
<td>config-node </td>
<td>支持节点选项配置. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9" title="XEP-0060">配置节点</a>
</td></tr>
<tr>
<td>create-and-configure </td>
<td>支持同时创建和配置节点. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E5.88.9B.E5.BB.BA.E5.B9.B6.E9.85.8D.E7.BD.AE.E8.8A.82.E7.82.B9" title="XEP-0060">创建并配置节点</a>
</td></tr>
<tr>
<td>create-nodes </td>
<td>支持i节点创建. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">创建节点</a>
</td></tr>
<tr>
<td>delete-items </td>
<td>支持删除条目. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点删除条目</a>
</td></tr>
<tr>
<td>delete-nodes </td>
<td>支持删除节点. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E5.88.A0.E9.99.A4.E8.8A.82.E7.82.B9" title="XEP-0060">删除节点</a>
</td></tr>
<tr>
<td>filtered-notifications </td>
<td>基于实体能力数据过滤通知. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.BF.87.E6.BB.A4.E9.80.9A.E7.9F.A5" title="XEP-0060">过滤通知</a>
</td></tr>
<tr>
<td>get-pending </td>
<td>支持获取未决的订阅批准. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82" title="XEP-0060">管理订阅请求</a>
</td></tr>
<tr>
<td>instant-nodes </td>
<td>支持创建即时节点. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E5.88.9B.E5.BB.BA.E8.8A.82.E7.82.B9" title="XEP-0060">创建节点</a>
</td></tr>
<tr>
<td>item-ids </td>
<td>发布者可以指定条目标识符. </td>
<td>推荐 </td>
<td>
</td></tr>
<tr>
<td>last-published </td>
<td>缺省的，最后发布的条目会被发送给新订阅者和现有的订阅者中有可用的出席信息的接收者. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BA.8B.E4.BB.B6.E7.B1.BB.E5.9E.8B" title="XEP-0060">事件类型</a>
</td></tr>
<tr>
<td>leased-subscription </td>
<td>支持基于时间的订阅. </td>
<td>可选 </td>
<td>	<a href="/XEP-0060#.E5.9F.BA.E4.BA.8E.E6.97.B6.E9.97.B4.E7.9A.84.E8.AE.A2.E9.98.85.28.E7.A7.9F.E7.94.A8.29" title="XEP-0060">基于时间的订阅(租用)</a>
</td></tr>
<tr>
<td>manage-subscriptions </td>
<td>节点所有者可以管理订阅. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85" title="XEP-0060">管理订阅</a>
</td></tr>
<tr>
<td>member-affiliation </td>
<td>支持成员从属关系. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">从属关系</a>
</td></tr>
<tr>
<td>meta-data </td>
<td>支持节点元数据. </td>
<td>推荐 </td>
<td>
</td></tr>
<tr>
<td>modify-affiliations </td>
<td>节点所有者可以修改从属关系. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E7.AE.A1.E7.90.86.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">管理从属关系</a>
</td></tr>
<tr>
<td>multi-collection </td>
<td>一个的难度的叶子节点可以被关联到多个集合. </td>
<td>可选 </td>
<td>参考 <b>XEP-0248</b>
</td></tr>
<tr>
<td>multi-subscribe </td>
<td>一个单独实体可以多次订阅一个节点. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E5.A4.9A.E9.87.8D.E8.AE.A2.E9.98.85" title="XEP-0060">多重订阅</a>
</td></tr>
<tr>
<td>outcast-affiliation </td>
<td>支持被排斥者从属关系. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">从属关系</a>
</td></tr>
<tr>
<td>persistent-items </td>
<td>支持持久化条目. </td>
<td>推荐 </td>
<td>
</td></tr>
<tr>
<td>presence-notifications </td>
<td>支持基于出席信息递送事件通知. </td>
<td>可选 </td>
<td>
</td></tr>
<tr>
<td>presence-subscribe </td>
<td>授权的联系人自动订阅到一个用户的虚拟pubsub服务. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85" title="XEP-0060">自动订阅</a>
</td></tr>
<tr>
<td>publish </td>
<td>支持发布条目. </td>
<td>必需 </td>
<td><a href="/XEP-0060#.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9" title="XEP-0060">发布条目到节点</a>
</td></tr>
<tr>
<td>publish-options </td>
<td>支持带选项发布一个条目. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E5.8F.91.E5.B8.83.E9.80.89.E9.A1.B9" title="XEP-0060">发布选项</a>
</td></tr>
<tr>
<td>publish-only-affiliation </td>
<td>支持 仅发布 从属关系. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">从属关系</a>
</td></tr>
<tr>
<td>publisher-affiliation </td>
<td>支持发布者从属关系. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">从属关系</a>
</td></tr>
<tr>
<td>purge-nodes </td>
<td>支持清理节点. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E6.B8.85.E9.99.A4.E6.89.80.E6.9C.89.E8.8A.82.E7.82.B9.E6.9D.A1.E7.9B.AE" title="XEP-0060">清除所有节点条目</a>
</td></tr>
<tr>
<td>retract-items </td>
<td>支持条目收回. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点删除条目</a>
</td></tr>
<tr>
<td>retrieve-affiliations </td>
<td>支持获取当前从属关系. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.8E.B7.E5.8F.96.E4.BB.8E.E5.B1.9E.E5.85.B3.E7.B3.BB" title="XEP-0060">获取从属关系</a>
</td></tr>
<tr>
<td>retrieve-default </td>
<td>支持获取缺省节点配置. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.8A.82.E7.82.B9.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9" title="XEP-0060">请求缺省节点配置选项</a>
</td></tr>
<tr>
<td>retrieve-default-sub </td>
<td>支持获取缺省订阅配置. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.AF.B7.E6.B1.82.E7.BC.BA.E7.9C.81.E8.AE.A2.E9.98.85.E9.85.8D.E7.BD.AE.E9.80.89.E9.A1.B9" title="XEP-0060">请求缺省订阅配置选项</a>
</td></tr>
<tr>
<td>retrieve-items </td>
<td>支持获取条目. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E8.8E.B7.E5.8F.96.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点获取条目</a>
</td></tr>
<tr>
<td>retrieve-subscriptions </td>
<td>支持获取当前订阅. </td>
<td>推荐 </td>
<td><a href="/XEP-0060#.E8.8E.B7.E5.8F.96.E8.AE.A2.E9.98.85" title="XEP-0060">获取订阅</a>
</td></tr>
<tr>
<td>subscribe </td>
<td>支持订阅和取消订阅. </td>
<td>必需 </td>
<td><a href="/XEP-0060#.E8.AE.A2.E9.98.85.E8.8A.82.E7.82.B9" title="XEP-0060">订阅节点</a> 和 <a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.8F.96.E6.B6.88.E8.AE.A2.E9.98.85" title="XEP-0060">从节点取消订阅</a>
</td></tr>
<tr>
<td>subscription-options </td>
<td>支持订阅选项的配置. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E9.85.8D.E7.BD.AE.E8.AE.A2.E9.98.85.E9.80.89.E9.A1.B9" title="XEP-0060">配置订阅选项</a>
</td></tr>
<tr>
<td>subscription-notifications </td>
<td>支持订阅状态变更通知. </td>
<td>可选 </td>
<td><a href="/XEP-0060#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5" title="XEP-0060">订阅状态变更通知</a>
</td></tr></table>
<h2> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E6.9D.A1.E4.BB.B6">错误条件</span></h2>
<p><b>表 8: 错误条件和典型原因</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>条件 </th>
<th>描述
</th></tr>
<tr>
<td>&lt;conflict/&gt; </td>
<td>节点已存在.
</td></tr>
<tr>
<td>&lt;feature-not-implemented/&gt; </td>
<td>对一个节点(或系统)尝试操作失败，因为服务或节点不支持该操作; 该错误也应该指定不支持哪个特性.
</td></tr>
<tr>
<td>&lt;forbidden/&gt; </td>
<td>一个实体没有足够权限来执行该动作, 请求对另一个Jabber ID的操作(例如, francisco@denmark.lit 尝试订阅 bernardo@denmark.lit 到一个节点), 或请求实体的从属关系为被排斥者 "outcast".
</td></tr>
<tr>
<td>&lt;item-not-found/&gt; </td>
<td>一些操作所指定的节点或条目不存在.
</td></tr>
<tr>
<td>&lt;not-allowed/&gt; </td>
<td>一个实体尝试执行一个服务实现的动作; 无论如何服务范围的管理员或节点所有者已经禁止那个服务或节点的这个动作.
</td></tr>
<tr>
<td>&lt;not-authorized/&gt; </td>
<td>一个实体尝试从一个节点订阅或获取条目但是未被授权查看该帐号所有者的出席信息, 不在适当的名册组中, 或不在订阅白名单上.
</td></tr>
<tr>
<td>&lt;payment-required/&gt; </td>
<td>订阅和条目获取是基于某种付费服务的. 付费将在带外完成，使用某些事先商定的方法(不在此定义).
</td></tr>
<tr>
<td>&lt;registration-required/&gt; </td>
<td>实体在被允许创建节点之前被要求注册.
</td></tr></table>
<h2> <span class="mw-headline" id=".E5.AE.9E.E7.8E.B0.E5.A4.87.E6.B3.A8">实现备注</span></h2>
<h3> <span class="mw-headline" id=".E9.80.9A.E7.9F.A5.E8.A7.A6.E5.8F.91">通知触发</span></h3>
<p>有很多中可能的触发器用来为当前发布的条目或最后发布的条目发送一个事件通知给一个实体, 总结如下:
</p>
<dl><dd><ol><li> 实体显式地从节点请求一个或多个条目并被授权获取条目们; 当服务接收到这样一个请求, 它发送条目们到该实体.
</li><li> 实体是某节点的授权订阅者(显式地通过订阅或隐性地基于一个所有者或发布者角色); 当发布者发送一个发布请求, 服务发送当前发布的条目给该实体(遵循适当的出席信息检查和通知过滤).
</li><li> 实体未订阅但是可以选择这么做，即曾经发送包含适当实体能力数据的出席信息给一个支持过滤通知的服务(基于一个对通知感兴趣的表达有效地建立一个 "临时订阅" ); 当服务首次接收到这样的出席信息, 它发送最后发布的条目给该实体(只在第一次接收到这样的出席信息之后发送它, 在收到随后的包含同样的通知兴趣的出席信息更新时不再发送).
</li><li> 实体未订阅但是可以选择这么做，即曾经发送包含适当实体能力数据的出席信息给一个支持过滤通知的服务(有效建立一个 "临时订阅"); 当发布者发送一个发布一个和该实体表达的通知兴趣匹配的请求, 该服务发送当前发布的条目给该实体.
</li><li> 实体获得对该节点的访问，因为节点访问模式的改变; 结果是, 该服务发送最后发布的条目给该实体.
</li><li> 实体被加入到和节点访问模式 "roster" 关联的名册组; 结果是, 该服务发送最后发布的条目给该实体.
</li></ol>
</dd></dl>
<h3> <span class="mw-headline" id=".E6.9C.9F.E6.9C.9B.E7.9A.84.E9.80.9A.E7.9F.A5.E6.8E.A5.E6.94.B6.E8.80.85">期望的通知接收者</span></h3>
<p>当一个pubsub服务生成了通知, 它必须遵循隐含在每个订阅者的订阅选项配置中的递送规则. 特别是, 'to' 地址应该只能是订阅的JID. 服务不应(SHOULD NOT)尝试猜测和订阅JID关联的最可用的资源(例如, 在即时消息系统上下文中).
</p>
<h3> <span class="mw-headline" id=".E9.80.9A.E7.9F.A5.E7.9B.B8.E5.85.B3.E7.9A.84.E9.94.99.E8.AF.AF.E5.A4.84.E7.90.86">通知相关的错误处理</span></h3>
<p>如上面提到的, 一个pubsub服务应该确保它为每个事件通知生成的&lt;message/&gt;节拥有一个有值的 'id' 属性. (这个通知ID不能和节点ID或条目ID混淆.) 这个ID在该pubsub服务上下文中必须是唯一的以确保跟踪任何递送相关的错误.
</p><p>服务如何准确地处理递送相关的错误将是一个实现的问题. 通常, 这类处理的效果类似其他消息递送系统执行的弹回操作, 类似邮件传送代理和邮件列表软件. 接下来是一些关于处理和pubsub事件通知相关的XMPP特有错误条件的建议指南(见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 和 <b>XEP-0086</b> 中关于XMPP错误条件的语义):
</p>
<dl><dd><ul><li> 如果该XMPP错误的类型是 "cancel" (例如, &lt;item-not-found/&gt;), 或该错误条件是&lt;gone/&gt;, pubsub服务应该终止该实体对那个节点的订阅并可以终止那个实体对所有位于该服务上的节点的订阅.
</li><li> 如果该XMPP错误的类型是 "auth" (例如, &lt;registration-required/&gt;) 或 "wait" (例如, &lt;remote-server-timeout/&gt;), 或错误条件是&lt;bad-request/&gt;, &lt;redirect/&gt;, 或 &lt;not-acceptable/&gt;, 该pubsub服务应该为那个实体增加一个弹回计数并可以在一个配置的时间段之后重新发送该事件通知. 该服务可以终止该实体对那个节点的订阅，如果弹回计数达到一个配置的限制.
</li></ul>
</dd></dl>
<h3> <span class="mw-headline" id=".E4.B8.B4.E6.97.B6.E8.AE.A2.E9.98.85">临时订阅</span></h3>
<p>一个实现可以让一个实体能临时订阅到一个节点, 即, 只在订阅者在线的这个当前出席信息会话中订阅. 要临时订阅, 订阅者必须把 "pubsub#expire" 订阅配置选项设为一个 "presence" 的文字值.
</p><p><b>例子 214. 一个临时订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'lease3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
          </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
        </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
     <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>该服务接着将在它从订阅者那里接收到类型为 "unavailable" 的出席信息的时候自动取消订阅.
</p><p>一个实现可以让节点所有者能强制所有订阅都是临时的, 它对于那些也被配置成使用基于出席信息递送的节点是有用的. 这个设定使用 "pubsub#tempsub" 节点配置选项，值设为true.
</p><p><b>例子 215. 所有者把所有订阅设为临时</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'hamlet@denmark.lit/elsinore'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'configtemp'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;configure</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#node_config</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#tempsub'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/configure<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BA.8B.E4.BB.B6.E5.9F.BA.E4.BA.8E.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E9.80.92.E9.80.81">事件基于出席信息递送</span></h3>
<p>pubsub实现可以只在订阅者在线的时候递送事件通知. 在这些情况下, 选项可以是一个上面例子中展示的节点配置选项. 为了便于实现这个目的, 该pubsub服务需要订阅该订阅者的出席信息并在发送任何事件通知之前检查订阅者的当前出席信息(如 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a></b> 所述). 出席信息订阅必须基于该订阅的JID.
</p>
<h3> <span class="mw-headline" id=".E4.B8.8D.E8.B7.AF.E7.94.B1.E4.BA.8B.E4.BB.B6.E5.88.B0.E7.A6.BB.E7.BA.BF.E5.AD.98.E5.82.A8">不路由事件到离线存储</span></h3>
<p>发送事件给现有的Jabber服务器的用户可以强制事件通知被路由到离线存储中用于晚些时候递送(如<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0160.html">离线消息处理最佳实践</a>] <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">27</a>). 这可能不总是必要的. 阻止这个行为的可能的方法包括:
</p>
<dl><dd><ul><li> 使用上述的基于出席信息的订阅选项.
</li><li> 使用<a href="/XEP-0079" title="XEP-0079">高级消息处理</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">28</a>定义的递送语义.
</li><li> 指定一个消息类型 "headline", 它在大部分现有的服务器实现中将阻止离线存储.
</li></ul>
</dd></dl>
<h3> <span class="mw-headline" id=".E5.8C.85.E5.90.AB.E6.B6.88.E6.81.AF.E4.B8.BB.E4.BD.93">包含消息主体</span></h3>
<p>如果一个服务理解一个特定载荷类型的语义且一个实体的订阅是配置成这样的(把 "pubsub#include_body" 订阅选项设为true), 该服务应该在它为给定节点发送的事件通知的载荷中包含一个适当的 XMPP &lt;body/&gt; 子元素, 这里 body 的XML字符串数据汇总或展现了包含在该载荷中的信息(这使那些不理解该载荷格式的客户端能展示适当的信息给一个终端用户). 例如, Atom &lt;summary/&gt; 元素(见 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc4287">RFC 4287</a></b> )可以被映射成 XMPP &lt;body/&gt; 元素. 一个服务不能(MUST NOT)为一个节点提供 "pubsub#include_body" 订阅选项，如果它没有一个已定义的方法来把部分或全部载荷格式转换成一个合理的消息主体. 一个节点所有者可以为把载荷格式转换成一个消息主体定义一个XSLT, 通过 "pubsub#body_xslt" 节点配置选项. 这个XSLT由pubsub服务在接收到一个发布请求之后和发送适当的通知之前应用, 不是由客户端在发送一个发布请求之前应用.
</p><p>如果服务不理解一个特定载荷类型的语义，因而不能把该载荷转换成一个自然人可读的消息主体, 它不应(SHOULD NOT)包含一个&lt;body/&gt;元素.
</p><p>如果一个订阅者对同一个节点有多个订阅, 其中的一些 SubIDs 把 include_body 设为 true 而其他一些则把 include_body 设为 false, 该服务应该在所有通知中包含一个主体.
</p>
<h3> <span class="mw-headline" id=".E8.8A.82.E7.82.B9ID.E5.92.8C.E6.9D.A1.E7.9B.AEID.E5.94.AF.E4.B8.80.E6.80.A7">节点ID和条目ID唯一性</span></h3>
<p>在一个特定的pubsub服务上下文中, NodeIDs必须被视为唯一的标识符.
</p><p>如果使用了条目标识符, 在该节点的范围内它们必须被视为唯一的. NodeID + ItemID 的组合在一个给定的服务中必须是唯一的, 且必须在一个单独的节点指定一个单独的已发布条目.
</p><p>如果一个发布者发布了一个条目且ItemID和一个现有的条目吻合, 该pubsub服务必须覆写现有的条目并生成新的事件通知.
</p><p>因为有可能一个节点的配置被改变了之后要求使用ItemIDs(例如, 从临时的改成持久的), 服务应该为了内部跟踪的目的使用ItemIDs， 即使它在配置变更之前生成的通知没有包含ItemIDs.
</p>
<h3> <span class="mw-headline" id=".E6.9D.A1.E7.9B.AE.E7.BC.93.E5.AD.98">条目缓存</span></h3>
<p>一个服务可以缓存最后发布到节点的条目, 即使该节点被配置成用于临时发布(即, 配置成非持久化条目). 最后发布的条目应该在成功处理订阅请求或由一个节点批准之后被发送给最新的订阅者.
</p><p>注意: 通用的 发布-订阅 协议的特定范本可以对于 "cache-last-item" 特性定义更严格的要求.
</p>
<h3> <span class="mw-headline" id=".E6.89.B9.E5.A4.84.E7.90.86">批处理</span></h3>
<p>一个发布者可以在一个发布请求中包含多个&lt;item/&gt;元素以及在一个收回请求中包含多个&lt;item/&gt;元素. 这就是发布或收回的 "批处理" .
</p><p>如果服务不能处理发布或收回的条目中的任何一个, 整个批处理必须失败且服务不能(MUST NOT)发布或收回任何条目.
</p><p>如果一个批量发布包含如此多的条目以至于所有条目的发布将超出该节点的最大数量限制, 该服务必须返回一个&lt;not-allowed/&gt;错误, 它应该也包含一个pubsub特有的错误条件&lt;max-items-exceeded/&gt;.
</p><p>注意: 批量发布造成了 "最后发布的条目" 概念的问题; 所以, 如果需要信息一致性, 一个发布者应该在分开的请求中发布条目而不是用批处理模式.
</p>
<h3> <span class="mw-headline" id=".E8.87.AA.E5.8A.A8.E8.AE.A2.E9.98.85.E7.9A.84.E6.89.80.E6.9C.89.E8.80.85.E5.92.8C.E5.8F.91.E5.B8.83.E8.80.85">自动订阅的所有者和发布者</span></h3>
<p>一个服务必须允许所有者和发布者订阅一个节点, 以及从一个节点获取条目，即使他们没有订阅. 服务可以自动订阅所有者和发布者，如果他们未曾订阅, 在这种情况下如果对订阅是必要的话它应该生成一个订阅ID，并且应该发送一个成功订阅的通知，如本文的<a href="/XEP-0060#.E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5" title="XEP-0060">订阅状态变更通知</a>所述.
</p>
<h3> <span class="mw-headline" id=".E6.8E.88.E6.9D.83.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82.28.E6.9C.AA.E5.86.B3.E8.AE.A2.E9.98.85.E8.80.85.29">授权订阅请求(未决订阅者)</span></h3>
<p>订阅请求如何被发送给节点所有者是一个实现的问题. 可能包括:
</p>
<dl><dd><ul><li> 发送请求给全部所有者(这些可以被放到离线存储中，如 <b>XEP-0160</b> 所述)并且第一个批准的人做主.
</li><li> 服务将订阅所有者的出席信息, 且只发送给在线的所有者.
</li><li> 全部所有者投票决定新订阅者.
</li><li> 允许任何所有者否决该订阅者.
</li></ul>
</dd></dl>
<p>一个实现可以使用这些方法中的任何一个, 或一些这里没定义的方法.
</p>
<h3> <span class="mw-headline" id=".E8.AE.A2.E9.98.85.E7.8A.B6.E6.80.81.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5">订阅状态变更通知</span></h3>
<p>各种动作和事件可以导致一个订阅状态的变更:
</p>
<dl><dd><ul><li> 批准或拒绝一个订阅请求，如<a href="/XEP-0060#.E7.AE.A1.E7.90.86.E8.AE.A2.E9.98.85.E8.AF.B7.E6.B1.82" title="XEP-0060">管理订阅请求</a>用例所述
</li></ul>
</dd></dl>
<dl><dd><ul><li> 撤销一个现有的订阅, 它有很多可能的触发器 "triggers"&#160;:
</li></ul>
<dl><dd><ul><li> 实体简单地取消订阅该节点
</li><li> 节点类型是 "presence" 且潜在的出席信息订阅被撤销
</li><li> 节点类型是 "roster" 且该实体被移动到未授权的名册组
</li></ul>
</dd></dl>
</dd></dl>
<p>当发生了一个订阅状态变更, 一个服务应该发送一个消息给这个(新的, 之前的, 或拒绝的)订阅者以向它通知这个变更, 这里该消息包含一个&lt;event/&gt;元素，并带有一个单独的&lt;subscription/&gt;子元素来指定该节点, JID, 和订阅状态. 该通知可以包含一个&lt;body/&gt;元素来指定关于该订阅变更的自然语言文本. 服务对其发送通知的那个JID的地址就是该订阅请求中的 'jid' 属性所设置的那个.
</p><p><b>例子 216. 订阅批准通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'approvalnotify1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 217. 订阅 撤销/拒绝 通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'horatio@denmark.lit'</span>
    <span class="re0">id</span>=<span class="st0">'unsubnotify1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'horatio@denmark.lit'</span> <span class="re0">subscription</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果服务有该订阅者(之前的或拒绝的)的出席信息的知识, 它应该发送消息给该订阅者的所有资源; 如果没有, 它必须发送该消息给该订阅者的从属的JID.
</p><p>如果一个服务或节点支持这个特性, 它必须在它对服务查询信息请求的应答中返回一个特性 "subscription-notifications" .
</p>
<h3> <span class="mw-headline" id="NodeID.E8.AF.AD.E4.B9.89">NodeID语义</span></h3>
<p>NodeIDs在pubsub的特定的范本,实现,或部署中可以有语义. 无论如何, 强烈建议这类语义不被用于封装节点的层次结构; 反之, 节点层次应该使用集合节点和它们的关联子节点来封装，如 <b>XEP-0248</b> 所述.
</p>
<h3> <span class="mw-headline" id=".E5.8C.85.E5.90.ABSHIM.E5.A4.B4">包含SHIM头</span></h3>
<p>当使用了SubIDs的时候, <b>节头和互联网元数据(SHIM)</b> 头被包含在里面以区分被发送的关联到特定订阅的不同通知. 相关用例和场景为:
</p>
<dl><dd><ul><li> 发送关于新发布条目的通知，如<a href="/XEP-0060#.E5.8F.91.E5.B8.83.E6.9D.A1.E7.9B.AE.E5.88.B0.E8.8A.82.E7.82.B9" title="XEP-0060">发布条目到节点</a>用例.
</li><li> 发送关于删除条目的通知，如<a href="/XEP-0060#.E4.BB.8E.E8.8A.82.E7.82.B9.E5.88.A0.E9.99.A4.E6.9D.A1.E7.9B.AE" title="XEP-0060">从节点删除条目</a>用例.
</li></ul>
</dd></dl>
<p>SHIM头是由订阅者订阅了的那个节点生成的, 它可以是一个叶子节点或一个集合节点(参考 <b>XEP-0248</b> ).
</p><p>当内容不是基于订阅ID来区分的时候，SHIM头不会被包含, 例如, 当一个节点发送配置变更通知, 该节点已经被清理的通知, 或该节点被删除的通知给该节点本身.
</p>
<h3> <span class="mw-headline" id=".E5.92.8C.E7.94.9F.E6.88.90.E5.AE.9E.E4.BD.93.E5.85.B3.E8.81.94.E7.9A.84.E4.BA.8B.E4.BB.B6.E5.92.8C.E8.BD.BD.E8.8D.B7">和生成实体关联的事件和载荷</span></h3>
<p>一个实现可以让节点配置能指定事件通知和实体之间的用于发布信息的关联, 但是这样一个特性是可选的. 这里是一些可能的例子:
</p>
<dl><dd><ul><li> 在一个使用<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0080.html">用户位置</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">29</a>的地理位置通知服务上下文中, 用户可以生成地理未知信息或该信息可由一个自动的服务生成(例如, 一个由移动电话供应商提供的服务), 但是在这两种情况下该信息都是关于该用户的地理位置，所以所有应答应该去到该用户(它可能是节点所有者).
</li><li> 在一个群组博客上下文中, 不同用户可以发布到该博客而应答可以给一个博文的发布者而不是该博客的所有者.
</li><li> 在一个集成了pubsub和多用户聊天系统的上下文中, 节点所有者可以是房间所有者但是所有应答需要被发送到房间而不是该所有者.
</li></ul>
</dd></dl>
<p>因此我们定义了 "itemreply" 节点配置选项, 有两个可能的值:
</p>
<dl><dd><ul><li> "owner" (即, 节点所有者或节点所有者的别名)
</li><li> "publisher" (即, 该条目的发布者)
</li></ul>
</dd></dl>
<p>一个节点所有者不能(MUST NOT)定义多于一个这类选项.
</p><p>一个例子如下.
</p><p><b>例子 218. 带发布者JID的事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
         <span class="re0">to</span>=<span class="st0">'bassanio@merchantofvenice.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'n48ad4fj78zn38st734'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'i1s2d3f4g5h6bjeh936'</span>
            <span class="re0">publisher</span>=<span class="st0">'portia@merchantofvenice.lit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;geoloc</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/geoloc'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;description<span class="re2">&gt;</span></span><span class="co3">Venice</span><span class="re1">&lt;/description<span class="re2">&gt;</span></span>
          <span class="re1">&lt;lat<span class="re2">&gt;</span></span><span class="co3">45.44</span><span class="re1">&lt;/lat<span class="re2">&gt;</span></span>
          <span class="re1">&lt;lon<span class="re2">&gt;</span></span><span class="co3">12.33</span><span class="re1">&lt;/lon<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/geoloc<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>作为一种选择, 如果一个服务实现了本协议的个人事件子集, 该虚拟pubsub服务是该帐号所有者的纯JID且通知被从那个JID发送; 细节参考 <b>XEP-0163</b> .
</p>
<h3> <span class="mw-headline" id=".E9.93.BE.E6.8E.A5">链接</span></h3>
<p>单词 "chaining" 指的是订阅一个节点到另一个节点的实践. 比如, 考虑一个场景，节点&lt;pubsub@example.net/NewsBroadcaster&gt;想分发信息从&lt;pubsub.example.com&gt;上的节点 "NewsFeed" 收到的信息. 因为理论上对于&lt;pubsub@example.net/NewsBroadcaster&gt;来说直接订阅NewsFeed节点是有可能的(因为之前的节点被直接寻址为一个JID), 实现不能(MUST NOT)以这种方式链接节点. 反之, 实现必须从该pubsub服务而不是该节点的地址来订阅(在这里展示的例子中, 该订阅将被从&lt;pubsub@example.net&gt;而不是&lt;pubsub@example.net/NewsBroadcaster&gt;)发送.
</p>
<h3> <span class="mw-headline" id=".E5.9F.BA.E4.BA.8E.E6.97.B6.E9.97.B4.E7.9A.84.E8.AE.A2.E9.98.85.28.E7.A7.9F.E7.94.A8.29">基于时间的订阅(租用)</span></h3>
<p>在一些系统中可能想要提供一个订阅 "leasing" 特性以让旧的或不新鲜的订阅超时失效. 租用能用可配置的订阅选项来实现; 具体来说, 当一个实体订阅了, 该服务将要求订阅选项配置且配置格式将包含一个字段 "pubsub#expire". 这个字段必须包含一个dateTime(定义于<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0082.html">XMPP日期和事件范本</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">30</a>).
</p><p>租用过程如下所示.
</p><p><b>例子 219. 租用过程</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'lease1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscribe</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'lease1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscribe-options<span class="re2">&gt;</span></span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/subscribe-options<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/subscription<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'lease2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'lease2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
        ...
        </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#expire'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Requested lease period'</span><span class="re2">/&gt;</span><span class="co3">
        ...
      </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'lease3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
          </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">2006-02-28T11:59Z</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
        </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
     <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'lease3'</span><span class="re2">/&gt;</span></pre></div></div>
<p>当该租用快要结束的时候(例如, 在该租约结束之前24小时)，该服务可以发送一个消息给该订阅者. 要做到这必须发送一个包含了一个由 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#event'">http://jabber.org/protocol/pubsub#event'</a> 命名空间限定的&lt;subscription/&gt;元素的&lt;message/&gt;，这个&lt;subscription/&gt;元素必须包含一个 'expiry' 属性.
</p><p><b>例子 220. 服务通知订阅者租约快到期了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">expiry</span>=<span class="st0">'2006-02-28T23:59Z'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">subid</span>=<span class="st0">'ba49252aaa4f5d320c24d3766f0bdcade78c78d3'</span>
        <span class="re0">subscription</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>当该订阅者想更新租用, 它将获得当前的订阅选项, 修改 "pubsub#expire" 字段的值, 并提交该新订阅选项给回服务. 如果新的过期值超过了订阅租用允许的最大值, 该服务必须把该字段的值改为当前的 date/time 加上最大允许租用时间.
</p><p><b>例子 221. 更新一个租用</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'renew1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'renew1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
        ...
        </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#expire'</span> <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Requested lease period'</span><span class="re2">/&gt;</span><span class="co3">
        ...
      </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'renew2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span> <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
          </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'pubsub#expire'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">2006-03-31T23:59Z</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
        </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
     <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'francisco@denmark.lit/barracks'</span>
    <span class="re0">id</span>=<span class="st0">'renew2'</span><span class="re2">/&gt;</span></pre></div></div>
<h3> <span class="mw-headline" id=".E5.9F.BA.E4.BA.8E.E5.86.85.E5.AE.B9.E7.9A.84Pubsub.E7.B3.BB.E7.BB.9F">基于内容的Pubsub系统</span></h3>
<p>一个服务可以让实体能订阅节点并应用一个过滤器到通知(例如, 关键字匹配，类似 "从Slashdot发送所有匹配术语 'Jabber' 的新闻条目给我"). 这样一个基于内容的服务应该允许一个实体多次订阅相同的节点并且, 如果是这样, 必须用订阅标识符(SubIDs)来区分多个订阅. 为了防止冲突, 一个支持基于内容订阅的使用SubIDs的服务应该代表订阅者生成SubIDs而不是允许订阅者设置他们自己的SubIDs. <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">31</a>
</p><p>基于内容的服务应该使用订阅选项来指定被应用的过滤器(们). 因为有很多可能的过滤机制(其中一些可以是应用特有的), 本文不订阅任何这类放大. 无论如何, 过滤机制可以被定义在独立的协议中.
</p><p>下面是一个用于基于内容的pubsub的订阅选项配置过程的虚构的例子.
</p><p><b>例子 222. 一个基于内容的订阅</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'filter1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscribe</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'francisco@denmark.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'filter1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;subscription</span>
        <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
        <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span>
        <span class="re0">subid</span>=<span class="st0">'991d7fd1616fd041015064133cd097a10030819e'</span>
        <span class="re0">subscription</span>=<span class="st0">'unconfigured'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;subscribe-options<span class="re2">&gt;</span></span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/subscribe-options<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/subscription<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'get'</span>
    <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'filter2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
             <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span>
             <span class="re0">subid</span>=<span class="st0">'991d7fd1616fd041015064133cd097a10030819e'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'filter2'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
             <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span>
             <span class="re0">subid</span>=<span class="st0">'991d7fd1616fd041015064133cd097a10030819e'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
        ...
        </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'x-http://shakespeare.lit/search#keyword'</span>
               <span class="re0">type</span>=<span class="st0">'text-single'</span>
               <span class="re0">label</span>=<span class="st0">'Keyword to match'</span><span class="re2">/&gt;</span><span class="co3">
        ...
      </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'filter3'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;options</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span>
             <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span>
             <span class="re0">subid</span>=<span class="st0">'991d7fd1616fd041015064133cd097a10030819e'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/pubsub#subscribe_options</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
          </span><span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'x-http://shakespeare.lit/search#keyword'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">peasant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/field<span class="re2">&gt;</span></span><span class="co3">
          ...
        </span><span class="re1">&lt;/x<span class="re2">&gt;</span></span>
     <span class="re1">&lt;/options<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'result'</span>
    <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'filter3'</span><span class="re2">/&gt;</span></pre></div></div>
<p>该订阅者接着将被通知匹配该关键字的事件.
</p><p><b>例子 223. 为匹配的关键字的事件通知</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'pubsub.shakespeare.lit'</span> <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;event</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;items</span> <span class="re0">node</span>=<span class="st0">'princely_musings'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'4e30f35051b7b8b42abe083742187228'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;entry</span> <span class="re0">xmlns</span>=<span class="st0">'http://www.w3.org/2005/Atom'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Alone</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
          <span class="re1">&lt;summary<span class="re2">&gt;</span></span><span class="co3">
Now I am alone.
O, what a rogue and peasant slave am I!
          </span><span class="re1">&lt;/summary<span class="re2">&gt;</span></span>
          <span class="re1">&lt;link</span> <span class="re0">rel</span>=<span class="st0">'alternate'</span> <span class="re0">type</span>=<span class="st0">'text/html'</span>
                <span class="re0">href</span>=<span class="st0">'http://denmark.lit/2003/12/13/atom03'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;id<span class="re2">&gt;</span></span><span class="co3">tag:denmark.lit,2003:entry-32396</span><span class="re1">&lt;/id<span class="re2">&gt;</span></span>
          <span class="re1">&lt;published<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/published<span class="re2">&gt;</span></span>
          <span class="re1">&lt;updated<span class="re2">&gt;</span></span><span class="co3">2003-12-13T11:09:53Z</span><span class="re1">&lt;/updated<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/entry<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/items<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/event<span class="re2">&gt;</span></span>
  <span class="re1">&lt;headers</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/shim'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;header</span> <span class="re0">name</span>=<span class="st0">'SubID'</span><span class="re2">&gt;</span><span class="co3">991d7fd1616fd041015064133cd097a10030819e</span><span class="re1">&lt;/header<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/headers<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E5.8D.95.E4.BB.B6.E8.8A.82.E7.82.B9">单件节点</span></h3>
<p>对于一些节点, 期望在任何时间至少有一个和该节点关联的条目存在(例如, 一个客户端可能想使用一个由那个客户端控制的命名空间命名的节点名来存储它的参数). 当想用这个模式的时候, 推荐该发布者指定一个 "current" ItemID来确保一个新条目的发布将覆盖现有的条目.
</p><p><b>例子 224. 发布到一个单件节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">type</span>=<span class="st0">'set'</span>
    <span class="re0">from</span>=<span class="st0">'horatio@denmark.lit/mobile'</span>
    <span class="re0">to</span>=<span class="st0">'pubsub.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'single1'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;pubsub</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;publish</span> <span class="re0">node</span>=<span class="st0">'elsinore-doorbell'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;item</span> <span class="re0">id</span>=<span class="st0">'current'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/publish<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/pubsub<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>自然的, 该节点所有者能通过把 max_items 配置选项设为 "1" 来强制该单件节点模式.
</p>
<h3> <span class="mw-headline" id="PubSub_URIs">PubSub URIs</span></h3>
<p>一个 XMPP URI (见 <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc5122">RFC 5122</a> <a href="/XEP-0060#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0060">32</a>)能被用于识别或交互的目的. 一些例子如下.
</p><p>以下URI只是标识一个pubsub节点.
</p><p><b>例子 225. XMPP URI 用于节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-html4strict" style="font-family: monospace;"><pre>xmpp:pubsub.shakespeare.lit?;node=princely_musings</pre></div></div>
<p>以下URI识别位于一个节点的一个特定条目.
</p><p><b>例子 226. XMPP URI 用于一个pubsub条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-html4strict" style="font-family: monospace;"><pre>xmpp:pubsub.shakespeare.lit?;node=princely_musings;item=ae890ac52d0df67ed7cfdf51b644e901</pre></div></div>
<p>以下URI定义如何订阅一个节点(详见本文的<a href="/XEP-0060#URI.E6.9F.A5.E8.AF.A2.E7.B1.BB.E5.9E.8B" title="XEP-0060">URI查询类型</a>).
</p><p><b>例子 227. URI 用于订阅一个pubsub节点</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-html4strict" style="font-family: monospace;"><pre>xmpp:pubsub.shakespeare.lit?pubsub;action=subscribe;node=princely_musings</pre></div></div>
<p>以下URI定义如何从一个节点获取一个特定的条目.
</p><p><b>例子 228. URI 用于获取一个pubsub条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-html4strict" style="font-family: monospace;"><pre>xmpp:pubsub.shakespeare.lit?pubsub;action=retrieve;node=princely_musings;item=ae890ac52d0df67ed7cfdf51b644e901</pre></div></div>
<h2> <span class="mw-headline" id="XML_Schemas">XML Schemas</span></h2>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub">http://jabber.org/protocol/pubsub</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0060: http://xmpp.org/extensions/xep-0060.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:import</span>
      <span class="re0">namespace</span>=<span class="st0">'jabber:x:data'</span>
      <span class="re0">schemaLocation</span>=<span class="st0">'http://xmpp.org/schemas/x-data.xsd'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'create'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'configure'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscribe'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'options'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'affiliations'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'default'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'items'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'publish'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'retract'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscription'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscriptions'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'unsubscribe'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'affiliations'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'affiliation'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'member'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publisher'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publish-only'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'configure'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">xmlns:xdata</span>=<span class="st0">'jabber:x:data'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'xdata:x'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'create'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'default'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'type'</span>
                        <span class="re0">use</span>=<span class="st0">'optional'</span>
                        <span class="re0">default</span>=<span class="st0">'leaf'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'collection'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'leaf'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'max_items'</span> <span class="re0">type</span>=<span class="st0">'xs:positiveInteger'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:any</span> <span class="re0">namespace</span>=<span class="st0">'##other'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'id'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'options'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:any</span> <span class="re0">namespace</span>=<span class="st0">'jabber:x:data'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'publish'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'retract'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">minOccurs</span>=<span class="st0">'1'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'notify'</span> <span class="re0">type</span>=<span class="st0">'xs:boolean'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscribe-options'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscribe'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscriptions'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscription'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscription'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscribe-options'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subscription'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'pending'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'unconfigured'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unsubscribe'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23errors"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#errors">http://jabber.org/protocol/pubsub#errors</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#errors'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      This namespace is used for error reporting only, as
      defined in XEP-0060:
&#160;
      http://xmpp.org/extensions/xep-0060.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'closed-node'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'configuration-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invalid-jid'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invalid-options'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invalid-payload'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invalid-subid'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item-forbidden'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'jid-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'max-items-exceeded'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'max-nodes-exceeded'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'nodeid-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'not-in-roster-group'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'not-subscribed'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'payload-too-big'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'payload-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'pending-subscription'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'presence-subscription-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subid-required'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'too-many-subscriptions'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unsupported'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'feature'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'access-authorize'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'access-open'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'access-presence'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'access-roster'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'access-whitelist'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'auto-create'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'auto-subscribe'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'collections'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'config-node'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'create-and-configure'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'create-nodes'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'delete-items'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'delete-nodes'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'filtered-notifications'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'get-pending'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'instant-nodes'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'item-ids'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'last-published'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'leased-subscription'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'manage-subscriptions'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'member-affiliation'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'meta-data'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'modify-affiliations'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'multi-collection'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'multi-subscribe'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'outcast-affiliation'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'persistent-items'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'presence-notifications'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'presence-subscribe'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publish'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publish-options'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publish-only-affiliation'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publisher-affiliation'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'purge-nodes'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'retract-items'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'retrieve-affiliations'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'retrieve-default'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'retrieve-items'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'retrieve-subscriptions'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscribe'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscription-options'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscription-notifications'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unsupported-access-model'</span> <span class="re0">type</span>=<span class="st0">'empty'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23event"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#event">http://jabber.org/protocol/pubsub#event</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#event'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0060: http://xmpp.org/extensions/xep-0060.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:import</span>
      <span class="re0">namespace</span>=<span class="st0">'jabber:x:data'</span>
      <span class="re0">schemaLocation</span>=<span class="st0">'http://xmpp.org/schemas/x-data.xsd'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'event'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'collection'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'configuration'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'delete'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'items'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'purge'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscription'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'collection'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'associate'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'disassociate'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'associate'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'disassociate'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'configuration'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">xmlns:xdata</span>=<span class="st0">'jabber:x:data'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'xdata:x'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'delete'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'redirect'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'1'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'retract'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:any</span> <span class="re0">namespace</span>=<span class="st0">'##other'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'id'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'publisher'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'purge'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'redirect'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'uri'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'retract'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'id'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscription'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'expiry'</span> <span class="re0">type</span>=<span class="st0">'xs:dateTime'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subscription'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'pending'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'unconfigured'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fpubsub.23owner"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub#owner">http://jabber.org/protocol/pubsub#owner</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/pubsub#owner'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0060: http://xmpp.org/extensions/xep-0060.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:import</span>
      <span class="re0">namespace</span>=<span class="st0">'jabber:x:data'</span>
      <span class="re0">schemaLocation</span>=<span class="st0">'http://xmpp.org/schemas/x-data.xsd'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'pubsub'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'affiliations'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'configure'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'default'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'delete'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'purge'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscriptions'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'affiliations'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'affiliation'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'member'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publisher'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'publish-only'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'configure'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">xmlns:xdata</span>=<span class="st0">'jabber:x:data'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'xdata:x'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'default'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">xmlns:xdata</span>=<span class="st0">'jabber:x:data'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'xdata:x'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'delete'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'redirect'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'1'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'purge'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'redirect'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'uri'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscriptions'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'subscription'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'node'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'subscription'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'subscription'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
              <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'pending'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'subscribed'</span><span class="re2">/&gt;</span>
                <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'unconfigured'</span><span class="re2">/&gt;</span>
              <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
            <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E8.87.B4.E8.B0.A2">致谢</span></h2>
<p>感谢 Kirk Bateman, Robin Collier, Blaine Cook, Ovidiu Craciun, Brian Cully, Dave Cridland, Guillaume Desmottes, Gaston Dombiak, William Edney, Seth Fitzsimmons, Fabio Forno, Nathan Fritz, Julien Genestoux, Anastasia Gornostaeva, Joe Hildebrand, Curtis King, Tuomas Koski, Petri Liimatta, Tobias Markmann, Pedro Melo, Dirk Meyer, Tory Patnoe, Peter Petrov, Sonny Piers, Christophe Romain, Pavel Šimerda, Andy Skelton, Kevin Smith, Chris Teegarden, Simon Tennant, Matt Tucker, Matthew Wild, Bob Wyman, Matus Zamborsky, and Brett Zamir 的反馈.
</p>
<h2> <span class="mw-headline" id=".E4.BD.9C.E8.80.85.E5.A4.87.E6.B3.A8">作者备注</span></h2>
<p>Peter Millard, 本协议从版本0.1到版本1.7的主要作者, 去世于 April 26, 2006. 其他的联合作者对它多年来在 发布-订阅 技术方面的工作深表感谢.
</p>
<h2> <span class="mw-headline" id=".E9.99.84.E5.BD.95">附录</span></h2>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF">附录A:文档信息</span></h3>
<p>系列：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/">XEP</a>
</p><p>序号：0060
</p><p>发布者：<a rel="nofollow" class="external text" href="http://xmpp.org/xsf/">XMPP标准基金会</a>
</p><p>状态：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0001.html#states-Draft">草案</a>
</p><p>类型：<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards%20Track">标准跟踪</a>
</p><p>版本：1.13
</p><p>最后更新：2010-07-12
</p><p>批准机构：<a rel="nofollow" class="external text" href="http://xmpp.org/council/">XMPP理事会</a>
</p><p>依赖标准：XMPP Core, XEP-0004, XEP-0030, XEP-0068, XEP-0082, XEP-0131
</p><p>替代标准：无
</p><p>被替代标准：无
</p><p>缩略名：pubsub
</p><p>用于pubsub命名空间的XML Schema: &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/schemas/pubsub.xsd">http://xmpp.org/schemas/pubsub.xsd</a>&gt;
</p><p>用于pubsub#errors命名空间的XML Schema: &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/schemas/pubsub-errors.xsd">http://xmpp.org/schemas/pubsub-errors.xsd</a>&gt;
</p><p>用于pubsub#event命名空间的XML Schema: &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/schemas/pubsub-event.xsd">http://xmpp.org/schemas/pubsub-event.xsd</a>&gt;
</p><p>用于pubsub#owner命名空间的XML Schema: &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/schemas/pubsub-owner.xsd">http://xmpp.org/schemas/pubsub-owner.xsd</a>&gt;
</p><p>原文控制： <a rel="nofollow" class="external text" href="http://gitorious.org/xmpp/xmpp/blobs/master/extensions/xep-0060.xml">HTML</a>
</p><p>本文的其它格式： <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0060.xml">XML</a> <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0060.pdf">PDF</a>
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF">附录B:作者信息</span></h3>
<p><b>Peter Millard</b>
</p><p>见 <a href="/XEP-0060#.E4.BD.9C.E8.80.85.E5.A4.87.E6.B3.A8" title="XEP-0060">作者备注</a>
</p><p><b>Peter Saint-Andre</b>
</p><p>Email: <a rel="nofollow" class="external text" href="mailto:stpeter@jabber.org">stpeter@jabber.org</a>
</p><p>JabberID: stpeter@jabber.org
</p><p>URI: <a rel="nofollow" class="external free" href="https://stpeter.im/">https://stpeter.im/</a>
</p><p><b>Ralph Meijer</b>
</p><p>Email: <a rel="nofollow" class="external text" href="mailto:ralphm@ik.nu">ralphm@ik.nu</a>
</p><p>JabberID: ralphm@ik.nu
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A">附录C:法律通告</span></h3>
<p><b>版权</b>
</p><p>XMPP扩展协议的版权(1999-2008)归XMPP标准化基金会(XSF)所有.
</p><p><b>权限</b>
</p><p>特此授权,费用全免,对任何获得本协议副本的人,对使用本协议没有限制,包括不限制在软件程序中实现本协议,不限制在网络服务中布署本协议,不限制拷贝,修改,合并,发行,翻译,分发,转授,或销售本协议的副本,被允许使用本协议做了以上工作的人士,应接受前述的版权声明和本许可通知并且必须包含在所有的副本或实质性部分的规格中.除非单独的许可，被重新分发的修改工作，不得含有关于作者，标题，编号，或出版者的规格的误导性资料，并不得宣称修改工作是由本文的作者，作者所属的任何组织或项目，或XMPP标准基金会签注。
</p><p><b>免责声明'</b>
</p><p><b>## 特别注意：本协议是提供的“原样”的基础，没有担保或任何形式的条件，明示或暗示，包括，但不限于任何担保或关于名称，非侵权性，适销性或适合作某一特定目的的条件. ##</b>
</p><p><b>责任限制</b>
</p><p>在任何情况下以及没有任何法律规定时，不论是侵权行为（包括疏忽），合同或其它方面，除非根据适用法律的要求（如蓄意和有严重疏忽行为）或以书面形式同意，XMPP标准基金会或任何作者不对本协议所造成的损失承担责任，包括任何直接，间接，特殊，偶发，或任何从本协议出，入，连接的字符产生的或实现，布署或其他对本协议的使用导致的相应的损害赔偿（包括但不限于善意的损失，停止作业，电脑失灵或故障，或任何和所有其他商业损害或损失） ，即使XMPP标准基金会或作者已被告知此类损害的可能性。
</p><p><b>知识产权的一致性</b>
</p><p>XMPP扩展协议完全遵守XSF的知识产权策略(可在&lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt;找到副本或写信给XMPP标准基金会, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB">附录D:和XMPP的关系</span></h3>
<p>可扩展的消息和出席信息协议 (XMPP) 定义于 XMPP Core (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>) 和 XMPP IM (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>) 规范里，由 XMPP标准基金会贡献到由依据<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2026">RFC 2026</a>成立的互联网工程人物组管理的互联网标准流程 Internet Standards Process. 本文定义的任何协议已在互联网标准流程之外开发，并且被理解为 XMPP 的扩展而不是一个XMPP本身的演化, 开发, 或修改.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9">附录E:讨论地点</span></h3>
<p>主要的XMPP扩展协议讨论地点是 &lt;standards@xmpp.org&gt; 讨论列表.
</p><p>在 xmpp.org 的其它讨论列表中的讨论可能也有合适的; 所有的列表见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; .
</p><p>勘误表可以发送邮件到 &lt;editor@xmpp.org&gt;.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7">附录F:需求一致性</span></h3>
<p>以下用于本文的需求关键字的解释见于 <a rel="nofollow" class="external text" href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p><p><br />
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8">附录G:备注</span></h3>
<p>1. <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc4287">RFC 4287</a>: The Atom Syndication Format &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc4287">http://tools.ietf.org/html/rfc4287</a>&gt;.
</p><p>2. <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc6120">RFC 6120</a>: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc6120">http://tools.ietf.org/html/rfc6120</a>&gt;.
</p><p>3. XEP-0030: Service Discovery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.
</p><p>4. XEP-0248: PubSub Collection Nodes &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0248.html">http://xmpp.org/extensions/xep-0248.html</a>&gt;.
</p><p>5. XEP-0163: Personal Eventing Protocol &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0163.html">http://xmpp.org/extensions/xep-0163.html</a>&gt;.
</p><p>6. <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.
</p><p>7. XEP-0045: Multi-User Chat &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0045.html">http://xmpp.org/extensions/xep-0045.html</a>&gt;.
</p><p>8. 这些节点等同于那些 XEP-0030: Service Discovery 中使用的节点.
</p><p>9. 这个规则不适用于根集合节点, 如果有的话.
</p><p>10. XEP-0055: Jabber Search &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0055.html">http://xmpp.org/extensions/xep-0055.html</a>&gt;.
</p><p>11. XEP-0004: Data Forms &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0004.html">http://xmpp.org/extensions/xep-0004.html</a>&gt;.
</p><p>12. XEP-0128: Service Discovery Extensions &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0128.html">http://xmpp.org/extensions/xep-0128.html</a>&gt;.
</p><p>13. XEP-0068: Field Data Standardization for Data Forms &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0068.html">http://xmpp.org/extensions/xep-0068.html</a>&gt;.
</p><p>14. XEP-0203: Delayed Delivery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0203.html">http://xmpp.org/extensions/xep-0203.html</a>&gt;.
</p><p>15. 根据 <b>XML Schema Part 2: Datatypes</b> 的3.2.2.1节, xs:boolean datatype 允许的词汇表达是字符 "0" 和 "false" 用于概念 '假' 而字符 "1" 和 "true" 用于概念 '真'; 实现必须同时支持两种词汇表达方式.
</p><p>16. XEP-0059: Result Set Management &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0059.html">http://xmpp.org/extensions/xep-0059.html</a>&gt;.
</p><p>17. 不再允许包含多个&lt;item/&gt;元素了, 从本协议的版本1.13给出了批量发布的移除功能.
</p><p>18. 对一个发布请求来说，要触发一个事件通知，包含一个载荷或甚至一个&lt;item/&gt;元素不是必要的. 例如, 发布到一个临时的，仅通知的节点的结果将是一个甚至不包含一个&lt;item/&gt;元素的事件通知. 无论如何, 为了方便讨论，我们参考发布行为 "发布一个条目" (而不是, 说, "触发一个事件通知") ，尽管一个发布请求不总是包含一个&lt;item/&gt;元素.
</p><p>19. XEP-0131: Stanza Headers and Internet Metadata &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0131.html">http://xmpp.org/extensions/xep-0131.html</a>&gt;.
</p><p>20. 根据 <b>XML Schema Part 2: Datatypes</b> 的3.2.2.1节, xs:boolean datatype 允许的词汇表达是字符 "0" 和 "false" 用于概念 '假' 而字符 "1" 和 "true" 用于概念 '真'; 实现必须同时支持两种词汇表达方式.
</p><p>21. XEP-0050: Ad-Hoc Commands &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0050.html">http://xmpp.org/extensions/xep-0050.html</a>&gt;.
</p><p>22. XEP-0080: User Geolocation &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0080.html">http://xmpp.org/extensions/xep-0080.html</a>&gt;.
</p><p>23. XEP-0118: User Tune &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0118.html">http://xmpp.org/extensions/xep-0118.html</a>&gt;.
</p><p>24. XEP-0108: User Activity &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0108.html">http://xmpp.org/extensions/xep-0108.html</a>&gt;.
</p><p>25. 包含的, 假如说, '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/geoloc'">http://jabber.org/protocol/geoloc'</a> NodeID 表示该客户端理解<b>XEP-0080</b> 所述的地理位置命名空间, 而包含 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/geoloc+notify'">http://jabber.org/protocol/geoloc+notify'</a> 命名空间表示该客户端理想接收和地理位置相关的通知, 这里的NodeID和地理位置命名空间 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/geoloc'">http://jabber.org/protocol/geoloc'</a> 是一样的(这种情况下，在命名空间名称和NodeID之间是一对一对应的).
</p><p>26. XEP-0086: Error Condition Mappings &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0086.html">http://xmpp.org/extensions/xep-0086.html</a>&gt;.
</p><p>27. XEP-0160: Best Practices for Handling Offline Messages &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0160.html">http://xmpp.org/extensions/xep-0160.html</a>&gt;.
</p><p>28. XEP-0079: Advanced Message Processing &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0079.html">http://xmpp.org/extensions/xep-0079.html</a>&gt;.
</p><p>29. XEP-0080: User Geolocation &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0080.html">http://xmpp.org/extensions/xep-0080.html</a>&gt;.
</p><p>30. XEP-0082: XMPP Date and Time Profiles &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0082.html">http://xmpp.org/extensions/xep-0082.html</a>&gt;.
</p><p>31. 另一个实现基于内容的订阅的方法是给每个关键或其他过滤器提供一个节点; 无论如何, 这相当于要求非常大量的节点.
</p><p>32. <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc5122">RFC 5122</a>: Internationalized Resource Identifiers (IRIs) and Uniform Resource Identifiers (URIs) for the Extensible Messaging and Presence Protocol (XMPP) &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc5122">http://tools.ietf.org/html/rfc5122</a>&gt;.
</p><p>33. 互联网号码分配机构(IANA)是为互联网协议分配唯一性的参数值的中间协调者, 类似端口号码和 URI schemes. 更多信息参见 &lt;<a rel="nofollow" class="external free" href="http://www.iana.org/">http://www.iana.org/</a>&gt;.
</p><p>34. XMPP注册处维护一个保留的协议命名空间的列表和在XMPP标准基金会批准的XMPP扩展协议的上下文中使用的参数的注册项的列表. 更多信息见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/registrar/">http://xmpp.org/registrar/</a>&gt;.
</p><p>35. 在XEP-0060的版本1.5之前, 这个类型被称为 "generic".
</p><p>36. XEP-0147: XMPP URI Query Components &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0147.html">http://xmpp.org/extensions/xep-0147.html</a>&gt;.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95H:.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2">附录H:修订历史</span></h3>
<p>注意: 本协议的旧版本可能在 <a rel="nofollow" class="external free" href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a> 还可用
</p>
<dl><dd><b>Version 1.13 (2010-07-12)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    Pending further discussion: added but then removed change to allow notifications via IQ stanzas; removed but then retained batch publishing; removed but then retained SubIDs in subscription approvals.
</li><li>    Corrected a large number of reported errata.
</li><li>    Removed delete-any feature.
</li><li>    Added missing delete-items feature.
</li><li>    Added special value of "presence" for the pubsub#expire option to support temporary subscriptions.
</li><li>    Removed replyto and replyroom config options.
</li><li>    Removed multiple node discovery since it depended on the deprecated Service Discovery Publishing feature.
</li><li>    Defined "room" value for itemreply config option.
</li><li>    Added optional 'publisher' attribute to &lt;item/&gt; element.
</li><li>    Added optional &lt;redirect/&gt; child to &lt;delete/&gt; element.
</li><li>    Based redirects on URIs for consistency with <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc6120">RFC 6120</a> gone and redirect errors.
</li><li>    Clarified meaning of filtered notifications (they are based on NodeIDs, not payload namespaces).
</li><li>    Added pubsub-on-a-jid service discovery feature for explicit discovery that an IM and presence account also functions as a virtual pubsub service.
</li><li>    Added purge_offline node configuration option for purging the node when the relevant publisher goes offline, for use in certain extended presence applications.
</li><li>    Added item_expire node configuration option for automatically removing items after a certain number of seconds.
</li><li>    Added notification_type node configuration option for defining which value of the &lt;message/&gt; type attribute shall be used for notifications.
</li><li>    Added retrieve-default-sub feature for retrieving default subscription configuration from a node (as you can retrieve default node configuration from the service).
</li><li>    Clarified suggested rules for payload definitions.
</li><li>    Mentioned that singleton pattern can be enforced by setting max_items to 1.
</li><li>    Removed the notion of batch publishing because it makes information coherence and atom handling excessively difficult.
</li><li>    Added error handling for too-many-subscriptions to help prevent a certain denial of service attack.
</li><li>    Added process for retrieving default subscription configuration options for leaf nodes, by omitting the 'node' attribute on the &lt;default/&gt; element (also added the &lt;default/&gt; element to the schema for the <a rel="nofollow" class="external free" href="http://jabber.org/protocol/pubsub">http://jabber.org/protocol/pubsub</a> namespace, since it was missing).
</li><li>    Removed informational mapping of node meta-data to Dublin Core.
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.12 (2008-09-03)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    Specified that service should return ItemID on successful publish if no ItemID was provided in request.
</li><li>    Described the use of Result Set Management to return some but not all published items.
</li><li>    Defined pubsub#notify_sub config option so that owners can receive notifications of new subscriptions, unsubscribes, and other subscription changes.
</li><li>    Harmonized definition of +notify feature with implementation reality.
</li><li>    Moved text about collections to XEP-0248.
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.11 (2008-03-05)</b>
</dd></dl>
<dl><dd><dl><dd>For collection nodes, changed name of node child element to associate and added disassociate child element to handle disassociation use case; corrected SHIM examples to conform to XEP-0131; modified lease expiry notification for consistency with other subscription-related notifications (i.e., not using SHIM header); renamed SHIM headers to Collection and SubID for consistency with HTTP and Email headers.
</dd><dd>(rm/psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.10 (2007-09-26)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    In accordance with XMPP Council consensus, moved the auto-create, auto-subscribe, filtered-notifications, and last-published features from XEP-0163 to this specification
</li><li>    Clarified implications of auto-subscribe feature for handling of account owners, stable presence subscribers, and transient presence sharers
</li><li>    Updated filtered-notifications text and examples to track changes to XEP-0115
</li><li>    Added publish-options functionality
</li><li>    Added developer-friendly How It Works section
</li><li>    Defined member affiliation to properly implement whitelist feature
</li><li>    Split several long sections into smaller sub-sections.
</li><li>    Clarified that a pubsub service must generate an ItemID if the publisher does not provide one.
</li><li>    Specified recommended ItemID for singleton nodes.
</li><li>    Summarized triggers for sending notifications.
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.9 (2006-09-13)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    Replaced boolean send_item_subscribe node configuration option with more comprehensive send_last_published_item option per list discussion
</li><li>    Added deliver_notifications node configuration option to enable quiet nodes without notifications, if desired enabling pull-model item retrieval only.
</li><li>    Modified subscription and affiliation retrieval to return empty element if no results.
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.8 (2006-06-27)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    Defined five access models: open, presence, roster, authorize, and whitelist
</li><li>    Renamed pubsub#subscription_model feature to pubsub#access_model
</li><li>    Separated affiliations retrieval from subscriptions retrieval
</li><li>    Removed subscription information from affiliations management
</li><li>    Changed &lt;entity/&gt; element to &lt;subscription/&gt; element in response to subscription request
</li><li>    Clarified batch processing of item publication and item deletion
</li><li>    Added basic example to introduction
</li><li>    More fully specified node creation flows
</li><li>    More fully specified recommended behavior for caching last published item, including use of jabber:x:delay protocol
</li><li>    Specified that semantic meaning of NodeIDs must not be used to encapsulate hierarchy
</li><li>    More fully specified error conditions
</li><li>    Changed some feature-related conditions to &lt;unsupported/&gt; plus feature attribute
</li><li>    Changed some error conditions from &lt;not-authorized/&gt; to &lt;forbidden/&gt;
</li><li>    Harmonized error conditions for unsubscribe if entity is not subscribed (unexpected-request rather than not-found)
</li><li>    Further defined error conditions related to item publication
</li><li>    Specified structure of &lt;affiliations/&gt;, &lt;delete/&gt;, &lt;purge/&gt;, and &lt;subscriptions/&gt; elements qualified by pubsub#owner namespace
</li><li>    Changed retrieval of default node configuration options to use &lt;default/&gt; element, not &lt;configure/&gt; element
</li><li>    Allowed caching of last published item
</li><li>    Added pubsub#deliver subscription option
</li><li>    Added meta-data fields for pubsub#owners and pubsub#contact
</li><li>    Changed element for retrieval of default node configuration options from &lt;configure/&gt; to &lt;default/&gt; to prevent ambiguity related to configuration of root collection node
</li><li>    Specified pubsub#node_type configuration field
</li><li>    Specified pubsub#collection SHIM header
</li><li>    Specified conformance with Resourceprep for nodes addressable as JIDs
</li><li>    Added pubsub#modify-affiliations feature
</li><li>    Added pubsub#digest_frequency field to subscribe_options FORM_TYPE
</li><li>    Added pubsub#roster_groups_allowed field to node_config FORM_TYPE
</li><li>    More clearly specified the requirements level (MUST, SHOULD, MAY) for each service discovery feature
</li><li>    Defined pubsub#include_body subscription option and the pubsub#body_xslt node configuration option to transform payload format into an XMPP message body, and clarified rules for inclusion of message bodies
</li><li>    Clarified nature of collections and association of a node to a collection
</li><li>    Specified that simultaneous subscriptions of type nodes and items are allowed to collection nodes
</li><li>    Added examples and further explanation of time-based and content-based subscriptions
</li><li>    Added Internationalization Considerations
</li><li>    Clarified terminology
</li><li>    Corrected and updated the schemas
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.7 (2005-03-03)</b>
</dd></dl>
<dl><dd><dl><dd><ul><li>    Reinstated pubsub#subscribe feature (deleted in error)
</li><li>    Added type attribute for the &lt;create/&gt; and &lt;configure/&gt; elements to differentiate between leaf nodes and collection nodes
</li><li>    In Section 8.1.7, changed affiliations retrieval support to SHOULD and added pubsub#retrieve-affiliations feature
</li><li>    In Section 8.1.10, removed two duplicate examples
</li><li>    In Section 8.1.12, clarified relationship between normal disco#info data and node meta-data (which uses a service discovery extension)
</li><li>    In Section 8.2.4, specified that node purgation MUST result in one event notification, not a notification per item
</li><li>    In Section 8.1.8, further specified handling of SubIDs
</li><li>    Clarified nature of the pubsub#type field
</li><li>    Mentioned that the forbidden error should be returned in response to certain operations requested by an outcast
</li><li>    Corrected datatype of max_items attribute from xs:string to xs:positiveInteger
</li><li>    Corrected &lt;requesting-entity-not-subscribed/&gt; error to &lt;not-subscribed/&gt; since the subscribed JID need not be that of the requesting entity
</li><li>    Added service discovery features for more optional use cases: retracting items, purging nodes, deleting nodes
</li><li>    Updated relevant registries
</li></ul>
</dd></dl>
</dd></dl>
<dl><dd><dl><dd>(psa/rm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.6 (2004-07-13)</b>
</dd></dl>
<dl><dd><dl><dd>Added service discovery features for pubsub#meta-data, and pubsub#retrieve-items. Added pubsub#subscription_depth configuration option. Specified pubsub-specific error condition elements qualified by pubsub#errors namespace.
</dd><dd>(pgm/psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.5 (2004-07-07)</b>
</dd></dl>
<dl><dd><dl><dd>Fixed typos. Added more details to the section on collections. Added paragraph to create node use case to allow the service to change the requested node-id to something which it creates. Added text about bouncing publish requests when the request does not match the event-type for that node. Added disco features for the jabber registrar. Changed affiliation verbiage to allow publishers to remove any item. Tweaked verbiage for create node, eliminated extra example. Fully defined XMPP Registrar submissions. Corrected schemas.
</dd><dd>(pgm/psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.4 (2004-06-22)</b>
</dd></dl>
<dl><dd><dl><dd>Added subid syntax in a variety of places. Added more information about disco#info and disco#items support. Added more info about subscription options. Added collection information. Added implementation notes about subscription leases, and content-based pubsub services.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.3 (2004-04-25)</b>
</dd></dl>
<dl><dd><dl><dd>Editorial review; added one implementation note.
</dd><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.2 (2004-03-09)</b>
</dd></dl>
<dl><dd><dl><dd>Added XMPP error handling.
</dd><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.1 (2004-01-14)</b>
</dd></dl>
<dl><dd><dl><dd>Added XMPP Registrar Considerations subsection for Service Discovery category/type registration.
</dd><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 1.0 (2003-10-28)</b>
</dd></dl>
<dl><dd><dl><dd>Per a vote of the Jabber Council, advanced status to Draft.
</dd><dd>(psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.16 (2003-10-23)</b>
</dd></dl>
<dl><dd><dl><dd>Clarified JID addressing usage for nodes. Added specific MAY requirement for disco usage. Added sentence about implementations verifying that an entity has a subscription before getting the current items.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.15 (2003-10-21)</b>
</dd></dl>
<dl><dd><dl><dd>Fixed invalid XML in examples for subscription deny/allow.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.14 (2003-10-21)</b>
</dd></dl>
<dl><dd><dl><dd>Clarified restrictions on addressing nodes by JID. Added section on Approving and Denying Subscription Requests. Changed get-pending to use Ad-Hoc Commands. Changed semantics when sending in a form type='cancel' for pending subscriptions.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.13 (2003-09-30)</b>
</dd></dl>
<dl><dd><dl><dd>Removed item as a possible child of subscribe and unsubscribe and pubsub in the schemas. Removed retract as a possible child of item in the pubsub#event schema. Added verbiage to requirements for addressing nodes either via JIDs or disco nodes.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.12 (2003-08-13)</b>
</dd></dl>
<dl><dd><dl><dd>Defined public vs. private nodes; described how changes to existing nodes might trigger meta-node events (e.g., configuration changes); changed &lt;x/&gt; to &lt;event/&gt; for #events namespace; added meta-data about meta-nodes; fully defined XMPP Registrar considerations.
</dd><dd>(pgm/psa)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.11 (2003-06-25)</b>
</dd></dl>
<dl><dd><dl><dd>Removed subscription notifications since they have inherent issues. Removed empty implementation note sub-section.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.10 (2003-06-11)</b>
</dd></dl>
<dl><dd><dl><dd>Fixed error example when returning 501 from an items-get request. Added note about receiving subscription requests when an entity is already subscribed. Fixed some entity elements in various subscription examples. Many were missing the node attribute. Added subscription change notification verbiage and example. Added verbiage and example of subscription state notification being sent to the requesting entity. Added disco#items information for getting a list of item identifiers for a single node. Added verbiage for returning the current entity element when a curent subscriber attempts to subscribe again.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.9 (2003-04-30)</b>
</dd></dl>
<dl><dd><dl><dd>Include JID attributes in the entity elements when receiving your affiliations. Changed error code 406 (which was wrong) to 404, which is correct. Changed many 405 errors to 401, and modified the error table to make it more implementable (rules are more concrete). Added subscribe-options element for indicating subscriptions may be configured.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.8 (2003-04-03)</b>
</dd></dl>
<dl><dd><dl><dd>Clarified the affiliations table and the semantics around subscribing and unsubscribing. Added protocol to get all of your affiliations in the service. Added protocol for services informing subscribers that configurable subscription options are available. Added protocol for obtaining existing node configuration settings and for concatenating configuration and node creation requests into a single stanza. Added meta-node implementation notes and specified the interaction with the XMPP Registrar and the meta NodeIDs. Added authorization notes to subscription options.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.7 (2003-02-14)</b>
</dd></dl>
<dl><dd><dl><dd>Clarified requirements around what affiliations must be supported. Moved requirements about specifying entities which can subscribe and publish out of the MUSTs to MAYs. Changed SHOULD to MAY when talking about allowing entities to create nodes. Added ability to send configuration requests in the same stanza as a creation request.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.6 (2003-02-06)</b>
</dd></dl>
<dl><dd><dl><dd>Added more details and an example about publishing without NodeID. Added more implementation notes about NodeIDs and persistent storage.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.5 (2003-01-22)</b>
</dd></dl>
<dl><dd><dl><dd>Fixed header for delete item example. Added examples showing subscribers being notified of deleted items. Added examples for notification of node deletion, and configuration for node deletion. Added Subscriber option semantics and examples. Added examples for 402 and 407 errors on subscribe and create respectively. Added clarification about ItemID handling to impl notes.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.4 (2003-01-21)</b>
</dd></dl>
<dl><dd><dl><dd>Clarified in-band and out-of-band configuration requirement. Added Delete Item privilege for all affiliations to the table. Added Delete item protocol for publishers and owners. Added 401 error case for subscribing to an illegal jid. Changed subscription request form. Added defaults to configuration form, and clarified role of the XMPP Registrar for the features show. Added text explaining the max_items attribute. Changed "last items" to "most recent items". Removed default configuration acceptance -- owners should just cancel. Added the notify_retract configuration option. Clarified error handling for affiliation modifications.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.3 (2003-01-20)</b>
</dd></dl>
<dl><dd><dl><dd>Added subscription attribute for entities. Removed subscriber from the affiliations table. Clarified configuration details. Clarified JabberID usages. Added XMPP Registrar Considerations. Added link to XEP-0068 about the FORM_TYPE element in subscription request notifications. Fixed some typos in examples. Added unsupported configuration namespace to example. Added a default node configuration example.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.2 (2003-01-02)</b>
</dd></dl>
<dl><dd><dl><dd>Added numerous implementation notes; added get-pending action with regard to subscriptions; added error table; changed purge and delete to use IQ type='set'.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<dl><dd><b>Version 0.1 (2002-11-19)</b>
</dd></dl>
<dl><dd><dl><dd>Initial version.
</dd><dd>(pgm)
</dd></dl>
</dd></dl>
<hr />
<p>结束
</p>
<!-- 
NewPP limit report
Preprocessor node count: 3077/1000000
Post-expand include size: 3182/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki:pcache:idhash:8-0!*!0!!zh-cn!*!* and timestamp 20160221174254 -->
</div><div class="printfooter">
来自“<a href="http://wiki.jabbercn.org/index.php?title=XEP-0060&amp;oldid=3400">http://wiki.jabbercn.org/index.php?title=XEP-0060&amp;oldid=3400</a>”</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/%E7%89%B9%E6%AE%8A:%E9%A1%B5%E9%9D%A2%E5%88%86%E7%B1%BB" title="特殊:页面分类">2个分类</a>: <ul><li><a href="/%E5%88%86%E7%B1%BB:XMPP%E6%89%A9%E5%B1%95" title="分类:XMPP扩展">XMPP扩展</a></li><li><a href="/%E5%88%86%E7%B1%BB:%E5%B7%B2%E7%BF%BB%E8%AF%91" title="分类:已翻译">已翻译</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="/XEP-0060" title="查看内容页面 [c]" accesskey="c">页面</a></li>
				<li id="ca-talk" class="new"><a href="/index.php?title=%E8%AE%A8%E8%AE%BA:XEP-0060&amp;action=edit&amp;redlink=1" title="关于内容页面的讨论 [t]" accesskey="t">讨论</a></li>
				<li id="ca-viewsource"><a href="/index.php?title=XEP-0060&amp;action=edit" title="本页面已被保护。你可以查看其源代码。 [e]" accesskey="e">查看源代码</a></li>
				<li id="ca-history"><a href="/index.php?title=XEP-0060&amp;action=history" title="本页面的早前修订版本 [h]" accesskey="h">历史</a></li>
			</ul>
		</div>
	</div>

	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95&amp;returnto=XEP-0060" title="我们希望您可以登入，但不强求 [o]" accesskey="o">登录/创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="访问首页" style="background-image: url(/skins/common/images/xmppcn.png);" href="/%E9%A6%96%E9%A1%B5"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/%E9%A6%96%E9%A1%B5" title="访问首页 [z]" accesskey="z">首页</a></li>
				<li id="n-portal"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E7%A4%BE%E5%8C%BA%E4%B8%93%E9%A1%B5" title="关于本项目，你可以做什么，在哪里找到你需要的事物">社区专页</a></li>
				<li id="n-currentevents"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E6%96%B0%E9%97%BB%E5%8A%A8%E6%80%81" title="查看当前事件的背景信息">新闻动态</a></li>
				<li id="n-recentchanges"><a href="/%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9" title="本wiki的最近更改列表 [r]" accesskey="r">最近更改</a></li>
				<li id="n-randompage"><a href="/%E7%89%B9%E6%AE%8A:%E9%9A%8F%E6%9C%BA%E9%A1%B5%E9%9D%A2" title="随机进入一个页面 [x]" accesskey="x">随机页面</a></li>
				<li id="n-help"><a href="/%E5%B8%AE%E5%8A%A9:%E7%9B%AE%E5%BD%95" title="寻求帮助的地方">帮助</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-XMPP.E8.B5.84.E6.BA.90">
		<h5>XMPP资源</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XMPP.E5.85.AC.E5.85.B1.E6.9C.8D.E5.8A.A1"><a href="/XMPP%E5%85%AC%E5%85%B1%E6%9C%8D%E5%8A%A1">XMPP公共服务</a></li>
				<li id="n-XMPP.E5.AE.A2.E6.88.B7.E7.AB.AF.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6">XMPP客户端软件</a></li>
				<li id="n-XMPP.E6.9C.8D.E5.8A.A1.E5.99.A8.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6">XMPP服务器软件</a></li>
				<li id="n-.E5.8F.8B.E6.83.85.E9.93.BE.E6.8E.A5"><a href="/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5">友情链接</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform">
				<input type='hidden' name="title" value="特殊:搜索"/>
				<input type="search" name="search" title="在Jabber/XMPP中文翻译计划中搜索 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="提交" title="如果相同的标题存在的话便直接前往该页面" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="搜索" title="搜索含这些文字的页面" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>




<script src="http://yacy.jabbercn.org:8090/yacy/ui/js/jquery-1.3.2.min.js" type="text/javascript"></script>
<script>
   $(document).ready(function() {
      yconf = {
         url : 'http://yacy.jabbercn.org:8090/',
         theme : 'smoothness',
         title : 'XMPP搜索大全',
         logo     : 'http://yacy.jabbercn.org:8090/env/grafics/50-xmpp_logo.jpg',
         link     : 'http://wiki.jabbercn.org',
         urlmaskfilter : '.*',
         width : 500,
         height : 500
      };
      $.getScript(yconf.url+'/yacy/ui/js/yacyui-portalsearch.js', function(){});
   });
</script>
        <div id="p-search" class="portlet">
<h5>站外搜索</h5>
<div id="yacylivesearch" class="pBody">
   <form id="ysearch" method="get" accept-charset="UTF-8" action="http://yacy.jabbercn.org:8090/yacysearch.html">
      <input name="search" id="yquery" type="text" size="8" maxlength="80" value=""/>
      <input type="hidden" name="verify" value="false" />
      <input type="hidden" name="maximumRecords" value="10" />
      <input type="hidden" name="resource" value="local" />
      <input type="hidden" name="urlmaskfilter" value=".*" />
      <input type="hidden" name="prefermaskfilter" value="" />
      <input type="hidden" name="former" value="" />
      <input type="hidden" name="display" value="2" />
      <input type="hidden" name="nav" value="all" />
      <input type="submit" name="Enter" value="搜索" class="searchButton" />
   </form>
</div>
</div>



	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%85%A5%E9%A1%B5%E9%9D%A2/XEP-0060" title="所有链入本页的wiki页面列表 [j]" accesskey="j">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%87%BA%E6%9B%B4%E6%94%B9/XEP-0060" title="本页链入的页面的最近更改 [k]" accesskey="k">链出更改</a></li>
				<li id="t-specialpages"><a href="/%E7%89%B9%E6%AE%8A:%E7%89%B9%E6%AE%8A%E9%A1%B5%E9%9D%A2" title="所有特殊页面列表 [q]" accesskey="q">特殊页面</a></li>
				<li><a href="/index.php?title=XEP-0060&amp;printable=yes" rel="alternate">可打印版</a></li>
				<li id="t-permalink"><a href="/index.php?title=XEP-0060&amp;oldid=3400" title="本页面该修订版本的永久链接">永久链接</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0 Unported" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> 本页面最后修订于2013年8月9日 (星期五) 11:09。</li>
		<li id="viewcount">此页面已被浏览过57,654次。</li>
		<li id="copyright">本站全部文字内容使用<a class="external" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Attribution-Noncommercial-Share Alike 3.0 Unported</a>授权。</li>
		<li id="privacy"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E9%9A%90%E7%A7%81%E6%9D%83%E6%94%BF%E7%AD%96" title="Jabber/XMPP中文翻译计划:隐私权政策">隐私权政策</a></li>
		<li id="about"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%B3%E4%BA%8E" title="Jabber/XMPP中文翻译计划:关于">关于Jabber/XMPP中文翻译计划</a></li>
		<li id="disclaimer"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="Jabber/XMPP中文翻译计划:免责声明">免责声明</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax", "mediawiki.legacy.mwsuggest"]);
}
</script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"zh-cn","language":"zh-cn","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: mediawiki:resourceloader:filter:minify-js:4:42c4e9caefe8ca663d220ee0c286ac74 */
}
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://rtp.rooyee.im/piwik/" : "http://rtp.rooyee.im/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 5);
piwikTracker.setDocumentTitle("XEP-0060");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://rtp.rooyee.im/piwik/piwik.php?idsite=5" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.043 secs. --></body></html>