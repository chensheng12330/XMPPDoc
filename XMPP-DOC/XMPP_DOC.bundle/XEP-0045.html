<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="client-nojs">
<head>
<title>XEP-0045 - Jabber/XMPP中文翻译计划</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Jabber/XMPP中文翻译计划 (zh-cn)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.jabbercn.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Jabber/XMPP中文翻译计划的Atom" href="/index.php?title=%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9&amp;feed=atom" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=zh-cn&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: mediawiki:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */</style>
<script src="/load.php?debug=false&amp;lang=zh-cn&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "XEP-0045", "wgTitle": "XEP-0045", "wgCurRevisionId": 3565, "wgArticleId": 6, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": ["XMPP扩展", "已翻译"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": [], "wgSearchNamespaces": [0]});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
.source-xml {border: 1px dashed #2f6fab; color: black; background-color: #f9f9f9;}
.source-xml li, .source-xml pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for xml
 * CSS class: source-xml, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.source-xml .de1, .source-xml .de2 {font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;}
.source-xml  {font-family: monospace;}
.source-xml .imp {font-weight: bold; color: red;}
.source-xml li, .source-xml li.li1 {font-weight: normal;}
.source-xml li.li2 {font-weight: bold;}
.source-xml .co1 {color: #808080; font-style: italic;}
.source-xml .co2 {color: #404040; font-style: italic;}
.source-xml .co3 {color: #000000;}
.source-xml .co4 {color: #400000; font-weight: bold;}
.source-xml .es0 {color: #000099; font-weight: bold;}
.source-xml .br0 {color: #66cc66;}
.source-xml .sy0 {color: #66cc66;}
.source-xml .st0 {color: #ff0000;}
.source-xml .nu0 {color: #cc66cc;}
.source-xml .re0 {color: #000066;}
.source-xml .re1 {color: #000000; font-weight: bold;}
.source-xml .re2 {color: #000000; font-weight: bold;}
.source-xml .ln-xtra, .source-xml li.ln-xtra, .source-xml div.ln-xtra {background-color: #ffc;}
.source-xml span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-XEP-0045 action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">XEP-0045</h1>
	<div id="bodyContent">
		<div id="siteSub">来自Jabber/XMPP中文翻译计划</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">跳转到： <a href="#column-one">导航</a>, <a href="#searchInput">搜索</a></div>
		<!-- start content -->
<div lang="zh-cn" dir="ltr" class="mw-content-ltr"><p><br />
<b>本文的英文原文来自<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0045.html">XEP-0045</a></b>
</p><p><b>XEP-0045: 多用户聊天</b>
</p><p>摘要: 本文定义了一个XMPP协议扩展用于多用户文本会议.即多个XMPP可以在一个房间或频道互相交流信息, 类似互联网中继聊天系统(IRC).还有标准聊天室功能如聊天室的主题和邀请，本协议定义了一个强有力的房间控制模型，包括能够踢和禁止用户，任命主持人和管理员，要求会员或密码才能加入房间，等等。
</p><p>作者:	Peter Saint-Andre
</p><p>XMPP扩展协议的版权(1999-2008)归XMPP标准化基金会(XSF)所有
</p><p>版权:	© 1999 - 2010 XMPP标准化基金会(XSF). 参见<a href="/XEP-0045#.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A" title="XEP-0045">法律通告</a>.
</p><p>状态: 草案
</p><p>类型: 标准跟踪
</p><p>版本: 1.24
</p><p>最后更新日期: 2008-07-16
</p><p>注意: 这里定义的协议是XMPP标准化基金会的一个草案标准.对本协议的执行是被鼓励的,也适于部署到生产系统,但是在它成为最终标准之前可能还会有一些变动.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目录</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E7.BB.AA.E8.AE.BA"><span class="tocnumber">1</span> <span class="toctext">绪论</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E8.8C.83.E5.9B.B4"><span class="tocnumber">2</span> <span class="toctext">范围</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E9.9C.80.E6.B1.82"><span class="tocnumber">3</span> <span class="toctext">需求</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E6.9C.AF.E8.AF.AD"><span class="tocnumber">4</span> <span class="toctext">术语</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#.E9.80.9A.E7.94.A8.E6.9C.AF.E8.AF.AD"><span class="tocnumber">4.1</span> <span class="toctext">通用术语</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#.E6.88.BF.E9.97.B4.E7.B1.BB.E5.9E.8B"><span class="tocnumber">4.2</span> <span class="toctext">房间类型</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#.E7.99.BB.E5.9C.BA.E4.BA.BA.E7.89.A9"><span class="tocnumber">4.3</span> <span class="toctext">登场人物</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#.E8.A7.92.E8.89.B2.28Roles.29.EF.BC.8C.E5.B2.97.E4.BD.8D.28Affiliations.29.E5.92.8C.E6.9D.83.E9.99.90.28Privileges.29"><span class="tocnumber">5</span> <span class="toctext">角色(Roles)，岗位(Affiliations)和权限(Privileges)</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#.E8.A7.92.E8.89.B2"><span class="tocnumber">5.1</span> <span class="toctext">角色</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#.E6.9D.83.E9.99.90"><span class="tocnumber">5.1.1</span> <span class="toctext">权限</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#.E9.BB.98.E8.AE.A4.E8.A7.92.E8.89.B2"><span class="tocnumber">5.1.2</span> <span class="toctext">默认角色</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#.E5.8F.98.E6.9B.B4.E8.A7.92.E8.89.B2"><span class="tocnumber">5.1.3</span> <span class="toctext">变更角色</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="#.E5.B2.97.E4.BD.8D"><span class="tocnumber">5.2</span> <span class="toctext">岗位</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#.E6.9D.83.E9.99.90_2"><span class="tocnumber">5.2.1</span> <span class="toctext">权限</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#.E5.8F.98.E6.9B.B4.E5.B2.97.E4.BD.8D"><span class="tocnumber">5.2.2</span> <span class="toctext">变更岗位</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#.E5.AE.9E.E4.BD.93.E7.94.A8.E4.BE.8B"><span class="tocnumber">6</span> <span class="toctext">实体用例</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#MUC.E7.9A.84.E5.8F.91.E7.8E.B0.E7.BB.84.E4.BB.B6.E6.94.AF.E6.8C.81"><span class="tocnumber">6.1</span> <span class="toctext">MUC的发现组件支持</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#.E5.8F.91.E7.8E.B0.E6.88.BF.E9.97.B4"><span class="tocnumber">6.2</span> <span class="toctext">发现房间</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#.E6.9F.A5.E8.AF.A2.E6.88.BF.E9.97.B4.E4.BF.A1.E6.81.AF"><span class="tocnumber">6.3</span> <span class="toctext">查询房间信息</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#.E6.9F.A5.E8.AF.A2.E6.88.BF.E9.97.B4.E6.9D.A1.E7.9B.AE"><span class="tocnumber">6.4</span> <span class="toctext">查询房间条目</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#.E6.9F.A5.E8.AF.A2.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4.E7.9A.84.E6.88.BF.E5.AE.A2"><span class="tocnumber">6.5</span> <span class="toctext">查询一个房间的房客</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#.E5.8F.91.E7.8E.B0.E5.AE.A2.E6.88.B7.E7.AB.AF.E5.AF.B9MUC.E7.9A.84.E6.94.AF.E6.8C.81"><span class="tocnumber">6.6</span> <span class="toctext">发现客户端对MUC的支持</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23"><a href="#.E6.88.BF.E5.AE.A2.E7.94.A8.E4.BE.8B"><span class="tocnumber">7</span> <span class="toctext">房客用例</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#.E8.BF.9B.E5.85.A5.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1</span> <span class="toctext">进入一个房间</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="#Groupchat_1.0.E5.8D.8F.E8.AE.AE"><span class="tocnumber">7.1.1</span> <span class="toctext">Groupchat 1.0协议</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#.E5.9F.BA.E6.9C.ACMUC.E5.8D.8F.E8.AE.AE"><span class="tocnumber">7.1.2</span> <span class="toctext">基本MUC协议</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E5.B9.BF.E6.92.AD"><span class="tocnumber">7.1.3</span> <span class="toctext">出席信息广播</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#.E7.BC.BA.E7.9C.81.E8.A7.92.E8.89.B2"><span class="tocnumber">7.1.4</span> <span class="toctext">缺省角色</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#.E9.9D.9E.E5.8C.BF.E5.90.8D.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.5</span> <span class="toctext">非匿名房间</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#.E5.8D.8A.E5.8C.BF.E5.90.8D.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.6</span> <span class="toctext">半匿名房间</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#.E5.AF.86.E7.A0.81.E4.BF.9D.E6.8A.A4.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.7</span> <span class="toctext">密码保护房间</span></a></li>
<li class="toclevel-3 tocsection-32"><a href="#.E4.BB.85.E9.99.90.E4.BC.9A.E5.91.98.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.8</span> <span class="toctext">仅限会员房间</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#.E8.A2.AB.E7.A6.81.E6.AD.A2.E7.9A.84.E7.94.A8.E6.88.B7"><span class="tocnumber">7.1.9</span> <span class="toctext">被禁止的用户</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#.E6.98.B5.E7.A7.B0.E5.86.B2.E7.AA.81"><span class="tocnumber">7.1.10</span> <span class="toctext">昵称冲突</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="#.E6.9C.80.E5.A4.A7.E7.94.A8.E6.88.B7.E6.95.B0"><span class="tocnumber">7.1.11</span> <span class="toctext">最大用户数</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#.E9.94.81.E4.BD.8F.E7.9A.84.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.12</span> <span class="toctext">锁住的房间</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#.E4.B8.8D.E5.AD.98.E5.9C.A8.E7.9A.84.E6.88.BF.E9.97.B4"><span class="tocnumber">7.1.13</span> <span class="toctext">不存在的房间</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#.E6.88.BF.E9.97.B4.E8.AE.B0.E5.BD.95"><span class="tocnumber">7.1.14</span> <span class="toctext">房间记录</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#.E8.AE.A8.E8.AE.BA.E5.8E.86.E5.8F.B2"><span class="tocnumber">7.1.15</span> <span class="toctext">讨论历史</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="#.E7.AE.A1.E7.90.86.E8.AE.A8.E8.AE.BA.E5.8E.86.E5.8F.B2"><span class="tocnumber">7.1.16</span> <span class="toctext">管理讨论历史</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#.E9.80.80.E5.87.BA.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4"><span class="tocnumber">7.2</span> <span class="toctext">退出一个房间</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#.E6.9B.B4.E6.94.B9.E6.98.B5.E7.A7.B0"><span class="tocnumber">7.3</span> <span class="toctext">更改昵称</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#.E6.9B.B4.E6.94.B9.E5.8F.AF.E7.94.A8.E6.80.A7.E7.8A.B6.E6.80.81"><span class="tocnumber">7.4</span> <span class="toctext">更改可用性状态</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#.E9.82.80.E8.AF.B7.E5.85.B6.E4.BB.96.E7.94.A8.E6.88.B7.E8.BF.9B.E5.85.A5.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4"><span class="tocnumber">7.5</span> <span class="toctext">邀请其他用户进入一个房间</span></a>
<ul>
<li class="toclevel-3 tocsection-45"><a href="#.E7.9B.B4.E6.8E.A5.E9.82.80.E8.AF.B7"><span class="tocnumber">7.5.1</span> <span class="toctext">直接邀请</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#.E9.97.B4.E6.8E.A5.E9.82.80.E8.AF.B7"><span class="tocnumber">7.5.2</span> <span class="toctext">间接邀请</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-47"><a href="#.E6.8A.8A.E4.B8.80.E5.AF.B9.E4.B8.80.E8.81.8A.E5.A4.A9.E8.BD.AC.E4.B8.BA.E5.A4.9A.E7.94.A8.E6.88.B7.E4.BC.9A.E8.AE.AE"><span class="tocnumber">7.6</span> <span class="toctext">把一对一聊天转为多用户会议</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#.E6.88.BF.E5.AE.A2.E4.BF.AE.E6.94.B9.E6.88.BF.E9.97.B4.E6.A0.87.E9.A2.98"><span class="tocnumber">7.7</span> <span class="toctext">房客修改房间标题</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#.E5.8F.91.E9.80.81.E7.A7.81.E6.9C.89.E6.B6.88.E6.81.AF"><span class="tocnumber">7.8</span> <span class="toctext">发送私有消息</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#.E5.8F.91.E9.80.81.E6.B6.88.E6.81.AF.E7.BB.99.E6.89.80.E6.9C.89.E6.88.BF.E5.AE.A2"><span class="tocnumber">7.9</span> <span class="toctext">发送消息给所有房客</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#.E6.B3.A8.E5.86.8C.E5.88.B0.E6.88.BF.E9.97.B4"><span class="tocnumber">7.10</span> <span class="toctext">注册到房间</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#.E8.8E.B7.E5.8F.96.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8"><span class="tocnumber">7.11</span> <span class="toctext">获取成员列表</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#.E5.8F.91.E7.8E.B0.E4.BF.9D.E7.95.99.E7.9A.84.E6.88.BF.E9.97.B4.E6.98.B5.E7.A7.B0"><span class="tocnumber">7.12</span> <span class="toctext">发现保留的房间昵称</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#.E7.94.B3.E8.AF.B7.E5.8F.91.E8.A8.80.E6.9D.83"><span class="tocnumber">7.13</span> <span class="toctext">申请发言权</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-55"><a href="#.E4.B8.BB.E6.8C.81.E4.BA.BA.E7.94.A8.E4.BE.8B"><span class="tocnumber">8</span> <span class="toctext">主持人用例</span></a>
<ul>
<li class="toclevel-2 tocsection-56"><a href="#.E4.BF.AE.E6.94.B9.E6.88.BF.E9.97.B4.E4.B8.BB.E9.A2.98"><span class="tocnumber">8.1</span> <span class="toctext">修改房间主题</span></a></li>
<li class="toclevel-2 tocsection-57"><a href="#.E8.B8.A2.E5.87.BA.E6.88.BF.E5.AE.A2"><span class="tocnumber">8.2</span> <span class="toctext">踢出房客</span></a></li>
<li class="toclevel-2 tocsection-58"><a href="#.E6.8E.88.E4.BA.88.E6.B8.B8.E5.AE.A2.E5.8F.91.E8.A8.80.E6.9D.83"><span class="tocnumber">8.3</span> <span class="toctext">授予游客发言权</span></a></li>
<li class="toclevel-2 tocsection-59"><a href="#.E6.92.A4.E9.94.80.E4.B8.8E.E4.BC.9A.E8.80.85.E5.8F.91.E8.A8.80.E6.9D.83"><span class="tocnumber">8.4</span> <span class="toctext">撤销与会者发言权</span></a></li>
<li class="toclevel-2 tocsection-60"><a href="#.E4.BF.AE.E6.94.B9.E5.8F.91.E8.A8.80.E6.9D.83.E5.88.97.E8.A1.A8"><span class="tocnumber">8.5</span> <span class="toctext">修改发言权列表</span></a></li>
<li class="toclevel-2 tocsection-61"><a href="#.E6.89.B9.E5.87.86.E5.8F.91.E8.A8.80.E6.9D.83.E7.94.B3.E8.AF.B7"><span class="tocnumber">8.6</span> <span class="toctext">批准发言权申请</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-62"><a href="#.E7.AE.A1.E7.90.86.E5.91.98.E7.94.A8.E4.BE.8B"><span class="tocnumber">9</span> <span class="toctext">管理员用例</span></a>
<ul>
<li class="toclevel-2 tocsection-63"><a href="#.E7.A6.81.E6.AD.A2.E7.94.A8.E6.88.B7"><span class="tocnumber">9.1</span> <span class="toctext">禁止用户</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#.E4.BF.AE.E6.94.B9.E9.BB.91.E5.90.8D.E5.8D.95"><span class="tocnumber">9.2</span> <span class="toctext">修改黑名单</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#.E6.8E.88.E4.BA.88.E6.88.90.E5.91.98.E8.B5.84.E6.A0.BC"><span class="tocnumber">9.3</span> <span class="toctext">授予成员资格</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#.E6.92.A4.E9.94.80.E6.88.90.E5.91.98.E8.B5.84.E6.A0.BC"><span class="tocnumber">9.4</span> <span class="toctext">撤销成员资格</span></a></li>
<li class="toclevel-2 tocsection-67"><a href="#.E4.BF.AE.E6.94.B9.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8"><span class="tocnumber">9.5</span> <span class="toctext">修改成员列表</span></a></li>
<li class="toclevel-2 tocsection-68"><a href="#.E6.8E.88.E4.BA.88.E4.B8.BB.E6.8C.81.E4.BA.BA.E6.9D.83.E9.99.90"><span class="tocnumber">9.6</span> <span class="toctext">授予主持人权限</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#.E6.92.A4.E9.94.80.E4.B8.BB.E6.8C.81.E4.BA.BA.E6.9D.83.E9.99.90"><span class="tocnumber">9.7</span> <span class="toctext">撤销主持人权限</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#.E4.BF.AE.E6.94.B9.E4.B8.BB.E6.8C.81.E4.BA.BA.E5.88.97.E8.A1.A8"><span class="tocnumber">9.8</span> <span class="toctext">修改主持人列表</span></a></li>
<li class="toclevel-2 tocsection-71"><a href="#.E6.89.B9.E5.87.86.E6.B3.A8.E5.86.8C.E7.94.B3.E8.AF.B7"><span class="tocnumber">9.9</span> <span class="toctext">批准注册申请</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-72"><a href="#.E6.89.80.E6.9C.89.E8.80.85.E7.94.A8.E4.BE.8B"><span class="tocnumber">10</span> <span class="toctext">所有者用例</span></a>
<ul>
<li class="toclevel-2 tocsection-73"><a href="#.E6.96.B0.E5.BB.BA.E6.88.BF.E9.97.B4"><span class="tocnumber">10.1</span> <span class="toctext">新建房间</span></a>
<ul>
<li class="toclevel-3 tocsection-74"><a href="#.E4.B8.80.E8.88.AC.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9"><span class="tocnumber">10.1.1</span> <span class="toctext">一般注意事项</span></a></li>
<li class="toclevel-3 tocsection-75"><a href="#.E6.96.B0.E5.BB.BA.E5.8D.B3.E6.97.B6.E6.88.BF.E9.97.B4"><span class="tocnumber">10.1.2</span> <span class="toctext">新建即时房间</span></a></li>
<li class="toclevel-3 tocsection-76"><a href="#.E6.96.B0.E5.BB.BA.E4.BF.9D.E7.95.99.E6.88.BF.E9.97.B4"><span class="tocnumber">10.1.3</span> <span class="toctext">新建保留房间</span></a></li>
<li class="toclevel-3 tocsection-77"><a href="#.E7.94.B3.E8.AF.B7.E5.94.AF.E4.B8.80.E6.88.BF.E9.97.B4.E5.90.8D"><span class="tocnumber">10.1.4</span> <span class="toctext">申请唯一房间名</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-78"><a href="#.E9.9A.8F.E5.90.8E.E7.9A.84.E6.88.BF.E9.97.B4.E9.85.8D.E7.BD.AE"><span class="tocnumber">10.2</span> <span class="toctext">随后的房间配置</span></a>
<ul>
<li class="toclevel-3 tocsection-79"><a href="#.E9.85.8D.E7.BD.AE.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5"><span class="tocnumber">10.2.1</span> <span class="toctext">配置变更通知</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-80"><a href="#.E6.8E.88.E4.BA.88.E6.89.80.E6.9C.89.E8.80.85.E6.9D.83.E9.99.90"><span class="tocnumber">10.3</span> <span class="toctext">授予所有者权限</span></a></li>
<li class="toclevel-2 tocsection-81"><a href="#.E6.92.A4.E9.94.80.E6.89.80.E6.9C.89.E8.80.85.E6.9D.83.E9.99.90"><span class="tocnumber">10.4</span> <span class="toctext">撤销所有者权限</span></a></li>
<li class="toclevel-2 tocsection-82"><a href="#.E4.BF.AE.E6.94.B9.E6.89.80.E6.9C.89.E8.80.85.E5.88.97.E8.A1.A8"><span class="tocnumber">10.5</span> <span class="toctext">修改所有者列表</span></a></li>
<li class="toclevel-2 tocsection-83"><a href="#.E6.8E.88.E4.BA.88.E7.AE.A1.E7.90.86.E5.91.98.E6.9D.83.E9.99.90"><span class="tocnumber">10.6</span> <span class="toctext">授予管理员权限</span></a></li>
<li class="toclevel-2 tocsection-84"><a href="#.E6.92.A4.E9.94.80.E7.AE.A1.E7.90.86.E5.91.98.E6.9D.83.E9.99.90"><span class="tocnumber">10.7</span> <span class="toctext">撤销管理员权限</span></a></li>
<li class="toclevel-2 tocsection-85"><a href="#.E4.BF.AE.E6.94.B9.E7.AE.A1.E7.90.86.E5.91.98.E5.88.97.E8.A1.A8"><span class="tocnumber">10.8</span> <span class="toctext">修改管理员列表</span></a></li>
<li class="toclevel-2 tocsection-86"><a href="#.E9.94.80.E6.AF.81.E6.88.BF.E9.97.B4"><span class="tocnumber">10.9</span> <span class="toctext">销毁房间</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-87"><a href="#.E9.94.99.E8.AF.AF.E5.92.8C.E7.8A.B6.E6.80.81.E7.A0.81"><span class="tocnumber">11</span> <span class="toctext">错误和状态码</span></a>
<ul>
<li class="toclevel-2 tocsection-88"><a href="#.E9.94.99.E8.AF.AF.E7.A0.81"><span class="tocnumber">11.1</span> <span class="toctext">错误码</span></a></li>
<li class="toclevel-2 tocsection-89"><a href="#.E7.8A.B6.E6.80.81.E7.A0.81"><span class="tocnumber">11.2</span> <span class="toctext">状态码</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-90"><a href="#.E5.9B.BD.E9.99.85.E5.8C.96.E4.BA.8B.E9.A1.B9"><span class="tocnumber">12</span> <span class="toctext">国际化事项</span></a></li>
<li class="toclevel-1 tocsection-91"><a href="#.E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9"><span class="tocnumber">13</span> <span class="toctext">安全事项</span></a>
<ul>
<li class="toclevel-2 tocsection-92"><a href="#.E7.94.A8.E6.88.B7.E9.AA.8C.E8.AF.81.E5.92.8C.E6.8E.88.E6.9D.83"><span class="tocnumber">13.1</span> <span class="toctext">用户验证和授权</span></a></li>
<li class="toclevel-2 tocsection-93"><a href="#.E7.AB.AF.E5.88.B0.E7.AB.AF.E5.8A.A0.E5.AF.86"><span class="tocnumber">13.2</span> <span class="toctext">端到端加密</span></a></li>
<li class="toclevel-2 tocsection-94"><a href="#.E9.9A.90.E7.A7.81"><span class="tocnumber">13.3</span> <span class="toctext">隐私</span></a></li>
<li class="toclevel-2 tocsection-95"><a href="#.E5.8C.BF.E5.90.8D"><span class="tocnumber">13.4</span> <span class="toctext">匿名</span></a></li>
<li class="toclevel-2 tocsection-96"><a href="#.E6.8B.92.E7.BB.9D.E6.9C.8D.E5.8A.A1"><span class="tocnumber">13.5</span> <span class="toctext">拒绝服务</span></a></li>
<li class="toclevel-2 tocsection-97"><a href="#.E5.85.B6.E5.AE.83.E4.BA.8B.E9.A1.B9"><span class="tocnumber">13.6</span> <span class="toctext">其它事项</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-98"><a href="#IANA.E4.BA.8B.E9.A1.B9"><span class="tocnumber">14</span> <span class="toctext">IANA事项</span></a></li>
<li class="toclevel-1 tocsection-99"><a href="#XMPP.E7.99.BB.E8.AE.B0.E4.BA.8B.E9.A1.B9"><span class="tocnumber">15</span> <span class="toctext">XMPP登记事项</span></a>
<ul>
<li class="toclevel-2 tocsection-100"><a href="#.E5.8D.8F.E8.AE.AE.E5.90.8D.E5.AD.97.E7.A9.BA.E9.97.B4"><span class="tocnumber">15.1</span> <span class="toctext">协议名字空间</span></a></li>
<li class="toclevel-2 tocsection-101"><a href="#.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E7.A7.8D.E7.B1.BB.2F.E7.B1.BB.E5.9E.8B"><span class="tocnumber">15.2</span> <span class="toctext">服务发现种类/类型</span></a></li>
<li class="toclevel-2 tocsection-102"><a href="#.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E7.89.B9.E6.80.A7"><span class="tocnumber">15.3</span> <span class="toctext">服务发现特性</span></a></li>
<li class="toclevel-2 tocsection-103"><a href="#.E7.9F.A5.E5.90.8D.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E8.8A.82.E7.82.B9"><span class="tocnumber">15.4</span> <span class="toctext">知名服务发现节点</span></a></li>
<li class="toclevel-2 tocsection-104"><a href="#.E5.AD.97.E6.AE.B5.E6.A0.87.E5.87.86.E5.8C.96"><span class="tocnumber">15.5</span> <span class="toctext">字段标准化</span></a>
<ul>
<li class="toclevel-3 tocsection-105"><a href="#muc.23register_FORM_TYPE"><span class="tocnumber">15.5.1</span> <span class="toctext">muc#register FORM_TYPE</span></a></li>
<li class="toclevel-3 tocsection-106"><a href="#muc.23request_FORM_TYPE"><span class="tocnumber">15.5.2</span> <span class="toctext">muc#request FORM_TYPE</span></a></li>
<li class="toclevel-3 tocsection-107"><a href="#muc.23roomconfig_FORM_TYPE"><span class="tocnumber">15.5.3</span> <span class="toctext">muc#roomconfig FORM_TYPE</span></a></li>
<li class="toclevel-3 tocsection-108"><a href="#muc.23roominfo_FORM_TYPE"><span class="tocnumber">15.5.4</span> <span class="toctext">muc#roominfo FORM_TYPE</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-109"><a href="#.E7.8A.B6.E6.80.81.E7.A0.81.E7.99.BB.E8.AE.B0.E5.A4.84"><span class="tocnumber">15.6</span> <span class="toctext">状态码登记处</span></a>
<ul>
<li class="toclevel-3 tocsection-110"><a href="#.E8.BF.87.E7.A8.8B"><span class="tocnumber">15.6.1</span> <span class="toctext">过程</span></a></li>
<li class="toclevel-3 tocsection-111"><a href="#.E5.88.9D.E5.A7.8B.E6.8F.90.E4.BA.A4"><span class="tocnumber">15.6.2</span> <span class="toctext">初始提交</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-112"><a href="#URI.E6.9F.A5.E8.AF.A2.E7.B1.BB.E5.9E.8B"><span class="tocnumber">15.7</span> <span class="toctext">URI查询类型</span></a>
<ul>
<li class="toclevel-3 tocsection-113"><a href="#join"><span class="tocnumber">15.7.1</span> <span class="toctext">join</span></a></li>
<li class="toclevel-3 tocsection-114"><a href="#invite"><span class="tocnumber">15.7.2</span> <span class="toctext">invite</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-115"><a href="#.E5.95.86.E4.B8.9A.E8.A7.84.E5.88.99"><span class="tocnumber">16</span> <span class="toctext">商业规则</span></a>
<ul>
<li class="toclevel-2 tocsection-116"><a href="#Addresses"><span class="tocnumber">16.1</span> <span class="toctext">Addresses</span></a></li>
<li class="toclevel-2 tocsection-117"><a href="#Message"><span class="tocnumber">16.2</span> <span class="toctext">Message</span></a></li>
<li class="toclevel-2 tocsection-118"><a href="#Presence"><span class="tocnumber">16.3</span> <span class="toctext">Presence</span></a></li>
<li class="toclevel-2 tocsection-119"><a href="#IQ"><span class="tocnumber">16.4</span> <span class="toctext">IQ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-120"><a href="#.E5.AE.9E.E7.8E.B0.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9"><span class="tocnumber">17</span> <span class="toctext">实现注意事项</span></a>
<ul>
<li class="toclevel-2 tocsection-121"><a href="#.E6.9C.8D.E5.8A.A1.E7.AB.AF"><span class="tocnumber">17.1</span> <span class="toctext">服务端</span></a>
<ul>
<li class="toclevel-3 tocsection-122"><a href="#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF"><span class="tocnumber">17.1.1</span> <span class="toctext">允许的通讯</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-123"><a href="#.E5.AE.A2.E6.88.B7.E7.AB.AF"><span class="tocnumber">17.2</span> <span class="toctext">客户端</span></a>
<ul>
<li class="toclevel-3 tocsection-124"><a href="#IRC.E5.91.BD.E4.BB.A4.E6.98.A0.E5.B0.84"><span class="tocnumber">17.2.1</span> <span class="toctext">IRC命令映射</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-125"><a href="#XML.E6.9E.B6.E6.9E.84"><span class="tocnumber">18</span> <span class="toctext">XML架构</span></a>
<ul>
<li class="toclevel-2 tocsection-126"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fmuc"><span class="tocnumber">18.1</span> <span class="toctext">http://jabber.org/protocol/muc</span></a></li>
<li class="toclevel-2 tocsection-127"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23user"><span class="tocnumber">18.2</span> <span class="toctext">http://jabber.org/protocol/muc#user</span></a></li>
<li class="toclevel-2 tocsection-128"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23admin"><span class="tocnumber">18.3</span> <span class="toctext">http://jabber.org/protocol/muc#admin</span></a></li>
<li class="toclevel-2 tocsection-129"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23owner"><span class="tocnumber">18.4</span> <span class="toctext">http://jabber.org/protocol/muc#owner</span></a></li>
<li class="toclevel-2 tocsection-130"><a href="#http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23unique"><span class="tocnumber">18.5</span> <span class="toctext">http://jabber.org/protocol/muc#unique</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-131"><a href="#.E9.B8.A3.E8.B0.A2"><span class="tocnumber">19</span> <span class="toctext">鸣谢</span></a></li>
<li class="toclevel-1 tocsection-132"><a href="#.E9.99.84.E5.BD.95"><span class="tocnumber">20</span> <span class="toctext">附录</span></a>
<ul>
<li class="toclevel-2 tocsection-133"><a href="#.E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF"><span class="tocnumber">20.1</span> <span class="toctext">附录A:文档信息</span></a></li>
<li class="toclevel-2 tocsection-134"><a href="#.E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF"><span class="tocnumber">20.2</span> <span class="toctext">附录B:作者信息</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A"><span class="tocnumber">20.3</span> <span class="toctext">附录C:法律通告</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB"><span class="tocnumber">20.4</span> <span class="toctext">附录D:和XMPP的关系</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9"><span class="tocnumber">20.5</span> <span class="toctext">附录E:讨论地点</span></a></li>
<li class="toclevel-2"><a href="#.E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7"><span class="tocnumber">20.6</span> <span class="toctext">附录F:需求一致性</span></a></li>
<li class="toclevel-2 tocsection-135"><a href="#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8"><span class="tocnumber">20.7</span> <span class="toctext">附录G:备注</span></a></li>
<li class="toclevel-2 tocsection-136"><a href="#.E9.99.84.E5.BD.95H:_.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2"><span class="tocnumber">20.8</span> <span class="toctext">附录H: 修订历史</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id=".E7.BB.AA.E8.AE.BA">绪论</span></h2>
<p>传统上, 即时消息被视为由一对一的聊天构成而不是多对多聊天(即所谓"群聊"或"文本会议"). 群聊功能常见于一些系统如 Internet Relay Chat (IRC) 和 流行的IM服务所提供的聊天室功能. Jabber社区早在1999年开发和实施了一个基本的群聊协议. 这个 "groupchat 1.0" 协议为聊天室提供了一个最小功能集但是范围很有限. 本协议(多用户聊天或简称MUC)建立在向后兼容旧的"groupchat 1.0"协议的基础上但是提供高级功能如邀请, 房间主持和管理, 以及专门的房间类型.
</p>
<h2> <span class="mw-headline" id=".E8.8C.83.E5.9B.B4">范围</span></h2>
<p>本文着重于和配置,参与以及管理一个独立的基于文本的会议室相关的通用需求. 这里所指出的需求是应用于单个房间级别的并且是"通用的", 某种意义上它们是在Jabber社区广泛讨论的或在现有的Jabber之外的基于文本的会议环境(例如, 定义在 <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc1459">RFC 1459</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">1</a>中的Internet Relay Chat 和它的继承者: <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc2810">RFC 2810</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">2</a>, <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc2811">RFC 2811</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">3</a>, <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc2812">RFC 2812</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">4</a>, <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc2813">RFC 2813</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">5</a>)中已经存在的.
</p><p>本文明确地不涉及以下需求:
</p>
<ul><li> 房间之间的关系(例如, 房间的层次结构)
</li></ul>
<ul><li> 多用户聊天服务的管理(例如, 管理跨越整个服务级别的权限或注册一个全局可用的房间昵称)；这些用例定义在<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0133.html">Service Administration</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">6</a>
</li></ul>
<ul><li> 个别消息的主持
</li></ul>
<ul><li> 通过房间发送的消息的加密
</li></ul>
<ul><li> 高级特性, 如附加文件给一个房间, 集成白板, 以及和语音或视频聊天服务的接口
</li></ul>
<ul><li> MUC部署和外来的聊天系统(例如, 和IRC网关或现有的其他IM系统)之间的交互
</li></ul>
<ul><li> 在多个MUC部署之间进行镜像或复制
</li></ul>
<p>这一受限的范围并非蔑视这些都很有用的主题; 无论如何, 这意味着本文专注于讨论和介绍一个易于理解的协议能够被类似的Jabber客户端和组件开发者实现. 将来的协议当然可能涉及以上提到的这些主题.
</p>
<h2> <span class="mw-headline" id=".E9.9C.80.E6.B1.82">需求</span></h2>
<p>本文描述了由Jabber现有的多用户聊天服务提供的最小功能集. 为了向后兼容性起见, 本文使用原来的"groupchat 1.0"协议作为基本功能, 包括以下这些:
</p>
<ul><li> 每个房间被标识为 &lt;room@service&gt; (例如, &lt;jdev@conference.jabber.org&gt;), 这里 "room" 是房间的名称而 "service" 是多用户聊天服务运行所在的主机名.
</li></ul>
<ul><li> 在一个房间里每个房客被标识为 &lt;room@service/nick&gt;, 这里 "nick" 是这个房客在这个房间里的昵称,定义于刚加入这个房间的时候，也可以在房客驻留改房间期间修改.
</li></ul>
<ul><li> 一个用户通过发送出席信息给 &lt;room@service/nick&gt; 来加入一个房间（也就是成为房客）.
</li></ul>
<ul><li> 在多用户聊天房间里发送的消息使用特殊的类型"groupchat"并且被寻址于房间本身 (room@service), 然后反映给所有房客.
</li></ul>
<ul><li> 通过发送出席信息给 &lt;room@service/newnick&gt;，一个房客可以改变他或她的房间昵称以及在房间中的可用性状态 .
</li></ul>
<ul><li> 通过发送一个类型为"unavailable"的出席信息给当前的&lt;room@service/nick&gt;，一个房客可以退出房间.
</li></ul>
<p>本文追加的特性和功能包括以下这些:
</p>
<ol><li> 本地会话日志(不需要房间内的机器人)
</li><li> 允许用户申请房间成员
</li><li> 在一个非匿名房间里, 允许房客可以察看(另)一个房客的全JID
</li><li> 在一个半匿名房间里, 允许主持人可以察看一个房客的全JID
</li><li> 允许只有主持人修改房间主题
</li><li> 允许主持人从房间里踢出与会者和游客
</li><li> 在一个被主持的房间里,主持人可以授予和撤销发言权(也就是说, 发言的权力), 并且管理发言权列表
</li><li> 允许管理员授权和取消主持人权力, 并且管理主持人列表
</li><li> 允许管理员在房间禁止用户, 并管理黑名单
</li><li> 允许管理员授予和撤销成员权力, 并且管理一个仅限成员的房间的成员列表
</li><li> 允许所有者限制房客的数量
</li><li> 允许所有者指定其他的所有者(们)
</li><li> 允许所有者授予或撤销管理特权, 并管理管理员列表
</li><li> 允许所有者销毁房间
</li></ol>
<p>另外, 本文提供了协议元素用于支持以下房间类型:
</p>
<ol><li> 公共的或隐藏的
</li><li> 持久的或临时的
</li><li> 密码保护的或不安全的
</li><li> 仅限成员的或开放的
</li><li> 主持的或非主持的
</li><li> 非匿名的或半匿名的
</li></ol>
<p>为了实现这些需求, 本扩展协议需要满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间(以及 在主名字空间URI加上 #owner, #admin, 和 #user 片断).
</p>
<h2> <span class="mw-headline" id=".E6.9C.AF.E8.AF.AD">术语</span></h2>
<h3> <span class="mw-headline" id=".E9.80.9A.E7.94.A8.E6.9C.AF.E8.AF.AD">通用术语</span></h3>
<p>Affiliation(岗位) -- 一个长期存在的和房间之间的联系或连接; 可能的岗位有 "owner"(所有者), "admin"(管理者), "member"(成员), 以及 "outcast"(被排斥者) (当然也可能没有岗位); 岗位(affiliation)和角色(role)是有区别的. 一个岗位跨越了用户对一个房间的访问期间.
</p><p>Ban(禁止) -- 从一个房间移除一个用户以使这个用户不能够再进入这个房间 (直到这个禁令被废除为止). 一个被禁止的用户的岗位(affiliation)为 "outcast"(被排斥者).
</p><p>Bare JID(纯JID) -- 一个用户的标识符 &lt;user@host&gt;, 不同于任何已有会话或资源的上下文, 与之相对的是全JID和房间JID.
</p><p>Full JID(全JID) -- 一个在线用户的标识符 &lt;user@host/resource&gt; , 不同于一个房间的上下文; 与之相对的是纯JID和房间JID.
</p><p>GC -- 最小的 "groupchat 1.0" 协议[7], Jabber社区于1999年开发; MUC 向后兼容GC.
</p><p>History(历史) -- 有限数量的消息节, 由当前讨论的上下文提供发送给一个新的房客.
</p><p>Invitation(邀请) -- 从一个用户发出的特殊消息给另一个用户, 邀请对方加入房间.; the invitation can be sent directly (see Direct MUC Invitations [8]) or mediated through the room (as described under Inviting Another User to a Room).
</p><p>IRC -- Internet Relay Chat.
</p><p>Kick(踢人) -- 临时从一个房间移除一个与会者或游客; 这个用户任何时候都可以再次进入这个房间. 一个被踢的用户的角色是"none".
</p><p>Logging(记录) -- 存储发生在一个房间的讨论内容用于公开发布到房间上下文之外的地方.
</p><p>Member(成员) -- 一个用户在一个仅限会员的房间内处于"white list"(白名单)内，或已经注册到一个公开的房间. 一个成员的岗位是"member".
</p><p>Moderator(主持人) -- 一个房间角色,通常和房间的管理有关但是这个角色可以被赋予非管理员; 可以踢人, 可以授予和撤销发言权, 等等. 一个主持人的角色是"moderator".
</p><p>MUC -- 本文所定义的基于文本会议的多用户聊天协议.
</p><p>Occupant(房客) -- 一个房间里的任何Jabber用户 (这是一个 "抽象类" 并且不对应任何特定的角色).
</p><p>Occupant JID(房客JID) -- 在一个房间上下文中的一个房客，以 &lt;room@service/nick&gt; 来标识; 与之相对的是纯JID和全JID.
</p><p>Outcast(被排斥者) -- 一个被某个房间禁止的用户. 一个被排斥者的岗位是 "outcast".
</p><p>Participant(与会者) -- 一个没有管理权限的房客; 在一个被主持的房间里, 参与者更多地被定义为有发言权的 (与之相反的是游客). 一个与会者的角色是"participant".
</p><p>Private Message(私有消息) -- 从一个房客直接发给另一个房间JID的消息(不是房间本身广播给所有房客的消息).
</p><p>Role(角色) -- 在一个房间里的一个临时的地位或者权限级别, 对于这个房间中的用户的长期岗位来说是唯一的; 可能的角色有 "moderator"（主持人）, "participant"(与会者), 和 "visitor"(游客) (也可能没有预定义的角色). 一个角色仅仅存在于一个房客访问一个房间的期间.
</p><p>Room(房间) -- 一个虚拟的地方, Jabber用户象征性地加入它, 来和其他用户一起参与一个实时的基于文本的会议.
</p><p>Room Administrator(房间管理员) -- 一个由房间所有者授权的用户, 可以执行管理功能, 如禁止用户等等; 无论如何, 不允许改变定义的房间特性. 一个管理员的岗位是"admin" .
</p><p>Room ID(房间ID) -- 一个房间JID的节点标识符部分, 它可以是不透明的因而对人类用户没有什么含义(见  语法的商业规则Business Rules for syntax); 与之相对的是房间名.
</p><p>Room JID(房间JID) -- 房间地址，如 &lt;room@service&gt; 
</p><p>Room Name(房间名) -- 一个用户友好的, 自然语言的房间名字, 由房间所有者配置并在服务查询中展示; 与之相对的是房间ID.
</p><p>Room Nickname(房间昵称) -- 房间JID的资源标识符部分(见语法的商业规则); 这是一个房客在这个房间中所呈现的"友好的名字".
</p><p>Room Owner(房间所有者) -- 建立某个房间的Jabber用户或一个被房间创建者或所有者指派拥有所有者权限(如果允许的话)的Jabber用户; 它被允许改变定义好的房间特性, 也可以执行全部的管理功能. 一个所有者的岗位为"owner".
</p><p>Room Roster(房间名册) -- 一个房间中的所有房客在一个Jabber客户端的展现.
</p><p>Server(服务器) -- 一个Jabber服务器，可以关联或不关联一个基于文本的会议服务.
</p><p>Service(服务) -- 一个主机, 提供基于文本的会议的能力; 通常但不必须是一个Jabber服务器的子域(例如, conference.jabber.org).
</p><p>Subject(主题) -- 一个房间的临时讨论标题.
</p><p>Visit(访问) -- 一个房间的一个用户的"session"(会话), 当用户进入这个房间时开始(也就是说, 成为一个房客) , 结束于用户离开房间之时.
</p><p>Visitor(游客) -- 在一个被主持的房间里的一个没有发言权的房客(相反则是一个与会者). 一个游客的角色是"visitor".
</p><p>Voice(发言权) -- 在一个被主持的房间里, 发送消息给全部房客的权限.
</p>
<h3> <span class="mw-headline" id=".E6.88.BF.E9.97.B4.E7.B1.BB.E5.9E.8B">房间类型</span></h3>
<p>Hidden Room(隐藏房间) -- 一个无法被任何用户以普通方法如搜索和服务查询来发现的房间; 反义词: 公开(public)房间.
</p><p>Members-Only Room(仅限会员的房间) -- 如果一个用户不在成员列表中则无法加入的一个房间; 反义词: 开放(open)房间.
</p><p>Moderated Room(被主持的房间) -- 只有有"发言权"的用户才可以发送消息给所有房客的房间; 反义词: 非主持的(Unmoderated)房间.
</p><p>Non-Anonymous Room(非匿名房间) -- 一个房客的全JID会暴露给所有其他房客的房间, 尽管房客可以选择任何期望的房间昵称; 相对的是半匿名(Semi-Anonymous)房间.
</p><p>Open Room(开放房间) -- 任何人可以加入而不需要在成员列表中的房间; 反义词: 仅限会员的房间.
</p><p>Password-Protected Room(密码保护房间) -- 一个用户必须提供正确密码才能加入的房间; 反义词: 非保密房间.
</p><p>Persistent Room(持久房间) -- 如果最后一个房客退出也不会被销毁的房间; 反义词: 临时房间.
</p><p>Public Room(公开房间) -- 用户可以通过普通方法如搜索和服务查询来发现的房间; 反义词: 隐藏房间.
</p><p>Semi-Anonymous Room(半匿名房间) -- 一个房客的全JID只能被房间管理员发现的房间; 相对的是非匿名(Non-Anonymous)房间.
</p><p>Temporary Room(临时房间) -- 如果最后一个房客退出就会被销毁的房间; 反义词: 持久房间.
</p><p>Unmoderated Room(非主持的房间) -- 任何房客都被允许发送消息给所有房客的房间; 反义词: 被主持的房间.
</p><p>Unsecured Room(非保密房间) -- 任何人不需要提供密码就可以进入的房间; 反义词: 密码保护房间.
</p>
<h3> <span class="mw-headline" id=".E7.99.BB.E5.9C.BA.E4.BA.BA.E7.89.A9">登场人物</span></h3>
<p>本文的大部分例子使用了莎士比亚的《麦克白》中第四幕第一场开头女巫在黑洞中开会的场景，在这里使用"coven@chat.shakespeare.lit"代表聊天室. 人物如下:
</p><p><b>表1: 剧中人</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>Room Nickname </th>
<th>Full JID</th>
<th>Affiliation
</th></tr>
<tr>
<td>firstwitch </td>
<td>crone1@shakespeare.lit/desktop </td>
<td>Owner
</td></tr>
<tr>
<td>secondwitch </td>
<td>wiccarocks@shakespeare.lit/laptop </td>
<td>Admin
</td></tr>
<tr>
<td>thirdwitch </td>
<td>hag66@shakespeare.lit/pda </td>
<td>None
</td></tr></table>
<h2> <span class="mw-headline" id=".E8.A7.92.E8.89.B2.28Roles.29.EF.BC.8C.E5.B2.97.E4.BD.8D.28Affiliations.29.E5.92.8C.E6.9D.83.E9.99.90.28Privileges.29">角色(Roles)，岗位(Affiliations)和权限(Privileges)</span></h2>
<p>A user might be allowed to perform any number of actions in a room, from joining or sending a message to changing configuration options or destroying the room altogether. We call each permitted action a "privilege". There are two ways we might structure privileges:
</p><p>1. Define each privilege atomically and explicitly define each user's particular privileges; this is flexible but can be confusing to manage.
</p><p>2. Define bundles of privileges that are generally applicable and assign a user-friendly "shortcut" to each bundle (e.g., "moderator" or "admin").
</p><p>MUC使用第2种方式。
</p><p>有两个尺度我们可以用来衡量一个用户的连接或在一个房间的地位. 一个是用户和一个房间的长期的联系 -- 例如, 用户的状态是一个所有者或一个被排斥者. 另一个是当用户驻留于一个聊天室的时候的角色 -- 例如, 一个房客的地位是主持人,有权踢出游客和与会者. 这两个尺度各自都是唯一的, 因为一个岗位是跨越访问的, 而一个角色只存在于一次访问期间. 另外, 在角色和岗位之间没有一对一的对应关系; 例如, 某个不从属于某房间的人可能成为一个(临时的)主持人, 一个成员可能在一个被主持的房间中是一个与会者或游客者. 这些概念以下全面解释.
</p>
<h3> <span class="mw-headline" id=".E8.A7.92.E8.89.B2">角色</span></h3>
<p>以下是已定义的角色:
</p><p><b>表2: 角色</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>名称 </th>
<th>支持
</th></tr>
<tr>
<td> 主持人Moderator   </td>
<td>必需的
</td></tr>
<tr>
<td> 无None       </td>
<td>缺少角色
</td></tr>
<tr>
<td> 与会者Participant   </td>
<td>必需的
</td></tr>
<tr>
<td> 游客Visitor     </td>
<td>推荐的
</td></tr></table>
<p>角色是临时的,它不一定要在用户对房间的访问中持久化,它可以(MAY)在一个房客访问房间期间改变. 一个实现可以(MAY)在一次访问期间持久化角色并且应该(SHOULD)在被主持的房间这样做 (因为在游客和与会者之间,唯一性对一个被主持的房间是很关键的).
</p><p>在角色和岗位之间没有一对一的映射(例如, 一个成员可以是一个与会者或一个游客).
</p><p>在房间会话中,一个主持人是最有权力的房客, 它能在某种程度走上管理房间的其他房客的角色. 一个与会者的权力小于一个主持人, 尽管他或她有权发言. 在一个被主持的房间会话中游客是一个更受限制的角色, 因为访问者不允许发送消息给所有房客.
</p><p>角色的授予,撤销, 和维护是基于房客的房间昵称或全JID,而不是纯JID. 和这些角色相关的权限，还有角色改变触发的动作, 定义在下文中.
</p><p>所有在房间中生成或反射的出席信息中关于角色的信息必须(MUST)被发送,从而发送给房客们.
</p>
<h4> <span class="mw-headline" id=".E6.9D.83.E9.99.90">权限</span></h4>
<p>大部分情况下, 角色存在于一个层次中. 例如, 一个与会者可以做任何游客能做的事, 而一个主持人可以做任何与会者能做的事. 每个角色拥有下一级角色所没有的权限; 这些权限定义于下表作为缺省值(一个实现可以(MAY)提供配置选项来重载这些缺省值).
</p><p><b>表3: 和角色相关的权限</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>权限 </th>
<th>无 </th>
<th>游客 </th>
<th>与会者 </th>
<th>主持人
</th></tr>
<tr>
<td>在房间中出席 </td>
<td>否 </td>
<td>是 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>接收消息 </td>
<td>否 </td>
<td>是 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>接收房客出席信息 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>出席信息广播到房间 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>改变可用性状态 </td>
<td>否 </td>
<td>是 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>改变房间昵称 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>发送私人消息 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>邀请其他用户 </td>
<td>否 </td>
<td>是* </td>
<td>是* </td>
<td>是
</td></tr>
<tr>
<td>发送消息给所有人 </td>
<td>否 </td>
<td>否** </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>修改标题 </td>
<td>否 </td>
<td>否* </td>
<td>是* </td>
<td>是
</td></tr>
<tr>
<td>踢出与会者和游客 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr>
<tr>
<td>授予发言权 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr>
<tr>
<td>撤销发言权 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是***
</td></tr></table>
<ul><li> 缺省; 设定配置时可以(MAY)修改这个权限.
</li></ul>
<ul><li><ul><li> 一个实现可以(MAY)在非主持的房间里缺省地授予发言权给游客.
</li></ul>
</li></ul>
<ul><li><ul><li><ul><li> 主持人不能(MUST NOT)从一个管理员或所有者收回发言权.
</li></ul>
</li></ul>
</li></ul>
<h4> <span class="mw-headline" id=".E9.BB.98.E8.AE.A4.E8.A7.92.E8.89.B2">默认角色</span></h4>
<p>服务必须（SHOULD）根据用户的岗位信息来设置房客在房间里的默认角色（没有与岗位（“outcast”）关联的默认角色，因为outcast用户不允许进入房间）。下表对与每个岗位关联的默认角色进行了总结。
</p><p>表4: 基于岗位的默认角色
</p>
<table border="1" cellspacing="0">
<tr>
<th>Room Type </th>
<th>None </th>
<th>Member </th>
<th>Admin </th>
<th>Owner
</th></tr>
<tr>
<td>Moderated </td>
<td>Visitor </td>
<td>Participant </td>
<td>Moderator </td>
<td>Moderator
</td></tr>
<tr>
<td>Unmoderated </td>
<td>Participant </td>
<td>Participant </td>
<td>Moderator </td>
<td>Moderator
</td></tr>
<tr>
<td>Members-Only </td>
<td>N/A * </td>
<td>Participant </td>
<td>Moderator </td>
<td>Moderator
</td></tr>
<tr>
<td>Open	</td>
<td>Participant </td>
<td>Participant </td>
<td>Moderator </td>
<td>Moderator
</td></tr></table>
<ul><li> Entry is not permitted.
</li></ul>
<h4> <span class="mw-headline" id=".E5.8F.98.E6.9B.B4.E8.A7.92.E8.89.B2">变更角色</span></h4>
<p>一个房客的角色变更方法是定义好的. 有时候房客自己的动作导致变更 (例如, 加入或退出房间), 反之有时候由主持人,管理员或所有者的动作导致变更. 如果一个房客的角色改变了, 一个 MUC 服务实现必须(MUST)变更这个房客的角色来反映这个变更并且传达这个变更给所有房客. 角色的变更和它们触发的动作定义于下表.
</p><p><b>表4: 角色状态表</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>&gt; </th>
<th>无 </th>
<th>游客 </th>
<th>与会者 </th>
<th>主持人
</th></tr>
<tr>
<td>无 </td>
<td>-- </td>
<td>进入被主持的房间 </td>
<td>进入非主持的房间 </td>
<td>管理员或所有者进入房间
</td></tr>
<tr>
<td>游客 </td>
<td>退出房间或被主持人踢出房间 </td>
<td>-- </td>
<td>主持人授予发言权 </td>
<td>管理员或所有者授予主持人权限
</td></tr>
<tr>
<td>与会者 </td>
<td>退出房间或被主持人踢出房间 </td>
<td>主持人撤销发言权	</td>
<td>--  </td>
<td>管理员或所有者授予主持人权限
</td></tr>
<tr>
<td>主持人	</td>
<td>退出房间 </td>
<td>管理员或所有者改变角色成为游客* </td>
<td>管理员或所有者改变角色成为与会者或撤销主持人权限* </td>
<td>--
</td></tr></table>
<ul><li> 一个主持人不能(MUST NOT)从一个岗位等于或高于主持人的房客那里收回主持人权限.
</li></ul>
<p>注意: 特定的角色一般暗含特定的权限. 例如, 一个管理员或所有者自动成为一个主持人, 所以如果一个房客被授予管理员地位那么这个房客事实上将被授予主持人权限; 类似的, 当一个房客成为一个被主持的房间的成员, 这个房客自动拥有一个与会者的角色. 无论如何, 失去管理员地位并不足以意味这个房客不再是主持人 (因为只要是与会者就可能成为一个主持人). 因此, 当一个房客被授予特定的岗位的时候所拥有的角色是固定的, 反之当一个房客失去一个特定的岗位时它的角色是不确定的并取决于(服务的)实现. 因为一个客户端无法预料是否在撤销某个岗位之后这个角色成为什么, 如果它不想同时移除管理员/所有者权限和主持人角色, 那么除了岗位变更之外它还必须特意请求角色变更.
</p>
<h3> <span class="mw-headline" id=".E5.B2.97.E4.BD.8D">岗位</span></h3>
<p>已定义了以下岗位:
</p>
<ol><li> 所有者
</li><li> 管理员
</li><li> 成员
</li><li> 被排斥者
</li><li> 无 (缺少岗位)
</li></ol>
<p>必须支持"所有者"这个岗位,推荐支持"管理员","成员","被排斥者"的岗位.（"无"表示缺少岗位)
</p><p>这些岗位是长时间的跨越一个用户对这个房间的访问期间的并且不受房间里事件的影响. 而且, 这些岗位和一个房客在房间中的角色之间没有一对一的映射关系. 岗位被授予,撤销, 和维护都是基于这个用户的纯 JID.
</p><p>如果一个没有已定义的岗位的用户进入一个房间, 这个用户的岗位被定义为"无"; 无论如何, 这个岗位不能跨越(多次的)访问 (也就是说, 一个服务不会跨越访问维护一个 "无 列表").
</p><p>"成员"岗位为房间所有者或管理员提供了一个方法来指定一个"白名单",其中的用户被允许加入一个仅供会员的房间. 当一个成员加入了一个仅供会员的房间, 他或她的岗位不会改变, 无论他或她的角色是什么. 成员岗位也为用户提供一个方法来高效地注册一个开放的房间并在某种方式意义上保持和那个房间的联系(例如可能在房间里预留那个用户的昵称).
</p><p>一个被排斥者就是一个被从房间踢出来并且不允许进入那个房间的用户.
</p><p>关于岗位的信息必须(MUST)由房间生成或反射到所有的出席信息节之中发送给房客们.
</p>
<h4> <span class="mw-headline" id=".E6.9D.83.E9.99.90_2">权限</span></h4>
<p>大部分情况下, 岗位存在一个层次结构. 例如, 一个所有者可以做任何管理员能做的事情, 而一个管理员可以做任何成员能做的事情. 每个岗位拥有其下一级岗位所没有的权限; 这些权限定义在下表中.
</p><p><b>表5: 和岗位相关的权限</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>权限 </th>
<th>Outcast(被排斥者) </th>
<th>None(无) </th>
<th>Member(成员) </th>
<th>Admin(管理员) </th>
<th>Owner(所有者)
</th></tr>
<tr>
<td>进入房间 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>注册一个开放的房间 </td>
<td>否 </td>
<td>是 </td>
<td>N/A </td>
<td>N/A </td>
<td>N/A
</td></tr>
<tr>
<td>接收成员列表 </td>
<td>否 </td>
<td>否** </td>
<td>是 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>加入一个仅限会员的房间 </td>
<td>否 </td>
<td>否 </td>
<td>是* </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>禁止成员并把用户的岗位删除	</td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>编辑成员列表 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是 </td>
<td>是
</td></tr>
<tr>
<td>编辑主持人列表 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是** </td>
<td>是**
</td></tr>
<tr>
<td>编辑管理员列表 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr>
<tr>
<td>编辑所有者列表 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr>
<tr>
<td>变更房间定义 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr>
<tr>
<td>销毁房间	</td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>否 </td>
<td>是
</td></tr></table>
<ul><li> 作为缺省值, 一个无岗位的用户进入一个被主持的房间的角色是一个游客, 而进入一个开放的房间的角色是一个与会者. 一个成员进入一个房间的角色是与会者. 一个管理员或所有者进入房间的角色是一个主持人.
</li></ul>
<ul><li><ul><li> 一个管理员或所有者不能(MUST NOT)撤销另一个管理员或所有者的权限.
</li></ul>
</li></ul>
<h4> <span class="mw-headline" id=".E5.8F.98.E6.9B.B4.E5.B2.97.E4.BD.8D">变更岗位</span></h4>
<p>一个用户的岗位变更方法已经定义得很完善. 有时用户自己的动作导致这些变更(例如, 注册为一个房间的新成员), 反之有时候一个管理员或所有者的动作导致了这些变更. 如果一个用户的岗位改变了, 一个MUC服务实现必须(MUST)变更这个用户的岗位来反射这一变更并通知所有房客. 岗位变更和他们触发的动作定义在下表中.
</p><p><b>表6: 岗位状态表</b>
</p>
<table border="1" cellspacing="0">
<tr>
<td>  </td>
<td>被排斥者(Outcast) </td>
<td>无(None) </td>
<td>成员(Member) </td>
<td>管理员(Admin) </td>
<td>所有者(Owner)
</td></tr>
<tr>
<td>被排斥者(Outcast) </td>
<td>-- </td>
<td>管理员或所有者移除屏蔽 </td>
<td>管理员或所有者增加用户到成员列表 </td>
<td>所有者增加用户到管理员列表 </td>
<td>所有者增加用户到所有者列表
</td></tr>
<tr>
<td>无(None) </td>
<td>管理员或所有者使用屏蔽 </td>
<td>-- </td>
<td>管理员或所有者增加用户到成员列表, 或用户注册一个成员(如果允许) </td>
<td>所有者增加用户到管理员列表 </td>
<td>所有者增加用户到所有者列表
</td></tr>
<tr>
<td>成员(Member) </td>
<td>管理员或所有者使用屏蔽 </td>
<td>管理员或所有者变更岗位为"none" </td>
<td>-- </td>
<td>所有者增加用户到管理员列表 </td>
<td>所有者增加用户到所有者列表
</td></tr>
<tr>
<td>管理员(Admin) </td>
<td>所有者使用屏蔽 </td>
<td>所有者变更岗位为"none" </td>
<td>所有者变更岗位为"member" </td>
<td>-- </td>
<td>所有者增加用户到所有者列表
</td></tr>
<tr>
<td>所有者(Owner) </td>
<td>所有者使用屏蔽 </td>
<td>所有者变更岗位为"none" </td>
<td>所有者变更岗位为"member" </td>
<td>所有者变更岗位为"admin" </td>
<td>--
</td></tr></table>
<h2> <span class="mw-headline" id=".E5.AE.9E.E4.BD.93.E7.94.A8.E4.BE.8B">实体用例</span></h2>
<p>一个MUC实现必须(MUST)支持<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0030.html">服务发现</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">7</a>.
</p>
<h3> <span class="mw-headline" id="MUC.E7.9A.84.E5.8F.91.E7.8E.B0.E7.BB.84.E4.BB.B6.E6.94.AF.E6.8C.81">MUC的发现组件支持</span></h3>
<p>一个Jabber实体可能希望发现是否一个服务实现了多用户聊天协议; 为了达到这个目的, 它发送一个服务发现信息("disco#info")查询给这组件的JID:
</p><p><b>例子 1. 用户通过Disco查询聊天服务是否支持MUC</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'disco1'</span>
    <span class="re0">to</span>=<span class="st0">'macbeth.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须(MUST)返回它的的身份和它所支持的特性:
</p><p><b>例子 2. 服务返回Disco Info结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco1'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span>
        <span class="re0">category</span>=<span class="st0">'conference'</span>
        <span class="re0">name</span>=<span class="st0">'Macbeth Chat Service'</span>
        <span class="re0">type</span>=<span class="st0">'text'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 因为MUC是旧的"groupchat 1.0"协议的超集, 一个MUC服务不应该(SHOULD NOT)返回一个&lt;feature var='gc-1.0'/&gt;条目在一个disco#info结果中.
</p>
<h3> <span class="mw-headline" id=".E5.8F.91.E7.8E.B0.E6.88.BF.E9.97.B4">发现房间</span></h3>
<p>发现服务条目("disco#items")协议使得一个用户可以向一个服务查询相关的条目列表, 在一个聊天服务中这包含这个服务所承载的所有特定房间的集合.
</p><p><b>例子 3. 用户向聊天服务查询房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'disco2'</span>
    <span class="re0">to</span>=<span class="st0">'macbeth.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务应该(SHOULD)返回它承载的所有房间的列表.
</p><p><b>例子 4. 服务返回Disco Item结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco2'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'heath@macbeth.shakespeare.lit'</span>
          <span class="re0">name</span>=<span class="st0">'A Lonely Heath'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
          <span class="re0">name</span>=<span class="st0">'A Dark Cave'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'forres@macbeth.shakespeare.lit'</span>
          <span class="re0">name</span>=<span class="st0">'The Palace'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'inverness@macbeth.shakespeare.lit'</span>
          <span class="re0">name</span>=<span class="st0">'Macbeth&amp;apos;s Castle'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果全部房间的列表太大(详见<a href="/XEP-0030" title="XEP-0030">XEP-0030</a>), 服务可以(MAY)只返回部分的房间列表.如果这样做了, 它应该 SHOULD 包含一个 &lt;set/&gt; 元素 (定义在 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0059.html">Result Set Management</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">8</a>) 以表明这个列表不是全部的结果集.
</p><p><b>例子 5. 服务返回Disco Item结果的部分列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'rooms.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco-rsm-1'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'alls-well-that-ends-well@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'as-you-like-it@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'cleopatra@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'comedy-of-errors@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'coriolanus@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'cymbeline@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'hamlet@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'henry-the-fourth-one@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'henry-the-fourth-two@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'henry-the-fifth@rooms.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;set</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/rsm'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;first</span> <span class="re0">index</span>=<span class="st0">'0'</span><span class="re2">&gt;</span><span class="co3">alls-well-that-ends-well@rooms.shakespeare.lit</span><span class="re1">&lt;/first<span class="re2">&gt;</span></span>
      <span class="re1">&lt;last<span class="re2">&gt;</span></span><span class="co3">henry-the-fifth@rooms.shakespeare.lit</span><span class="re1">&lt;/last<span class="re2">&gt;</span></span>
      <span class="re1">&lt;count<span class="re2">&gt;</span></span><span class="co3">37</span><span class="re1">&lt;/count<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/set<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E6.88.BF.E9.97.B4.E4.BF.A1.E6.81.AF">查询房间信息</span></h3>
<p>使用 disco#info 协议, 一个用户也可以查询一个特定房间的详情. 为了在进入房间之间确定这个房间的隐私和安全配置用户应该(SHOULD)这样做(详见<a href="/XEP-0045#.E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9" title="XEP-0045">安全事项</a>).
</p><p><b>例子 6. 用户查询特定聊天室的信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'disco3'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>房间必须(MUST)返回它的标识并且应该(SHOULD)返回它支持的特性:
</p><p><b>例子 7. 房间返回查询信息结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco3'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span>
        <span class="re0">category</span>=<span class="st0">'conference'</span>
        <span class="re0">name</span>=<span class="st0">'A Dark Cave'</span>
        <span class="re0">type</span>=<span class="st0">'text'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_passwordprotected'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_hidden'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_temporary'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_open'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_unmoderated'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_nonanonymous'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 因为 MUC 是旧的 "groupchat 1.0" 协议的超集, 一个 MUC 房间不应该(SHOULD NOT)在一个disco#info结果中返回&lt;feature var='gc-1.0'/&gt;条目. 房间应该(SHOULD)返回它支持的实质的有意义的特性, 例如密码保护和房间主持(这些特性被完整地列入了特性注册, 由<a rel="nofollow" class="external text" href="http://xmpp.org/registrar/">XMPP Registrar</a>维护; 也见于本文的<a href="/XEP-0045#registrar" title="XEP-0045">XMPP注册</a> 章节).
</p><p>一个聊天室可以(MAY)使用<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0128.html">服务查询扩展</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">9</a>在它的disco#info应答中返回更详细的信息, 通过包含一个隐含的FORM_TYPE属性值"<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#roominfo">http://jabber.org/protocol/muc#roominfo</a>"来标识. 这些信息可能包括关于一个房间的更详细的描述, 当前的房间标题, 以及这个房间当前的房客数量:
</p><p><b>例子 8. 房间返回扩展的查询信息结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco3a'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span>
        <span class="re0">category</span>=<span class="st0">'conference'</span>
        <span class="re0">name</span>=<span class="st0">'A Dark Cave'</span>
        <span class="re0">type</span>=<span class="st0">'text'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_passwordprotected'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_hidden'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_temporary'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_open'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_unmoderated'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'muc_nonanonymous'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roominfo</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_description'</span> <span class="re0">label</span>=<span class="st0">'Description'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">The place for all good witches!</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_changesubject'</span> <span class="re0">label</span>=<span class="st0">'Whether Occupants May Change the Subject'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_contactjid'</span> <span class="re0">label</span>=<span class="st0">'Contact Addresses'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">crone1@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_subject'</span> <span class="re0">label</span>=<span class="st0">'Subject'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Spells</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_occupants'</span> <span class="re0">label</span>=<span class="st0">'Number of occupants'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">3</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_lang'</span> <span class="re0">label</span>=<span class="st0">'Language of discussion'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">en</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_logs'</span> <span class="re0">label</span>=<span class="st0">'URL for discussion logs'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://www.shakespeare.lit/chatlogs/darkcave/</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roominfo_pubsub'</span> <span class="re0">label</span>=<span class="st0">'Associated pubsub node'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">xmpp:pubsub.shakespeare.lit?node=chatrooms/darkcave</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>某些扩展的房间信息可能是动态生成的(例如, 讨论记录的URL地址, 它可能取决于服务器那一层的配置); 反之另一些信息则可能基于房间那一层的配置,任何定义在<a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">muc#roomconfig FORM_TYPE</a> 里的字段都可以用于扩展服务发现的字段(如上文所示的 muc#roomconfig_changesubject 字段).
</p><p>注意: 前述 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#roominfo'">http://jabber.org/protocol/muc#roominfo'</a> FORM_TYPE的扩展服务发现字段将来还可以扩充(通过本文的<a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">字段标准化</a>章节描述的机制).
</p>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E6.88.BF.E9.97.B4.E6.9D.A1.E7.9B.AE">查询房间条目</span></h3>
<p>一个用户也可以(MAY)向一个特定的聊天室查询和它相关的条目:
</p><p><b>例子 9. 用户查询和一个特定聊天室相关的条目</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'disco4'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>一个实现可以(MAY)返回现有房客的列表(如果那信息是可公开的), 或不返回列表(如果那信息是私有的).
</p><p><b>例子 10. 房间返回查询条目结果(条目是公开的)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco4'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/firstwitch'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/secondwitch'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 这些 &lt;item/&gt; 元素由 disco#items 名字空间限定, 而不是 muc 名字空间; 这意味着他们不能拥有 'affiliation' 或 'role' 属性, 例如.
</p><p><b>例子 11. 房间返回空的查询条目结果(条目是私有的)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'disco4'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.9F.A5.E8.AF.A2.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4.E7.9A.84.E6.88.BF.E5.AE.A2">查询一个房间的房客</span></h3>
<p>如果一个非房客试图发送一个查询请求给一个&lt;room@service/nick&gt;类型的地址, 一个 MUC 服务应该(SHOULD)返回这个请求给这个实体并指明一个&lt;bad-request/&gt;错误条件. 如果一个房客发送这样一个请求, 服务可以(MAY)把它传递给指定的接收者; 详见本文的 <a href="/XEP-0045#.E5.AE.9E.E7.8E.B0.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9" title="XEP-0045">实现注意事项</a>章节.
</p>
<h3> <span class="mw-headline" id=".E5.8F.91.E7.8E.B0.E5.AE.A2.E6.88.B7.E7.AB.AF.E5.AF.B9MUC.E7.9A.84.E6.94.AF.E6.8C.81">发现客户端对MUC的支持</span></h3>
<p>一个 Jabber 用户可能想发现这个用户的某个联系人是否支持多用户聊天协议. 这可以使用服务发现(协议)来完成.
</p><p><b>例子 12. 用户查询联系人对于 MUC 的支持</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'disco5'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>客户端应该(SHOULD)返回它的标识和它支持的特性:
</p><p><b>例子 13. 联系人返回发现信息结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">id</span>=<span class="st0">'disco5'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span>
        <span class="re0">category</span>=<span class="st0">'client'</span>
        <span class="re0">type</span>=<span class="st0">'pc'</span><span class="re2">/&gt;</span><span class="co3">
    ...
    </span><span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span><span class="co3">
    ...
  </span><span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>一个用户也可能查询一个联系人在哪个房间. 这可以通过特定服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#rooms'">http://jabber.org/protocol/muc#rooms'</a> 查询联系人的全JID(&lt;user@host/resource&gt;)来完成&#160;:
</p><p><b>例子 14. 用户在当前房间查询联系人</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'rooms1'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/muc#rooms'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 15. 联系人返回房间查询结果</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">id</span>=<span class="st0">'rooms1'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#items'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/muc#rooms'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'characters@conference.shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>可选的, 联系人可以(MAY)把它的房间昵称作为'name'属性的值返回:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">    ...
    </span><span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
          <span class="re0">name</span>=<span class="st0">'secondwitch'</span><span class="re2">/&gt;</span><span class="co3">
    ...</span></pre></div></div>
<h2> <span class="mw-headline" id=".E6.88.BF.E5.AE.A2.E7.94.A8.E4.BE.8B">房客用例</span></h2>
<p>在一个多用户聊天环境中主要的行为者是房客, 它可以被认为存在于一个多用户聊天室"之内"并且参与那个房间的讨论 (在本协议中, 与会者和游客"仅仅"被认为是房客, 因为他们不拥有管理员权限). 为了更加清晰起见, 本文中的协议元素中涉及到驻留者的用例分为以下三类:
</p>
<ol><li> 现存于 "groupchat 1.0" 协议的最小功能集
</li><li> 对于 "groupchat 1.0" 协议直接的应用, 如处理一些和新房间类型有关的错误
</li><li> 用来处理"groupchat 1.0"协议未涉及的功能的额外的协议元素(房间邀请, 房间密码, 和房间角色及岗位相关的扩展出席信息); 在'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间">http://jabber.org/protocol/muc#user'名字空间</a>
</li></ol>
<p>注意: 这里所有客户端生成的例子是从服务的角度来展示的, 所以所有由服务收到的节都包含一个'from'属性来表达发送者的全JID(这个from属性是由一个通用的Jabber路由或会话管理者加入的). 另外, 通常的表示请求已被完成的 IQ 结果节(如 <a href="/index.php?title=RFC_3920&amp;action=edit&amp;redlink=1" class="new" title="RFC 3920（尚未撰写）">RFC 3920</a> [10]中所要求的)未显示在这里.
</p>
<h3> <span class="mw-headline" id=".E8.BF.9B.E5.85.A5.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4">进入一个房间</span></h3>
<h4> <span class="mw-headline" id="Groupchat_1.0.E5.8D.8F.E8.AE.AE">Groupchat 1.0协议</span></h4>
<p>为了参加一个多用户聊天室的讨论, 一个Jabber用户必须(MUST)首先进入一个房间成为一个房客. 在旧的"groupchat 1.0"协议中, 这是通过发送出席信息&lt;room@service/nick&gt;来实现的, 这里"room"是房间的 ID, "service" 是聊天服务的主机名, "nick" 是这个用户在这房间里预期的昵称:
</p><p><b>例子 16. Jabber用户进入一个房间(Groupchat 1.0)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span><span class="re2">/&gt;</span></pre></div></div>
<p>在这个例子中, 一个全JID为"hag66@shakespeare.lit/pda"的用户请求用昵称"thirdwitch"进入位于"macbeth.shakespeare.lit"聊天服务的房间"darkcave".
</p><p>如果用户未指定一个房间昵称, 服务应该(SHOULD)返回一个&lt;jid-malformed/&gt;错误:
</p><p><b>例子 17. Jabber用户进入一个房间(Groupchat 1.0)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">code</span>=<span class="st0">'400'</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;jid-malformed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E5.9F.BA.E6.9C.ACMUC.E5.8D.8F.E8.AE.AE">基本MUC协议</span></h4>
<p>兼容的多用户聊天服务必须（MUST）接受知道"groupchat 1.0" (GC)协议或multi-user chat (MUC)协议的任何客户端发出上述请求进入会议室; 无论如何, MUC 客户端应该(SHOULD)声明他们的有能力支持 MUC 协议, 方法是在出席信息节里面包含一个空的 &lt;x/&gt; 元素, 满足名字空间 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a>  (注意不需要 '#user' 部分):
</p><p><b>例子 18. Jabber用户准备进入一个房间(Multi-User Chat)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">&quot;hag66@shakespeare.lit/pda&quot;</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 如果发生了一个和加入房间有关的错误, 服务应该 SHOULD 返回一个包含 MUC 子元素 (i.e., &lt;x xmlns='<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'/">http://jabber.org/protocol/muc'/</a>&gt;) 的 &lt;presence/&gt; 节，其 type 为 "error".
</p><p>在尝试进入房间之间, 一个兼容MUC的客户端应该(SHOULD)首先查询它的保留的房间昵称 (如果有的话), 接下来的协议本文中的 <a href="/XEP-0045#.E5.8F.91.E7.8E.B0.E4.BF.9D.E7.95.99.E7.9A.84.E6.88.BF.E9.97.B4.E6.98.B5.E7.A7.B0" title="XEP-0045">发现保留的房间昵称</a> 章节对此作了定义.
</p>
<h4> <span class="mw-headline" id=".E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E5.B9.BF.E6.92.AD">出席信息广播</span></h4>
<p>如果服务能够添加用户到房间, 它必须(MUST)从所有现存的房客的房间JID发送出席信息给新的房客的全JID, 包括扩展的关于角色的出席信息, 一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的&lt;x/&gt; 元素并包含一个&lt;item/&gt;子元素, 这个子元素的'role'属性值设为"moderator", "participant", 或"visitor", 这个子元素的'affiliation'属性值设为"owner", "admin", "member", 或 "none" 中的一个:
</p><p><b>例子 19. 服务从现有的房客发送出席信息给新的房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span> <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span> <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>这个示例中, 用户已从前一个例子进入房间, 有两个人已经在房间里: 一个是昵称为"firstwitch"的(房间拥有者), 另一个是昵称为"secondwitch"的(房间管理员).
</p><p>服务也必须(MUST)从新进入的房客的房间JID向所有房客的全JID发送出席信息(含新房客):
</p><p><b>例子 20. 服务发送新房客的出席信息给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>在这个例子里, 初始的房间出席信息从新房客(thirdwitch)发送给所有房客, 包括这个新房客自己. 看看上面最后一个节, 由房间以房客的名义发送给用户自己的出席信息,应该 SHOULD 包含一个 110 状态码，这样用户就知道这个出席信息来自于作为房客的那个他自己.
</p><p>服务可以 MAY 重写新房客的房间昵称 (例如, 如果房间昵称被锁定). 如果服务不接受新房客请求的房间昵称，而是分配一个新的房间昵称, 它必须 MUST 包含一个 "210" 状态码在发送给这个新房客的出席信息广播里.
</p><p><b>例子 21. 服务发送新房客的出席信息给新房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@macbeth.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'210'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 发送给新房客的出席信息的顺序是很重要的. 服务必须 MUST 首先发送现有房客的完整列表给这个新房客,然后只发送新房客自己的出席信息给新房客. 这有助于客户端知道什么时候它收到了完整的房间名册( "room roster").
</p><p>发送出席信息广播之后(并且只在这之后), 服务可以发送讨论历史, 即时消息, 出席信息更新, 以及其他房间内的流量.
</p>
<h4> <span class="mw-headline" id=".E7.BC.BA.E7.9C.81.E8.A7.92.E8.89.B2">缺省角色</span></h4>
<p>下表总结了初始缺省的角色，一个服务应该根据用户的岗位来设置它们(没有和 被排斥者 "outcast" 岗位相关的角色, 因为这些用户不允许进入房间).
</p><p><b>表7: 基于岗位的初始角色</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>房间类型 </th>
<th>无 </th>
<th>成员 </th>
<th>管理员 </th>
<th>所有者
</th></tr>
<tr>
<td>被主持的 </td>
<td>游客 </td>
<td>与会者 </td>
<td>主持人 </td>
<td>主持人
</td></tr>
<tr>
<td>非主持的 </td>
<td>与会者 </td>
<td>与会者 </td>
<td>主持人 </td>
<td>主持人
</td></tr>
<tr>
<td>仅限会员的 </td>
<td>N/A * </td>
<td>与会者 </td>
<td>主持人 </td>
<td>主持人
</td></tr>
<tr>
<td>开放的 </td>
<td>与会者 </td>
<td>与会者 </td>
<td>主持人 </td>
<td>主持人
</td></tr></table>
<ul><li> 实体不被允许.
</li></ul>
<h4> <span class="mw-headline" id=".E9.9D.9E.E5.8C.BF.E5.90.8D.E6.88.BF.E9.97.B4">非匿名房间</span></h4>
<p>如果房间是非匿名的, 服务必须 MUST 发送新房客的全JID给所有房客,使用满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的扩展出席信息,其中带有 &lt;x/&gt; 元素并包含一个 &lt;item/&gt; 子元素,其 'jid' 属性值为这个房客的全JID:
</p><p><b>例子 22. 服务发送全JID给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果这个用户正在进入一个非匿名房间(即, 它如上所示,向所有房客通报每个房客的全JID), 服务应该 SHOULD 允许该用户加入本房间,但是必须 MUST 同时警告该用户本房间是非匿名的. 应该 SHOULD 在房间发送给这个新房客的初始出席信息种包含状态码 "100" 来实现这一点:
</p><p><b>例子 23. 服务发送新房客的出席信息给新房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'100'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'210'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>无论如何, 也可以 MAY 发送一个 "groupchat" 类型的消息给新房客来达到上述目的,这个消息应该包含一个 &lt;x/&gt; 子元素,并拥有 &lt;status/&gt; 子元素,并且其'code'属性值为"100":
</p><p><b>例子 24. 服务警告新房客(该房间)非匿名</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">This room is not anonymous.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'100'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>附带的状态码协助客户端展示它们自己的通知消息 (例如, 和用户所在地方有关的信息).
</p>
<h4> <span class="mw-headline" id=".E5.8D.8A.E5.8C.BF.E5.90.8D.E6.88.BF.E9.97.B4">半匿名房间</span></h4>
<p>如果房间是半匿名的, 服务必须 MUST 如上文所述从新房客发送出席信息给所有房客, 但是必须 MUST 只在发给"主持人"的时候发送新房客的全JID,而非主持人则不发(全JID).
</p><p>(注意: 所有随后的例子中，涉及的&lt;item/&gt;元素都带有'jid'属性, 即使这个信息在半匿名房间里不被发送给非主持人.)
</p>
<h4> <span class="mw-headline" id=".E5.AF.86.E7.A0.81.E4.BF.9D.E6.8A.A4.E6.88.BF.E9.97.B4">密码保护房间</span></h4>
<p>如果房间要求密码验证而用户不能提供(或密码错误), 服务必须 MUST 拒绝访问这个房间并且通知该用户它们是未被授权的; 具体方法是返回一个类型为"error"的出席信息节并标明 &lt;not-authorized/&gt; 错误:
</p><p><b>例子 25. 服务拒绝访问,因为(用户)未提供密码</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-authorized</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>密码应该 SHOULD 通过进入房间时发送的出席信息节来提供, 包含在满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间的 &lt;x/&gt; 元素的&lt;password/&gt; 子元素里. 密码以明码方式发送; 目前不支持其它验证方法, 而且任何这类的验证或授权方法都将会定义在一个独立的协议里(参见本文的<a href="/XEP-0045#.E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9" title="XEP-0045">安全事项</a>章节).
</p><p><b>例子 26. 用户进入房间时提供密码</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.BB.85.E9.99.90.E4.BC.9A.E5.91.98.E6.88.BF.E9.97.B4">仅限会员房间</span></h4>
<p>如果房间是仅限会员的,但用户不是(该房间的)成员, 服务必须 MUST 拒绝访问这个房间并通知用户它们不被允许进入房间; 具体方法是返回一个"error"类型的出席信息节，并包含一个 &lt;registration-required/&gt; 错误条件:
</p><p><b>例子 27. 服务拒绝访问，因为用户不在成员列表中</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;registration-required</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.A2.AB.E7.A6.81.E6.AD.A2.E7.9A.84.E7.94.A8.E6.88.B7">被禁止的用户</span></h4>
<p>如果用户已经被房间禁止(即, 其岗位为被排斥者 "outcast"), 服务必须 MUST 拒绝访问这个房间并通知用户他(她)被禁止了; 具体方法是返回一个出席信息节,类型为"error"，标明 &lt;forbidden/&gt; 错误条件:
</p><p><b>例子 28. 服务拒绝访问，因为用户被禁止了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E6.98.B5.E7.A7.B0.E5.86.B2.E7.AA.81">昵称冲突</span></h4>
<p>如果房间里已经有别的用户使用了准备进入房间的新用户预期的昵称(或如果这个昵称被保留给另一个成员列表里面的用户), 服务必须 MUST 拒绝访问这个房间并通知用户这个冲突; 具体方法是返回一个出席信息节,类型为"error"，标明 &lt;conflict/&gt; 错误条件:
</p><p><b>例子 29. 服务拒绝访问，因为昵称冲突</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;conflict</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>无论如何, 如果现有房客的纯 JID &lt;localpart@domain.tld&gt; 和准备进入房间的用户的纯 JID 相同, 那么服务应该 SHOULD 允许这个用户的进入, 所以这个用户就有两个(或更多) 房间内的会话 "sessions" 使用同一个房间昵称, 每一个对应一个资源. 如果一个服务允许相同纯JID可以同时存在多个房客并使用同一个房间的房间昵称, 它应该 SHOULD 路由房间内的消息给该用户的所有资源并允许用户的所有资源发送消息给房间; 视实现而定，服务来决定如何适当的处理从用户的资源发送的出席信息以及如何路由私有消息到所有或某个资源(基于出席信息优先级或其他机制).
</p><p>如何确定昵称冲突取决于实现(例如, 该服务是否应用于一个特定的惯例, 一个 stringprep 规则如 Resourceprep 或 Nodeprep, 等等).
</p>
<h4> <span class="mw-headline" id=".E6.9C.80.E5.A4.A7.E7.94.A8.E6.88.B7.E6.95.B0">最大用户数</span></h4>
<p>如果房间达到它的最大房客数量, 服务应该 SHOULD 拒绝访问这个房间并通知该用户这个限制; 方法是返回一个出席信息节，类型为"error"，标明 &lt;service-unavailable/&gt; 错误条件:
</p><p><b>例子 30. 服务通知用户该房间已达到房客数量极限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'wait'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;service-unavailable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>另外, 房间可以踢出空闲用户("idle user")以腾出空间.
</p><p>如果房间的房客数量已达到最大值但是一个房间管理员或所有者试图进入，该房间应该允许管理员或所有者加入，为了使得额外的房客达到一个合理的数目，该数量可以 MAY 做成可配置的。
</p>
<h4> <span class="mw-headline" id=".E9.94.81.E4.BD.8F.E7.9A.84.E6.88.BF.E9.97.B4">锁住的房间</span></h4>
<p>如果一个用户尝试进入一个房间而该房间是锁住的 "locked" (即, 在房间创建者提供初始的配置之前以及也就是在房间正式存在之前), 服务必须 MUST 拒绝进入并返回一个 &lt;item-not-found/&gt; 错误给该用户:
</p><p><b>例子 31. 服务拒绝访问，因为房间不存在</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item-not-found</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E4.B8.8D.E5.AD.98.E5.9C.A8.E7.9A.84.E6.88.BF.E9.97.B4">不存在的房间</span></h4>
<p>如果用户准备进入房间时，该房间已经不存在了, 服务应该 SHOULD 建立它; 无论如何, 这不是必需的, 因为一个实现或部署可以 MAY 选择限制建立房间的权限. 详见本文的<a href="/XEP-0045#.E6.96.B0.E5.BB.BA.E6.88.BF.E9.97.B4" title="XEP-0045">新建房间</a>章节.
</p>
<h4> <span class="mw-headline" id=".E6.88.BF.E9.97.B4.E8.AE.B0.E5.BD.95">房间记录</span></h4>
<p>如果用户进入一个房间，该房间的讨论是被记录到一个公开的存档里面(经常可以通过HTTP访问的), 服务应该 SHOULD 允许该用户加入该房间但是必须 MUST 同时警告该用户讨论已被记录. 方法是应该 SHOULD 在房间发送给该新房客的初始出席信息中包含一个状态码 "170":
</p><p><b>例子 32. 服务发送新房客的出席信息给新房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'100'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'170'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'210'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id=".E8.AE.A8.E8.AE.BA.E5.8E.86.E5.8F.B2">讨论历史</span></h4>
<p>如上发送完初始出席信息之后, 一个房间可以 MAY 发送讨论历史给这个新房客. (在完成按照本文<a href="/XEP-0045#.E5.87.BA.E5.B8.AD.E4.BF.A1.E6.81.AF.E5.B9.BF.E6.92.AD" title="XEP-0045">出席信息广播</a>章节规定的发送房间出席信息之前，该房间不能 MUST NOT 发送任何讨论历史.) 是否这个历史要被发送, 以及这个历史里面包含多少条消息, 将由聊天服务实现或特定的部署来决定.
</p><p><b>例子 33. 讨论历史的发送</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice the brinded cat hath mew'd.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2002-10-13T23:58:37Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice and once the hedge-pig whined.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2002-10-13T23:58:43Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Harpier cries 'Tis time, 'tis time.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
     <span class="re0">stamp</span>=<span class="st0">'2002-10-13T23:58:49Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>讨论历史消息必须 MUST 标为<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0203.html">Delayed Delivery</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">11</a>信息，满足'urn:xmpp:delay' 名字空间，以表明它们是被延迟发送的并且标明它们最初发出的时间. (注意: 'urn:xmpp:delay' 名字空间定义在 XEP-0203 里面，取代了旧的定义在 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0091.html">Legacy Delayed Delivery</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">12</a> 里的 'jabber:x:delay' 名字空间&#160;; XEP-0091状态更改为已过时之前, 实现应该 SHOULD 包含两种日期时间(datetime)格式.). 在非匿名房间里，'from'属性应该 SHOULD 是原始发送者的全JID, 但不能 MUST NOT 在半匿名房间里(在那里'from'属性应该 SHOULD 设置为房间本身的JID). 服务应该 SHOULD 在进入该房间之后，发送任何即时("live")消息之前，发送完所有讨论历史消息.
</p>
<h4> <span class="mw-headline" id=".E7.AE.A1.E7.90.86.E8.AE.A8.E8.AE.BA.E5.8E.86.E5.8F.B2">管理讨论历史</span></h4>
<p>用户可能 MAY 希望管理进入房间时(由房间)提供的讨论历史(可能因为用户带宽比较低或正在使用迷你客户端). 他必须 MUST 在加入房间时发出的初始出席信息节里包含一个 &lt;history/&gt; 子元素. 这个元素有四个可用的属性:
</p><p><b>表8: 历史管理属性</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>属性 </th>
<th>数据类型 </th>
<th>含义
</th></tr>
<tr>
<td> maxchars   </td>
<td>int    </td>
<td>限制历史中的字符总数为"X" (这里的字符数量是全部 XML 节的字符数, 不只是它们的 XML 字符数据).
</td></tr>
<tr>
<td> maxstanzas    </td>
<td>int    </td>
<td>限制历史中的消息总数为"X".
</td></tr>
<tr>
<td> seconds   </td>
<td>int   </td>
<td>仅发送最后 "X" 秒收到的消息.
</td></tr>
<tr>
<td> since     </td>
<td>dateTime     </td>
<td>仅发送从指定日期时间 datetime 之后收到的消息 (这个datatime必须 MUST 符合<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">13</a> 定义的DateTime 规则，).
</td></tr></table>
<p>服务必须 MUST 发送满足以上条件组合的最小数量的消息, 还要顾及服务级别和房间级别的缺省设置. 服务必须 MUST 只发送完整的消息节(即, 它不能 MUST not 按特定字符数把历史从字面上截断, 但是必须 MUST 发送最大数量的完整节,这使得字符数小于或等于 'maxchars' 属性的值). 如果客户端不希望收到历史, 它必须 MUST 把'maxchars' 属性值设为"0" (zero).
</p><p>以下例子展示如何使用这个协议.
</p><p><b>例子 34. 用户请求在历史中限制消息数量</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;history</span> <span class="re0">maxstanzas</span>=<span class="st0">'20'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 35. 用户请求最后三分钟的历史</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;history</span> <span class="re0">seconds</span>=<span class="st0">'180'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 36. 用户请求从Unix时代到现在的所有历史</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;history</span> <span class="re0">since</span>=<span class="st0">'1970-01-01T00:00:00Z'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>服务绝对不应该 SHOULD NOT 返回从Unix时代开始到现在的所有消息, 而应该 SHOULD 基于服务或房间的缺省值返回适当的有限数量的历史给用户.
</p><p><b>例子 37. 用户请求不发送历史</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;history</span> <span class="re0">maxchars</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E9.80.80.E5.87.BA.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4">退出一个房间</span></h3>
<p>为了退出一个多用户聊天房间, 一个房客发送一个类型为"unavailable"的出席信息节给正在使用这个房间的 &lt;room@service/nick&gt; .
</p><p><b>例子 38. 房客退出一个房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着从要离开的房客的房间JID发送"unavailable"类型的出席信息节给这个要离开的房客的全JID们以及留在房间的房客们:
</p><p><b>例子 39. 服务发送和离开的房客有关的出席信息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>由房间反射的类型为"unavailable"的出席信息节必须 MUST 包含扩展的关于角色和岗位的出席信息; 'role'属性值应该 SHOULD 被设为 "none" 以表示这个人不再是一个房客了.
</p><p>房客可以 MAY 在出席信息节包含一个常规的 &lt;status/&gt; 信息; 这使房客能在必要的情况下提供一个自定的退出消息:
</p><p><b>例子 40. 自定的退出消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;status<span class="re2">&gt;</span></span><span class="co3">gone where the goblins go</span><span class="re1">&lt;/status<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>常规的出席信息节生成规则定义在 <a href="/RFC3921" title="RFC3921">XMPP IM</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G.3B.E5.A4.87.E6.B3.A8" title="XEP-0045">14</a>, 所以如果用户发送一个一般的不可用出席信息节, 用户的服务器将广播那个节到 &lt;room@service/nick&gt; ，而该用户之前曾经发送过直接出席信息给这个&lt;room@service/nick&gt;.
</p><p>有可能一个用户不能正常地通过直接发送不可用信息给一个房间来退出该房间. 如果该用户没有发送不可用出席信息就下线了, 用户的服务器负责代替该用户发送不可用出席信息 (依据 <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>). 如果该用户的服务器下线或该用户的服务器和该用户连接的MUC服务失去连接(例如, 在联邦通信), 这个MUC服务负责监视它收到的错误信息节以确定该用户是否下线. 如果该MUC服务确定该用户已下线, 它必须 must 当成该用户自己发送了不可用信息一样地处理这个用户.
</p><p>注意: 如果房间不是持久的并且该房客是最后一个退出的, 服务负责销毁这个房间.
</p>
<h3> <span class="mw-headline" id=".E6.9B.B4.E6.94.B9.E6.98.B5.E7.A7.B0">更改昵称</span></h3>
<p>多用户聊天室的一个常用功能是一个房客能修改自己在房间里的昵称. 在 MUC 里这需要发送一个更新出席信息给房间, 具体来说是在相同的房间里发送出席信息给一个新的房间JID (变更的只是这个房间JID的资源).
</p><p><b>例子 41. 房客修改昵称</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务接着发送两个出席信息节给每个房客的全JID(包括修改自己昵称的房客本身), 一个是类型为"unavailable"的用于旧的昵称另一个指明新昵称可用了.
</p><p>这个不可用出席信息必须 MUST 在一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的 &lt;x/&gt; 子元素里面包含以下扩展的出席信息&#160;:
</p>
<ul><li> 新昵称(在这个例子中, nick='oldhag')
</li><li> 一个状态码 303
</li></ul>
<p>这使接受者能从旧昵称关联到新昵称.
</p><p><b>例子 42. 服务更新昵称</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">nick</span>=<span class="st0">'oldhag'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'303'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">nick</span>=<span class="st0">'oldhag'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'303'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">nick</span>=<span class="st0">'oldhag'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'303'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该用户尝试修改他或她的房间昵称,但这个昵称已经被其他用户使用了 (或者这个昵称是被这房间的其他用户岗位保留的, 例如, 一个成员或者所有者), 服务必须 MUST 拒绝这次昵称修改并通知该用户这一冲突; 也就是返回一个类型为 "error" 的出席信息节指明 &lt;conflict/&gt; 错误条件:
</p><p><b>例子 43. 服务拒绝昵称修改，因为昵称冲突</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;conflict</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>无论如何, 如果现有房客的纯JID &lt;localpart@domain.tld&gt; 和尝试变更昵称的房客的纯JID相同, 那么服务可以 MAY 允许昵称变更. 详见本文的<a href="/XEP-0045#.E6.98.B5.E7.A7.B0.E5.86.B2.E7.AA.81" title="XEP-0045">昵称冲突</a>章节.
</p><p>如果该用户尝试变更自己的昵称但是房间昵称被锁定了("locked down"), 服务必须 MUST 拒绝这个昵称变更请求并返回一个"error"类型的出席信息节，指明一个 &lt;not-acceptable/&gt; 错误条件:
</p><p><b>例子 44. 服务拒绝昵称变更，因为房间昵称被锁定</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>用户应该 SHOULD 接着发现它的保留昵称，如本文的 <a href="/XEP-0045#.E5.8F.91.E7.8E.B0.E4.BF.9D.E7.95.99.E7.9A.84.E6.88.BF.E9.97.B4.E6.98.B5.E7.A7.B0" title="XEP-0045">发现保留的房间昵称</a>章节所述.
</p>
<h3> <span class="mw-headline" id=".E6.9B.B4.E6.94.B9.E5.8F.AF.E7.94.A8.E6.80.A7.E7.8A.B6.E6.80.81">更改可用性状态</span></h3>
<p>在一个多用户聊天系统里例如IRC, 一个常用的修改某人房间昵称的行为也意味着变更某人的可用性(例如, 变更某人的房间昵称为"thirdwitch|away"). 在Jabber里面, 可用性当然是通过出席信息 (中 &lt;show/&gt; 和 &lt;status/&gt; 元素)的变更来通知的, 这能提供重要的上下文给聊天室. 一个房客通过发送更新的出席信息给它自己的&lt;room@service/nick&gt;来改变他在房间内的可用性状态.
</p><p><b>例子 45. 房客变更可用性状态</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/oldhag'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;show<span class="re2">&gt;</span></span><span class="co3">xa</span><span class="re1">&lt;/show<span class="re2">&gt;</span></span>
  <span class="re1">&lt;status<span class="re2">&gt;</span></span><span class="co3">gone where the goblins go</span><span class="re1">&lt;/status<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>服务然后从该房客发送一个出席信息节来修改他或她的出席信息给每个房客的全JID, 包含扩展的出席信息，包括这个房客的角色和全JID(给那些有权知道的人):
</p><p><b>例子 46. 服务传递修改的出席信息给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;show<span class="re2">&gt;</span></span><span class="co3">xa</span><span class="re1">&lt;/show<span class="re2">&gt;</span></span>
  <span class="re1">&lt;status<span class="re2">&gt;</span></span><span class="co3">gone where the goblins go</span><span class="re1">&lt;/status<span class="re2">&gt;</span></span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E9.82.80.E8.AF.B7.E5.85.B6.E4.BB.96.E7.94.A8.E6.88.B7.E8.BF.9B.E5.85.A5.E4.B8.80.E4.B8.AA.E6.88.BF.E9.97.B4">邀请其他用户进入一个房间</span></h3>
<h4> <span class="mw-headline" id=".E7.9B.B4.E6.8E.A5.E9.82.80.E8.AF.B7">直接邀请</span></h4>
<p>一个办法是发送一个直接的邀请(而不是由房间本身来间接邀请),定义在<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0249.html">Direct MUC Invitations</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">15</a>. 直接发送邀请有助于适应被邀请者那一边的通信阻塞(对方可能拒绝和和不在好友名单中的实体通信).
</p>
<h4> <span class="mw-headline" id=".E9.97.B4.E6.8E.A5.E9.82.80.E8.AF.B7">间接邀请</span></h4>
<p>邀请别的用户到一个房间成为房客是很有用的. 为了做到这一点, 一个 MUC 客户端必须 MUST 发送以下格式的 XML 给 &lt;room@service&gt; 本身 (原因(reason)是可选的 OPTIONAL 而消息(message)的类型必须 MUST 是显式或隐式的"normal"类型):
</p><p><b>例子 47. 房客通过房间发送一个邀请</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">
        Hey Hecate, this is the place for all good witches!
      </span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;room@service&gt; 本身必须 MUST 接着增加一个 'from' 地址到 &lt;invite/&gt; 元素，其值为邀请者的纯JID, 全JID, 或房间JID，并发送邀请给 'to' 地址所指明的被邀请者(为了旧的客户端，服务可以 MAY 包含一个消息主体"message body"解释这个邀请或包含一个原因"reason"(子元素); 另外, 房间应该 SHOULD 增加 password 如果该房间是密码保护的):
</p><p><b>例子 48. 房间代表邀请者发送邀请给被邀请者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">
        Hey Hecate, this is the place for all good witches!
      </span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果房间是仅限成员的, 服务可以 MAY 同时把这个被邀请者加入成员列表. (注意: 在仅限成员的房间里邀请的权力应该 SHOULD 由房间管理员限定; 如果一个没有权限的成员修改成员列表试图邀请别的用户, 服务应该 SHOULD 返回一个 &lt;forbidden/&gt; 错误给该房客; 详见本文的<a href="/XEP-0045#.E4.BF.AE.E6.94.B9.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8" title="XEP-0045">修改成员列表</a>章节.)
</p><p>如果邀请者提供了一个不存在的JID, 房间应该 SHOULD 返回一个 &lt;item-not-found/&gt; 错误给邀请者.
</p><p>被邀请者可以 MAY 选择正式地拒绝 (反之则忽略) 邀请; 这是发送者希望看到的正式的通知. 为了拒绝这个邀请, 被邀请者必须 MUST 发送以下格式的消息给 &lt;room@service&gt; 本身:
</p><p><b>例子 49. 被邀请者谢绝邀请</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;decline</span> <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">
        Sorry, I'm too busy right now.
      </span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/decline<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 50. 房间通知邀请者邀请被拒绝了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;decline</span> <span class="re0">from</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">
        Sorry, I'm too busy right now.
      </span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/decline<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>可能(有人)想知道为什么被邀请者不直接发送拒绝消息给访问者. 主要原因是特定的实现可能 MAY 选择让邀请基于房间JIDs而不是纯JIDs (所以, 例如, 一个房客可能从一个房间邀请某人到另一个房间而不需要知道这个人的纯JID). 因而服务必须 MUST 同时处理邀请和拒绝.
</p>
<h3> <span class="mw-headline" id=".E6.8A.8A.E4.B8.80.E5.AF.B9.E4.B8.80.E8.81.8A.E5.A4.A9.E8.BD.AC.E4.B8.BA.E5.A4.9A.E7.94.A8.E6.88.B7.E4.BC.9A.E8.AE.AE">把一对一聊天转为多用户会议</span></h3>
<p>有时候人们需要把一个一对一的聊天转成一个多用户的会议. 以下例子展示了这个流程.
</p><p>首先, 两个用户开始一个一对一聊天.
</p><p><b>例子 51. 一个一对一聊天</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'chat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice the brinded cat hath mew'd.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'chat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice and once the hedge-pig whined.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>现在第一个用户决定加入第三个人到这个讨论, 所以她 (或, 更准确地说, 她的客户端) 做以下事情:
</p>
<ol><li> 新建一个多用户聊天室
</li><li> 可选地发送一对一聊天的历史到房间
</li><li> 发送一个邀请给第二个人和第三个人, 包含一个 &lt;continue/&gt; 元素 (可选地包含一个 'thread' 属性).
</li></ol>
<p>注意: 新房间应该 SHOULD 是非匿名的, 可以 MAY 是一个即时房间(定义于本文的<a href="/XEP-0045#.E6.96.B0.E5.BB.BA.E5.8D.B3.E6.97.B6.E6.88.BF.E9.97.B4" title="XEP-0045">新建即时房间</a>章节), 也可以 MAY 有一个从服务接收的唯一房间名(定义于本文的<a href="/XEP-0045#.E8.AF.B7.E6.B1.82.E5.94.AF.E4.B8.80.E7.9A.84.E6.88.BF.E9.97.B4.E5.90.8D" title="XEP-0045">请求唯一的房间名</a>章节.
</p><p>注意: 如果这个一对一的聊天消息包含了一个 &lt;thread/&gt; 元素, 这个新建房间的人应该 SHOULD 在历史消息中包含这个 ThreadID, 在邀请中把这个 ThreadID 的值赋予 &lt;continue/&gt; 元素的 'thread' 属性, 并把这 ThreadID 包含在任何新的消息中发送到房间. ThreadIDs 的使用是推荐的 RECOMMENDED ，因为它帮助提供一对一聊天和多用户聊天的连续性.
</p><p><b>例子 52. 继续讨论 I: 用户新建房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span> <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 53. 继续讨论 II: 所有者发送历史到房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice the brinded cat hath mew'd.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2004-09-29T01:54:37Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice and once the hedge-pig whined.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2004-09-29T01:55:21Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 使用 Delayed Delivery 协议使房间创建者能够从他一对一聊天历史指明每个消息的日期时间 datetime (通过 'stamp' 属性), 以及每个消息的原始发送者的 JID (通过'from' 属性). 房间创建者应该 SHOULD 在邀请额外的用户到房间之前发送完整的一对一聊天历史, 并且也应该 SHOULD 把第二个人加入该房间之前和第一个人在一对一聊天界面中出现的任何消息当成历史来发送; 如果这个一对一历史特别的大, 发送的客户端可能希望在数秒内发送这个历史而不是一次性发送所有历史(以to 避免触发频率限制). 服务不应该 SHOULD NOT 在从房间所有者接收的历史消息之前添加它自己的延迟元素"delay elements" (见本文的<a href="/XEP-0045#.E8.AE.A8.E8.AE.BA.E5.8E.86.E5.8F.B2" title="XEP-0045">讨论历史</a>章节) .
</p><p><b>例子 54. 继续讨论 III: 所有者发送邀请(们), 包含 Continue 标志</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">This coven needs both wiccarocks and hag66.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
      <span class="re1">&lt;continue</span> <span class="re0">thread</span>=<span class="st0">'e0ffe42b28561960c6b12b944a092794b9683a38'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">This coven needs both wiccarocks and hag66.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
      <span class="re1">&lt;continue</span> <span class="re0">thread</span>=<span class="st0">'e0ffe42b28561960c6b12b944a092794b9683a38'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 当邀请者的客户端一知道和它一对一聊天的那个人的全JID之后, 它就应该 SHOULD 在邀请中包含这个全JID (而不是纯JID).
</p><p>邀请被递送到被邀请者:
</p><p><b>例子 55. 邀请被递送</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span><span class="co3">
    to='wiccarocks@shakespeare.lit/laptop'&gt;
  </span><span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">This coven needs both wiccarocks and hag66.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
      <span class="re1">&lt;continue</span> <span class="re0">thread</span>=<span class="st0">'e0ffe42b28561960c6b12b944a092794b9683a38'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span><span class="co3">
    to='hag66@shakespeare.lit'&gt;
  </span><span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">This coven needs both wiccarocks and hag66.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
      <span class="re1">&lt;continue</span> <span class="re0">thread</span>=<span class="st0">'e0ffe42b28561960c6b12b944a092794b9683a38'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>当客户端被 &lt;wiccarocks@shakespeare.lit/laptop&gt; 用来接收邀请, 它应该 SHOULD 自动加入或提示用户是否加入 (取决于用户的选项配置) 并且随后无缝地把现有的一对一聊天窗口转到一个多用户会议的窗口:
</p><p><b>例子 56. 被邀请者接受邀请, 加入房间, 并接收出席信息和历史</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span> <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice the brinded cat hath mew'd.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2004-09-29T01:54:37Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;thread<span class="re2">&gt;</span></span><span class="co3">e0ffe42b28561960c6b12b944a092794b9683a38</span><span class="re1">&lt;/thread<span class="re2">&gt;</span></span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Thrice and once the hedge-pig whined.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;delay</span> <span class="re0">xmlns</span>=<span class="st0">'urn:xmpp:delay'</span>
     <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
     <span class="re0">stamp</span>=<span class="st0">'2004-09-29T01:55:21Z'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 事实上,这些消息从 &lt;room@service&gt; 本身而不是 &lt;room@service/nick&gt; 发出，告诉这些接收的客户端这些消息是优先的聊天历史, 因为任何来自房客的消息的 'from' 地址应该等于发送者的房间JID.
</p>
<h3> <span class="mw-headline" id=".E6.88.BF.E5.AE.A2.E4.BF.AE.E6.94.B9.E6.88.BF.E9.97.B4.E6.A0.87.E9.A2.98">房客修改房间标题</span></h3>
<p>如果房间配置允许, 一个房客可以 MAY 被允许修改一个房间的主题. 详见本文的<a href="/XEP-0045#.E4.BF.AE.E6.94.B9.E6.88.BF.E9.97.B4.E4.B8.BB.E9.A2.98" title="XEP-0045">修改房间主题</a>章节.
</p>
<h3> <span class="mw-headline" id=".E5.8F.91.E9.80.81.E7.A7.81.E6.9C.89.E6.B6.88.E6.81.AF">发送私有消息</span></h3>
<p>因为每个房客有一个唯一的房间JID, 一个房客可以 MAY 发送一个私有消息 "private message" 给选定的房客，即通过服务发送一个消息给那房客的房间JID. 这个消息类型应该 SHOULD 是 "chat" 并且不能 MUST NOT 是 "groupchat", 但是可以 MAY 不表明 (即, 一个常规"normal"消息). 这个权力应该 SHOULD 被任何房客允许 (甚至在一个被主持的房间里的游客).
</p><p><b>例子 57. 房客发送私有消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">type</span>=<span class="st0">'chat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">I'll give thee a wind.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>服务负责把'from'地址改为发送者的房间JID并递送这个消息到预期的接收者的全JID.
</p><p><b>例子 58. 接收者接收私有消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'chat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">I'll give thee a wind.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果发送者尝试发送一个类型为 "groupchat" 的私有消息给特定的房客, 服务必须 MUST 拒绝递送这个消息 (因为接收者的客户端期望的房间内的消息类型为"groupchat") 并且返回一个 &lt;bad-request/&gt; 错误给发送者:
</p><p><b>例子 59. 房客尝试发送类型为"Groupchat"的私有消息给特定的房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">I'll give thee a wind.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">I'll give thee a wind.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果发送者尝试发送一个私有消息给一个不存在的房间JID, 服务必须 MUST 返回一个 &lt;item-not-found/&gt; 错误给发送者.
</p><p>如果发送者不是预期的接收者正在访问的那个房间的房客, 服务必须 MUST 返回一个 &lt;not-acceptable/&gt; 错误给发送者.
</p>
<h3> <span class="mw-headline" id=".E5.8F.91.E9.80.81.E6.B6.88.E6.81.AF.E7.BB.99.E6.89.80.E6.9C.89.E6.88.BF.E5.AE.A2">发送消息给所有房客</span></h3>
<p>房客发送一个消息给所有房间内的房客的方法，是发送一个类型为 "groupchat" 的消息到 &lt;room@service&gt; 本身 (服务可以 MAY 忽略或拒绝类型不是 "groupchat" 的消息). 在一个被主持的房间, 这个权力限于角色为与会者或更高的房客拥有.
</p><p><b>例子 60. 房客发送一个消息给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Harpier cries: 'tis time, 'tis time.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果发送者在这个房间有发言权 (在被主持的房间里缺省是这样期望), 服务必须 MUST 修改发送者的 'from' 属性成为房间JID并反射这个消息到每个房客的全JID.
</p><p><b>例子 61. 服务反射消息给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Harpier cries: 'tis time, 'tis time.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Harpier cries: 'tis time, 'tis time.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span>
<span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">Harpier cries: 'tis time, 'tis time.</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果发送者是个游客 即, 在一个被主持的房间里没有发言权), 服务可以 MAY 返回一个 &lt;forbidden/&gt; 错误给发送者并且不能 MUST NOT 反射这个消息给所有房客. 如果发送者不是该房间的房客, 服务应该 SHOULD 返回一个 &lt;not-acceptable/&gt; 错误给发送者并且不应该 SHOULD NOT 反射这个消息给所有房客; 这个规则的唯一的例外是，一个实现可以 MAY 允许用户们拥有特定的权限 (例如, 一个房间拥有者, 房间管理员, 或服务级别的管理员) 发送消息到这个房间，即使那些用户不是房客.
</p>
<h3> <span class="mw-headline" id=".E6.B3.A8.E5.86.8C.E5.88.B0.E6.88.BF.E9.97.B4">注册到房间</span></h3>
<p>一个实现可以 MAY 允许一个无岗位的用户(在一个被主持的房间里, 通常是一个与会者) 注册一个房间从而成为该房间的一个成员 (反之, 一个实现也可以 MAY 限制这个权力并且只允许房间管理员添加新的成员). 特别是, 不在成员列表的人是无法加入一个仅限会员的房间的, 所以为了加入这样一个房间，实体需要申请会籍.
</p><p>如果允许, 这个功能应该 SHOULD 这样被实现。让用户使用 'jabber:iq:register' 名字空间<a href="/XEP-0077" title="XEP-0077">带内注册</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">16</a>提出注册申请给房间,:
</p><p><b>例子 62. 用户提出注册申请</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'reg1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:iq:register'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果用户提出的注册申请不被允许注册该房间 (例如, 因为那个权限被限制了), 该房间必须 MUST 返回一个 &lt;not-allowed/&gt; 错误给该用户. 如果该用户已经注册过了, 房间必须 MUST 返回一个类型为"result"的IQ节并包含一个空的&lt;register/&gt;元素(定义于<b>XEP-0077</b>). 如果该房间不存在, 服务必须 MUST 返回一个 &lt;item-not-found/&gt; 错误.
</p><p>否则, 房间必须 MUST 接着返回一个数据表单"Data Form"给该用户 (定义于<a href="/XEP-0004" title="XEP-0004">数据表单</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">17</a>). 注册需要的信息可以 MAY 根据实现和部署的不同而不同并且没有完全定义在本文中 (例如, 本文根据 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#register'">http://jabber.org/protocol/muc#register'</a> 名字空间采用的注册字段  FORM_TYPE 可能将来会根据<a href="/XEP-0045#.E5.AD.97.E6.AE.B5.E6.A0.87.E5.87.86.E5.8C.96" title="XEP-0045">字段标准化</a>章节里描述的得到补充，). 以下是一个典型的例子:
</p><p><b>例子 63. 服务返回注册表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'reg1'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:iq:register'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
      To register on the web, visit http://shakespeare.lit/
    </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Dark Cave Registration</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
      <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
        Please provide the following information
        to register with this room.
      </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">type</span>=<span class="st0">'hidden'</span>
          <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#register</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Given Name'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_first'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Family Name'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_last'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Desired Nickname'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_roomnick'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;required</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Your URL'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_url'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Email Address'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_email'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'FAQ Entry'</span>
          <span class="re0">type</span>=<span class="st0">'text-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#register_faqentry'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>用户应该 SHOULD 接着提交这个表单:
</p><p><b>例子 64. 用户提交注册表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'reg2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:iq:register'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#register</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_first'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Brunhilde</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_last'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Entwhistle-Throckmorton</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_roomnick'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">thirdwitch</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_url'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://witchesonline/~hag66/</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_email'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hag66@witchesonline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_faqentry'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Just another witch.</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果期望的房间昵称已经被那个房间保留, 房间必须 MUST 返回一个 &lt;conflict/&gt; 错误给该用户:
</p><p><b>例子 65. 房间返回冲突错误给用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'reg2'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;conflict</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该房间或服务不支持注册, 它必须 MUST 返回一个 &lt;service-unavailable/&gt; 错误给用户:
</p><p><b>例子 66. 房间返回服务不可用错误给用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'reg2'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;service-unavailable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果用户没有提交合法的数据表格, 房间必须 MUST 返回一个 &lt;bad-request/&gt; 错误给用户:
</p><p><b>例子 67. 房间返回"服务错误的请求"错误给用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'reg2'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;bad-request</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>否则, 该房间必须 MUST 通知用户注册请求被成功地接收到了:
</p><p><b>例子 68. 房间通知用户注册请求已经被处理了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'reg2'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>用户提交表单之后, 服务可以 MAY 向一个房间 管理员/所有者 请求批准该申请 (参见本文的<a href="/XEP-0045#.E6.89.B9.E5.87.86.E6.B3.A8.E5.86.8C.E7.94.B3.E8.AF.B7" title="XEP-0045">批准注册申请</a>章节) 或也可以 MAY 立刻把该用户的岗位从"none"变更为"member"来添加此用户到成员列表. 如果服务变更了该用户的岗位并且该用户在房间里, 它必须 MUST 从这个用户发送更新的出席信息给所有房客, 声明岗位的变更，这个更新的出席信息应包含一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间 &lt;x/&gt; 元素并包含一个'affiliation' 属性值设为"member"的 &lt;item/&gt; 子元素.
</p><p><b>例子 69. 服务发送成员变更通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果一个用户已经注册到一个房间, 该房间可以 MAY 选择限制这个用户在那个房间仅能使用已注册的昵称. 如果它这样做, 当用户尝试以不同于该用户之前已注册的房间昵称来加入该房间 (这使房间锁定"lock down"房间昵称以保证房客身份的一致性)的时候，它应该 SHOULD 返回一个 &lt;not-acceptable/&gt; 错误给该用户.
</p>
<h3> <span class="mw-headline" id=".E8.8E.B7.E5.8F.96.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8">获取成员列表</span></h3>
<p>根据房间配置如果允许的话, 一个房客可以 MAY 被允许接收房间成员的列表. 详见本文的<a href="/XEP-0045#.E4.BF.AE.E6.94.B9.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8" title="XEP-0045">修改成员列表</a>章节.
</p>
<h3> <span class="mw-headline" id=".E5.8F.91.E7.8E.B0.E4.BF.9D.E7.95.99.E7.9A.84.E6.88.BF.E9.97.B4.E6.98.B5.E7.A7.B0">发现保留的房间昵称</span></h3>
<p>一个用户可以 MAY 有一个保留的房间昵称, 例如通过显式的房间注册, 数据库集成, 或昵称锁定 "lockdown". 用户应该 SHOULD 在尝试进入该房间之前发现自己的保留昵称. 这可以通过发送一个发现服务信息请求并指定一个服务发现节点"x-roomuser-item"给房间JID来做到.
</p><p><b>例子 70. 用户请求保留的昵称</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'getnick1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'x-roomuser-item'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>对一个多用户聊天服务来说，对上述的服务发现节点的支持是可选的 OPTIONAL . 如果房间或服务不支持上述的服务发现节点, 它必须 MUST 返回一个 &lt;feature-not-implemented/&gt; 错误给用户. 如果它支持这个特性并且该用户有一个已注册的昵称, 它必须 MUST 返回这个昵称给这个用户，方法是发送一个服务发现的&lt;identity/&gt;元素，其'name'属性值为这个昵称 (此处 category/type 应该 SHOULD 是 "conference/text"):
</p><p><b>例子 71. 房间返回昵称</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'getnick1'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'x-roomuser-item'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;identity</span>
        <span class="re0">category</span>=<span class="st0">'conference'</span>
        <span class="re0">name</span>=<span class="st0">'thirdwitch'</span>
        <span class="re0">type</span>=<span class="st0">'text'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该用户没有已注册的昵称, 房间必须 MUST 返回一个空的服务发现 &lt;query/&gt; 元素 (根据 <b>XEP-0030</b>).
</p><p>即使一个用户已经注册了一个房间昵称, 服务应该 SHOULD 允许该用户在加入该房间时指定一个不同的昵称 (例如, 为了从不同的客户端资源加入), 尽管该服务可以 MAY 选择通过一个 &lt;not-acceptable/&gt; 错误来锁定 "lock down" 昵称并拒绝该用户 . 如果该用户的客户端在加入该房间之后发送上述请求，服务不能 MUST NOT 返回一个错误给该用户, 而应该 SHOULD 返回上文所述.
</p><p>如果另一个用户尝试以第一个用户保留的房间昵称来加入房间, 服务必须 MUST 拒绝第二个用户并返回一个前文所述的 &lt;conflict/&gt; 错误.
</p>
<h3> <span class="mw-headline" id=".E7.94.B3.E8.AF.B7.E5.8F.91.E8.A8.80.E6.9D.83">申请发言权</span></h3>
<p>在一个被主持的房间里游客是不能发言的 (即, 发送一个消息给所有房客). 为了申请发言权, 一个游客应该 SHOULD 发送包含一个数据表格的 &lt;message/&gt; 节给房间本身, 这个数据表格仅仅是一个 'muc#role' 字段，值为 "participant".
</p><p><b>例子 72. 房客申请发言权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
         <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#request</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#role'</span>
           <span class="re0">type</span>=<span class="st0">'text-single'</span>
           <span class="re0">label</span>=<span class="st0">'Requested role'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>服务接着应该 SHOULD 转发这个请求给房间主持人(们) ，定义于本文的<a href="/XEP-0045#.E6.89.B9.E5.87.86.E5.8F.91.E8.A8.80.E6.9D.83.E7.94.B3.E8.AF.B7" title="XEP-0045">批准发言权申请</a>.
</p>
<h2> <span class="mw-headline" id=".E4.B8.BB.E6.8C.81.E4.BA.BA.E7.94.A8.E4.BE.8B">主持人用例</span></h2>
<p>一个主持人有权在房间里执行特定的动作 (例如, 变更某些房客的角色) 但无权变更岗位的持久信息 (它只能被管理员或所有者) 或定义关于这个房间的信息. 具体哪些动作可由主持人执行，取决于配置. 无论如何, 对于 MUC 框架来说, 主持人被规定有权执行以下动作:
</p>
<ol><li> 在一个半匿名的房间里发现一个房客的全JID(如上文所述缺省会发生)
</li><li> 修改主题
</li><li> 从该房间踢出一个与会者或游客
</li><li> 在一个被主持的房间里授予或撤销发言权
</li><li> 在一个被主持的房间里修改拥有发言权的房客列表
</li></ol>
<p>这些特性将通过一个基于 &lt;iq/&gt; 元素的 请求/应答 交换来实现，这个IQ元素包含一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin'">http://jabber.org/protocol/muc#admin'</a> 名字空间的子元素. 以下例子展示这个协议和实现如何互动达到期望的功能. (以下除非显式地提及, 任何接下来的管理请求必须 MUST 被拒绝,如果该请求的'from'地址 &lt;user@host&gt; 和主持人的纯JID不符的话; 在这种情况下, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误.)
</p>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E6.88.BF.E9.97.B4.E4.B8.BB.E9.A2.98">修改房间主题</span></h3>
<p>多用户聊天室的一个常用特性是变更房间主题的能力. 缺省地, 一个房间里只有角色为主持人 "moderator" 的用户应该 SHOULD 被允许变更主题 (尽管这应该 SHOULD 是可配置的, 结果是如果需要的话，仅仅与会者或甚至游客都被允许修改主题). 主题变更是通过发送一个类型为 "groupchat" 的消息给 &lt;room@service&gt;来实现的, 在这里 &lt;message/&gt; 必须 MUST 包含一个 &lt;subject/&gt; 元素以指定新的主题，但不应该 SHOULD NOT 包含其他元素 (例如, 不应该有 &lt;body/&gt; 元素或 &lt;thread/&gt; 元素).
</p><p><b>例子 73. 主持人变更主题</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="co3">Fire Burn and Cauldron Bubble!</span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果一个 MUC 服务接收到这样一个消息, 它必须 MUST 以发送这个变更主题消息的那个用户的房间JID作为'from'地址来反射这个消息给所有其他房客:
</p><p><b>例子 74. 服务通知所有房客主题变更</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="co3">Fire Burn and Cauldron Bubble!</span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>另外, 当一个新的房客加入房间时，该房间应该 SHOULD 在被发送的讨论历史中包含最后的主题变更.
</p><p>一个接收到这类信息的 MUC 客户端可以 MAY 选择显示一个房间内的消息, 如下:
</p><p><b>例子 75. 客户端显式房间主题变更消息</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">* secondwitch has changed the subject to: Fire Burn and Cauldron Bubble!</span></pre></div></div>
<p>如果一些没有适当权限的人尝试变更房间主题, 服务必须 MUST 返回一个 "error" 类型的消息指明一个 &lt;forbidden/&gt; 错误条件:
</p><p><b>例子 76. 服务返回未被授权变更主题的错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="co3">Fire Burn and Cauldron Bubble!</span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>为了移除现有的主题而不是提供一个新主题 (即, 设置主题为空), 客户端应该发送一个空的 &lt;subject/&gt; 元素 (即,  "&lt;subject/&gt;" 或 "&lt;subject&gt;&lt;/subject&gt;").
</p><p><b>例子 77. 主持人设置空的主题</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E8.B8.A2.E5.87.BA.E6.88.BF.E5.AE.A2">踢出房客</span></h3>
<p>主持人有权从一个房间踢出特定种类的房客 (哪些房客是可被踢的 "kickable" 取决于服务规定, 房间配置, 以及主持人的岗位 -- 见下文). 踢人通常基于房客的房间昵称来执行 (尽管可以 MAY 基于全JID) 并且完全是通过把与会者或游客的角色设为 "none" 来实现的.
</p><p><b>例子 78. 主持人踢出房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'fluellen@shakespeare.lit/pda'</span>
    <span class="re0">id</span>=<span class="st0">'kick1'</span>
    <span class="re0">to</span>=<span class="st0">'harfleur@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'pistol'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Avaunt, you cullion!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 移除被踢的用户，通过发送一个类型为 "unavailable" 的出席信息节给每个被踢的房客, 这个出席信息应在其扩展出席信息中包含状态码 307 , 或(可选地)包含 reason 子元素(如果提供了) 以及踢人的执行者的纯JID.
</p><p><b>例子 79. 服务移除被踢的房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'harfleur@henryv.shakespeare.lit/pistol'</span>
    <span class="re0">to</span>=<span class="st0">'pistol@shakespeare.lit/harfleur'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;actor</span> <span class="re0">jid</span>=<span class="st0">'fluellen@shakespeare.lit'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Avaunt, you cullion!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'307'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>包含状态码可使客户端能够提交他们自己的通知消息 (例如, 适当的用户位置的信息). 可选的包含原因 reason 元素以及执行者 actor 使得被踢的用户能理解为什么他或她被踢了, 以及被踢的用户可以找谁去理论. <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">18</a>
</p><p>移除被踢的房客(们)之后, 服务必须 MUST 接着通知主持人成功了:
</p><p><b>例子 80. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'harfleur@henryv.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'kick1'</span>
    <span class="re0">to</span>=<span class="st0">'fluellen@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>通知主持人之后, 服务必须 MUST 接着通知剩余的房客那个被踢的房客已经不在房间里了,即从被踢者的房间昵称(&lt;room@service/nick&gt;)发送 "unavailable" 类型的出席信息节给所有剩余的房客 (就像房客自愿退出房间时所做的一样), 包含状态码 status 以及可选的原因 reason 和执行者 actor.
</p><p><b>例子 81. 服务通知剩余的房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'harfleur@henryv.shakespeare.lit/pistol'</span>
    <span class="re0">to</span>=<span class="st0">'gower@shakespeare.lit/cell'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'307'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>一个用户不能被比自己岗位低的主持人踢出. 所以, 如果一个身为与会者的主持人尝试踢出一个管理员，或一个身为与会者的主持人或管理员尝试踢出一个所有者, 服务必须 MUST 拒绝这个请求并返回一个 &lt;not-allowed/&gt; 错误给发送者:
</p><p><b>例子 82. 服务对于尝试踢出更高岗位的用户返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'kicktest'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'firstwitch'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Be gone!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果一个主持人尝试踢出他自己, 服务可以 MAY 拒绝这个请求并返回一个 &lt;conflict/&gt; 错误给发送者. (尽管这个踢出自己的行为可能看起来怪异, 它在 IRC 里很常见，用于在房间里为某人的行为道歉.)
</p>
<h3> <span class="mw-headline" id=".E6.8E.88.E4.BA.88.E6.B8.B8.E5.AE.A2.E5.8F.91.E8.A8.80.E6.9D.83">授予游客发言权</span></h3>
<p>在一个被主持的房间里, 主持人可能希望管理房间内谁有水没有发言权 "voice" (即, 发送消息给所有房客的能力). 发言权的授予是基于游客的房间昵称来的, 服务将从内部把这个房间昵称转成游客的全JID. 主持人通过把游客的角色变更为与会者 "participant"来给一个游客授予权限.
</p><p><b>例子 83. 主持人授予权限给一个游客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'voice1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL:
</p><p><b>例子 84. 主持人授予权限给一个游客(包含一个原因 Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'voice1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着通知主持人成功了:
</p><p><b>例子 85. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voice1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着以这个人的&lt;room@service/nick&gt;发送更新的出席信息给所有房客, 在这个出席信息里包含了一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间的">http://jabber.org/protocol/muc#user'名字空间的</a>&lt;x/&gt;元素，&lt;x/&gt;元素则包含一个&lt;item/&gt;子元素，其'role'属性值为"participant"，指明添加了发言权.
</p><p><b>例子 86. 服务发送发言权通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.92.A4.E9.94.80.E4.B8.8E.E4.BC.9A.E8.80.85.E5.8F.91.E8.A8.80.E6.9D.83">撤销与会者发言权</span></h3>
<p>在一个被主持的房间里, 主持人可能希望撤销一个与会者发言的权力,主持人通过把与会者的角色变更为游客 "visitor"来撤销一个游客的发言权:
</p><p><b>例子 87. 主持人撤销一个与会者的发言权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'voice2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL:
</p><p><b>例子 88. 主持人撤销一个与会者的发言权(包含一个原因Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'voice2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Not so worthy after all!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着通知主持人成功了:
</p><p><b>例子 89. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voice2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着以这个人的&lt;room@service/nick&gt;发送更新的出席信息给所有房客, 在这个出席信息里包含了一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间的">http://jabber.org/protocol/muc#user'名字空间的</a>&lt;x/&gt;元素，&lt;x/&gt;元素则包含一个&lt;item/&gt;子元素，其'role'属性值为"visitor"，指明移除了发言权.
</p><p><b>例子 90. 服务通知失去发言权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>一个主持人不能 MUST NOT 从一个岗位等于或高于主持人岗位的用户撤销发言权. 另外, 服务不能 MUST NOT 允许一个管理员或所有者的发言权被任何人撤销. 如果一个主持人尝试撤销这些人的发言权, 服务必须 MUST 拒绝这个请求并返回一个 &lt;not-allowed/&gt; 的错误给发送者(通过以下的违规条目):
</p><p><b>例子 91. 服务对于尝试从管理员，所有者或更高岗位的用户撤销权限返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voicetest'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'secondwitch'</span> <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E5.8F.91.E8.A8.80.E6.9D.83.E5.88.97.E8.A1.A8">修改发言权列表</span></h3>
<p>在一个被主持的房间里主持人可能希望管理发言权列表. 为了达到这个目的, 主持人首先查询房间所有角色为'participant'的房客列表来请求发言权列表.
</p><p><b>例子 92. 主持人请求发言权列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'voice3'</span>
    <span class="re0">to</span>=<span class="st0">'goodfolk@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着返回发言权列表给主持人; 每个条目必须 MUST 包含 'nick' 和 'role' 属性并且应该 SHOULD 包含 'affiliation' 和 'jid' 属性:
</p><p><b>例子 93. 服务发送发言权列表给主持人</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'goodfolk@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voice3'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'polonius@hamlet/castle'</span>
          <span class="re0">nick</span>=<span class="st0">'Polo'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'horatio@hamlet/castle'</span>
          <span class="re0">nick</span>=<span class="st0">'horotoro'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
          <span class="re0">nick</span>=<span class="st0">'Hecate'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>主持人可以 MAY 接着修改发言权列表. 为了达到这个目的, 主持人必须 MUST 发送变更了的条目 (即, 只有 "delta") 给服务; 每个条目必须 MUST 包含 'nick' 属性和 'role' 属性 (通常设置值为 "participant" 或 "visitor") 但是不应该 SHOULD NOT 包含 'jid' 属性并且不能 MUST NOT 包含 'affiliation' 属性 (它用于管理如所有者那样的岗位而不是与会者那样的角色):
</p><p><b>例子 94. 主持人发送修改的发言权列表给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'voice4'</span>
    <span class="re0">to</span>=<span class="st0">'goodfolk@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'Hecate'</span>
          <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'rosencrantz'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy fellow.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'guildenstern'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy fellow.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着通知主持人成功了:
</p><p><b>例子 95. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'goodfolk@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voice1'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着为任何受影响的人发送更新的出席信息给所有房客, 如前文的用例所述，发送适当的扩展出席信息来指明发言权的变更.
</p><p>大家知道, 不能撤销一个房间所有者或管理员的发言权, 也不能撤销比发出请求的主持人岗位高的用户的发言权. 如果一个房间管理员尝试通过修改发言权列表来撤销这类用户的发言权, 服务必须 MUST 拒绝请求并返回一个 &lt;not-allowed/&gt; 错误给发送者:
</p><p><b>例子 96. 服务返回错误给试图撤销管理员，所有者或比发送者岗位更高的用户的发言权的发送者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'goodfolk@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'voicetest'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span>
          <span class="re0">nick</span>=<span class="st0">'Hecate'</span>
          <span class="re0">role</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.89.B9.E5.87.86.E5.8F.91.E8.A8.80.E6.9D.83.E7.94.B3.E8.AF.B7">批准发言权申请</span></h3>
<p>在本文的<a href="/XEP-0045#.E7.94.B3.E8.AF.B7.E5.8F.91.E8.A8.80.E6.9D.83" title="XEP-0045">申请发言权</a>章节提到, 当服务接受到一个来自房客的请求，它应该 SHOULD 转发那个请求给房间的主持人(们). 为了达到这个目的, 服务应该 SHOULD 发送一个 &lt;message/&gt; 节给房间主持人(们), 这里 &lt;message/&gt; 节包含一个数据表格data form来批准或拒绝这个申请, 如下所示.
</p><p>'<i>例子 97. 申请批准发言权表格</i>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
         <span class="re0">id</span>=<span class="st0">'approve'</span>
         <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Voice request</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
    <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
      To approve this request for voice, select 
      the </span><span class="co4">&amp;quot;</span><span class="co3">Grant voice to this person?</span><span class="co4">&amp;quot;</span><span class="co3">
      checkbox and click OK. To skip this request, 
      click the cancel button.
    </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#request</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#role'</span>
           <span class="re0">type</span>=<span class="st0">'text-single'</span>
           <span class="re0">label</span>=<span class="st0">'Requested role'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#jid'</span>
           <span class="re0">type</span>=<span class="st0">'text-single'</span>
           <span class="re0">label</span>=<span class="st0">'User ID'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hag66@shakespeare.lit/pda</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomnick'</span>
           <span class="re0">type</span>=<span class="st0">'text-single'</span>
           <span class="re0">label</span>=<span class="st0">'Room Nickname'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">thirdwitch</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#request_allow'</span>
           <span class="re0">type</span>=<span class="st0">'boolean'</span>
           <span class="re0">label</span>=<span class="st0">'Grant voice to this person?'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">false</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>为了批准这个申请, 主持人将提交此表格:
</p><p><b>例子 98. 批准发言权申请</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/pda'</span>
         <span class="re0">id</span>=<span class="st0">'approve'</span>
         <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#request</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#role'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#jid'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hag66@shakespeare.lit/pda</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomnick'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">thirdwitch</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#request_allow'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">true</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果主持人批准了这个发言权申请, 服务将授予发言权给该房客并发送一个出席信息更新，如本文<a href="/XEP-0045#.E6.8E.88.E4.BA.88.E6.B8.B8.E5.AE.A2.E5.8F.91.E8.A8.80.E6.9D.83" title="XEP-0045">授予游客发言权</a>章节所述.
</p>
<h2> <span class="mw-headline" id=".E7.AE.A1.E7.90.86.E5.91.98.E7.94.A8.E4.BE.8B">管理员用例</span></h2>
<p>一个房间管理员有权修改用户岗位的持久信息 (例如, 通过禁止用户) 并授予和撤销主持人权限, 但是无权修改房间的定义, 那是唯一属于房间所有者(们)的权力. 具体哪些动作是管理员可以执行的则取决于配置. 无论如何, 在 MUC 框架中的用途, 规定房间管理员最少拥有执行以下操作的权限:
</p>
<ol><li> 在房间里禁止一个用户
</li><li> 在房间里修改黑名单
</li><li> 授予或撤销成员资格
</li><li> 修改成员列表
</li><li> 授予或撤销主持人权力
</li><li> 修改主持人列表
</li></ol>
<p>这些特性将由一个 请求/应答 request/response 式的交换来实现，使用 &lt;iq/&gt; 元素，包含满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin'">http://jabber.org/protocol/muc#admin'</a> 名字空间的子元素. 以下例子展示协议如何与实现互动以得到期望的功能. (以下除非显示地声明, 如果发送方的'from'地址中的&lt;user@host&gt;和任何房间管理员的纯JID都不同，接下来的任何管理请求必须 MUST 被拒绝; 这种情况下, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误.)
</p>
<h3> <span class="mw-headline" id=".E7.A6.81.E6.AD.A2.E7.94.A8.E6.88.B7">禁止用户</span></h3>
<p>在房间里一个管理员或所有者可以禁止一个或多个用户. 这动作必须 MUST 基于房客的纯JID来执行. 为了禁止一个用户, 管理员必须 MUST 把该用户的岗位改为"outcast".
</p><p><b>例子 99. 管理员禁止用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">id</span>=<span class="st0">'ban1'</span>
    <span class="re0">to</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 100. 管理员禁止用户(包含一个原因 Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">id</span>=<span class="st0">'ban1'</span>
    <span class="re0">to</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 把那个纯JID添加到黑名单, 应该 SHOULD 把被排斥者的昵称从已注册的昵称列表中移除, 并且必须 MUST 通知管理员或所有者成功了:
</p><p><b>例子 101. 服务通知管理员或所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ban1'</span>
    <span class="re0">to</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 也移除任何还在房间中的被禁止的用户，通过发送 "unavailable" 类型的出席信息节给每个被禁止的房客, 在扩展的出席信息中包含一个状态码 301 , 可选地带上 reason (如果服务提供的话) 以及执行这个禁止动作的用户的纯JID.
</p><p><b>例子 102. 服务移除被禁止的用户</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'southampton@henryv.shakespeare.lit/cambridge'</span>
    <span class="re0">to</span>=<span class="st0">'earlofcambridge@shakespeare.lit/stabber'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;actor</span> <span class="re0">jid</span>=<span class="st0">'kinghenryv@shakespeare.lit'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'301'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>包含状态码可使客户端能够提交他们自己的通知消息 (例如, 适当的用户位置的信息). 可选的包含原因 reason 元素以及执行者 actor 使得被踢的用户能理解为什么他或她被踢了, 以及被踢的用户可以找谁去理论.
</p><p>通知主持人之后, 服务必须 MUST 接着通知剩余的房客那个被禁止的房客已经不在房间里了,即从被禁止用户发送 "unavailable" 类型的出席信息节给所有剩余的房客 (就像房客自愿退出房间时所做的一样), 包含状态码 status 以及可选的原因 reason 和执行者 actor. 
</p><p><b>例子 103. 服务通知剩余的房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span>
    <span class="re0">from</span>=<span class="st0">'southampton@henryv.shakespeare.lit/cambridge'</span>
    <span class="re0">to</span>=<span class="st0">'exeter@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit/stabber'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'301'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>就像<a href="/XEP-0045#.E8.B8.A2.E5.87.BA.E6.88.BF.E5.AE.A2" title="XEP-0045">踢出房客</a>一样, 一个用户不能被自己岗位低的管理员禁止. 所以, 如果一个管理员尝试禁止一个所有者， 服务必须 MUST 拒绝这个请求并返回一个 &lt;not-allowed/&gt; 错误给发送者: 
</p><p><b>例子 104. 服务对尝试禁止更高岗位用户返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">id</span>=<span class="st0">'ban1'</span>
    <span class="re0">to</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果一个管理员或所有者尝试禁止他自己, 服务必须 MUST 拒绝这个请求并返回一个 &lt;conflict/&gt; 错误给发送者. (注意:这和踢出自己时推荐的服务行为不同, 踢自己的行为服务是允许的.)
</p>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E9.BB.91.E5.90.8D.E5.8D.95">修改黑名单</span></h3>
<p>房间管理员可能希望修改黑名单. 注意: 黑名单总是基于用户的纯JID. 要修改黑名单, 管理员首先向房间查询所有岗位为'outcast'的用户以得到黑名单.
</p><p><b>例子 105. 管理员请求黑名单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">id</span>=<span class="st0">'ban2'</span>
    <span class="re0">to</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着返回黑名单给管理员; 每个条目必须 MUST 包含 'affiliation' 和 'jid' 属性但不应该 SHOULD NOT 包含 'nick' 和 'role' 属性:
</p><p><b>例子 106. 服务发送黑名单给管理员</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ban2'</span>
    <span class="re0">to</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>管理员可以 MAY 接着修改黑名单. 为此, 管理员必须 MUST 发送变更的条目 (即, 仅是 "delta") 给服务; 每个条目必须 MUST 包含 'affiliation' 属性 (通常设为"outcast"来禁止或"none"来取消禁止) 和 'jid' 属性，但不应该 SHOULD NOT 包含 'nick' 属性，不能 MUST NOT 包含 'role' 属性 (它用来管理角色，例如与会者，而不是被排斥者岗位); 另外, reason 和 actor 元素是可选的 OPTIONAL:
</p><p><b>例子 107. 管理员发送修改的黑名单给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">id</span>=<span class="st0">'ban3'</span>
    <span class="re0">to</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'earlofcambridge@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span><span class="re2">&gt;</span><span class="co3">
          jid='lordscroop@shakespeare.lit'&gt;
      </span><span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'sirthomasgrey@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Treason</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>更新黑名单之后, 服务必须 MUST 通知管理员成功了:
</p><p><b>例子 108. 服务通知管理员成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'southampton@henryv.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ban3'</span>
    <span class="re0">to</span>=<span class="st0">'kinghenryv@shakespeare.lit/throne'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着移除受影响的房客 (如果他们在房间里) 并从他们发送更新的出席信息 (包含适当的状态码) 给所有剩余的房客，如 "禁止用户" 用例所述. (服务应该 SHOULD 也移除从保留房间昵称列表中移除每个被禁止的用户的保留昵称, 如果必要.)
</p><p>当一个实体被一个房间禁止, 实现应该 SHOULD 按以下顺序匹配 JIDs (这些匹配规则和<b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a></b>中定义的隐私列表的匹配规则是相同的):
</p>
<ol><li> &lt;user@domain/resource&gt; (仅匹配特定的资源)
</li><li> &lt;user@domain&gt; (匹配任何资源)
</li><li> &lt;domain/resource&gt; (仅匹配特定资源)
</li><li> &lt;domain&gt; (匹配域名本身, 就像任何 user@domain 或 domain/resource 一样)
</li></ol>
<p>一些管理员可能希望在一个 MUC 服务中的所有房间里禁止所有和特定域名相关的用户. 这个功能是一个服务级的特性，所以超过了本文的范围, 它定义在 <b>XEP-0133</b>里.
</p>
<h3> <span class="mw-headline" id=".E6.8E.88.E4.BA.88.E6.88.90.E5.91.98.E8.B5.84.E6.A0.BC">授予成员资格</span></h3>
<p>管理员可以授予成员资格给一个用户; 方法是把用户的岗位改为 "member" (通常如果用户在房间里，基于昵称，如果用户不在房间里，则基于纯JID; 在这两种情况下如果提供了昵称, 那么这个昵称就是用户在这个房间的缺省昵称，如果实现支持那个功能的话):
</p><p><b>例子 109. 管理员授予成员资格</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 110. 管理员授予成员资格(包含一个原因Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 把这个用户添加到成员列表，然后通知管理员成功了:
</p><p><b>例子 111. 服务通知管理员成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'member1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该用户在房间里, 服务必须 MUST 接着以这个用户的名义发送更新的出席信息给所有房客, 在这个出席信息里包含了一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间的">http://jabber.org/protocol/muc#user'名字空间的</a>&lt;x/&gt;元素，&lt;x/&gt;元素则包含一个&lt;item/&gt;子元素，其'affiliation'属性值为"member"，指明授予了成员资格.
</p><p><b>例子 112. 服务发送成员资格通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果该用户不在房间里, 服务可以 MAY 从房间本身发送一个消息给房间的房客们, 在这个消息里包含了一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间的">http://jabber.org/protocol/muc#user'名字空间的</a>&lt;x/&gt;元素，&lt;x/&gt;元素则包含一个&lt;item/&gt;子元素，其'affiliation'属性值为"member"，指明授予了成员资格.
</p><p><b>例子 113. 服务发送成员资格通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.92.A4.E9.94.80.E6.88.90.E5.91.98.E8.B5.84.E6.A0.BC">撤销成员资格</span></h3>
<p>一个管理员可能想撤销一个用户的成员资格; 通过把该用户的岗位改为"none":
</p><p><b>例子 114. 管理员撤销成员资格</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 115. 管理员撤销成员资格(包含一个原因Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Not so worthy after all!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span> 
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 从成员列表中移除该用户然后通知主持人成功了:
</p><p><b>例子 116. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'member2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着以这个用户的名义发送更新的出席信息节给所有房客, 在这个出席信息里包含了一个满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'名字空间的">http://jabber.org/protocol/muc#user'名字空间的</a>&lt;x/&gt;元素，&lt;x/&gt;元素则包含一个&lt;item/&gt;子元素，其'affiliation'属性值为"none"，指明失去了成员资格.
</p><p><b>例子 117. 服务通知失去成员资格</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果房间是仅限会员的, 服务必须 MUST 从房间移除这个用户, 包含一个状态码 321 来指明用户被移除是因为岗位变更, 并通知所有剩余的房客:
</p><p><b>例子 118. 服务移除非会员</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span><span class="co3">
    type='unavailable'&gt;
  </span><span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;actor</span> <span class="re0">jid</span>=<span class="st0">'bard@shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'321'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span><span class="co3">
    type='unavailable'&gt;
  </span><span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'321'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E6.88.90.E5.91.98.E5.88.97.E8.A1.A8">修改成员列表</span></h3>
<p>在一个仅限会员的房间的上下文里, 成员列表本质上是一个允许人们加入房间的白名单 "whitelist". 任何不是成员的人等于是被禁止加入该房间, 即使他们的岗位不是"outcast".
</p><p>在一个开放房间的上下文里, 成员列表只是一个注册了这个房间的用户 (纯JID和保留的昵称) 的列表. 这些用户可以出现在一个房间名册里, 有他们自己的保留房间昵称, 在搜索结果或类似FAQ里被返回给(查询者).
</p><p>推荐 RECOMMENDED 在仅限会员的房间里只让房间管理员拥有修改成员列表的权力. 为此, 管理员首先请求成员列表，通过查询房间里所有岗位为"member"的用户来实现:
</p><p><b>例子 119. 管理员请求成员列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member3'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: 在一个仅限会员的房间里，服务也应该 SHOULD 返回成员列表给任何房客; 即, 当一个房间的成员请求房间列表时，它不应该 SHOULD NOT 生成一个 &lt;forbidden/&gt; 错误. 这个功能可帮助客户端展示所有现有的成员，即使他们中的一些人不在房间里, 例如. 帮助成员确定是否另一个用户应该被邀请. 服务也应该 SHOULD 允许任何成员接收成员列表，即使还不是一个房客（译注：即未进入房间）.
</p><p>服务必须 MUST 接着返回全部的成员列表给管理员，遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin'">http://jabber.org/protocol/muc#admin'</a> 名字空间; 每个条目必须 MUST 包含 'affiliation' 和 'jid' 属性，每个正在房间里的成员可以 MAY 包含 'nick' 和 'role' 属性.
</p><p><b>例子 120. 服务发送成员列表给管理员</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'member3'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span>
          <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>管理员可以 MAY 接着修改成员列表. 为此, 管理员必须 MUST 发送变更的条目 (即, 仅 "delta") 给服务; 每个条目必须 MUST 包含 'affiliation' 属性(通常值设为 "member" 或 "none") 和 'jid' 属性，但不应该 SHOULD NOT 包含 'nick' 属性，并且不能 MUST NOT 包含 'role' 属性(它是用来管理角色的，例如与会者，而不是成员的岗位):
</p><p><b>例子 121. 管理员发送修改的成员列表给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'member4'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 修改成员列表然后通知主持人成功了:
</p><p><b>例子 122. 服务通知主持人成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'member4'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 变更任何受影响的用户的岗位. 如果该用户已经从成员列表中移除了, 服务必须 MUST 把该用户的岗位从 "member" 变更为 "none". 如果该用户已经被加入到成员列表, 服务必须 MUST 把该用户的岗位改成 "member".
</p><p>如果一个被移除的成员正在一个仅限会员的房间, 服务应该 SHOULD 踢出这个房客，如前文所述，通过把被移除的成员的角色改成 "none" 并发送适当的出席信息给这个被移除的成员来实现. 无论是否被移除的那个用户在或不在一个仅限会员的房间里, 服务必须 MUST 随后拒绝这个用户的进入.
</p><p>对所有的房间类型来说, 服务必须 MUST 以这个用户的名义发送更新的出席信息给所有的房客, 这个出席信息拥有一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的&lt;x/&gt; 元素并包含一个&lt;item/&gt;子元素, 这个子元素的'affiliation'属性值设为"none",以指明这个岗位的变更.
</p><p><b>例子 123. 服务发送失去成员资格的通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>另外, 服务必须 SHOULD 发送一个邀请给任何已加入到仅限会员的房间里的成员名单中的用户，如果该用户目前在该房间还没有岗位, 例如作为一个管理员或所有者(这类用户在定义时不在房间里; 同时要注意这个例子里使用了一个密码password而不是原因reason -- 这两个子元素都是可选的 OPTIONAL):
</p><p><b>例子 124. 房间发送邀请给新成员</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>因为只有管理员们和所有者们应该 SHOULD 被允许修改成员列表, 一个实现可以 MAY 提供一个配置选项，在仅限会员的房间里开放邀请权限给任何成员. 这种情况下, 任何被发送的邀请都应该 SHOULD 自动触发被邀请者加入成员列表. 无论如何, 如果邀请权限被限于管理员们，而普通成员尝试发送邀请, 服务必须 MUST 拒绝这个邀请的的请求并返回一个 &lt;forbidden/&gt; 错误给发送者:
</p><p><b>例子 125. 服务在普通成员尝试邀请其他人加入仅限会员的房间时返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">
        Hey Hecate, this is the place for all good witches!
      </span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>从开放房间发送的邀请不能 MUST NOT 触发被邀请者加入成员列表.
</p><p>如果一个用户被加入一个开放房间的成员列表并且该用户在该房间内, 服务必须 MUST 以该用户的名义发送更新的出席信息给所有房客, 这个出席信息拥有一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的&lt;x/&gt; 元素并包含一个&lt;item/&gt;子元素, 这个子元素的'affiliation'属性值设为"member",以指明这个岗位的变更.
</p><p><b>例子 126. 服务发送成员资格通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/hecate'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.8E.88.E4.BA.88.E4.B8.BB.E6.8C.81.E4.BA.BA.E6.9D.83.E9.99.90">授予主持人权限</span></h3>
<p>管理员可能想授予主持人权限给一个与会者或游客; 通过把用户的角色改为 "moderator":
</p><p><b>例子 127. 管理员授予主持人权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 128. 管理员授予主持人权限(包含一个原因Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span> 
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 添加这个用户到主持人列表然后通知管理员成功了:
</p><p><b>例子 129. 服务通知管理员成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'mod1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着以该用户的名义发送更新的出席信息给所有的房客, 这个出席信息拥有一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的&lt;x/&gt; 元素并包含一个&lt;item/&gt;子元素, 这个子元素的'role'属性值设为"moderator",以指明添加了主持人权限.
</p><p><b>例子 130. 服务发送主持人权限通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.92.A4.E9.94.80.E4.B8.BB.E6.8C.81.E4.BA.BA.E6.9D.83.E9.99.90">撤销主持人权限</span></h3>
<p>管理员可能想撤销用户的主持人权限. 一个管理员只可以 MAY 撤销岗位为"member" 或 "none" (也就是, 非管理员和所有者)的用户的主持人权限. 权限的撤销是通过把用户的角色改为 "participant"实现的:
</p><p><b>例子 131. 管理员撤销主持人权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 132. 管理员撤销主持人权限(包含一个原因Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Not so worthy after all!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span> 
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 从主持人列表移除这个用户然后通知管理员成功了: 
</p><p><b>例子 133. 服务通知管理员成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'mod2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 接着以该用户的名义发送更新的出席信息给所有的房客, 这个出席信息拥有一个满足 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的&lt;x/&gt; 元素并包含一个&lt;item/&gt;子元素, 这个子元素的'role'属性值设为"participant",以指明移除了主持人权限. 
</p><p><b>例子 134. 服务通知失去了主持人权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>大家知道, 管理员不 MUST NOT 被允许从岗位为 "owner" 或 "admin"的用户撤销主持人权限. 如果一个管理员尝试撤销这类用户的权限, 服务必须MUST 拒绝这个请求并返回一个 &lt;not-allowed/&gt; 错误给发送者:
</p><p><b>例子 135. 服务在用户尝试撤销管理员或所有者的主持人权限时返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'modtest'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'secondwitch'</span> <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E4.B8.BB.E6.8C.81.E4.BA.BA.E5.88.97.E8.A1.A8">修改主持人列表</span></h3>
<p>管理员可能希望修改主持人列表. 为此, 管理员首先通过请求房间内所有角色为'moderator'的用户来请求主持人列表.
</p><p><b>例子 136. 管理员请求主持人列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod3'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着返回主持人列表给管理员; 每个条目必须 MUST 包含 'jid', 'nick', 'role' 属性并应该 SHOULD 包含 'affiliation' 属性:
</p><p><b>例子 137. 服务发送主持人列表给管理员</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'mod3'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">nick</span>=<span class="st0">'thirdwitch'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>管理员可以 MAY 接着修改主持人列表. 为此, 管理员必须 MUST发送修改的条目(即, 仅"delta") 给服务; 每个条目必须 MUST 包含 'jid' 属性和'role' 属性(通常值设为 "member" 或 "participant") 但不应该 SHOULD NOT 包含 'nick' 属性并且不能 MUST NOT 包含 'affiliation' 属性(它被用于管理类似管理员这样的岗位而不是主持人这样的角色):
</p><p><b>例子 138. 管理员发送修改了的主持人列表给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'mod4'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 修改主持人列表并通知管理员成功了:
</p><p><b>例子 139. 服务通知管理员成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'mod4'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 随后以所有受影响的用户发送更新的出席信息给所有的房客, 支出主持人权限的变更，通过发送前面用例所述的适当的扩展出席信息.
</p><p>显然, 房间所有者或房间管理员的主持人权限不能被撤销. 如果一个房间管理员尝试通过修改主持人列表来撤销这类用户的主持人权限, 服务必须 MUST 拒绝请求并返回一个 &lt;not-allowed/&gt; 错误给发送者:
</p><p><b>例子 140. 服务在用户尝试撤销管理员或所有者的主持人权限时返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'modtest'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit/broom'</span>
          <span class="re0">nick</span>=<span class="st0">'Hecate'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.89.B9.E5.87.86.E6.B3.A8.E5.86.8C.E7.94.B3.E8.AF.B7">批准注册申请</span></h3>
<p>如果一个服务不自动接受注册到房间的请求, 它可以 MAY 为房间管理员提供一个方法来批准或拒绝来自 Jabber 的注册请求(替代方案是, 它可能提供一个 web 接口或一些其他管理工具). 对这个服务来说，最简单的办法就是，当接收到注册请求时发送一个 &lt;message/&gt; 节给房间管理员(们), 这里的&lt;message/&gt; 节包含一个数据表格 Data Form asking 用来询问管理员是否批准用户的注册申请. 推荐 RECOMMENDED 以下数据表格 Data Form，但是实现可以 MAY 使用完全不同的表格, 或or 在下面的表格基础上补充字段.
</p><p><b>例子 141. 注册申请批准表格</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
         <span class="re0">id</span>=<span class="st0">'approve'</span>
         <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/pda'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Registration request</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
    <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
      To approve this registration request, select the
      </span><span class="co4">&amp;quot;</span><span class="co3">Allow this person to register with the room?</span><span class="co4">&amp;quot;</span><span class="co3">
      checkbox and click OK. To skip this request, click the 
      cancel button.
    </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span> <span class="re0">type</span>=<span class="st0">'hidden'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#register</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_first'</span>
           <span class="re0">type</span>=<span class="st0">'text-single'</span>
           <span class="re0">label</span>=<span class="st0">'Given Name'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Brunhilde</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_last'</span>
           <span class="re0">type</span>=<span class="st0">&quot;text-single&quot;</span>
           <span class="re0">label</span>=<span class="st0">&quot;Family Name&quot;</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Entwhistle-Throckmorton</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_roomnick'</span>
           <span class="re0">type</span>=<span class="st0">&quot;text-single&quot;</span>
           <span class="re0">label</span>=<span class="st0">&quot;Desired Nickname&quot;</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">thirdwitch</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_url'</span>
           <span class="re0">type</span>=<span class="st0">&quot;text-single&quot;</span>
           <span class="re0">label</span>=<span class="st0">&quot;User URL&quot;</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://witchesonline/~hag66/</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_email'</span>
           <span class="re0">type</span>=<span class="st0">&quot;text-single&quot;</span>
           <span class="re0">label</span>=<span class="st0">&quot;Email Address&quot;</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hag66@witchesonline</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_faqentry'</span>
           <span class="re0">type</span>=<span class="st0">&quot;text-single&quot;</span>
           <span class="re0">label</span>=<span class="st0">&quot;FAQ Entry&quot;</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">Just another witch.</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#register_allow'</span>
           <span class="re0">type</span>=<span class="st0">'boolean'</span>
           <span class="re0">label</span>=<span class="st0">'Allow this person to register with the room?'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>如果管理员批准了注册申请, 服务将把该用户注册到房间.
</p><p>更多高级的批准机制(例如, 使用特定命令<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0050.html">Ad-Hoc Commands</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">19</a>来接收注册申请列表,就像 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0060.html">Publish-Subscribe</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">20</a>里所做的一样) 超出了本文的范围.
</p>
<h2> <span class="mw-headline" id=".E6.89.80.E6.9C.89.E8.80.85.E7.94.A8.E4.BE.8B">所有者用例</span></h2>
<p>每个房间必须 MUST 至少有一个所有者, 而所有者(或一个成功者)在一个房间的生命周期里是这个房间长期存在的属性(例如, 所有者在退出一个持久性的房间时不会失去所有权). 本文假定(初始的) 房间所有者是那个新建了该房间的用户并且有一个房间所有者有权修改房间配置选项的定义，例如房间类型. 理想情况下, 房间所有者不仅能指定房间类型(密码保护的, 仅限会员的, 等等) 而且包括如本文的 [XEP-0045#需求|需求]章节所述的房间特定属性. 另外, 如果所有者能指定其他所有者们的JID也是不错的, 但那将取决于具体实现.
</p><p>为了让配置选项更加广泛提供必要的伸缩性, 房间配置将使用 Data Forms (<b>XEP-0004</b>), 通过使用由 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间触发. 也就是, 如果一个实体在它请求加入房间的 join/request 里不包含 MUC 名字空间, 那么服务将立刻新建房间，在新建房间之前不等待通过数据表格进行配置(这保证了和旧的"groupchat 1.0"协议的向后兼容); 无论如何, 如果房间的 join/create 请求包含了 MUC 扩展, 那么服务在新建和解锁该房间之前将通过数据表格请求配置.
</p><p>注意: 以下展示的配置选项列出了本文的需求章节的所有特性和房间类型; 无论如何, 实际的配置选项和表格布局将取决于实现和具体的布署. 而且, 这些只是例子，不代表这些就是房间可以拥有的所有允许或需要的配置选项. 一个特定的实现或布署可以 MAY 选择提供额外的配置选项(敏感词过滤, 设置房间的缺省语言, 消息记录, 等等), 这就是为什么在这里使用 'jabber:x:data' 协议是很有价值的.
</p>
<h3> <span class="mw-headline" id=".E6.96.B0.E5.BB.BA.E6.88.BF.E9.97.B4">新建房间</span></h3>
<h4> <span class="mw-headline" id=".E4.B8.80.E8.88.AC.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9">一般注意事项</span></h4>
<p>新建房间的权限可以 MAY 限制在特定的用户群或可以 MAY 保留给一个服务级别的管理员. 如果访问被拒绝而一个用户试图新建一个房间, 服务必须MUST 返回一个 &lt;not-allowed/&gt; 错误:
</p><p><b>例子 142. 服务通知用户不能新建房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-allowed</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>如果访问不限制, 服务必须 MUST 允许用户按以下步骤新建房间.
</p><p>从房间创建的视角来看, 本质上有两种房间:
</p>
<ul><li> 即时房间"Instant rooms" -- 可以立刻访问并基于某些缺省配置自动创建.
</li><li> 保留房间"Reserved rooms" -- 在任何人访问之前由房间配置者手动创建.
</li></ul>
<p>新建和配置这些房间的流程如下:
</p>
<ol><li> 用户必须 MUST 发送出席信息到 &lt;room@service/nick&gt; 并声明他或她对MUC协议的支持，通过包含一个扩展的出席信息,并包含在一个空的满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'名字空间的">http://jabber.org/protocol/muc'名字空间的</a> &lt;x/&gt; 子元素里(注意这里不包含 '#owner' 或 '#user' 后缀).
</li><li> 如果用户被允许新建房间并且房间还不存在, 服务必须 MUST 根据一些缺省配置新建此房间, 指定请求的用户成为初始的房间拥有者, 并增加这个拥有者到该房间但不允许任何别的用户进入该房间(有效地锁定 "locking"该房间). 从房间发送由所有者收到的初始的出席信息节必须 MUST 包含扩展的出席信息以指出该用户的状态为一个所有者并承认房间已经被创建了(通过状态码 201) 并等待配置.
</li><li> 如果初始的房间所有者想新建和配置一个保留房间, 房间所有者必须 MUST 接着请求一个配置，通过发送类型为"get"的IQ节并包含一个空的满足'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'名字空间的">http://jabber.org/protocol/muc#owner'名字空间的</a>&lt;query/&gt;元素给该房间 ,然后完成第4和第5步. 如果房间所有者喜欢新建一个即时房间, 该房间所有者必须 MUST 发送一个遵循'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'名字空间的">http://jabber.org/protocol/muc#owner'名字空间的</a> query 元素并包含一个遵循 'jabber:x:data' 名字空间的空的类型为 "submit" 的 &lt;x/&gt; 元素, 然后跳到第6步.
</li><li> 如果房间所有者请求了一个配置表格, 服务必须 MUST 发送一个包含配置表格并遵循 'jabber:x:data'名字空间的 IQ 给房间拥有者. 如果没有配置选项可用, 房间必须 MUST 返回一个空的 query 元素给房间所有者.
</li><li> 初始的房间所有者应该 SHOULD 为该房间提供一个开始的配置(或接受缺省配置)，通过发送"set"类型并包含完整的配置表格的 IQ . 另外, 房间所有者可以 MAY 取消配置过程. (实现可以 MAY 设置一个初始化配置的超时, 这样如果房间所有者再给定的超时时间内不配置房间, 房间所有者就被假定已经接受了缺省得配置或取消了配置过程.)
</li><li> 一旦服务从初始房间所有者接收了完整的配置表格(或接收到了一个即时房间的请求), 服务必须 MUST 解锁 "unlock" 这个房间 (即, 允许其他用户进入此房间) 并发送"result"类型的 IQ  给房间所有者. 如果服务接收到了取消（指令）, 它必须 MUST 销毁这个房间.
</li></ol>
<p>以下例子展示了这个协议流程.
</p><p>首先, Jabber用户必须 MUST 发送出席信息给房间, 包含空的 &lt;x/&gt; 元素，遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间(当他寻求进入一个房间时也发送和这同样的节).
</p><p><b>例子 143. Jabber用户新建一个房间并声明对多用户聊天的支持</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>如果该房间不存在, 服务应该 SHOULD 新建这个房间(取决于关于新建房间的本地策略), 指定发出请求的用户的纯JID成为所有者, 添加这个所有者到房间, 并通过发送以下格式的出席信息节承认房间新建成功:
</p><p><b>例子 144. 服务承认房间新建成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'110'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'201'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>接收到该房间已经创建的通知之后, 房间所有者需要决定是否接受缺省的房间配置(即, 新建一个即时房间 "instant room") 还是做一些不同于缺省房间设置的配置 (即, 新建一个保留房间"reserved room"). 完成这两个用例的协议流程展示如下.
</p><p>注意: 如果如上的发送到一个不存在的房间里的出席信息节没有包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'名字空间的">http://jabber.org/protocol/muc'名字空间的</a> &lt;x/&gt; 元素, 服务应该SHOULD 立刻新建一个缺省的房间(即, 它必须 MUST 假定客户端支持 "groupchat 1.0" 而不是 Multi-User Chat, 所以在等待房间创建者决定是创建即时房间还是保留房间的时候,它不能 MUST NOT 锁定这个房间).
</p>
<h4> <span class="mw-headline" id=".E6.96.B0.E5.BB.BA.E5.8D.B3.E6.97.B6.E6.88.BF.E9.97.B4">新建即时房间</span></h4>
<p>如果初始的房间所有者想接受缺省的房间配置(即, 新建一个即时房间"instant room"), 房间所有者必须 MUST 拒绝初始配置表格,通过发送一个 IQ set 给 &lt;room@service&gt; 本身,包含一个遵循'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'名字空间的">http://jabber.org/protocol/muc#owner'名字空间的</a> &lt;query/&gt; 元素, 这里 &lt;query/&gt; 的唯一子元素是一个空的遵循'jabber:x:data'名字空间的 &lt;x/&gt; 元素并且拥有一个 'type'属性值为 "submit":
</p><p><b>例子 145. 所有者请求即时房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 接着解锁该房间并允许其他实体加入它.
</p>
<h4> <span class="mw-headline" id=".E6.96.B0.E5.BB.BA.E4.BF.9D.E7.95.99.E6.88.BF.E9.97.B4">新建保留房间</span></h4>
<p>如果初始的房间所有者想新建并配置一个保留房间, 这个房间所有者必须 MUST 请求初始配置表格,通过发送一个 IQ get 给 &lt;room@service&gt; 本身,包含一个空的遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'">http://jabber.org/protocol/muc#owner'</a> 名字空间的 &lt;query/&gt; 元素&#160;:
</p><p><b>例子 146. 所有者请求配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果房间还不存在, 服务必须 MUST 返回一个初始的房间配置表单给该用户. (注意: 以下例子展示一个配置选项的典型例子. 已登记用于房间创建和配置的所有 x:data 字段列表由 XMPP Registrar 维护; 参见本文的 <a href="/XEP-0045#XMPP.E6.B3.A8.E5.86.8C.E9.A1.B9.E4.BA.8B.E9.A1.B9" title="XEP-0045">XMPP注册项事项</a> 章节.)
</p><p><b>例子 147. 服务发送配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Configuration for &quot;darkcave&quot; Room</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
      <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
          Your room darkcave@macbeth has been created!
          The default configuration is as follows:
            - No logging
            - No moderation
            - Up to 20 occupants
            - No password required
            - No invitation required
            - Room is not persistent
            - Only admins may change the subject
            - Presence broadcasted for all users
          To accept the default configuration, click OK. To
          select a different configuration, please complete
          this form.
      </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">type</span>=<span class="st0">'hidden'</span>
          <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roomconfig</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Natural-Language Room Name'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomname'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Short Description of Room'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomdesc'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Natural Language for Room Discussions'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_lang'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Enable Public Logging?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_enablelogging'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Allow Occupants to Change Subject?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_changesubject'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Allow Occupants to Invite Others?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_allowinvites'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Maximum Number of Occupants'</span>
          <span class="re0">type</span>=<span class="st0">'list-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_maxusers'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">20</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'10'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'20'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">20</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'30'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">30</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'50'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">50</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'100'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">100</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'None'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">none</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Roles for which Presence is Broadcast'</span>
          <span class="re0">type</span>=<span class="st0">'list-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_presencebroadcast'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderator'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Participant'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Visitor'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Roles and Affiliations that May Retrieve Member List'</span>
          <span class="re0">type</span>=<span class="st0">'list-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_getmemberlist'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderator'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Participant'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Visitor'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Publicly Searchable?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_publicroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Persistent?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_persistentroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Moderated?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_moderatedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Members-Only?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_membersonly'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Password Required to Enter?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_passwordprotectedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          If a password is required to enter this room,
          you must specify the password below.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Password'</span>
          <span class="re0">type</span>=<span class="st0">'text-private'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomsecret'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Who May Discover Real JIDs?'</span>
          <span class="re0">type</span>=<span class="st0">'list-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_whois'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderators Only'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderators</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Anyone'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">anyone</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          You may specify additional people who have
          administrative privileges in the room. Please
          provide one Jabber ID per line.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Room Admins'</span>
          <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomadmins'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          You may specify additional owners for this
          room. Please provide one Jabber ID per line.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Room Owners'</span>
          <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomowners'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>注意: _whois 配置选项指定该房间是非匿名的(值为 "anyone"), 半匿名的(值为"moderators"), 还是全匿名的(值为"none", 不显示在这).
</p><p>如果没有配置选项可用, 服务必须 MUST 返回空的 query 元素给房间所有者:
</p><p><b>例子 148. 服务通知所有者没有配置可用</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>房间所有者应该 SHOULD 接着填好表单并提交给服务.
</p><p><b>例子 149. 所有者提交配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'submit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roomconfig</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomname'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">A Dark Cave</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomdesc'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">The place for all good witches!</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_enablelogging'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_changesubject'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_allowinvites'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_maxusers'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_publicroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_persistentroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_moderatedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_membersonly'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_passwordprotectedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomsecret'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_whois'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderators</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomadmins'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">wiccarocks@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hecate@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果房间创建成功, 服务必须 MUST 通知新的房间所有者成功了:
</p><p><b>例子 150. 服务通知新房间所有者成功</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果因为指定的房间配置违反了一个或多个服务策略而导致房间创建失败 (例如, 因为密码保护房间的密码为空), 服务必须 MUST 返回一个 &lt;not-acceptable/&gt; 错误.
</p><p><b>例子 151. 服务通知所有者请求的配置选项不被接受</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'modify'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;not-acceptable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>另一方面, 房间所有者可以 MAY 取消配置过程:
</p><p><b>例子 152. 所有者取消初始的配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'create2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果房间所有者取消了初始的房间配置, 服务应该 SHOULD 销毁房间, 确保发送不可用出席信息给房间所有者 (详见 "销毁房间" 用例).
</p><p>如果房间所有者在提交表单之前因为任何原因下线了(例如, 失去连接), 服务将接收到一个类型为 "unavailable" 的出席信息节，从所有者到所有者的 &lt;room@service/nick&gt; 或到 &lt;room@service&gt; (或两者). 服务必须 MUST 接着销毁这个房间, 发送一个 "unavailable" 类型的出席信息节，从房间到所有者，包含一个 &lt;destroy/&gt; 元素以及 reason (子元素)(如果提供了) ，参见本文的 <a href="/XEP-0045#.E9.94.80.E6.AF.81.E6.88.BF.E9.97.B4" title="XEP-0045">销毁房间</a>章节.
</p>
<h4> <span class="mw-headline" id=".E7.94.B3.E8.AF.B7.E5.94.AF.E4.B8.80.E6.88.BF.E9.97.B4.E5.90.8D">申请唯一房间名</span></h4>
<p>在一些场合 (例如, 当 <a href="/XEP-0045#.E6.8A.8A.E4.B8.80.E5.AF.B9.E4.B8.80.E8.81.8A.E5.A4.A9.E8.BD.AC.E4.B8.BA.E5.A4.9A.E7.94.A8.E6.88.B7.E4.BC.9A.E8.AE.AE" title="XEP-0045">把一对一聊天转为会议</a>), 房间创建者可能想在尝试新建房间之前请求一个唯一的房间名 (例如, 避免可能的房间冲突). 为此, 服务可以 MAY 如本章所述支持这个特性. (如果服务支持这个特性, 它必须 MUST 在对服务发现信息请求应答时返回一个 "<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#unique">http://jabber.org/protocol/muc#unique</a>" 特性.)
</p><p>房间创建者通过发送一个 IQ-get 给服务本身来请求唯一房间名, 这个IQ节中包含一个空的 &lt;unique/&gt; 元素，遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#unique'">http://jabber.org/protocol/muc#unique'</a> 名字空间:
</p><p><b>例子 153. 实体请求唯一房间名</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'unique1'</span>
    <span class="re0">to</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;unique</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#unique'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果服务支持这个特性, 它应该 SHOULD 以 XML 字符数据的方式返回一个唯一房间名，包含一个 &lt;unique/&gt; 元素 (但不创建该房间):
</p><p><b>例子 154. 服务返回唯一房间名</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'unique1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;unique</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#unique'</span><span class="re2">&gt;</span><span class="co3">
    6d9423a55f499b29ad20bf7b2bdea4f4b885ead1
  </span><span class="re1">&lt;/unique<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务可以 MAY 拒绝返回一个唯一房间名给一个没有资格创建房间的实体, 或那些发送请求唯一房间名过多次数的实体, 等等.
</p><p>服务可以 MAY 使用算法保证房间名的创建在服务上下文中是唯一的 (例如, 对发出请求的JID,datetime,和random salt的SHA-1 哈希运算).
</p><p>房间创建者将接着使用 XML 字符数据 &lt;unique/&gt; 元素作为它请求的房间JID的节点标识符(ID):
</p><p><b>例子 155. 所有者以唯一名创建房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> 
    <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">to</span>=<span class="st0">'6d9423a55f499b29ad20bf7b2bdea4f4b885ead1@chat.shakespeare.lit/firstwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E9.9A.8F.E5.90.8E.E7.9A.84.E6.88.BF.E9.97.B4.E9.85.8D.E7.BD.AE">随后的房间配置</span></h3>
<p>在指定房间的初始配置之后的任何时间, 房间所有者可能想修改房间配置. 为此, 房间所有者必须 MUST 向房间发出一个新的配置表单请求,通过发送一个 IQ 到 &lt;room@service&gt; ，包含一个空的 &lt;query/&gt; 元素，遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'">http://jabber.org/protocol/muc#owner'</a> 名字空间.
</p><p><b>例子 156. 所有者请求配置表单</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果'from'地址的 &lt;user@host&gt; 部分和房间所有者的纯JID不符, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误给发送者:
</p><p><b>例子 157. 服务禁止非所有者的访问配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'configures'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>另外, 服务必须 MUST 以当前使用的选项组作为缺省值发送一个配置表单给房间所有者:
</p><p><b>例子 158. 服务发送配置表单给所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'config1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'form'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;title<span class="re2">&gt;</span></span><span class="co3">Configuration for &quot;darkcave&quot; Room</span><span class="re1">&lt;/title<span class="re2">&gt;</span></span>
      <span class="re1">&lt;instructions<span class="re2">&gt;</span></span><span class="co3">
        Complete this form to make changes to
        the configuration of your room.
      </span><span class="re1">&lt;/instructions<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">type</span>=<span class="st0">'hidden'</span>
          <span class="re0">var</span>=<span class="st0">'FORM_TYPE'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roomconfig</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Natural-Language Room Name'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomname'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">A Dark Cave</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Short Description of Room'</span>
          <span class="re0">type</span>=<span class="st0">'text-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomdesc'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">The place for all good witches!</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Enable Public Logging?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_enablelogging'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Allow Occupants to Change Subject?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_changesubject'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Allow Occupants to Invite Others?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_allowinvites'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Maximum Number of Occupants'</span>
          <span class="re0">type</span>=<span class="st0">'list-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_maxusers'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'10'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">10</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'20'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">20</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'30'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">30</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'50'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">50</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'100'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">100</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'None'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">none</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Roles for which Presence is Broadcast'</span>
          <span class="re0">type</span>=<span class="st0">'list-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_presencebroadcast'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderator'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Participant'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Visitor'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Roles and Affiliations that May Retrieve Member List'</span>
          <span class="re0">type</span>=<span class="st0">'list-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_getmemberlist'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderator'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderator</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Participant'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">participant</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Visitor'</span><span class="re2">&gt;</span><span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">visitor</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span><span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Publicly Searchable?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_publicroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Persistent?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_persistentroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Moderated?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_moderatedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Make Room Members Only?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_membersonly'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">0</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Password Required for Entry?'</span>
          <span class="re0">type</span>=<span class="st0">'boolean'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_passwordprotectedroom'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">1</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          If a password is required to enter this room,
          you must specify the password below.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Password'</span>
          <span class="re0">type</span>=<span class="st0">'text-private'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomsecret'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Who May Discover Real JIDs?'</span>
          <span class="re0">type</span>=<span class="st0">'list-single'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_whois'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderators</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Moderators Only'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">moderators</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
        <span class="re1">&lt;option</span> <span class="re0">label</span>=<span class="st0">'Anyone'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">anyone</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/option<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          You may specify additional people who have
          administrative privileges in the room. Please
          provide one Jabber ID per line.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Room Admins'</span>
          <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomadmins'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">wiccarocks@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">hecate@shakespeare.lit</span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span> <span class="re0">type</span>=<span class="st0">'fixed'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;value<span class="re2">&gt;</span></span><span class="co3">
          You may specify additional owners for this
          room. Please provide one Jabber ID per line.
        </span><span class="re1">&lt;/value<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/field<span class="re2">&gt;</span></span>
      <span class="re1">&lt;field</span>
          <span class="re0">label</span>=<span class="st0">'Room Owners'</span>
          <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
          <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomowners'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果没有配置选项可用, 服务必须 MUST 返回一个空的 query 元素给房间所有者，如前面的用例所示.
</p><p>该房间所有者应该 SHOULD 接着以更新的配置信息提交表单.
</p><p>另外, 房间所有者可以 MAY 取消这次配置过程:
</p><p><b>例子 159. 所有者取消随后的配置</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'config2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果房间所有者取消随后的配置, 服务必须 MUST 让该房间的配置保持和房间所有者请求这次配置之前一样.
</p><p>如果一次房间配置变更导致一个房间管理员失去管理权限，而这个管理员正在房间里, 该房间必须 MUST 为那个管理员发送更新的出席信息给所有房客, 表明状态的变更，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "member" 或 'role' 属性值为 "participant" 或 "visitor" ，以适当地表达岗位级别和房间类型:
</p><p><b>例子 160. 服务通知失去管理员岗位</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果一次房间配置变更导致一个用户获得管理员权限，而这个用户正在房间里, 房间必须 MUST 为那个用户发送更新的出席信息给所有房客, 表明状态的变更，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "admin" 或 'role' 属性值为 "admin"&#160;:
</p><p><b>例子 161. 服务通知所有用户有人获得管理员岗位</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果一次房间配置变更导致一个房间所有者失去所有者权限，而这个所有者正在房间里, 该房间必须 MUST 为那个所有者发送更新的出席信息给所有房客, 表明状态的变更，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "admin" 或 'role' 属性值为根据岗位和房间类型确定的适当的值(推荐为"moderator").
</p><p><b>例子 162. 服务通知失去所有者岗位</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果没有其他所有者，服务不能 MUST NOT 允许一个所有者撤销他或她自己的所有权; 如果一个所有者企图这么干, 服务必须 MUST 返回一个 &lt;conflict/&gt; 错误给这个所有者. 然而, 如果有其他所有者，服务应该 SHOULD 允许一个所有者撤销自己的所有者权限.
</p><p>如果一次房间配置变更导致一个用户获得所有者权限，而这个用户正在房间里, 房间必须 MUST 为那个用户发送更新的出席信息给所有房客, 表明状态的变更，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "owner" 或 'role' 属性值为根据岗位和房间类型确定的适当的值(推荐为"moderator").
</p><p><b>例子 163. 服务通知所有用户有人获得所有者权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果一次房间配置变更导致房间类型变成仅限会员，但还有非成员在房间里, 服务必须 MUST 从房间移除任何非成员，并在发送给那些剩余的房客的 '不可用' 出席信息节里包含状态码 322.
</p>
<h4> <span class="mw-headline" id=".E9.85.8D.E7.BD.AE.E5.8F.98.E6.9B.B4.E9.80.9A.E7.9F.A5">配置变更通知</span></h4>
<p>当一个房间的配置变更会对房间的隐私和安全策略产生影响时，该房间必须 MUST 发送通知给所有房客. 这个通知将包括一个 &lt;message/&gt; 节，包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的 &lt;x/&gt; 元素,  &lt;x/&gt; 元素则只有一个 &lt;status/&gt; 子元素，其 'code' 属性为一个适当的值. 这是例子:
</p><p><b>例子 164. 配置状态码</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
         <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
         <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;status</span> <span class="re0">code</span>=<span class="st0">'170'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>房间配置中和隐私相关的策略变更导致生成这些状态码，如下:
</p>
<ul><li> 如果房间日志功能可用了, 状态码 170.
</li><li> 如果房间日志现在禁止了, 状态码 171.
</li><li> 如果房间现在是非匿名的了, 状态码 172.
</li><li> 如果房间现在是半匿名的了, 状态码 173.
</li><li> 如果房间现在是全匿名的了, 状态码 174.
</li></ul>
<p>对更多其他配置变更, 房间应该 SHOULD 发送状态码 104 这样感兴趣的房客如果想要的话可以接受到更新的房间配置.
</p>
<h3> <span class="mw-headline" id=".E6.8E.88.E4.BA.88.E6.89.80.E6.9C.89.E8.80.85.E6.9D.83.E9.99.90">授予所有者权限</span></h3>
<p>如果实现允许, 一个所有者可以 MAY 授予所有权给其他用户; 只要把用户的岗位改成"owner":
</p><p><b>例子 165. 所有者授予所有权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'owner1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL.
</p><p><b>例子 166. 所有者授予所有权(饱含一个原因 Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'owner1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 把用户添加到所有者列表并通知所有者成功了:
</p><p><b>例子 167. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'owner1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该用户在房间里, 服务必须 MUST 接着以这个用户的名义发送更新的出席信息给所有房客, 表明已授予所有权，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "owner" 并且 'role' 属性值为根据岗位和房间类型确定的适当的值(推荐为"moderator"). 
</p><p><b>例子 168. 服务发送所有权通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/hecate'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果该用户不在房间, 服务可以 MAY 从房间本身发送一个消息给房间的房客们, 表明已授予所有权，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "owner" . 
</p><p><b>例子 169. 服务发送所有权通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.92.A4.E9.94.80.E6.89.80.E6.9C.89.E8.80.85.E6.9D.83.E9.99.90">撤销所有者权限</span></h3>
<p>实现可以 MAY 允许一个所有者撤销其他用户的所有权; 只要把用户的岗位改成非"owner":
</p><p><b>例子 170. 所有者撤销所有权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'owner2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt;元素是可选的 OPTIONAL.
</p><p><b>例子 171. 所有者撤销所有权(包含一个原因)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'owner2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Not so worthy after all!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span> 
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果没有其它所有者，服务不能 MUST NOT 允许一个所有者撤销他或她自己的所有权; 如果一个所有者尝试这么干, 服务必须 MUST 返回一个 &lt;conflict/&gt; 错误给该所有者. 然而, 如果有其他所有者，服务应该 SHOULD 允许一个所有者撤销自己的所有权.
</p><p>如果一个实现不允许所有者撤销另一个用户的所有权, 实现必须 MUST 返回一个 &lt;not-authorized/&gt; 错误给做出这个请求的所有者.
</p><p>注意: 允许一个所有者移除其它用户的所有权能给房间管理一个折衷的控制模式; 所以这个特性是可选的 OPTIONAL, 并且鼓励实现支持通过一个只有拥有服务范围管理权限的用户使用的接口来移除所有者.
</p><p>其它情况下, 服务必须 MUST 把用户从所有者列表移除并通知所有者成功了:
</p><p><b>例子 172. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'owner2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该用户在房间里, 服务必须 MUST 接着以这个用户的名义发送更新的出席信息给所有房客, 表明已失去所有权，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为非 "owner" 并且 'role' 属性值为根据岗位和房间类型确定的适当的值:
</p><p><b>例子 173. 服务通知失去所有权</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果该用户不在房间, 服务可以 MAY 从房间本身发送一个消息给房间的房客们, 表明已失去所有权，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为非 "owner" .
</p><p><b>例子 174. 服务发送失去所有权通知给所有房客 </b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E6.89.80.E6.9C.89.E8.80.85.E5.88.97.E8.A1.A8">修改所有者列表</span></h3>
<p>如果实现允许, 一个房间所有者可能想修改所有者列表. 为此, 所有者首先请求所有者列表，通过向房间请求所有岗位为 'owner'的用户.
</p><p><b>例子 175. 所有者请求所有者列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'owner3'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果'from'地址的 &lt;user@host&gt; 部分和房间所有者的纯JID不符, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误给发送者.
</p><p>否则, 服务必须 MUST 接着返回所有者列表给所有者; 每个条目必须 MUST 包含 'affiliation' 和 'jid' 属性，对任何正是一名房客（也就是正在房间里）的所有者可以 MAY 包含 'nick' 和 'role' 属性:
</p><p><b>例子 176. 服务发送所有者列表给所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'owner3'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'crone1@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>所有者可以 MAY 接着修改所有者列表. 为此, 所有者必须 MUST 发送修改的条目 (即, 仅 "delta") 给服务; <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">21</a>每个条目必须 MUST 包含 'affiliation' 和 'jid' 属性，但不应该 SHOULD NOT 包含 'nick' 属性，不能 MUST NOT 包含 'role' 属性 (它用于管理参与者之类的角色，而不是所有者之类的岗位):
</p><p><b>例子 177. 所有者发送修改过的所有者列表给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'owner4'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>只有所有者被允许修改所有者列表. 如果一个非所有者试图察看或修改所有者列表, 服务必须 MUST 拒绝这个请求并返回一个 &lt;forbidden/&gt; 错误给发送者:
</p><p><b>例子 178. 服务对于非所有者试图修改所有者列表返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'ownertest'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'owner'</span> 
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果没有别的所有者，服务不能 MUST NOT 允许一个所有者撤销自己的所有权; 如果一个所有者尝试这么干, 服务必须 MUST 返回一个 &lt;conflict/&gt; 错误给该所有者. 然而, 如果有其他所有者，服务应该 SHOULD 允许一个所有者撤销自己的所有权. 
</p><p>其它情况下, 服务必须 MUST 修改所有者列表并通知所有者成功了: 
</p><p><b>例子 179. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'owner4'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 也为任何因前述所有者列表修改而导致的岗位变化而发送出席信息通知.
</p>
<h3> <span class="mw-headline" id=".E6.8E.88.E4.BA.88.E7.AE.A1.E7.90.86.E5.91.98.E6.9D.83.E9.99.90">授予管理员权限</span></h3>
<p>一个所有者可以授予管理员权限给一个成员或无岗位的用户; 只要把用户的岗位改成"admin":
</p><p><b>例子 180. 所有者授予管理员权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'admin1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt; 元素是可选的 OPTIONAL. 
</p><p><b>例子 181. 所有者授予管理员权限(包含一个原因 Reason)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'admin1'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">A worthy witch indeed!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 把用户添加到管理员列表并通知所有者成功了:
</p><p><b>例子 182. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'admin1'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该用户在房间里, 服务必须 MUST 接着以这个用户的名义发送更新的出席信息给所有房客, 表明已授予管理员权限，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "admin" 并且 'role' 属性值为根据岗位和房间类型确定的适当的值. 
</p><p><b>例子 183. 服务发送管理员权限通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果该用户不在房间, 服务可以 MAY 从房间本身发送一个消息给房间的房客们, 表明已授予管理员权限，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为 "admin".
</p><p><b>例子 184. 服务发送管理员权限通知给所有房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E6.92.A4.E9.94.80.E7.AE.A1.E7.90.86.E5.91.98.E6.9D.83.E9.99.90">撤销管理员权限</span></h3>
<p>一个所有者可能想撤销一个用户的管理员权限; 只要把用户的岗位改成非"admin"和非"owner":
</p><p><b>例子 185. 所有者撤销管理员权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'admin2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>&lt;reason/&gt;元素是可选的 OPTIONAL. 
</p><p><b>例子 186. 所有者撤销管理员权限(包含一个原因)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'admin2'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Not so worthy after all!</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span> 
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务必须 MUST 把该用户从管理员列表移除并接着通知所有者成功了:
</p><p><b>例子 187. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'admin2'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果该用户在房间里, 服务必须 MUST 接着以这个用户的名义发送更新的出席信息给所有房客, 表明已失去管理员权限，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为非"admin"非"owner", 并且 'role' 属性值为根据岗位和房间类型确定的适当的值: 
</p><p><b>例子 188. 服务通知失去管理员权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<p>如果该用户不在房间, 服务可以 MAY 从房间本身发送一个消息给房间的房客们, 表明已失去所有权，通过包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a>  名字空间的的 &lt;x/&gt; 元素以及一个 &lt;item/&gt; 子元素，该 &lt;item/&gt; 子元素的 'affiliation' 属性值为非 "admin" . 
</p><p><b>例子 189. 服务通知失去管理员权限</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span>
    <span class="re0">from</span>=<span class="st0">'chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'member'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span>
          <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span><span class="co3">
&#160;
[ ... ]</span></pre></div></div>
<h3> <span class="mw-headline" id=".E4.BF.AE.E6.94.B9.E7.AE.A1.E7.90.86.E5.91.98.E5.88.97.E8.A1.A8">修改管理员列表</span></h3>
<p>一个房间所有者可能想修改管理员列表. 为此, 所有者首先请求管理员列表，通过向房间请求所有岗位为 'admin'的用户. 
</p><p><b>例子 190. 所有者请求管理员列表</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/desktopaffiliation
    id='</span>admin3<span class="st0">'
    to='</span>darkcave@chat.shakespeare.lit<span class="st0">'
    type='</span>get<span class="st0">'&gt;
  &lt;query xmlns='</span>http://jabber.org/protocol/muc#admin<span class="st0">'&gt;
    &lt;item affiliation='</span>admin<span class="st0">'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;</span></pre></div></div>
<p>如果'from'地址的 &lt;user@host&gt; 部分和房间所有者的纯JID不符, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误给发送者.
</p><p>否则, 服务必须 MUST 接着返回管理员列表给所有者; 每个条目必须 MUST 包含 'affiliation' 和 'jid' 属性，对任何正是一名房客（也就是正在房间里）的管理员可以 MAY 包含 'nick' 和 'role' 属性: 
</p><p><b>例子 191. 服务发送管理员列表给所有者</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'admin3'</span>
    <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'wiccarocks@shakespeare.lit'</span>
          <span class="re0">nick</span>=<span class="st0">'secondwitch'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>所有者可以 MAY 接着修改管理员列表. 为此, 所有者必须 MUST 发送修改的条目 (即, 仅 "delta") 给服务; <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">22</a> 每个条目必须 MUST 包含 'affiliation'属性(通常值为 "admin" 或 "none") 和 'jid' 属性，但不应该 SHOULD NOT 包含 'nick' 属性，不能 MUST NOT 包含 'role' 属性 (它用于管理参与者之类的角色，而不是管理员之类的岗位): 
</p><p><b>例子 192. 所有者发送修改的管理员列表给服务</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'bard@shakespeare.lit/globe'</span>
    <span class="re0">id</span>=<span class="st0">'admin4'</span>
    <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span>
          <span class="re0">jid</span>=<span class="st0">'hag66@shakespeare.lit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span>
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>只有所有者被允许修改管理员列表. 如果一个非所有者试图察看或修改所有者列表, 服务必须 MUST 拒绝这个请求并返回一个 &lt;forbidden/&gt; 错误给发送者: 
</p><p><b>例子 193. 服务对于非所有者试图修改管理员列表返回错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'admintest'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'admin'</span> 
          <span class="re0">jid</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>否则, 服务必须 MUST 修改管理员列表并通知所有者成功了: 
</p><p><b>例子 194. 服务通知所有者成功了</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'admin4'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>服务必须 MUST 也为任何因前述管理员列表修改而导致的岗位变化而发送出席信息通知.
</p>
<h3> <span class="mw-headline" id=".E9.94.80.E6.AF.81.E6.88.BF.E9.97.B4">销毁房间</span></h3>
<p>房间所有者必须 MUST 能够销毁一个房间, 特别是如果这个房间不是持久房间的时候. 流程如下:
</p>
<ol><li> 房间所有者请求销毁房间, 如果必要的话指出一个原因 reason 和一个备用场地.
</li><li> 该房间移除所有房客(包含适当的关于备用场地和被移除的原因的信息) 并销毁房间, 即使它被定义为持久房间.
</li></ol>
<p>不像前述的, 本文不指定一个MUC服务实现收到一个销毁房间请求之后将会如何做. 例如, 如果房间定义为持久地, 一个实现可以 MAY 选择锁定房间I，这样它不能被重用, 把加入该房间的请求重定向到替代场地, 或邀请当前的参与者到新的房间; 无论如何, 这些行为是可选的 OPTIONAL.
</p><p>为了销毁一个房间, 房间所有者必须 MUST 发送一个 IQ set 指令到要销毁的房间的地址. 这个 &lt;iq/&gt; 节将包含一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner'">http://jabber.org/protocol/muc#owner'</a> 名字空间的 &lt;query/&gt; 元素，它将包含一个 &lt;destroy/&gt; 元素. 替代场地的地址可以 MAY 用这个 &lt;destroy/&gt; 元素的 'jid' 属性来提供. 一个密码保护的替代场地可以 MAY 通过 &lt;destroy/&gt; 元素的 &lt;password/&gt; 子元素的 XML 字符数据来提供. 摧毁房间的原因可以 MAY 通过 &lt;destroy/&gt; 元素的 &lt;reason/&gt; 子元素的 XML 字符数据来提供.
</p><p>以下例子展示了协议发送和接收的元素:
</p><p><b>例子 195. 所有者提交房间摧毁请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">id</span>=<span class="st0">'begone'</span>
    <span class="re0">to</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;destroy</span> <span class="re0">jid</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Macbeth doth come.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/destroy<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>服务负责移除所有房客. 它不应该 SHOULD NOT 广播类型为"unavailable"的出席信息节给所有房客, 只需要发送一个"unavailable"类型的出席信息节给每个房客，这样该用户知道他或她已经从房间移除了. 如果所有者的扩展出席信息指定了一个替代场地的 JID 以及房间销毁的原因, 这个出席信息节必须 MUST 包含那些信息.
</p><p><b>例子 196. 服务移除每个房客</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit/firstwitch'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;destroy</span> <span class="re0">jid</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Macbeth doth come.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/destroy<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit/secondwitch'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;destroy</span> <span class="re0">jid</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Macbeth doth come.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/destroy<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;presence</span>
    <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit/thirdwitch'</span>
    <span class="re0">to</span>=<span class="st0">'hag66@shakespeare.lit/pda'</span>
    <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'none'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;destroy</span> <span class="re0">jid</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Macbeth doth come.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/destroy<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 197. 服务通知所有者成功销毁房间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'begone'</span>
    <span class="re0">to</span>=<span class="st0">'crone1@shakespeare.lit/desktop'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">/&gt;</span></pre></div></div>
<p>如果在一个销毁请求中接收到的'from'地址的 &lt;user@host&gt; 和一个房间所有者的纯JID不符, 服务必须 MUST 返回一个 &lt;forbidden/&gt; 错误给发送者:
</p><p><b>例子 198. 服务拒绝由非所有者提交的销毁请求</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'destroytest'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;destroy</span> <span class="re0">jid</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">Macbeth doth come.</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/destroy<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'auth'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;forbidden</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E5.92.8C.E7.8A.B6.E6.80.81.E7.A0.81">错误和状态码</span></h2>
<h3> <span class="mw-headline" id=".E9.94.99.E8.AF.AF.E7.A0.81">错误码</span></h3>
<p>和'<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间相关的错误码相当简单, 总结于下表之中. 关于传统的错误码到XMPP格式的错误之间的映射的详细信息, 参见 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0086.html">错误条件映射</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">23</a>; 实现应该 SHOULD 支持传统和XMPP错误处理两者.
</p><p><b>表9: <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user">http://jabber.org/protocol/muc#user</a> 名字空间的错误码</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>码 </th>
<th>类型 </th>
<th>元素 </th>
<th>上下文 </th>
<th>目的
</th></tr>
<tr>
<td>401 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户需要密码
</td></tr>
<tr>
<td>403 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户他或她被房间禁止了
</td></tr>
<tr>
<td>404 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户房间不存在
</td></tr>
<tr>
<td>405 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户限制创建房间
</td></tr>
<tr>
<td>406 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户必须使用保留的房间昵称
</td></tr>
<tr>
<td>407 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户他或她不在成员列表中
</td></tr>
<tr>
<td>409 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户他或她的房间昵称正在使用或被别的用户注册了
</td></tr>
<tr>
<td>503 </td>
<td>Error </td>
<td>Presence  </td>
<td>进入一个房间 </td>
<td>通知用户已经达到最大用户数
</td></tr></table>
<p>本文不规定和上述错误条件相关的文本字符串(即, XMPP &lt;text/&gt; 元素值).
</p>
<h3> <span class="mw-headline" id=".E7.8A.B6.E6.80.81.E7.A0.81">状态码</span></h3>
<p>多用户聊天的使用一个 &lt;status/&gt; 元素(特指, &lt;status/&gt; 元素的的 'code' 属性  ) 来传达关于用户在一个房间里的状态的信息. 随着时间的推移, 状态码的数量已经增加了很多, 而新的状态码继续被作者申请. 所以, 这些状态码现在记录在一个由XMPP登记处维护的注册表里. 细节可参考本文的 <a href="/XEP-0045#.E7.8A.B6.E6.80.81.E7.A0.81.E6.B3.A8.E5.86.8C.E8.A1.A8" title="XEP-0045">状态码注册表</a>.
</p><p>注意: 通常, MUC 状态码倾向于沿用<a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc2616">RFC 2616</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">24</a> 和 <a rel="nofollow" class="external text" href="http://tools.ietf.org/html/rfc1893">RFC 1893</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">25</a> (1xx 码表示信息, 2xx 码说明情况良好可继续, 3xx 码指定重定向被踢或被禁止的用户, x3x 码指系统状态, x7x 码指安全或策略事务, 等等) 里面的状态码的 "抽象"含义.
</p><p>注意: 如果今天来定义 MUC 协议, 它将指定一个更有弹性的, XML-友好的 途径而不是硬编码的状态数字; 然而, 现在修改状态汇报系统带来的痛苦将远大于好处, 这是为什么状态码数字保持使用至今. 本文的未来版本可能定义一个更 类XMPP 的途径来表示状态条件, 保留状态码数字但是给它们补充更多的描述性的子元素,就像 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a> </b>里那样.
</p>
<h2> <span class="mw-headline" id=".E5.9B.BD.E9.99.85.E5.8C.96.E4.BA.8B.E9.A1.B9">国际化事项</span></h2>
<p>如 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 中所定义的, XMPP 实体 (包括 MUC 房间和 MUC 服务) 应该 SHOULD 遵守任何给定的节提供的 'xml:lang' 属性. 然而, 群聊消息的同声翻译超出了本文的范围.
</p><p>这里定义的状态和错误码允许一个客户端实现展示一个本地化的界面; 然而, 任何给定语言社区的本地化文本字符串的定义超出了本文范围.
</p><p>尽管这里的很多数据表单字段的标签显示为英文, MUC 客户端应该 SHOULD 把这些字段展示为本地化的文本而不是英文文本.
</p>
<h2> <span class="mw-headline" id=".E5.AE.89.E5.85.A8.E4.BA.8B.E9.A1.B9">安全事项</span></h2>
<h3> <span class="mw-headline" id=".E7.94.A8.E6.88.B7.E9.AA.8C.E8.AF.81.E5.92.8C.E6.8E.88.E6.9D.83">用户验证和授权</span></h3>
<p>本文没有定义或要求比明文密码更安全的房间准入验证或授权方法. 然而, 这些潜在的风险可能使用 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 描述的通过使用 TLS 和 SASL 加密通道来减轻.
</p>
<h3> <span class="mw-headline" id=".E7.AB.AF.E5.88.B0.E7.AB.AF.E5.8A.A0.E5.AF.86">端到端加密</span></h3>
<p>这里没有定义没有端到端消息或会话加密方法. 用户不应该 SHOULD NOT 相信一个服务能保持通过房间发送的任何文本的安全.
</p>
<h3> <span class="mw-headline" id=".E9.9A.90.E7.A7.81">隐私</span></h3>
<p>取决于房间配置, 一个房间可以公开地记录房间里发生的所有讨论. 服务必须 MUST 警告用户该房间是公开记录的，通过在该用户的初始出席信息中返回一个状态码 "170" , 并且如果房间讨论被记录 (用户的客户端也应该 SHOULD 在允许用户进入之前查询房间的配置，以"预先发现"房间是否被记录)，该用户的客户端也必须 MUST 警告用户. 如果房间的配置随后修改成允许房间记录(当房间发送状态码 170 时客户端将发现)，客户端也必须 MUST 警告用户 . 注意: 房间内的历史和公开房间记录是不同的, 并且很自然的一个房间不能有效地阻止房客独立维护的自有的房间记录, 它可能被公开; 用户应该 SHOULD 谨慎操作并认识到任何房间讨论可能被有效地公开.
</p>
<h3> <span class="mw-headline" id=".E5.8C.BF.E5.90.8D">匿名</span></h3>
<p>取决于房间配置, 一个房间可以 MAY 暴光每个房客的真实 JID 给其他房客 (如果该房间是非匿名的) 并且将几乎肯定地暴光每个房客的真实 JID 给该房间的所有者和管理员(如果该房间不是全匿名的).服务必须 MUST 警告用户真实 JIDs 在房间被暴光，通过在该用户的初始出席信息中包含状态码 "100" , 并且用户的客户端必须 MUST 警告该用户 (一个用户的客户端应该 SHOULD 也在允许用户进入房间之前查询房间配置以 "预先发现" 是否真实 JIDs 会在房间中暴光). 如果房间配置随后从半匿名或全匿名修改成非匿名(当房间发送状态码 172 时客户端将发现) ，客户端必须 MUST 也警告用户，如果房间的配置随后从全匿名改成半匿名时(当房间发送状态码 173 时客户端将发现)，客户端也应该 SHOULD 警告用户.
</p>
<h3> <span class="mw-headline" id=".E6.8B.92.E7.BB.9D.E6.9C.8D.E5.8A.A1">拒绝服务</span></h3>
<p>公开的 MUC 房间能承受一定数量的攻击, 大部分能减少拒绝服务攻击. 这些攻击包括但不限于:
</p>
<ol><li> 向房间里塞进大量的非法房客从而阻止合法用户加入房间.
</li><li> 发送侮辱性的消息接着在被踢或被禁止之前离开房间; 这些侮辱性的消息包含但不限于，大量消息以阻止参与者正常跟踪会话线索或房间历史, 对参与者的人身攻击 (特别是房间管理员和主持人), 攻击性的文字, 以及垃圾网站链接.
</li><li> 高频率的制造出席信息变更.
</li><li> 使用过长的昵称导致无法看到完整的发言.
</li><li> 辱骂房间管理员或其他房间房客.
</li><li> 在一个服务里注册很多昵称然后禁止这些昵称的使用.
</li><li> 模仿别的房客的昵称(例如, 通过在尾部增加一个空格或看起来相似的字符串), 然后以那个房间昵称发送消息用于欺骗房客.
</li></ol>
<p>这些攻击可能被减轻不能完全被阻止，通过灵活地使用管理员操作。例如禁止用户, 有管理员权限的自动的房间机器人出席信息, 智能内容过滤的实现, 检查连接的用户的 IP 地址(在分布式的系统里不一定能实现), 应用发言规则到出席信息以及消息, 使用比Resourceprep profile of stringprep更严格的规则匹配房间昵称, 等等. 然而, 经验表明无法完全阻止这类攻击.
</p>
<h3> <span class="mw-headline" id=".E5.85.B6.E5.AE.83.E4.BA.8B.E9.A1.B9">其它事项</span></h3>
<p>关于延迟递送符号的列入和流程的更多安全事项参见 <b>XEP-0203</b>.
</p>
<h2> <span class="mw-headline" id="IANA.E4.BA.8B.E9.A1.B9">IANA事项</span></h2>
<p>本文档与<a rel="nofollow" class="external text" href="http://www.iana.org/">互联网编号分配授权机构</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">26</a>无关。
</p>
<h2> <span class="mw-headline" id="XMPP.E7.99.BB.E8.AE.B0.E4.BA.8B.E9.A1.B9">XMPP登记事项</span></h2>
<p><a rel="nofollow" class="external text" href="http://xmpp.org/registrar/">XMPP登记处</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">27</a>在它的登记处包含了以下信息.
</p>
<h3> <span class="mw-headline" id=".E5.8D.8F.E8.AE.AE.E5.90.8D.E5.AD.97.E7.A9.BA.E9.97.B4">协议名字空间</span></h3>
<p>XMPP登记处在它的协议名字空间注册表里包含了以下 MUC相关的名字空间:
</p>
<ul><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc">http://jabber.org/protocol/muc</a>
</li><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin">http://jabber.org/protocol/muc#admin</a>
</li><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner">http://jabber.org/protocol/muc#owner</a>
</li><li> <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user">http://jabber.org/protocol/muc#user</a>
</li></ul>
<h3> <span class="mw-headline" id=".E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E7.A7.8D.E7.B1.BB.2F.E7.B1.BB.E5.9E.8B">服务发现种类/类型</span></h3>
<p>一个多用户聊天服务或房间在服务发现里是用 "conference" 种类categary 和 "text" 类型type 来标识的.
</p>
<h3> <span class="mw-headline" id=".E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E7.89.B9.E6.80.A7">服务发现特性</span></h3>
<p>有很多和MUC相关的服务或房间相关的特性可以被"服务发现"来发现. 这里面最基本的是 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间. 另外, 一个MUC房间应该 SHOULD 提供关于它实现的特定房间特性的信息, 例如密码保护和房间主持.
</p><p><b>注册提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#register</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Support for the muc#register FORM_TYPE</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roomconfig</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Support for the muc#roomconfig FORM_TYPE</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roominfo</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Support for the muc#roominfo FORM_TYPE</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_hidden</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Hidden room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_membersonly</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Members-only room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_moderated</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Moderated room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_nonanonymous</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Non-anonymous room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_open</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Open room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_passwordprotected</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Password-protected room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_persistent</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Persistent room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_public</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Public room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_rooms</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">List of MUC rooms (each as a separate item)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_semianonymous</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Semi-anonymous room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_temporary</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Temporary room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_unmoderated</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Unmoderated room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span>
<span class="re1">&lt;var<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">muc_unsecured</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">Unsecured room in Multi-User Chat (MUC)</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
<span class="re1">&lt;/var<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E7.9F.A5.E5.90.8D.E6.9C.8D.E5.8A.A1.E5.8F.91.E7.8E.B0.E8.8A.82.E7.82.B9">知名服务发现节点</span></h3>
<p>知名服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#rooms'">http://jabber.org/protocol/muc#rooms'</a> 允许发现一个用户是哪个房间的房客.
</p><p>知名服务发现节点 'x-roomuser-item' 允许一个用户从房间外发现自己的已注册房间昵称.
</p><p>知名服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#traffic'">http://jabber.org/protocol/muc#traffic'</a> 允许发现通过一个房间能发送哪些名字空间的通讯(参见本文允许的 <a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节).
</p>
<h3> <span class="mw-headline" id=".E5.AD.97.E6.AE.B5.E6.A0.87.E5.87.86.E5.8C.96">字段标准化</span></h3>
<p><a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0068.html">数据表单的字段标准化</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">28</a> 定义了用于遵循特定名字空间的数据表单的字段标准化的过程. 在 MUC 里面, 使用了四种这类表单: 房间注册 ( "muc#register" FORM_TYPE), 请求发言权和批准请求 ("muc#request"), 房间配置 ("muc#roomconfig"), 以及用于房间信息的服务发现扩展 ("muc#roominfo"). 这些保留的字段定义如下.
</p>
<h4> <span class="mw-headline" id="muc.23register_FORM_TYPE">muc#register FORM_TYPE</span></h4>
<p><b>注册处提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;form_type<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#register</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">
    Forms enabling user registration with a
    Multi-User Chat (MUC) room or admin approval
    of user registration requests.
  </span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;field</span> 
     <span class="re0">var</span>=<span class="st0">'muc#register_allow'</span>
     <span class="re0">type</span>=<span class="st0">'boolean'</span>
     <span class="re0">label</span>=<span class="st0">'Allow this person to register with the room?'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_email'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Email Address'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_faqentry'</span>
      <span class="re0">type</span>=<span class="st0">'text-multi'</span>
      <span class="re0">label</span>=<span class="st0">'FAQ Entry'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_first'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Given Name'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_last'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Family Name'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_roomnick'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Desired Nickname'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#register_url'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Your URL'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/form_type<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id="muc.23request_FORM_TYPE">muc#request FORM_TYPE</span></h4>
<p><b>注册处提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;form_type<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#request</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">
    Forms enabling voice requests in a 
    Multi-User Chat (MUC) room or admin
    approval of such requests.
  </span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#role'</span>
         <span class="re0">type</span>=<span class="st0">'text-single'</span>
         <span class="re0">label</span>=<span class="st0">'Requested role'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#jid'</span>
         <span class="re0">type</span>=<span class="st0">'text-single'</span>
         <span class="re0">label</span>=<span class="st0">'User ID'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#roomnick'</span>
         <span class="re0">type</span>=<span class="st0">'text-single'</span>
         <span class="re0">label</span>=<span class="st0">'Room Nickname'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span> <span class="re0">var</span>=<span class="st0">'muc#request_allow'</span>
         <span class="re0">type</span>=<span class="st0">'boolean'</span>
         <span class="re0">label</span>=<span class="st0">'Whether to grant voice'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/form_type<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id="muc.23roomconfig_FORM_TYPE">muc#roomconfig FORM_TYPE</span></h4>
<p><b>注册处提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;form_type<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roomconfig</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">
    Forms enabling creation and configuration of
    a Multi-User Chat (MUC) room.
  </span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_allowinvites'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Allow Occupants to Invite Others'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_changesubject'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Allow Occupants to Change Subject'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_enablelogging'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Enable Public Logging of Room Conversations'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_getmemberlist'</span>
      <span class="re0">type</span>=<span class="st0">'list-multi'</span>
      <span class="re0">label</span>=<span class="st0">'Roles and Affiliations that May Retrieve Member List'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_lang'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Natural Language for Room Discussions'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_pubsub'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'XMPP URI of Associated Publish-Subcribe Node'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_maxusers'</span>
      <span class="re0">type</span>=<span class="st0">'list-single'</span>
      <span class="re0">label</span>=<span class="st0">'Maximum Number of Room Occupants'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_membersonly'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether an Make Room Members-Only'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_moderatedroom'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Make Room Moderated'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_passwordprotectedroom'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether a Password is Required to Enter'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_persistentroom'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Make Room Persistent'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_presencebroadcast'</span>
      <span class="re0">type</span>=<span class="st0">'list-multi'</span>
      <span class="re0">label</span>=<span class="st0">'Roles for which Presence is Broadcast'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_publicroom'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'Whether to Allow Public Searching for Room'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomadmins'</span>
      <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
      <span class="re0">label</span>=<span class="st0">'Full List of Room Admins'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomdesc'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Short Description of Room'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomname'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Natural-Language Room Name'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomowners'</span>
      <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
      <span class="re0">label</span>=<span class="st0">'Full List of Room Owners'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_roomsecret'</span>
      <span class="re0">type</span>=<span class="st0">'text-private'</span>
      <span class="re0">label</span>=<span class="st0">'The Room Password'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roomconfig_whois'</span>
      <span class="re0">type</span>=<span class="st0">'list-single'</span>
      <span class="re0">label</span>=<span class="st0">'Affiliations that May Discover Real JIDs of Occupants'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/form_type<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id="muc.23roominfo_FORM_TYPE">muc#roominfo FORM_TYPE</span></h4>
<p><b>注册处提交</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;form_type<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc#roominfo</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">
    Forms enabling the communication of extended service discovery
    information about a Multi-User Chat (MUC) room.
  </span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_contactjid'</span>
      <span class="re0">type</span>=<span class="st0">'jid-multi'</span>
      <span class="re0">label</span>=<span class="st0">'Contact Addresses (normally, room owner or owners)'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_description'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Short Description of Room'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_lang'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Natural Language for Room Discussions'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_ldapgroup'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'An associated LDAP group that defines room membership; 
             this should be an LDAP Distinguished Name according to an
             implementation-specific or deployment-specific definition
             of a group.'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_logs'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'URL for Archived Discussion Logs'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_occupants'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Current Number of Occupants in Room'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_subject'</span>
      <span class="re0">type</span>=<span class="st0">'text-single'</span>
      <span class="re0">label</span>=<span class="st0">'Current Subject or Discussion Topic in Room'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;field</span>
      <span class="re0">var</span>=<span class="st0">'muc#roominfo_subjectmod'</span>
      <span class="re0">type</span>=<span class="st0">'boolean'</span>
      <span class="re0">label</span>=<span class="st0">'The room subject can be modified by participants'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/form_type<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E7.8A.B6.E6.80.81.E7.A0.81.E7.99.BB.E8.AE.B0.E5.A4.84">状态码登记处</span></h3>
<h4> <span class="mw-headline" id=".E8.BF.87.E7.A8.8B">过程</span></h4>
<p>XMPP注册员为遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的&lt;status/&gt; 元素的 'code' 属性维护注册表中的值 .
</p><p>为了提交新值给这个注册表, 注册人将按以下格式定义一个XML段并把它包含在相关的XMPP扩展协议中，或者发到&lt;registrar@xmpp.org&gt;:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">the three-digit code number</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">the stanza type of which it is a child (message or presence)</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">the use case or situation in which the status is used</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">a natural-language description of the meaning</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
  <span class="re1">&lt;child<span class="re2">&gt;</span></span><span class="co3">the descriptive child element (reserved for future use)</span><span class="re1">&lt;/child<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span></pre></div></div>
<p>注册人可一次注册多个状态码，每个状态码包含在独立的&lt;statuscode/&gt;元素中。
</p>
<h4> <span class="mw-headline" id=".E5.88.9D.E5.A7.8B.E6.8F.90.E4.BA.A4">初始提交</span></h4>
<p>作为本文的一部分, 以下状态码已被注册了:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">100</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message or presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Entering a room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that any occupant is allowed to see the user's full JID</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">101</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message (out of band)</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Affiliation change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that his or her affiliation changed while not in the room</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">102</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that room now shows unavailable members</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">103</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that room now does not show unavailable members</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">104</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">
    Inform occupants that a non-privacy-related room configuration change has occurred
  </span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">110</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Any room presence</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that presence refers to one of its own room occupants</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">170</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message or initial presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that room logging is now enabled</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">171</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that room logging is now disabled</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">172</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that the room is now non-anonymous</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">173</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that the room is now semi-anonymous</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">174</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">message</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Configuration change</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform occupants that the room is now fully-anonymous</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">201</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Entering a room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that a new room has been created</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">210</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Entering a room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that service has assigned or modified occupant's roomnick</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">301</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Removal from room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that he or she has been banned from the room</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">303</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Exiting a room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform all occupants of new room nickname</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">307</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Removal from room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that he or she has been kicked from the room</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">321</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Removal from room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that he or she is being removed from the room 
    because of an affiliation change</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">322</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Removal from room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that he or she is being removed from the room 
    because the room has been changed to members-only and the user 
    is not a member</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span>
<span class="re1">&lt;statuscode<span class="re2">&gt;</span></span>
  <span class="re1">&lt;number<span class="re2">&gt;</span></span><span class="co3">332</span><span class="re1">&lt;/number<span class="re2">&gt;</span></span>
  <span class="re1">&lt;stanza<span class="re2">&gt;</span></span><span class="co3">presence</span><span class="re1">&lt;/stanza<span class="re2">&gt;</span></span>
  <span class="re1">&lt;context<span class="re2">&gt;</span></span><span class="co3">Removal from room</span><span class="re1">&lt;/context<span class="re2">&gt;</span></span>
  <span class="re1">&lt;purpose<span class="re2">&gt;</span></span><span class="co3">Inform user that he or she is being removed from the room 
    because of a system shutdown</span><span class="re1">&lt;/purpose<span class="re2">&gt;</span></span>
<span class="re1">&lt;/statuscode<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="URI.E6.9F.A5.E8.AF.A2.E7.B1.BB.E5.9E.8B">URI查询类型</span></h3>
<p>作为由<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0147.html">XMPP URI Query Components</a> <a href="/index.php?title=XEP-00450&amp;action=edit&amp;redlink=1" class="new" title="XEP-00450（尚未撰写）">29</a>授权的机构，XMPP注册员维护着一个用于 XMPP URIs 的查询和键-值对的注册表（见&lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/registrar/querytypes.html">http://www.xmpp.org/registrar/querytypes.html</a>&gt;）。
</p>
<h4> <span class="mw-headline" id="join">join</span></h4>
<p>"join" 查询类型被注册为一个 MUC相关的动作, 伴随一个可选的键 "password".
</p><p><b>例子 199. Join动作: IRI/URI</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">xmpp:darkcave@chat.shakespeare.lit?join</span></pre></div></div>
<p>应用必须 MUST 要么展示一个界面允许用户提供一个房间昵称，要么基于配置好的选项或昵称发现来获取这个房间昵称.
</p><p><b>例子 200. Join动作: 结果节</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>join 动作可以 MAY 为这房间包含一个密码. 自然的, 对一个包含了房间密码的 URI 的访问必须 MUST 得到适当的控制.
</p><p><b>例子 201. Join动作包含密码: IRI/URI</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">xmpp:darkcave@chat.shakespeare.lit?join;password=cauldronburn</span></pre></div></div>
<p><b>例子 202. Join动作包含密码: 结果节</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
<p>以下提交注册 "join" 查询类型.
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;querytype<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">join</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;proto<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc</span><span class="re1">&lt;/proto<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">enables joining a multi-user chat room</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;keys<span class="re2">&gt;</span></span>
    <span class="re1">&lt;key<span class="re2">&gt;</span></span>
      <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">password</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
      <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">the password required to enter a multi-user chat room</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/key<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/keys<span class="re2">&gt;</span></span>
<span class="re1">&lt;/querytype<span class="re2">&gt;</span></span></pre></div></div>
<h4> <span class="mw-headline" id="invite">invite</span></h4>
<p>"invite" 查询类型被注册为一个 MUC相关的动作, 伴随一个可选的键 "jid".
</p><p><b>例子 203. Invite动作: IRI/URI</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">xmpp:darkcave@chat.shakespeare.lit?invite;jid=hecate@shakespeare.lit</span></pre></div></div>
<p>如果加入中的用户还未在房间里, 应用必须 MUST 发送两个节: 第一个加入房间，第二个邀请另一个人. 如果加入中的用户已经在房间里, 应用将只发送邀请节.
</p><p><b>例子 204. Invite动作: 结果节(s)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>URI 可以包含多个邀请:
</p><p><b>例子 205. Invite动作包含多个邀请: IRI/URI</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">xmpp:darkcave@chat.shakespeare.lit?invite;jid=hecate@shakespeare.lit;jid=bard@shakespeare.lit</span></pre></div></div>
<p><b>例子 206. Invite动作包含多个邀请: 结果节</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'bard@shakespeare.lit'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>URI 也可以包含一个密码:
</p><p><b>例子 207. Invite动作包含密码: IRI/URI</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="co3">xmpp:darkcave@chat.shakespeare.lit?invite;jid=hecate@shakespeare.lit;password=cauldronburn</span></pre></div></div>
<p>如果加入中的用户还未在房间里, 应用必须 MUST 发送两个节: 第一个加入房间，第二个邀请另一个人. 如果加入中的用户已经在房间里, 应用将只发送邀请节.
</p><p><b>例子 208. Invite动作包含密码: 结果节(s)</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit/thirdwitch'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'darkcave@chat.shakespeare.lit'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'hecate@shakespeare.lit'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">cauldronburn</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
<p>以下提交注册 "invite" 查询类型.
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;querytype<span class="re2">&gt;</span></span>
  <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">invite</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
  <span class="re1">&lt;proto<span class="re2">&gt;</span></span><span class="co3">http://jabber.org/protocol/muc</span><span class="re1">&lt;/proto<span class="re2">&gt;</span></span>
  <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">enables simultaneously joining a groupchat room and inviting others</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;doc<span class="re2">&gt;</span></span><span class="co3">XEP-0045</span><span class="re1">&lt;/doc<span class="re2">&gt;</span></span>
  <span class="re1">&lt;keys<span class="re2">&gt;</span></span>
    <span class="re1">&lt;key<span class="re2">&gt;</span></span>
      <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">jid</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
      <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">the Jabber ID of the invitee</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/key<span class="re2">&gt;</span></span>
    <span class="re1">&lt;key<span class="re2">&gt;</span></span>
      <span class="re1">&lt;name<span class="re2">&gt;</span></span><span class="co3">password</span><span class="re1">&lt;/name<span class="re2">&gt;</span></span>
      <span class="re1">&lt;desc<span class="re2">&gt;</span></span><span class="co3">the password required to enter a multi-user chat room</span><span class="re1">&lt;/desc<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/key<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/keys<span class="re2">&gt;</span></span>
<span class="re1">&lt;/querytype<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E5.95.86.E4.B8.9A.E8.A7.84.E5.88.99">商业规则</span></h2>
<h3> <span class="mw-headline" id="Addresses">Addresses</span></h3>
<p>为了提供关于从房间JIDs抓获的地址的一致性, Room IDs 必须 MUST 遵循 Stringprep 的 Nodeprep 规范并且 Room Nicknames 必须 MUST 符合 Stringprep (这些都定义在 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b>) 的 Resourceprep 规范. 尽管在 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b> 中没有显式的说明 , 一个 Room JID 的 Room ID (node) 和 Room Nickname (resource) 部分都必须 MUST 长度不为零. 另外, 一个 MUC 服务不能 MUST NOT 允许空的或不可见的房间昵称 Room Nicknames (即, 房间昵称Room Nicknames 只包含一个或多个空格).
</p><p>取决于服务实现，是否更多地限制房间昵称 (例如, 通过应用情景例程, stringprep的Nodeprep规范, 或其他限制).
</p>
<h3> <span class="mw-headline" id="Message">Message</span></h3>
<ol><li> 如果一个房客想发送一个消息给所有其他房客, MUC 客户端必须 MUST 把 'type' 属性值设为 "groupchat". 服务可以 MAY 忽略不正确的消息类型, 或用 &lt;bad-request/&gt; 错误弹回.
</li><li> 如果一个MUC服务从一个角色为"none"的Jabber用户收到一个发送给该房间的消息或给某个房客的消息, 服务不能 MUST NOT 递送这个消息并应该 SHOULD 返回给这个消息给发送者并伴随一个 &lt;forbidden/&gt; 错误.
</li><li> 如果一个MUC服务 接收到一个发送给不存在的或尚未解锁的房间的消息, 服务应该 SHOULD 返回这个消息给发送者并伴随一个 &lt;item-not-found/&gt; 错误.
</li><li> 一个MUC服务应该 SHOULD 不做修改地传递扩展的消息 (例如, 一个消息主体的 XHTML 版本) 给房客; 然而, 一个 MUC 服务可以 MAY 不允许消息的特定扩展(参见本文的<a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节).
</li><li> 一个MUC客户端可以 MAY 生成扩展以满足 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0022.html">消息事件</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">30</a> 或 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0085.html">聊天状态通知</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">31</a> 规范; 然而, 一个 MUC 服务可以 MAY 不允许这些扩展 (参见本文的<a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节).
</li></ol>
<h3> <span class="mw-headline" id="Presence">Presence</span></h3>
<ol><li> 一个房间必须 MUST 安静地忽略从一个角色为"none"的用户发来的不可用出席信息信息.
</li><li> 只有MUC服务自身应该 SHOULD 生成关于角色，岗位，全JIDs或遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的状态码的扩展的出席信息 (基于服务所知道的关于房客的信息, 例如, 角色, 或由一个主持人或房间管理员的动作所产生的结果). 一个客户端不应该 SHOULD NOT 推定生成这类信息. 如果一个 MUC 服务从一个房客接收到这类扩展的出席信息, 它不能 MUST NOT 反射它给其他房客们. (一个客户端可以 MAY 为了提供一个密码而生成遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的扩展的出席信息, 但自然的这是不反射给其他房客的.)
</li><li> 一个MUC服务应该 SHOULD 允许所有其他出席信息通过, 尽管它可以 MAY 选择阻塞扩展的出席信息; 参见本文的 <a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节.
</li><li> 为了适当地通知房客角色和岗位, 并使之更易于Jabber客户端跟踪房间里所有用户的当前状态, MUC服务实现必须 MUST 在所有出席信息节里提供关于角色和岗位的扩展的出席信息, 包括一个用户因为任何原因退出该房间时被发送的类型为"unavailable"的出席信息节.
</li><li> 如果一个权限被撤销, 服务必须 MUST 通知这件事，通过发送一个遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的 &lt;x/&gt; 元素并包含一个 &lt;item/&gt; 子元素，该&lt;item/&gt; 子元素的 'role' 和/或 'affiliation' 属性值的设定指明是去了有关的权限. 所有将来的为这个房客发出的出席信息节必须 MUST 包含这个更新的角色和岗位, 直到除非它们再次改变.
</li><li> 一个MUC服务必须 MUST 发送扩展的出席信息给一个客户端，即使客户端在进入该房间时没有发送一个空的遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc'">http://jabber.org/protocol/muc'</a> 名字空间的 &lt;x/&gt; 元素&#160;; 自然的, 一个客户端必须 MUST 忽略这类信息，如果它不懂得它的话(根据 <b><a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a></b>).
</li><li> 在 muc#user 名字空间中被发送的关于角色和岗位的扩展的出席信息必须 MUST 包含全JID (不是纯JID) 作为 'jid' 属性的值.
</li><li> 如果想要，一个客户端可以 MAY 发送一个客户化的退出消息 (就像 IRC 频道里经常出现的那样) ，通过在退出时被发送的"unavailable"类型的出席信息节里包含一个 &lt;status/&gt; 元素.
</li></ol>
<h3> <span class="mw-headline" id="IQ">IQ</span></h3>
<ol><li> MUC被设计用于分享消息和出席信息, 而不是 IQs. 一个被发送的到房间本身JID的 IQ 由房间本身来处理并且不反射给所有房客.
</li><li> 如果一个房客想在一个非匿名房间发送一个 IQ 节给其他用户, 发送者应该 SHOULD 直接发送请求给接收者的纯JID或全JID, 而不是试图通过房间发送请求(即, 通过接收者的房间JID).
</li><li> 如果一个房客想在一个半匿名房间发送一个 IQ 节给其他用户, 发送者能直接发送这个节给接受者的房间JID并且服务可以 MAY 转发这个节给接收者的真实JID. 然而, 任何时候一个MUC服务不能 MUST NOT 泄露这个发送者的真实JID给接收者, 也不能泄露接收者的真实JID给发送者.
</li><li> 一个MUC客户端必须 MUST 在IQ set 中的遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin'">http://jabber.org/protocol/muc#admin'</a> &lt;item/&gt; 子元素中只发送 'affiliation' 属性或 'role' 属性; 如果一个主持人, 管理员, 或所有者试图在相同的IQ set中修改相同条目的岗位或角色, 服务必须 MUST 返回一个 &lt;bad-request/&gt; 错误给发送者. 无论如何, 一个MUC服务可以 MAY 基于一个岗位的变更来修改一个角色，从而可以 MAY 发送出席信息更新，同时包含一个修改的角色和一个修改的岗位.
</li><li> 在关于角色的 IQ sets中, 一个MUC客户端必须 MUST 只包含 'nick' 属性; 在关于角色的 IQ results中, 一个 MUC 服务必须 MUST 包含 'nick', 'role', 'affiliation', 和'jid' 属性 (值为后来设置的用户的全JID).
</li><li> 在关于岗位的 IQ sets中, 一个MUC客户端必须 MUST 只包含 'jid' 属性(值为纯JID); 在关于岗位的 IQ results中, 一个MUC服务不能 MUST NOT 包含 'role' 属性, 必须MUST 包含 'affiliation' 属性和 'jid' 属性 (值为纯JID), 并且应该 SHOULD 包含 'nick' 属性 (除非岗位为 "outcast", 以为被排斥者不应该 SHOULD NOT 有保留的房间昵称).
</li></ol>
<h2> <span class="mw-headline" id=".E5.AE.9E.E7.8E.B0.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9">实现注意事项</span></h2>
<p>以下方针有助于客户端和组件开发者建立 MUC 实现.
</p>
<h3> <span class="mw-headline" id=".E6.9C.8D.E5.8A.A1.E7.AB.AF">服务端</span></h3>
<ol><li> 在处理一个被主持的房间里游客发送的消息时, 一个MUC服务可以 MAY 通过一个主持人让每个消息排队等待批准并且可以 MAY 通知发送者消息正在等待批准; 然而, 这一行为是可选的 OPTIONAL, 并且一个消息批准协议的定义 (例如, 使用<b>XEP-0004</b>定义的数据表单) 超出了本文的范围.
</li><li> 对于一个 MUC 服务来说，在特定事件发生时提供房间内的消息是很常见的, 例如当标题变更时, 当一个房客加入或退出时, 或当一个房间被销毁时. 这类消息完全是可选的 OPTIONAL 并且留给实现或布署来决定, 但如果使用了，则必须 MUST 是从房间JID本身(&lt;room@service&gt;) 而不是从一个特定的房客(&lt;room@service/nick&gt;)发送的类型为 "groupchat" 类型的消息. 无论如何, 通常接收的客户端倾向于基于房间的事件以及MUC提供的特定状态码来生成类似的消息(例如, 用户加入或退出)&#160;; 这将帮助确保这类消息的正确的本地化.
</li><li> 出于礼貌, 一个MUC服务可以 MAY 发送一个房间外的 &lt;message/&gt; 给一个被踢的或被禁止的房客, 并且可以 MAY 广播一个房间内的 &lt;message/&gt; 给所有剩余的房客通知他们该房客已被该房间踢出或禁止. 无论如何, 这类消息是可选的 OPTIONAL, 并且事实上是多余的，因为接收的客户端生成这类消息所必需的信息已经通过MUC服务发送的出席信息节(特别是状态码)得到了.
</li><li> 出于礼貌, 如果一个用户的岗位变更了而该用户不在房间里，一个MUC服务可以MAY发送一个房间外的 &lt;message/&gt;&#160;; 这消息应该 SHOULD 被从房间发送给该用户的纯JID, 可以 MAY 包含一个 &lt;body/&gt; 元素描述岗位变更, 并且必须 MUST 包含一个状态码 101.
</li><li> 没有需求要一个MUC服务将为旧的"groupchat 1.0"用户提供特别的治疗, 例如包含等价于扩展的遵循 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> 名字空间的出席信息的消息.
</li><li> 房间类型可以 MAY 被配置成任何组合. 一个MUC服务可以 MAY 支持或允许任何想要的房间类型或它们的组合.
</li><li> 一个MUC服务可以 MAY 限制在初始配置完成之后配置选项展示给一个所有者的次数, 例如因为特定的选项除非重启服务无法生效.
</li><li> 一个MUC服务可以 MAY 提供一个接口给房间创建和配置(例如, 以一个特定的Jabber表单或一个网页), 这样表面上房间所有者是一个应用而不是一个自然人用户.
</li><li> 一个MUC服务可以 MAY 选择让一个特定的房间内资源提供接口给管理功能 (例如, 一个 "user" 名的机器人 "ChatBot"), 房客们可以和它直接互动, 从而允许管理员在一个私有消息里键入命令参数 '/command parameter' 给那个机器人 "user". 显然这种服务要求服务在房间创建时添加一个 'ChatBot' 用户到房间, 并且阻止任何房客在该房间使用房间昵称 'ChatBot' . 这可能在一些实现或布署中比较难以保证. 任何情况下, 任何这类接口是可选的 OPTIONAL.
</li><li> 如果服务接收到它之前发送给该用户的节相关的递送类错误，一个MUC服务应该 SHOULD 移除一个用户; 递送相关的错误即 &lt;gone/&gt;, &lt;item-not-found/&gt;, &lt;recipient-unavailable/&gt;, &lt;redirect/&gt;, &lt;remote-server-not-found/&gt;, 和 &lt;remote-server-timeout/&gt;.
</li><li> 一个MUC服务可以 MAY 选择在反射出席信息变更给一个房间的房客们之前，抛弃附加在&lt;presence/&gt; 节上的扩展的出席信息. 也就是, 一个实现可以 MAY 选择只反射该出席信息节的 &lt;show/&gt;, &lt;status/&gt;, 和 &lt;priority/&gt; 子元素，如 'jabber:client' 名字空间描述的 XML 架构之中, 结果导致那个在扩展的名字空间中的出席信息变更 "changes" (例如, gabber:x:music:info) 不被传递给房客. 如果一个服务禁止特定的扩展名字空间, 它应该 SHOULD 在本文 <a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节描述的知名的服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#traffic'">http://jabber.org/protocol/muc#traffic'</a> 提供一个允许的通讯的描述.
</li><li> 一个MUC服务可以 MAY 在反射消息给一个房间的房客之前选择抛弃附加在 &lt;message/&gt; 节的扩展信息. 一个这类扩展信息的例子是轻量级文本标记，定义于 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0071.html">XHTML-IM</a>  [XEP-0045#附录G:备注|32]]. 如果一个服务禁止特定的扩展名字空间, 它应该 SHOULD 在本文 <a href="/XEP-0045#.E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF" title="XEP-0045">允许的通讯</a>章节描述的知名的服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#traffic'">http://jabber.org/protocol/muc#traffic'</a> 提供一个允许的通讯的描述.
</li><li> 一个MUC服务可以 MAY 选择锁定 "lock down" 房间昵称 (例如, 硬编码房间昵称给该房客的纯JID). 如果这么干, 该服务必须 MUST 把被锁定的昵称看作一个保留的房间昵称并且必须 MUST 支持本文<a href="/XEP-0045#.E5.8F.91.E7.8E.B0.E4.BF.9D.E7.95.99.E7.9A.84.E6.88.BF.E9.97.B4.E6.98.B5.E7.A7.B0" title="XEP-0045">发现保留的房间昵称</a>章节定义的协议.
</li></ol>
<h4> <span class="mw-headline" id=".E5.85.81.E8.AE.B8.E7.9A.84.E9.80.9A.E8.AE.AF">允许的通讯</span></h4>
<p>大家知道, 一个服务 (更准确地说, 一个正确配置的房间)可以 MAY 抛弃一些或所有的扩展的附加在从发送者通过房间反射给所有房客的 &lt;message/&gt; 和 &lt;presence/&gt; 节的名字空间. 如果房间这么干, 它应该 SHOULD 允许发送者通过发送 disco#info 查询知名的服务发现节点 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#traffic'">http://jabber.org/protocol/muc#traffic'</a> 来发现允许的扩展的列表, 在结果中返回支持的名字空间每个用一个 &lt;feature/&gt; 元素表示. 如果该房间不允许任何扩展的名字空间, 它必须 MUST 如 <b>XEP-0030</b> 所述返回一个空的 query . 如果该房间不支持 "#traffic" 节点, 它必须 MUST 返回一个 &lt;feature-not-implemented/&gt; 错误应答给查询发送到 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#traffic'">http://jabber.org/protocol/muc#traffic'</a> 节点的查询.
</p><p>以下例子展示一个只允许 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/xhtml-im'">http://jabber.org/protocol/xhtml-im'</a> 和 '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/rosterx'">http://jabber.org/protocol/rosterx'</a> 名字空间的房间, 而不包括其他的名字空间.
</p><p><b>例子 209. 用户查询服务关于允许的名字空间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">to</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">id</span>=<span class="st0">'allow1'</span>
    <span class="re0">type</span>=<span class="st0">'get'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/muc#traffic'</span><span class="re2">/&gt;</span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p><b>例子 210. 服务返回允许的名字空间</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">id</span>=<span class="st0">'allow1'</span>
    <span class="re0">type</span>=<span class="st0">'result'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/muc#traffic'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/xhtml-im'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;feature</span> <span class="re0">var</span>=<span class="st0">'http://jabber.org/protocol/rosterx'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<p>如果一个服务不抛弃任何名字空间或不实现这个特性, 它必须 MUST 返回一个 &lt;service-unavailable/&gt; 错误:
</p><p><b>例子 211. 服务返回服务不可用错误</b>
</p>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">from</span>=<span class="st0">'heath@chat.shakespeare.lit'</span>
    <span class="re0">to</span>=<span class="st0">'wiccarocks@shakespeare.lit/laptop'</span>
    <span class="re0">id</span>=<span class="st0">'allow1'</span>
    <span class="re0">type</span>=<span class="st0">'error'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/disco#info'</span>
         <span class="re0">node</span>=<span class="st0">'http://jabber.org/protocol/muc#traffic'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;error</span> <span class="re0">type</span>=<span class="st0">'cancel'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;service-unavailable</span> <span class="re0">xmlns</span>=<span class="st0">'urn:ietf:params:xml:ns:xmpp-stanzas'</span><span class="re2">/&gt;</span>
  <span class="re1">&lt;/error<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id=".E5.AE.A2.E6.88.B7.E7.AB.AF">客户端</span></h3>
<ol><li> Jabber客户端可以 MAY 展示房间角色，通过在一个房间名册里为每个角色显示特定的群. 这将使房客清楚图形化的知道哪个房客是主持人, 参与者, 和游客. 无论如何, 这样一个展示是可选的 OPTIONAL.
</li><li> Jabber客户端可以 MAY 实现多样化的界面以提供快捷方式 "shortcuts" 给功能，例如修改某人昵称, 踢人或禁止用户, 发现一个房客的全JID, 或修改主题. 一个选项包含了类IRC 的命令例如 '/nick', '/kick', '/ban', 和 '/whois'; 另一个是使用户能用鼠标右击房间名册里的项目. 所有这些界面形式是可选的 OPTIONAL. 然而, 为方便起见, 下面提供了一个 IRC 命令到 MUC 协议的映射.
</li></ol>
<h4> <span class="mw-headline" id="IRC.E5.91.BD.E4.BB.A4.E6.98.A0.E5.B0.84">IRC命令映射</span></h4>
<p>IRC 客户端使用大量常用的快捷方式 "shortcut" 命令，以一个斜杠开始, 例如 '/nick' and '/ban'. 下表提供一个 类IRC 命令到 MUC 协议的映射, 用于希望支持类似功能的 Jabber 客户端.
</p><p><b>表10: IRC命令映射</b>
</p>
<table border="1" cellspacing="0">
<tr>
<th>命令 </th>
<th>功能 </th>
<th>MUC协议
</th></tr>
<tr>
<td>/ban &lt;roomnick&gt; [comment] </td>
<td>在房间里以房间昵称禁止用户(客户端翻译房间昵称为纯JID) </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">id</span>=<span class="st0">'someid'</span>
    <span class="re0">to</span>=<span class="st0">'room@service'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">affiliation</span>=<span class="st0">'outcast'</span>
          <span class="re0">jid</span>=<span class="st0">'bare-jid-of-user'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">comment</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/invite &lt;jid&gt; [comment] </td>
<td>以JID邀请用户到此房间 </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'room@service'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;invite</span> <span class="re0">to</span>=<span class="st0">'jid'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">comment</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/invite<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/join &lt;roomname&gt; [pass] </td>
<td>在服务里加入房间(房间昵称同本房间内的昵称) </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'room@service/nick'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;x</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;password<span class="re2">&gt;</span></span><span class="co3">pass</span><span class="re1">&lt;/password<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/x<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/kick &lt;roomnick&gt; [comment] </td>
<td>以房间昵称从房间里踢人 </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;iq</span> <span class="re0">id</span>=<span class="st0">'someid'</span>
    <span class="re0">to</span>=<span class="st0">'room@service'</span>
    <span class="re0">type</span>=<span class="st0">'set'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;query</span> <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;item</span> <span class="re0">nick</span>=<span class="st0">'roomnick'</span> <span class="re0">role</span>=<span class="st0">'none'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;reason<span class="re2">&gt;</span></span><span class="co3">comment</span><span class="re1">&lt;/reason<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/item<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/query<span class="re2">&gt;</span></span>
<span class="re1">&lt;/iq<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/msg &lt;roomnick&gt; &lt;foo&gt; </td>
<td>发送私有消息"foo"给房间昵称 </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'room@service/nick'</span> <span class="re0">type</span>=<span class="st0">'chat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;body<span class="re2">&gt;</span></span><span class="co3">foo</span><span class="re1">&lt;/body<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/nick &lt;newnick&gt; </td>
<td>变更在此房间内的昵称为"newnick" </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'room@service/newnick'</span><span class="re2">/&gt;</span></pre></div></div>
</td></tr>
<tr>
<td>/part [comment] </td>
<td>退出本房间(一些 IRC 客户端也支持 /leave) </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;presence</span> <span class="re0">to</span>=<span class="st0">'room@service/nick'</span>
          <span class="re0">type</span>=<span class="st0">'unavailable'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;status<span class="re2">&gt;</span></span><span class="co3">comment</span><span class="re1">&lt;/status<span class="re2">&gt;</span></span>
<span class="re1">&lt;/presence<span class="re2">&gt;</span></span></pre></div></div>
</td></tr>
<tr>
<td>/topic &lt;foo&gt; </td>
<td>变更此房间主题为"foo" </td>
<td><div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;message</span> <span class="re0">to</span>=<span class="st0">'room@service'</span> <span class="re0">type</span>=<span class="st0">'groupchat'</span><span class="re2">&gt;</span>
  <span class="re1">&lt;subject<span class="re2">&gt;</span></span><span class="co3">foo</span><span class="re1">&lt;/subject<span class="re2">&gt;</span></span>
<span class="re1">&lt;/message<span class="re2">&gt;</span></span></pre></div></div>
</td></tr></table>
<p><br />
注意: 因为 MUC 房间昵称遵循stringprep的Resourceprep脚本, 它们被允许包含一个空格字符, 而 IRC 昵称不允许. 尽管一个给定的客户端可以 MAY 支持引用字符串用于这个目的 (导致命令类似 '/ban "king lear" insanity is no defense'), 最常见的引用字符(类似 " 和 ') 也是被Resourceprep允许的 , 从而导致增加了复杂性和包含空格和引号的房间昵称中引号的潜在问题. 所以不建议 NOT RECOMMENDED Jabber客户端支持包含了空格符的房间昵称的类IRC的快捷方式命令.
</p><p>注意: 很多Jabber客户端也实现了 '/me ' 命令，如 <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0245.html">The /me Command</a> <a href="/XEP-0045#.E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8" title="XEP-0045">33</a> 所述. 这个命令不会导致任何 MUC 或 IRC 协议的动作所以不显式在上表中.
</p>
<h2> <span class="mw-headline" id="XML.E6.9E.B6.E6.9E.84">XML架构</span></h2>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fmuc"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc">http://jabber.org/protocol/muc</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/muc'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0045: http://www.xmpp.org/extensions/xep-0045.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'x'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'history'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'password'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'history'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'maxchars'</span> <span class="re0">type</span>=<span class="st0">'xs:int'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'maxstanzas'</span> <span class="re0">type</span>=<span class="st0">'xs:int'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'seconds'</span> <span class="re0">type</span>=<span class="st0">'xs:int'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'since'</span> <span class="re0">type</span>=<span class="st0">'xs:dateTime'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23user"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user">http://jabber.org/protocol/muc#user</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#user'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0045: http://www.xmpp.org/extensions/xep-0045.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'x'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'decline'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'destroy'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'invite'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'password'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'status'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'decline'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'reason'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'from'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'to'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'destroy'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'reason'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'invite'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'reason'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'from'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'to'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'actor'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'reason'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'continue'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'admin'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'member'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'nick'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'role'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'actor'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'continue'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'thread'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'status'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'code'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:int'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:minInclusive</span> <span class="re0">value</span>=<span class="st0">'100'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:maxInclusive</span> <span class="re0">value</span>=<span class="st0">'999'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'reason'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23admin"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#admin">http://jabber.org/protocol/muc#admin</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#admin'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0045: http://www.xmpp.org/extensions/xep-0045.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'query'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'item'</span> <span class="re0">maxOccurs</span>=<span class="st0">'unbounded'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'item'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'actor'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'reason'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'affiliation'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'admin'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'member'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'outcast'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'owner'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'nick'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'role'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:simpleType<span class="re2">&gt;</span></span>
          <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:NCName'</span><span class="re2">&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'moderator'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'none'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'participant'</span><span class="re2">/&gt;</span>
            <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">'visitor'</span><span class="re2">/&gt;</span>
          <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
        <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:attribute<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'actor'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:simpleContent<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:extension</span> <span class="re0">base</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
          <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'required'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;/xs:extension<span class="re2">&gt;</span></span>
      <span class="re1">&lt;/xs:simpleContent<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'reason'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23owner"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner">http://jabber.org/protocol/muc#owner</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#owner'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0045: http://www.xmpp.org/extensions/xep-0045.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:import</span> 
      <span class="re0">namespace</span>=<span class="st0">'jabber:x:data'</span>
      <span class="re0">schemaLocation</span>=<span class="st0">'http://www.xmpp.org/schemas/x-data.xsd'</span><span class="re2">/&gt;</span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'query'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:choice</span> <span class="re0">xmlns:xdata</span>=<span class="st0">'jabber:x:data'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'xdata:x'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">ref</span>=<span class="st0">'destroy'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:choice<span class="re2">&gt;</span></span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'destroy'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:complexType<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:sequence<span class="re2">&gt;</span></span>
        <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'password'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
        <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'reason'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">minOccurs</span>=<span class="st0">'0'</span><span class="re2">/&gt;</span>
      <span class="re1">&lt;/xs:sequence<span class="re2">&gt;</span></span>
      <span class="re1">&lt;xs:attribute</span> <span class="re0">name</span>=<span class="st0">'jid'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span> <span class="re0">use</span>=<span class="st0">'optional'</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:complexType<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:element<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:simpleType</span> <span class="re0">name</span>=<span class="st0">'empty'</span><span class="re2">&gt;</span>
    <span class="re1">&lt;xs:restriction</span> <span class="re0">base</span>=<span class="st0">'xs:string'</span><span class="re2">&gt;</span>
      <span class="re1">&lt;xs:enumeration</span> <span class="re0">value</span>=<span class="st0">''</span><span class="re2">/&gt;</span>
    <span class="re1">&lt;/xs:restriction<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:simpleType<span class="re2">&gt;</span></span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h3> <span class="mw-headline" id="http:.2F.2Fjabber.org.2Fprotocol.2Fmuc.23unique"><a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#unique">http://jabber.org/protocol/muc#unique</a></span></h3>
<div dir="ltr" style="text-align: left;"><div class="source-xml" style="font-family: monospace;"><pre><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">'1.0'</span> <span class="re0">encoding</span>=<span class="st0">'UTF-8'</span><span class="re2">?&gt;</span>
&#160;
<span class="re1">&lt;xs:schema</span>
    <span class="re0">xmlns:xs</span>=<span class="st0">'http://www.w3.org/2001/XMLSchema'</span>
    <span class="re0">targetNamespace</span>=<span class="st0">'http://jabber.org/protocol/muc#unique'</span>
    <span class="re0">xmlns</span>=<span class="st0">'http://jabber.org/protocol/muc#unique'</span>
    <span class="re0">elementFormDefault</span>=<span class="st0">'qualified'</span><span class="re2">&gt;</span>
&#160;
  <span class="re1">&lt;xs:annotation<span class="re2">&gt;</span></span>
    <span class="re1">&lt;xs:documentation<span class="re2">&gt;</span></span><span class="co3">
      The protocol documented by this schema is defined in
      XEP-0045: http://www.xmpp.org/extensions/xep-0045.html
    </span><span class="re1">&lt;/xs:documentation<span class="re2">&gt;</span></span>
  <span class="re1">&lt;/xs:annotation<span class="re2">&gt;</span></span>
&#160;
  <span class="re1">&lt;xs:element</span> <span class="re0">name</span>=<span class="st0">'unique'</span> <span class="re0">type</span>=<span class="st0">'xs:string'</span><span class="re2">/&gt;</span>
&#160;
<span class="re1">&lt;/xs:schema<span class="re2">&gt;</span></span></pre></div></div>
<h2> <span class="mw-headline" id=".E9.B8.A3.E8.B0.A2">鸣谢</span></h2>
<p>作者感谢以下个人，为他们很多对于本协议草案的帮助性的评论: David Sutton, Peter Millard, Joe Hildebrand, Craig Kaes, Alexey Shchepin, David Waite, Jean-Louis Seguineau, Jacek Konieczny, Gaston Dombiak, 以及其他在 jdev@conference.jabber.org 会议室和在 Standards 邮件列表里的人.
</p>
<h2> <span class="mw-headline" id=".E9.99.84.E5.BD.95">附录</span></h2>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95A:.E6.96.87.E6.A1.A3.E4.BF.A1.E6.81.AF">附录A:文档信息</span></h3>
<p>系列：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/">XEP</a>
</p><p>序号：0045
</p><p>发布者：<a rel="nofollow" class="external text" href="http://xmpp.org/xsf/">XMPP标准基金会</a>
</p><p>状态：<a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0001.html#states-Draft">草案 </a>
</p><p>类型：<a rel="nofollow" class="external text" href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards%20Track">标准跟踪</a>
</p><p>版本：1.24
</p><p>最后更新：2008-07-16
</p><p>批准机构：<a rel="nofollow" class="external text" href="http://xmpp.org/council/">XMPP理事会</a>
</p><p>依赖标准：XMPP Core, XMPP IM, XEP-0004, XEP-0030, XEP-0068, XEP-0082, XEP-0128
</p><p>替代标准：无
</p><p>被替代标准：无
</p><p>缩略名：muc
</p><p>muc名字空间的XML方案: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/muc.xsd">http://www.xmpp.org/schemas/muc.xsd</a>&gt;
</p><p>muc#admin名字空间的XML方案: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/muc-admin.xsd">http://www.xmpp.org/schemas/muc-admin.xsd</a>&gt;
</p><p>muc#owner名字空间的XML方案: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/muc-owner.xsd">http://www.xmpp.org/schemas/muc-owner.xsd</a>&gt;
</p><p>muc#unique名字空间的XML方案: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/muc-unique.xsd">http://www.xmpp.org/schemas/muc-unique.xsd</a>&gt;
</p><p>muc#user名字空间的XML方案: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/schemas/muc-user.xsd">http://www.xmpp.org/schemas/muc-user.xsd</a>&gt;
</p><p>注册表: &lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/registrar/muc.html">http://www.xmpp.org/registrar/muc.html</a>&gt;
</p><p>原文控制： <a rel="nofollow" class="external text" href="http://svn.xmpp.org:18080/browse/XMPP/trunk/extensions/xep-0045.xml">HTML</a> <a rel="nofollow" class="external text" href="http://svn.xmpp.org:18080//changelog/~rss/XMPP/trunk/extensions/xep-0045.xml/rss.xml">RSS</a>
</p><p>本文的其它格式： <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0045.xml">XML</a> <a rel="nofollow" class="external text" href="http://xmpp.org/extensions/xep-0045.pdf">PDF</a>
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95B:.E4.BD.9C.E8.80.85.E4.BF.A1.E6.81.AF">附录B:作者信息</span></h3>
<p><b>Peter Saint-Andre</b>
</p><p>Email: <a rel="nofollow" class="external text" href="mailto:stpeter@jabber.org">stpeter@jabber.org</a>
</p><p>JabberID: stpeter@jabber.org
</p><p>URI: <a rel="nofollow" class="external free" href="https://stpeter.im/">https://stpeter.im/</a>
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95C:.E6.B3.95.E5.BE.8B.E9.80.9A.E5.91.8A">附录C:法律通告</span></h3>
<p><b>版权</b>
</p><p>XMPP扩展协议的版权(1999-2008)归XMPP标准化基金会(XSF)所有.
</p><p><b>权限</b>
</p><p>特此授权,费用全免,对任何获得本协议副本的人,对使用本协议没有限制,包括不限制在软件程序中实现本协议,不限制在网络服务中布署本协议,不限制拷贝,修改,合并,发行,翻译,分发,转授,或销售本协议的副本,被允许使用本协议做了以上工作的人士,应接受前述的版权声明和本许可通知并且必须包含在所有的副本或实质性部分的规格中.除非单独的许可，被重新分发的修改工作，不得含有关于作者，标题，编号，或出版者的规格的误导性资料，并不得宣称修改工作是由本文的作者，作者所属的任何组织或项目，或XMPP标准基金会签注。
</p><p><b>免责声明'</b>
</p><p><b>## 特别注意：本协议是提供的“原样”的基础，没有担保或任何形式的条件，明示或暗示，包括，但不限于任何担保或关于名称，非侵权性，适销性或适合作某一特定目的的条件. ##</b>
</p><p><b>责任限制</b>
</p><p>在任何情况下以及没有任何法律规定时，不论是侵权行为（包括疏忽），合同或其它方面，除非根据适用法律的要求（如蓄意和有严重疏忽行为）或以书面形式同意，XMPP标准基金会或任何作者不对本协议所造成的损失承担责任，包括任何直接，间接，特殊，偶发，或任何从本协议出，入，连接的字符产生的或实现，布署或其他对本协议的使用导致的相应的损害赔偿（包括但不限于善意的损失，停止作业，电脑失灵或故障，或任何和所有其他商业损害或损失） ，即使XMPP标准基金会或作者已被告知此类损害的可能性。
</p><p><b>知识产权的一致性</b>
</p><p>XMPP扩展协议完全遵守XSF的知识产权策略(可在&lt;<a rel="nofollow" class="external free" href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt;找到副本或写信给XMPP标准基金会, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95D:.E5.92.8CXMPP.E7.9A.84.E5.85.B3.E7.B3.BB">附录D:和XMPP的关系</span></h3>
<p>可扩展的消息和出席信息协议 (XMPP) 定义于 XMPP Core (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>) 和 XMPP IM (<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>) 规范里，由 XMPP标准基金会贡献到由依据<a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2026">RFC 2026</a>成立的互联网工程人物组管理的互联网标准流程 Internet Standards Process. 本文定义的任何协议已在互联网标准流程之外开发，并且被理解为 XMPP 的扩展而不是一个XMPP本身的演化, 开发, 或修改.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95E:.E8.AE.A8.E8.AE.BA.E5.9C.B0.E7.82.B9">附录E:讨论地点</span></h3>
<p>主要的XMPP扩展协议讨论地点是 &lt;standards@xmpp.org&gt; 讨论列表.
</p><p>在 xmpp.org 的其它讨论列表中的讨论可能也有合适的; 所有的列表见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; .
</p><p>勘误表可以发送邮件到 &lt;editor@xmpp.org&gt;.
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95F:.E9.9C.80.E6.B1.82.E4.B8.80.E8.87.B4.E6.80.A7">附录F:需求一致性</span></h3>
<p>以下用于本文的需求关键字的解释见于 <a rel="nofollow" class="external text" href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".
</p><p><br />
</p>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95G:.E5.A4.87.E6.B3.A8">附录G:备注</span></h3>
<ol><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc1459">RFC 1459</a>: Internet Relay Chat &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc1459">http://tools.ietf.org/html/rfc1459</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2810">RFC 2810</a>: Internet Relay Chat: Architecture &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc2810">http://tools.ietf.org/html/rfc2810</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2811">RFC 2811</a>: Internet Relay Chat: Channel Management &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc2811">http://tools.ietf.org/html/rfc2811</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2812">RFC 2812</a>: Internet Relay Chat: Client Protocol &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc2812">http://tools.ietf.org/html/rfc2812</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2813">RFC 2813</a>: Internet Relay Chat: Server Protocol &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc2813">http://tools.ietf.org/html/rfc2813</a>&gt;.
</li><li> XEP-0133: Service Administration &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0133.html">http://xmpp.org/extensions/xep-0133.html</a>&gt;.
</li><li> XEP-0030: Service Discovery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.
</li><li> XEP-0059: Result Set Management &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0059.html">http://xmpp.org/extensions/xep-0059.html</a>&gt;.
</li><li> XEP-0128: Service Discovery Extensions &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0128.html">http://xmpp.org/extensions/xep-0128.html</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3920">RFC 3920</a>: 可扩展的消息和出席信息协议 (XMPP): Core &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3920">http://tools.ietf.org/html/rfc3920</a>&gt;.
</li><li> XEP-0203: Delayed Delivery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0203.html">http://xmpp.org/extensions/xep-0203.html</a>&gt;.
</li><li> XEP-0091: Legacy Delayed Delivery &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0091.html">http://xmpp.org/extensions/xep-0091.html</a>&gt;.
</li><li> XEP-0082: XMPP Date and Time Profiles &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0082.html">http://xmpp.org/extensions/xep-0082.html</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc3921">RFC 3921</a>: 可扩展的消息和出席信息协议 (XMPP): Instant Messaging and Presence &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.
</li><li> XEP-0249: Direct MUC Invitations &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0249.html">http://xmpp.org/extensions/xep-0249.html</a>&gt;.
</li><li> XEP-0077: In-Band Registration &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0077.html">http://xmpp.org/extensions/xep-0077.html</a>&gt;.
</li><li> XEP-0004: Data Forms &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0004.html">http://xmpp.org/extensions/xep-0004.html</a>&gt;.
</li><li> 一些评论者抱怨公开房间的所有者和管理员存在潜在的滥用; 很不幸的, 能力越大责任越大.
</li><li> XEP-0050: Ad-Hoc Commands &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0050.html">http://xmpp.org/extensions/xep-0050.html</a>&gt;.
</li><li> XEP-0060: Publish-Subscribe &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0060.html">http://xmpp.org/extensions/xep-0060.html</a>&gt;.
</li><li> 这和房间配置的行为不同, 这里 'muc#roomconfig_roomowners' 字段指定房间所有者的完整列表, 不是delta.
</li><li> 这和房间配置的行为不同, 这里 'muc#roomconfig_roomadmins' 字段指定房间管理眼的完整列表, 不是delta.
</li><li> XEP-0086: Error Condition Mappings &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0086.html">http://xmpp.org/extensions/xep-0086.html</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc2616">RFC 2616</a>: Hypertext Transport Protocol -- HTTP/1.1 &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc2616">http://tools.ietf.org/html/rfc2616</a>&gt;.
</li><li> <a class="external mw-magiclink-rfc" href="//tools.ietf.org/html/rfc1893">RFC 1893</a>: Enhanced Mail System Status Codes &lt;<a rel="nofollow" class="external free" href="http://tools.ietf.org/html/rfc1893">http://tools.ietf.org/html/rfc1893</a>&gt;.
</li><li> 互联网编号分配机构 (IANA) 是用于互联网协议的唯一性参数值分配的核心协调者, 例如号码和URI计划. 更多信息, 见 &lt;<a rel="nofollow" class="external free" href="http://www.iana.org/">http://www.iana.org/</a>&gt;.
</li><li> XMPP登记员 XMPP Registrar 维护着一个保留的协议名字空间以及用于由XMPP标准基金会批准的XMPP扩展协议的上下文参数的注册项的列表. 更多信息, 见 &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/registrar/">http://xmpp.org/registrar/</a>&gt;.
</li><li> XEP-0068: Field Data Standardization for Data Forms &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0068.html">http://xmpp.org/extensions/xep-0068.html</a>&gt;.
</li><li> XEP-0147: XMPP URI Query Components &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0147.html">http://xmpp.org/extensions/xep-0147.html</a>&gt;.
</li><li> XEP-0022: Message Events &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0022.html">http://xmpp.org/extensions/xep-0022.html</a>&gt;.
</li><li> XEP-0085: Chat State Notifications &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0085.html">http://xmpp.org/extensions/xep-0085.html</a>&gt;.
</li><li> XEP-0071: XHTML-IM &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0071.html">http://xmpp.org/extensions/xep-0071.html</a>&gt;.
</li><li> XEP-0245: The /me Command &lt;<a rel="nofollow" class="external free" href="http://xmpp.org/extensions/xep-0245.html">http://xmpp.org/extensions/xep-0245.html</a>&gt;.
</li></ol>
<h3> <span class="mw-headline" id=".E9.99.84.E5.BD.95H:_.E4.BF.AE.E8.AE.A2.E5.8E.86.E5.8F.B2">附录H: 修订历史</span></h3>
<p>注意: 本协议的旧版本可能在 <a rel="nofollow" class="external free" href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a> 还可用
</p><p><b>版本 1.24 (2008-07-16)</b>
</p><p>增加了更多原因reason元素的例子; 移除了关于黑名单包含的昵称部分; 增加了拒绝服务注意事项.
</p><p>(psa)
</p><p><b>版本 1.23 (2008-01-14)</b>
</p>
<ul><li> 定义了 getmemberlist 房间配置选项
</li><li> 增加了直接邀请协议
</li><li> 修正了当房间满的时候房间承认所有者/管理员的逻辑
</li><li> 定义了和LDAP群关联的服务发现扩展字段
</li><li> 指定了房间配置字段能被列入扩展的房间信息之中
</li><li> 指定了消息格式用于用户不在房间时的岗位变更
</li><li> 增加了例子展示结果集管理
</li><li> 推荐出席信息错误中包含的MUC子元素
</li><li> 为一对一聊天和多用户聊天的连续性描述了ThreadID的使用, 包括在邀请中为 continue 元素定义 thread 属性.
</li></ul>
<p>(psa)
</p><p><b>版本 1.22 (2007-04-10)</b>
</p><p>更新了延迟消息递送以反映 XEP-0203 演化到草案和 XEP-0091 的过时.
</p><p>(psa)
</p><p><b>版本 1.21 (2006-09-13)</b>
</p>
<ul><li> 澄清了MUC扩展的介入，在房间加入/创建请求触发数据表单流但没有MUC扩展可导致自动房间创建以向后兼容旧的 groupchat 1.0 协议.
</li><li> 指定昵称变更时如果昵称被锁定则返回 &lt;not-acceptable/&gt; 错误.
</li><li> 要求客户端在进入房间之前发现房间配置并指定相关的安全事项, 包括使用隐私相关的状态码 170, 171, 172, 173, 和 174.
</li><li> 指定在房间配置选项不能被执行或违反服务策略时使用 &lt;not-acceptable/&gt; 错误.
</li><li> 强制要求房间昵称不能只包含空格.
</li><li> 移除所有服务发现用例到专用章节.
</li><li> 修改 urn:xmpp:delay 支持从 SHOULD 改为 MUST.
</li><li> 澄清 _whois 房间配置选项定义房间类型.
</li><li> 定义 XEP-0128 房间信息字段用于讨论记录, 关联的 pubsub 节点, 以及联系人 JID.
</li><li> 指出修改角色到主持人导致岗位变更为管理员或所有者成为推荐的, 而不是必需的.
</li><li> 增加了国际化事项中关于数据表单的本地化的部分.
</li><li> 指出实现可以持久化角色括月整个访问并且应该在被主持的房间里这样做.
</li><li> 增加了协议和服务发现特性用于在新建房间之前请求唯一的房间名.
</li><li> 更多澄清保留的房间昵称和昵称锁定的性质.
</li><li> 定义数据表单用于请求发言权和批准发言申请.
</li><li> 增加了多个邀请的例子用于XMPP URI.
</li><li> 澄清了出席信息，讨论历史的顺序, 等等.
</li><li> 增加了状态码用于房客拥有的房间昵称, 服务修改的房间昵称, 并警告房间讨论被公开记录.
</li><li> 澄清关于房间记录和非匿名房间的隐私和匿名事项.
</li></ul>
<p>(psa)
</p><p><b>版本 1.20 (2005-09-08)</b>
</p><p>同意了踢人和禁止用户的能力, 并定义了一个用户不能被一个比自己岗位低的主持人或管理员踢或禁止.
</p><p>(psa)
</p><p><b>版本 1.19 (2005-04-21)</b>
</p><p>定义了怎样发送并发多邀请; 纠正了一些和岗位变更状态一致性的错误; 修改了消息事件禁令表单从 MUST NOT 到 SHOULD NOT; 修正了和 #traffic disco 节点相关的错误处理; 允许了 &lt;password/&gt; 作为&lt;destroy/&gt;的一个子元素; 修改了最大用户数错误从 &lt;not-allowed/&gt; 到 &lt;service-unavailable/&gt;; 指定了 maxchars 属性的字符数是指完整的 XML 节; 为 FORM_TYPEs;增加了 disco 特性 为状态码定义了注册表; 为遵守协议分开了新建即时房间的用例; 调整了 XML 架构以反映之前的修改; 重写了绪论; 澄清了小的文本错误.
</p><p>(psa)
</p><p>Version 1.18 (2004-11-02)
</p><p>Corrected several errors in the affiliation state chart and in the examples (wrong FORM_TYPE values); mentioned /me command.
(psa)
Version 1.17 (2004-10-04)
</p><p>Added text about allowable extension namespaces and related service discovery mechanisms; specified well-known service discovery nodes; added conformance terms to clarify some descriptions; modified affiliation state chart to allow more flexible state changes; per list dicussion, added ability to convert a one-to-one chat into a conference, including sending of history; specified error to use when max users limit is reached; specified form for admin approval of user registration requests and modified FORM_TYPE from <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user">http://jabber.org/protocol/muc#user</a> to <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#register">http://jabber.org/protocol/muc#register</a>; modified FORM_TYPE for room configuration from <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner">http://jabber.org/protocol/muc#owner</a> to <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#roomconfig">http://jabber.org/protocol/muc#roomconfig</a>.
(psa)
Version 1.16 (2004-06-30)
</p><p>Added example and registry submission for service discovery extension.
(psa)
Version 1.15 (2004-06-24)
</p><p>Removed jabber:iq:browse references; clarified order of presence stanzas sent to new occupant on entering room; specified format of in-room messages (type='groupchat', from='room@service'); clarified allowable attributes in various list-related operations; made admin/owner revocation text and examples consistent with state chart; clarified ownership revocation conflict scenarios; changed the 'muc#roomconfig_inviteonly' field to 'muc#roomconfig_membersonly'; changed attribute order in examples to match XML canonicalization rules; corrected several errors in the schemas.
(psa)
Version 1.14 (2004-05-03)
</p><p>Corrected discovery of registered roomnicks; added note about error to return if nicks are locked down.
(psa)
Version 1.13 (2004-03-31)
</p><p>Fixed an error in the muc#user schema.
(psa)
Version 1.12 (2004-03-01)
</p><p>Corrected a few errors in the examples; added IQ results in order to clarify workflows.
(psa)
Version 1.11 (2004-02-05)
</p><p>Clarified JID matching rules (same as for privacy lists in XMPP IM).
(psa)
Version 1.10 (2004-01-07)
</p><p>Added XMPP error handling; fully specified all conformance terms.
(psa)
Version 1.9 (2003-12-14)
</p><p>Removed protocol for requesting voice in a moderated room (should be performed using Ad-Hoc Commands).
(psa)
Version 1.8 (2003-12-04)
</p><p>Added protocol for requesting voice in a moderated room; added (informational) mapping of IRC commands to MUC protocols.
(psa)
Version 1.7 (2003-10-21)
</p><p>Added room configuration option for restricting presence broadcast to certain roles.
(psa)
Version 1.6 (2003-10-03)
</p><p>Added history management protocol on entering a room.
(psa)
Version 1.5 (2003-09-11)
</p><p>Specified that ban occurs by JID, not roomnick; allowed privileged users to send messages to the room even if not present in the room; added note that service should remove occupant if a delivery-related stanza error occurs; enabled user to disco the room in order to discover registered roomnick; specified that "banning" by domain or regex is a service-level configuration matter and therefore out of scope for MUC; specified that role should be decremented as appropriate if affiliation is lowered; added some clarifying text to room creation workflow; added implementation note about sending an out-of-band message if a user's affiliation changes while the user is not in the room; fixed stringprep references (room nicks use Resourceprep); clarified relationship between Room ID (i.e., node identifier of Room JID, which may be opaque) and natural-language Room Name; specified Field Standardization profile per XEP-0068; defined XMPP Registrar submissions; added schema locations.
(psa)
Version 1.4 (2003-02-16)
</p><p>Added XML schemas.
(psa)
Version 1.3 (2003-02-11)
</p><p>Added reference to nodeprep Internet-Draft.
(psa)
Version 1.2 (2003-01-30)
</p><p>Commented out revision history prior to version 1.0 (too long); clarified business rules regarding when nicks, full JIDs, and bare JIDs are used in reference to roles and affiliations; consistently specified that extended presence information in the muc#user namespace must include the full JID as the value of the 'jid' attribute in all cases; cleaned up text and examples throughout; added open issue regarding syntax of room nicknames.
(psa)
Version 1.1 (2002-12-16)
</p><p>Added protocol for declining an invitation; replaced &lt;created/&gt; element with status code 201; modified the destroy room protocol so that &lt;destroy/&gt; is a child of &lt;query/&gt;; clarified usage of 'nick' attribute when adding members; prohibited use of message events.
(psa)
Version 1.0 (2002-11-21)
</p><p>Per a vote of the Jabber Council, revision 0.23 was advanced to Draft on 2002-11-21. (For earlier revision history, refer to XML source.)
(psa)
Version 0.23 (2002-11-06)
</p><p>Added examples for disco#items queries sent to a room; prohibited 'type' attribute on invite messages sent from client to room; added dependencies on browse and disco; changed 'room user' to 'occupant'; fixed many small errors throughout.
(psa)
Version 0.22 (2002-11-04)
</p><p>Added example for disco#items; added support for cancellation of room configuration using type='cancel' from XEP-0004; noted 403 error for invites sent by non-admins in members-only room.
(psa)
Version 0.21 (2002-11-01)
</p><p>Clarified several small ambiguities; made &lt;body/&gt; optional on invites sent from the service to the invitee; added error scenarios for changing nickname and for destroying the room; specified that the service must return the full member list for a members-only room (not only the members in the room); updated the disco examples to track protocol changes.
(psa)
Version 0.20 (2002-10-29)
</p><p>Specified that messages sent to change the room subject must be of type "groupchat"; updated the legal notice to conform to the XSF IPR policy.
(psa)
Version 0.19 (2002-10-28)
</p><p>Added ability to create an instant room within MUC (not by using gc-1.0 protocol); cleaned up disco examples.
(psa)
Version 0.18 (2002-10-27)
</p><p>Added experimental support for disco; added sections for security, IANA, and JANA considerations; corrected typographical errors; cleaned up some DocBook formatting.
(psa)
Version 0.17 (2002-10-23)
</p><p>Added the optional &lt;actor/&gt; element (with 'jid' attribute) to &lt;item/&gt; elements inside presence stanzas of type "unavailable" that are sent to users who are kicked or banned, as well as within IQs for tracking purposes; reverted all list editing use cases (ban, voice, member, moderator, admin, owner) to use of MUC format rather than 'jabber:x:data' namespace; added several guidelines regarding generation and handling of XML stanzas; cleaned up the change room subject use case; changed several ambiguous uses of 'would', 'can', and 'will' to 'should', 'may', or 'must'; fixed several small errors in the text, examples, and DTDs.
(psa)
Version 0.16 (2002-10-20)
</p><p>Added the &lt;item/&gt; element to presence stanzas of type "unavailable" in order to improve the tracking of user states in the room; consolidated &lt;invitee/&gt; and &lt;invitor/&gt; elements into an &lt;invite/&gt; element with 'from' and 'to' attributes; made &lt;reason/&gt; element always a child of &lt;item/&gt; or &lt;invite/&gt; in the muc#user namespace; moved the alternate room location in room destruction to a 'jid' attribute of the &lt;alt/&gt; element; further specified several error messages; disallowed simultaneous modifications of both affiliations and roles by a moderator or admin; added several more rules regarding handling of XML stanzas; added use cases for granting and revoking administrative privileges; adjusted DTD to track all changes.
(psa)
Version 0.15 (2002-10-18)
</p><p>Fully incorporated the change to affiliations + roles; moved a number of admin use cases to a new section for moderator use cases; added participant use case for requesting membership; added admin use cases for adding members, removing members, granting and revoking moderator privileges, and modifying the moderator list; organized the sections in a more logical manner.
(psa)
Version 0.14 (2002-10-17)
</p><p>Significantly modified the privileges model by distinguishing between in-room "roles" and long-lived "affiliations"; specified the privileges of the various roles and affiliations; included state transition charts for both roles and affiliations; removed use of MUC protocol for editing ban, voice, and admin lists (but not for the actions of banning users and granting/revoking voice); added delivery rule regarding IQ stanzas; changed kick so that the action is based on changing the role to "none".
(psa)
Version 0.13 (2002-10-16)
</p><p>Corrected the change nickname examples (newnick sent on unavailable, no nick sent on available).
(psa)
Version 0.12 (2002-10-16)
</p><p>Removed SHA1 passwords; specified that room shall add passwords on invitations to password-protected rooms (not supplied by invitor).
(psa)
Version 0.11 (2002-10-16)
</p><p>Changed 'participant' to 'room user' and 'discussant' to 'participant'; clarified presence rule about client generation of extended presence information; added role of 'none'.
(psa)
Version 0.10 (2002-10-15)
</p><p>Fixed extended presence on entering or creating a room (plain '...muc' with no fragment); harmonized #user with #admin regarding the use of the &lt;item/&gt; element and associated attributes (jid, nick, etc.), and added 'role' attribute; modified management of voice, ban, admin, and member lists to use &lt;query/&gt; wrapper and new &lt;item/&gt; structure; changed the 'member' role to 'discussant', added 'outcast' role for banned users, and added new 'member' role to enable management of member lists; changed invitation-only rooms to members-only rooms and made appropriate adjustments to apply member lists to both members-only rooms and open rooms; modified nickname change protocol slightly to send the old nickname in the unavailable presence and the new nickname in the available presence; removed prohibition on members-only rooms that are password-protected; removed the &lt;query/&gt; wrapper for the &lt;destroy/&gt; element; updated the DTDs.
(psa)
Version 0.9 (2002-10-13)
</p><p>Added extended presence ('...#user') on entering a room for MUC clients; changed namespace on room creation request to '...#owner'; added a service discovery example using jabber:iq:browse; added information about discussion history; made small fixes to several examples; further defined the presence rules; transferred all implementation notes to a dedicated section; added a Terminology section.
(psa)
Version 0.8 (2002-10-10)
</p><p>Made further changes to the room creation workflow (finally correct); removed feature discovery use case (this needs to be addressed by a real service discovery protocol!); added ability for room owners to edit the admin list; removed &lt;body/&gt; from invitations generated by the service; removed messages sent to kicked and banned users (handled by unavailable presence with status code); added a number of implementation notes; converted all examples to Shakespeare style.
(psa)
Version 0.7.6 (2002-10-09)
</p><p>Fixed the room creation workflow; changed some terminology ("join" to "enter" and "leave" to "exit").
(psa)
Version 0.7.5 (2002-10-08)
</p><p>Specified and improved the handling of invitation-only rooms. In particular, added the ability for room admins to edit the invitation list and added a configuration option that limits the ability to send invitations to room admins only.
(psa)
Version 0.7.4 (2002-10-07)
</p><p>Changed namespaces from <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc/owner">http://jabber.org/protocol/muc/owner</a> etc. to <a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#owner">http://jabber.org/protocol/muc#owner</a> etc. per Jabber Council discussion.
(psa)
Version 0.7.3 (2002-10-07)
</p><p>Changed namespaces to HTTP URIs; left role handling up to the implementation; further clarified presence rules.
(psa)
Version 0.7.2 (2002-10-06)
</p><p>Disallowed kicking, banning, and revoking voice with respect to room admins and room owners; replaced &lt;x/&gt; with &lt;query/&gt; in the Discovering Room Features and Destroying a Room use cases; corrected some small errors and made many clarifications throughout.
(psa)
Version 0.7.1 (2002-10-04)
</p><p>Removed &lt;whois/&gt; command (unnecessary since participants with appropriate privileges receive the full JID of all participants in presence stanzas); completed many small fixes throughout.
(psa)
Version 0.7 (2002-10-03)
</p><p>More clearly delineated participant roles and defined the hierarchy thereof (owner, admin, member, visitor); replaced &lt;voice/&gt; element in extended presence with &lt;item role='member'/&gt;; changed initial room configuration to use IQ rather than message; adjusted presence rules (especially regarding extended presence information); cleaned up examples throughout; updated DTD to track changes.
(psa)
Version 0.6 (2002-09-21)
</p><p>More clearly defined the scope; removed fully anonymous rooms; changed meaning of semi-anonymous rooms and of non-anonymous rooms; added mechanism for notification of full JIDs in non-anonymous rooms; replaced the &lt;admin/&gt; element in extended presence with a &lt;role/&gt; element (more extensible); changed room passwords to cleartext; added status codes for various messages received from the service; added lists of valid error and status codes associated with the '<a rel="nofollow" class="external free" href="http://jabber.org/protocol/muc#user'">http://jabber.org/protocol/muc#user'</a> namespace; added a &lt;reason/&gt; element for invitations; made kick and ban reasons child elements rather than attributes; replaced stopgap feature discovery mechanism with jabber:iq:negotiate; added extended presence element to room creation request and clarified the room creation process; specified presence reflection rules; added method for destroying a room; adjusted DTDs to track all changes.
(psa)
Version 0.5.1 (2002-09-20)
</p><p>Added DTDs; changed feature discovery to use &lt;x/&gt; element rather than query and made service response come in IQ result; fixed reference to JID spec; changed 'grant' to 'add' and 'revoke' to 'remove' for consistency in the item attributes; made several other small changes.
(psa)
Version 0.5 (2002-09-19)
</p><p>Changed the kick, ban, and voice protocols; added a few more configuration options; specified the restrictions for roomnicks; and added a stopgap service discovery protocol.
(psa)
Version 0.4 (2002-09-18)
</p><p>Changed all non-GC-1.0 use cases to jabber:gc:* namespaces or jabber:x:data; added use cases for ban list management and room moderation; added protocol for sending notice of admin and voice privileges in presence; cleaned up text and many examples.
(psa)
Version 0.3 (2002-09-17)
</p><p>Changed admin use cases; cleaned up participant and owner use cases.
(psa)
Version 0.2 (2002-09-12)
</p><p>Broke content out into three actors (participant, owner, and admin) and added more detail to owner and admin use cases.
(psa)
Version 0.1 (2002-09-09)
</p><p>Initial version.
(psa)
</p><p>END
</p>
<!-- 
NewPP limit report
Preprocessor node count: 2657/1000000
Post-expand include size: 3182/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki:pcache:idhash:6-0!*!0!!zh-cn!*!* and timestamp 20160221162129 -->
</div><div class="printfooter">
来自“<a href="http://wiki.jabbercn.org/index.php?title=XEP-0045&amp;oldid=3565">http://wiki.jabbercn.org/index.php?title=XEP-0045&amp;oldid=3565</a>”</div>
		<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/%E7%89%B9%E6%AE%8A:%E9%A1%B5%E9%9D%A2%E5%88%86%E7%B1%BB" title="特殊:页面分类">2个分类</a>: <ul><li><a href="/%E5%88%86%E7%B1%BB:XMPP%E6%89%A9%E5%B1%95" title="分类:XMPP扩展">XMPP扩展</a></li><li><a href="/%E5%88%86%E7%B1%BB:%E5%B7%B2%E7%BF%BB%E8%AF%91" title="分类:已翻译">已翻译</a></li></ul></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-main" class="selected"><a href="/XEP-0045" title="查看内容页面 [c]" accesskey="c">页面</a></li>
				<li id="ca-talk" class="new"><a href="/index.php?title=%E8%AE%A8%E8%AE%BA:XEP-0045&amp;action=edit&amp;redlink=1" title="关于内容页面的讨论 [t]" accesskey="t">讨论</a></li>
				<li id="ca-viewsource"><a href="/index.php?title=XEP-0045&amp;action=edit" title="本页面已被保护。你可以查看其源代码。 [e]" accesskey="e">查看源代码</a></li>
				<li id="ca-history"><a href="/index.php?title=XEP-0045&amp;action=history" title="本页面的早前修订版本 [h]" accesskey="h">历史</a></li>
			</ul>
		</div>
	</div>

	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95&amp;returnto=XEP-0045" title="我们希望您可以登入，但不强求 [o]" accesskey="o">登录/创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="访问首页" style="background-image: url(/skins/common/images/xmppcn.png);" href="/%E9%A6%96%E9%A1%B5"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/%E9%A6%96%E9%A1%B5" title="访问首页 [z]" accesskey="z">首页</a></li>
				<li id="n-portal"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E7%A4%BE%E5%8C%BA%E4%B8%93%E9%A1%B5" title="关于本项目，你可以做什么，在哪里找到你需要的事物">社区专页</a></li>
				<li id="n-currentevents"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E6%96%B0%E9%97%BB%E5%8A%A8%E6%80%81" title="查看当前事件的背景信息">新闻动态</a></li>
				<li id="n-recentchanges"><a href="/%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9" title="本wiki的最近更改列表 [r]" accesskey="r">最近更改</a></li>
				<li id="n-randompage"><a href="/%E7%89%B9%E6%AE%8A:%E9%9A%8F%E6%9C%BA%E9%A1%B5%E9%9D%A2" title="随机进入一个页面 [x]" accesskey="x">随机页面</a></li>
				<li id="n-help"><a href="/%E5%B8%AE%E5%8A%A9:%E7%9B%AE%E5%BD%95" title="寻求帮助的地方">帮助</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-XMPP.E8.B5.84.E6.BA.90">
		<h5>XMPP资源</h5>
		<div class='pBody'>
			<ul>
				<li id="n-XMPP.E5.85.AC.E5.85.B1.E6.9C.8D.E5.8A.A1"><a href="/XMPP%E5%85%AC%E5%85%B1%E6%9C%8D%E5%8A%A1">XMPP公共服务</a></li>
				<li id="n-XMPP.E5.AE.A2.E6.88.B7.E7.AB.AF.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6">XMPP客户端软件</a></li>
				<li id="n-XMPP.E6.9C.8D.E5.8A.A1.E5.99.A8.E8.BD.AF.E4.BB.B6"><a href="/XMPP%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6">XMPP服务器软件</a></li>
				<li id="n-.E5.8F.8B.E6.83.85.E9.93.BE.E6.8E.A5"><a href="/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5">友情链接</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform">
				<input type='hidden' name="title" value="特殊:搜索"/>
				<input type="search" name="search" title="在Jabber/XMPP中文翻译计划中搜索 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="提交" title="如果相同的标题存在的话便直接前往该页面" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="搜索" title="搜索含这些文字的页面" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>




<script src="http://yacy.jabbercn.org:8090/yacy/ui/js/jquery-1.3.2.min.js" type="text/javascript"></script>
<script>
   $(document).ready(function() {
      yconf = {
         url : 'http://yacy.jabbercn.org:8090/',
         theme : 'smoothness',
         title : 'XMPP搜索大全',
         logo     : 'http://yacy.jabbercn.org:8090/env/grafics/50-xmpp_logo.jpg',
         link     : 'http://wiki.jabbercn.org',
         urlmaskfilter : '.*',
         width : 500,
         height : 500
      };
      $.getScript(yconf.url+'/yacy/ui/js/yacyui-portalsearch.js', function(){});
   });
</script>
        <div id="p-search" class="portlet">
<h5>站外搜索</h5>
<div id="yacylivesearch" class="pBody">
   <form id="ysearch" method="get" accept-charset="UTF-8" action="http://yacy.jabbercn.org:8090/yacysearch.html">
      <input name="search" id="yquery" type="text" size="8" maxlength="80" value=""/>
      <input type="hidden" name="verify" value="false" />
      <input type="hidden" name="maximumRecords" value="10" />
      <input type="hidden" name="resource" value="local" />
      <input type="hidden" name="urlmaskfilter" value=".*" />
      <input type="hidden" name="prefermaskfilter" value="" />
      <input type="hidden" name="former" value="" />
      <input type="hidden" name="display" value="2" />
      <input type="hidden" name="nav" value="all" />
      <input type="submit" name="Enter" value="搜索" class="searchButton" />
   </form>
</div>
</div>



	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%85%A5%E9%A1%B5%E9%9D%A2/XEP-0045" title="所有链入本页的wiki页面列表 [j]" accesskey="j">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%87%BA%E6%9B%B4%E6%94%B9/XEP-0045" title="本页链入的页面的最近更改 [k]" accesskey="k">链出更改</a></li>
				<li id="t-specialpages"><a href="/%E7%89%B9%E6%AE%8A:%E7%89%B9%E6%AE%8A%E9%A1%B5%E9%9D%A2" title="所有特殊页面列表 [q]" accesskey="q">特殊页面</a></li>
				<li><a href="/index.php?title=XEP-0045&amp;printable=yes" rel="alternate">可打印版</a></li>
				<li id="t-permalink"><a href="/index.php?title=XEP-0045&amp;oldid=3565" title="本页面该修订版本的永久链接">永久链接</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0 Unported" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> 本页面最后修订于2014年1月2日 (星期四) 14:01。</li>
		<li id="viewcount">此页面已被浏览过190,498次。</li>
		<li id="copyright">本站全部文字内容使用<a class="external" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Attribution-Noncommercial-Share Alike 3.0 Unported</a>授权。</li>
		<li id="privacy"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E9%9A%90%E7%A7%81%E6%9D%83%E6%94%BF%E7%AD%96" title="Jabber/XMPP中文翻译计划:隐私权政策">隐私权政策</a></li>
		<li id="about"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%B3%E4%BA%8E" title="Jabber/XMPP中文翻译计划:关于">关于Jabber/XMPP中文翻译计划</a></li>
		<li id="disclaimer"><a href="/Jabber/XMPP%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="Jabber/XMPP中文翻译计划:免责声明">免责声明</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax", "mediawiki.legacy.mwsuggest"]);
}
</script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"zh-cn","language":"zh-cn","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: mediawiki:resourceloader:filter:minify-js:4:42c4e9caefe8ca663d220ee0c286ac74 */
}
</script><!-- Piwik -->
<script type="text/javascript">
/* <![CDATA[ */
var pkBaseURL = (("https:" == document.location.protocol) ? "https://rtp.rooyee.im/piwik/" : "http://rtp.rooyee.im/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 5);
piwikTracker.setDocumentTitle("XEP-0045");
piwikTracker.setIgnoreClasses("image");

piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
/* ]]> */
</script><noscript><p><img src="http://rtp.rooyee.im/piwik/piwik.php?idsite=5" style="border:0" alt=""/></p></noscript>
<!-- /Piwik --><!-- Served in 0.041 secs. --></body></html>